var by=Object.defineProperty;var Iy=(r,t,i)=>t in r?by(r,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[t]=i;var ei=(r,t,i)=>(Iy(r,typeof t!="symbol"?t+"":t,i),i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function i(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(e){if(e.ep)return;e.ep=!0;const o=i(e);fetch(e.href,o)}})();var Ia=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zs(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var tv={exports:{}},js={},rv={exports:{}},se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zo=Symbol.for("react.element"),zy=Symbol.for("react.portal"),jy=Symbol.for("react.fragment"),Ny=Symbol.for("react.strict_mode"),Fy=Symbol.for("react.profiler"),Hy=Symbol.for("react.provider"),By=Symbol.for("react.context"),Gy=Symbol.for("react.forward_ref"),Wy=Symbol.for("react.suspense"),Vy=Symbol.for("react.memo"),Zy=Symbol.for("react.lazy"),yc=Symbol.iterator;function Uy(r){return r===null||typeof r!="object"?null:(r=yc&&r[yc]||r["@@iterator"],typeof r=="function"?r:null)}var iv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nv=Object.assign,ov={};function xn(r,t,i){this.props=r,this.context=t,this.refs=ov,this.updater=i||iv}xn.prototype.isReactComponent={};xn.prototype.setState=function(r,t){if(typeof r!="object"&&typeof r!="function"&&r!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,r,t,"setState")};xn.prototype.forceUpdate=function(r){this.updater.enqueueForceUpdate(this,r,"forceUpdate")};function av(){}av.prototype=xn.prototype;function Gu(r,t,i){this.props=r,this.context=t,this.refs=ov,this.updater=i||iv}var Wu=Gu.prototype=new av;Wu.constructor=Gu;nv(Wu,xn.prototype);Wu.isPureReactComponent=!0;var wc=Array.isArray,sv=Object.prototype.hasOwnProperty,Vu={current:null},lv={key:!0,ref:!0,__self:!0,__source:!0};function hv(r,t,i){var n,e={},o=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(o=""+t.key),t)sv.call(t,n)&&!lv.hasOwnProperty(n)&&(e[n]=t[n]);var s=arguments.length-2;if(s===1)e.children=i;else if(1<s){for(var l=Array(s),h=0;h<s;h++)l[h]=arguments[h+2];e.children=l}if(r&&r.defaultProps)for(n in s=r.defaultProps,s)e[n]===void 0&&(e[n]=s[n]);return{$$typeof:zo,type:r,key:o,ref:a,props:e,_owner:Vu.current}}function $y(r,t){return{$$typeof:zo,type:r.type,key:t,ref:r.ref,props:r.props,_owner:r._owner}}function Zu(r){return typeof r=="object"&&r!==null&&r.$$typeof===zo}function Xy(r){var t={"=":"=0",":":"=2"};return"$"+r.replace(/[=:]/g,function(i){return t[i]})}var xc=/\/+/g;function gl(r,t){return typeof r=="object"&&r!==null&&r.key!=null?Xy(""+r.key):t.toString(36)}function za(r,t,i,n,e){var o=typeof r;(o==="undefined"||o==="boolean")&&(r=null);var a=!1;if(r===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(r.$$typeof){case zo:case zy:a=!0}}if(a)return a=r,e=e(a),r=n===""?"."+gl(a,0):n,wc(e)?(i="",r!=null&&(i=r.replace(xc,"$&/")+"/"),za(e,t,i,"",function(h){return h})):e!=null&&(Zu(e)&&(e=$y(e,i+(!e.key||a&&a.key===e.key?"":(""+e.key).replace(xc,"$&/")+"/")+r)),t.push(e)),1;if(a=0,n=n===""?".":n+":",wc(r))for(var s=0;s<r.length;s++){o=r[s];var l=n+gl(o,s);a+=za(o,t,i,l,e)}else if(l=Uy(r),typeof l=="function")for(r=l.call(r),s=0;!(o=r.next()).done;)o=o.value,l=n+gl(o,s++),a+=za(o,t,i,l,e);else if(o==="object")throw t=String(r),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Qo(r,t,i){if(r==null)return r;var n=[],e=0;return za(r,n,"","",function(o){return t.call(i,o,e++)}),n}function Jy(r){if(r._status===-1){var t=r._result;t=t(),t.then(function(i){(r._status===0||r._status===-1)&&(r._status=1,r._result=i)},function(i){(r._status===0||r._status===-1)&&(r._status=2,r._result=i)}),r._status===-1&&(r._status=0,r._result=t)}if(r._status===1)return r._result.default;throw r._result}var st={current:null},ja={transition:null},Yy={ReactCurrentDispatcher:st,ReactCurrentBatchConfig:ja,ReactCurrentOwner:Vu};se.Children={map:Qo,forEach:function(r,t,i){Qo(r,function(){t.apply(this,arguments)},i)},count:function(r){var t=0;return Qo(r,function(){t++}),t},toArray:function(r){return Qo(r,function(t){return t})||[]},only:function(r){if(!Zu(r))throw Error("React.Children.only expected to receive a single React element child.");return r}};se.Component=xn;se.Fragment=jy;se.Profiler=Fy;se.PureComponent=Gu;se.StrictMode=Ny;se.Suspense=Wy;se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yy;se.cloneElement=function(r,t,i){if(r==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+r+".");var n=nv({},r.props),e=r.key,o=r.ref,a=r._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,a=Vu.current),t.key!==void 0&&(e=""+t.key),r.type&&r.type.defaultProps)var s=r.type.defaultProps;for(l in t)sv.call(t,l)&&!lv.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&s!==void 0?s[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=i;else if(1<l){s=Array(l);for(var h=0;h<l;h++)s[h]=arguments[h+2];n.children=s}return{$$typeof:zo,type:r.type,key:e,ref:o,props:n,_owner:a}};se.createContext=function(r){return r={$$typeof:By,_currentValue:r,_currentValue2:r,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},r.Provider={$$typeof:Hy,_context:r},r.Consumer=r};se.createElement=hv;se.createFactory=function(r){var t=hv.bind(null,r);return t.type=r,t};se.createRef=function(){return{current:null}};se.forwardRef=function(r){return{$$typeof:Gy,render:r}};se.isValidElement=Zu;se.lazy=function(r){return{$$typeof:Zy,_payload:{_status:-1,_result:r},_init:Jy}};se.memo=function(r,t){return{$$typeof:Vy,type:r,compare:t===void 0?null:t}};se.startTransition=function(r){var t=ja.transition;ja.transition={};try{r()}finally{ja.transition=t}};se.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};se.useCallback=function(r,t){return st.current.useCallback(r,t)};se.useContext=function(r){return st.current.useContext(r)};se.useDebugValue=function(){};se.useDeferredValue=function(r){return st.current.useDeferredValue(r)};se.useEffect=function(r,t){return st.current.useEffect(r,t)};se.useId=function(){return st.current.useId()};se.useImperativeHandle=function(r,t,i){return st.current.useImperativeHandle(r,t,i)};se.useInsertionEffect=function(r,t){return st.current.useInsertionEffect(r,t)};se.useLayoutEffect=function(r,t){return st.current.useLayoutEffect(r,t)};se.useMemo=function(r,t){return st.current.useMemo(r,t)};se.useReducer=function(r,t,i){return st.current.useReducer(r,t,i)};se.useRef=function(r){return st.current.useRef(r)};se.useState=function(r){return st.current.useState(r)};se.useSyncExternalStore=function(r,t,i){return st.current.useSyncExternalStore(r,t,i)};se.useTransition=function(){return st.current.useTransition()};se.version="18.2.0";rv.exports=se;var Xe=rv.exports;const Qy=zs(Xe);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qy=Xe,Ky=Symbol.for("react.element"),e0=Symbol.for("react.fragment"),t0=Object.prototype.hasOwnProperty,r0=qy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i0={key:!0,ref:!0,__self:!0,__source:!0};function uv(r,t,i){var n,e={},o=null,a=null;i!==void 0&&(o=""+i),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)t0.call(t,n)&&!i0.hasOwnProperty(n)&&(e[n]=t[n]);if(r&&r.defaultProps)for(n in t=r.defaultProps,t)e[n]===void 0&&(e[n]=t[n]);return{$$typeof:Ky,type:r,key:o,ref:a,props:e,_owner:r0.current}}js.Fragment=e0;js.jsx=uv;js.jsxs=uv;tv.exports=js;var We=tv.exports,Eh={},fv={exports:{}},Ct={},cv={exports:{}},dv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(r){function t(R,b){var N=R.length;R.push(b);e:for(;0<N;){var Z=N-1>>>1,X=R[Z];if(0<e(X,b))R[Z]=b,R[N]=X,N=Z;else break e}}function i(R){return R.length===0?null:R[0]}function n(R){if(R.length===0)return null;var b=R[0],N=R.pop();if(N!==b){R[0]=N;e:for(var Z=0,X=R.length,ne=X>>>1;Z<ne;){var te=2*(Z+1)-1,J=R[te],q=te+1,ue=R[q];if(0>e(J,N))q<X&&0>e(ue,J)?(R[Z]=ue,R[q]=N,Z=q):(R[Z]=J,R[te]=N,Z=te);else if(q<X&&0>e(ue,N))R[Z]=ue,R[q]=N,Z=q;else break e}}return b}function e(R,b){var N=R.sortIndex-b.sortIndex;return N!==0?N:R.id-b.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;r.unstable_now=function(){return o.now()}}else{var a=Date,s=a.now();r.unstable_now=function(){return a.now()-s}}var l=[],h=[],u=1,f=null,c=3,d=!1,g=!1,v=!1,y=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(R){for(var b=i(h);b!==null;){if(b.callback===null)n(h);else if(b.startTime<=R)n(h),b.sortIndex=b.expirationTime,t(l,b);else break;b=i(h)}}function w(R){if(v=!1,_(R),!g)if(i(l)!==null)g=!0,H(C);else{var b=i(h);b!==null&&B(w,b.startTime-R)}}function C(R,b){g=!1,v&&(v=!1,p(P),P=-1),d=!0;var N=c;try{for(_(b),f=i(l);f!==null&&(!(f.expirationTime>b)||R&&!D());){var Z=f.callback;if(typeof Z=="function"){f.callback=null,c=f.priorityLevel;var X=Z(f.expirationTime<=b);b=r.unstable_now(),typeof X=="function"?f.callback=X:f===i(l)&&n(l),_(b)}else n(l);f=i(l)}if(f!==null)var ne=!0;else{var te=i(h);te!==null&&B(w,te.startTime-b),ne=!1}return ne}finally{f=null,c=N,d=!1}}var x=!1,T=null,P=-1,S=5,E=-1;function D(){return!(r.unstable_now()-E<S)}function A(){if(T!==null){var R=r.unstable_now();E=R;var b=!0;try{b=T(!0,R)}finally{b?I():(x=!1,T=null)}}else x=!1}var I;if(typeof m=="function")I=function(){m(A)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,O=L.port2;L.port1.onmessage=A,I=function(){O.postMessage(null)}}else I=function(){y(A,0)};function H(R){T=R,x||(x=!0,I())}function B(R,b){P=y(function(){R(r.unstable_now())},b)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(R){R.callback=null},r.unstable_continueExecution=function(){g||d||(g=!0,H(C))},r.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<R?Math.floor(1e3/R):5},r.unstable_getCurrentPriorityLevel=function(){return c},r.unstable_getFirstCallbackNode=function(){return i(l)},r.unstable_next=function(R){switch(c){case 1:case 2:case 3:var b=3;break;default:b=c}var N=c;c=b;try{return R()}finally{c=N}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(R,b){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var N=c;c=R;try{return b()}finally{c=N}},r.unstable_scheduleCallback=function(R,b,N){var Z=r.unstable_now();switch(typeof N=="object"&&N!==null?(N=N.delay,N=typeof N=="number"&&0<N?Z+N:Z):N=Z,R){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=N+X,R={id:u++,callback:b,priorityLevel:R,startTime:N,expirationTime:X,sortIndex:-1},N>Z?(R.sortIndex=N,t(h,R),i(l)===null&&R===i(h)&&(v?(p(P),P=-1):v=!0,B(w,N-Z))):(R.sortIndex=X,t(l,R),g||d||(g=!0,H(C))),R},r.unstable_shouldYield=D,r.unstable_wrapCallback=function(R){var b=c;return function(){var N=c;c=b;try{return R.apply(this,arguments)}finally{c=N}}}})(dv);cv.exports=dv;var n0=cv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gv=Xe,xt=n0;function G(r){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+r,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+r+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var vv=new Set,po={};function yi(r,t){fn(r,t),fn(r+"Capture",t)}function fn(r,t){for(po[r]=t,r=0;r<t.length;r++)vv.add(t[r])}var gr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kh=Object.prototype.hasOwnProperty,o0=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Cc={},Pc={};function a0(r){return kh.call(Pc,r)?!0:kh.call(Cc,r)?!1:o0.test(r)?Pc[r]=!0:(Cc[r]=!0,!1)}function s0(r,t,i,n){if(i!==null&&i.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:i!==null?!i.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function l0(r,t,i,n){if(t===null||typeof t>"u"||s0(r,t,i,n))return!0;if(n)return!1;if(i!==null)switch(i.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function lt(r,t,i,n,e,o,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=e,this.mustUseProperty=i,this.propertyName=r,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var Ye={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){Ye[r]=new lt(r,0,!1,r,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var t=r[0];Ye[t]=new lt(t,1,!1,r[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(r){Ye[r]=new lt(r,2,!1,r.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){Ye[r]=new lt(r,2,!1,r,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){Ye[r]=new lt(r,3,!1,r.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(r){Ye[r]=new lt(r,3,!0,r,null,!1,!1)});["capture","download"].forEach(function(r){Ye[r]=new lt(r,4,!1,r,null,!1,!1)});["cols","rows","size","span"].forEach(function(r){Ye[r]=new lt(r,6,!1,r,null,!1,!1)});["rowSpan","start"].forEach(function(r){Ye[r]=new lt(r,5,!1,r.toLowerCase(),null,!1,!1)});var Uu=/[\-:]([a-z])/g;function $u(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var t=r.replace(Uu,$u);Ye[t]=new lt(t,1,!1,r,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var t=r.replace(Uu,$u);Ye[t]=new lt(t,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(r){var t=r.replace(Uu,$u);Ye[t]=new lt(t,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(r){Ye[r]=new lt(r,1,!1,r.toLowerCase(),null,!1,!1)});Ye.xlinkHref=new lt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(r){Ye[r]=new lt(r,1,!1,r.toLowerCase(),null,!0,!0)});function Xu(r,t,i,n){var e=Ye.hasOwnProperty(t)?Ye[t]:null;(e!==null?e.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(l0(t,i,e,n)&&(i=null),n||e===null?a0(t)&&(i===null?r.removeAttribute(t):r.setAttribute(t,""+i)):e.mustUseProperty?r[e.propertyName]=i===null?e.type===3?!1:"":i:(t=e.attributeName,n=e.attributeNamespace,i===null?r.removeAttribute(t):(e=e.type,i=e===3||e===4&&i===!0?"":""+i,n?r.setAttributeNS(n,t,i):r.setAttribute(t,i))))}var xr=gv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qo=Symbol.for("react.element"),Ii=Symbol.for("react.portal"),zi=Symbol.for("react.fragment"),Ju=Symbol.for("react.strict_mode"),Rh=Symbol.for("react.profiler"),pv=Symbol.for("react.provider"),mv=Symbol.for("react.context"),Yu=Symbol.for("react.forward_ref"),Ah=Symbol.for("react.suspense"),Oh=Symbol.for("react.suspense_list"),Qu=Symbol.for("react.memo"),kr=Symbol.for("react.lazy"),_v=Symbol.for("react.offscreen"),Tc=Symbol.iterator;function Rn(r){return r===null||typeof r!="object"?null:(r=Tc&&r[Tc]||r["@@iterator"],typeof r=="function"?r:null)}var Ee=Object.assign,vl;function Qn(r){if(vl===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);vl=t&&t[1]||""}return`
`+vl+r}var pl=!1;function ml(r,t){if(!r||pl)return"";pl=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var n=h}Reflect.construct(r,[],t)}else{try{t.call()}catch(h){n=h}r.call(t.prototype)}else{try{throw Error()}catch(h){n=h}r()}}catch(h){if(h&&n&&typeof h.stack=="string"){for(var e=h.stack.split(`
`),o=n.stack.split(`
`),a=e.length-1,s=o.length-1;1<=a&&0<=s&&e[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(e[a]!==o[s]){if(a!==1||s!==1)do if(a--,s--,0>s||e[a]!==o[s]){var l=`
`+e[a].replace(" at new "," at ");return r.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",r.displayName)),l}while(1<=a&&0<=s);break}}}finally{pl=!1,Error.prepareStackTrace=i}return(r=r?r.displayName||r.name:"")?Qn(r):""}function h0(r){switch(r.tag){case 5:return Qn(r.type);case 16:return Qn("Lazy");case 13:return Qn("Suspense");case 19:return Qn("SuspenseList");case 0:case 2:case 15:return r=ml(r.type,!1),r;case 11:return r=ml(r.type.render,!1),r;case 1:return r=ml(r.type,!0),r;default:return""}}function Lh(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case zi:return"Fragment";case Ii:return"Portal";case Rh:return"Profiler";case Ju:return"StrictMode";case Ah:return"Suspense";case Oh:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case mv:return(r.displayName||"Context")+".Consumer";case pv:return(r._context.displayName||"Context")+".Provider";case Yu:var t=r.render;return r=r.displayName,r||(r=t.displayName||t.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case Qu:return t=r.displayName||null,t!==null?t:Lh(r.type)||"Memo";case kr:t=r._payload,r=r._init;try{return Lh(r(t))}catch{}}return null}function u0(r){var t=r.type;switch(r.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=t.render,r=r.displayName||r.name||"",t.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Lh(t);case 8:return t===Ju?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function $r(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function yv(r){var t=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function f0(r){var t=yv(r)?"checked":"value",i=Object.getOwnPropertyDescriptor(r.constructor.prototype,t),n=""+r[t];if(!r.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var e=i.get,o=i.set;return Object.defineProperty(r,t,{configurable:!0,get:function(){return e.call(this)},set:function(a){n=""+a,o.call(this,a)}}),Object.defineProperty(r,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){r._valueTracker=null,delete r[t]}}}}function Ko(r){r._valueTracker||(r._valueTracker=f0(r))}function wv(r){if(!r)return!1;var t=r._valueTracker;if(!t)return!0;var i=t.getValue(),n="";return r&&(n=yv(r)?r.checked?"true":"false":r.value),r=n,r!==i?(t.setValue(r),!0):!1}function qa(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Dh(r,t){var i=t.checked;return Ee({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??r._wrapperState.initialChecked})}function Sc(r,t){var i=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;i=$r(t.value!=null?t.value:i),r._wrapperState={initialChecked:n,initialValue:i,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function xv(r,t){t=t.checked,t!=null&&Xu(r,"checked",t,!1)}function bh(r,t){xv(r,t);var i=$r(t.value),n=t.type;if(i!=null)n==="number"?(i===0&&r.value===""||r.value!=i)&&(r.value=""+i):r.value!==""+i&&(r.value=""+i);else if(n==="submit"||n==="reset"){r.removeAttribute("value");return}t.hasOwnProperty("value")?Ih(r,t.type,i):t.hasOwnProperty("defaultValue")&&Ih(r,t.type,$r(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(r.defaultChecked=!!t.defaultChecked)}function Mc(r,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+r._wrapperState.initialValue,i||t===r.value||(r.value=t),r.defaultValue=t}i=r.name,i!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,i!==""&&(r.name=i)}function Ih(r,t,i){(t!=="number"||qa(r.ownerDocument)!==r)&&(i==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+i&&(r.defaultValue=""+i))}var qn=Array.isArray;function Ji(r,t,i,n){if(r=r.options,t){t={};for(var e=0;e<i.length;e++)t["$"+i[e]]=!0;for(i=0;i<r.length;i++)e=t.hasOwnProperty("$"+r[i].value),r[i].selected!==e&&(r[i].selected=e),e&&n&&(r[i].defaultSelected=!0)}else{for(i=""+$r(i),t=null,e=0;e<r.length;e++){if(r[e].value===i){r[e].selected=!0,n&&(r[e].defaultSelected=!0);return}t!==null||r[e].disabled||(t=r[e])}t!==null&&(t.selected=!0)}}function zh(r,t){if(t.dangerouslySetInnerHTML!=null)throw Error(G(91));return Ee({},t,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Ec(r,t){var i=t.value;if(i==null){if(i=t.children,t=t.defaultValue,i!=null){if(t!=null)throw Error(G(92));if(qn(i)){if(1<i.length)throw Error(G(93));i=i[0]}t=i}t==null&&(t=""),i=t}r._wrapperState={initialValue:$r(i)}}function Cv(r,t){var i=$r(t.value),n=$r(t.defaultValue);i!=null&&(i=""+i,i!==r.value&&(r.value=i),t.defaultValue==null&&r.defaultValue!==i&&(r.defaultValue=i)),n!=null&&(r.defaultValue=""+n)}function kc(r){var t=r.textContent;t===r._wrapperState.initialValue&&t!==""&&t!==null&&(r.value=t)}function Pv(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jh(r,t){return r==null||r==="http://www.w3.org/1999/xhtml"?Pv(t):r==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var ea,Tv=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,i,n,e){MSApp.execUnsafeLocalFunction(function(){return r(t,i,n,e)})}:r}(function(r,t){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=t;else{for(ea=ea||document.createElement("div"),ea.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ea.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;t.firstChild;)r.appendChild(t.firstChild)}});function mo(r,t){if(t){var i=r.firstChild;if(i&&i===r.lastChild&&i.nodeType===3){i.nodeValue=t;return}}r.textContent=t}var ao={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},c0=["Webkit","ms","Moz","O"];Object.keys(ao).forEach(function(r){c0.forEach(function(t){t=t+r.charAt(0).toUpperCase()+r.substring(1),ao[t]=ao[r]})});function Sv(r,t,i){return t==null||typeof t=="boolean"||t===""?"":i||typeof t!="number"||t===0||ao.hasOwnProperty(r)&&ao[r]?(""+t).trim():t+"px"}function Mv(r,t){r=r.style;for(var i in t)if(t.hasOwnProperty(i)){var n=i.indexOf("--")===0,e=Sv(i,t[i],n);i==="float"&&(i="cssFloat"),n?r.setProperty(i,e):r[i]=e}}var d0=Ee({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Nh(r,t){if(t){if(d0[r]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(G(137,r));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(G(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(G(61))}if(t.style!=null&&typeof t.style!="object")throw Error(G(62))}}function Fh(r,t){if(r.indexOf("-")===-1)return typeof t.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hh=null;function qu(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Bh=null,Yi=null,Qi=null;function Rc(r){if(r=Fo(r)){if(typeof Bh!="function")throw Error(G(280));var t=r.stateNode;t&&(t=Gs(t),Bh(r.stateNode,r.type,t))}}function Ev(r){Yi?Qi?Qi.push(r):Qi=[r]:Yi=r}function kv(){if(Yi){var r=Yi,t=Qi;if(Qi=Yi=null,Rc(r),t)for(r=0;r<t.length;r++)Rc(t[r])}}function Rv(r,t){return r(t)}function Av(){}var _l=!1;function Ov(r,t,i){if(_l)return r(t,i);_l=!0;try{return Rv(r,t,i)}finally{_l=!1,(Yi!==null||Qi!==null)&&(Av(),kv())}}function _o(r,t){var i=r.stateNode;if(i===null)return null;var n=Gs(i);if(n===null)return null;i=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(r=r.type,n=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!n;break e;default:r=!1}if(r)return null;if(i&&typeof i!="function")throw Error(G(231,t,typeof i));return i}var Gh=!1;if(gr)try{var An={};Object.defineProperty(An,"passive",{get:function(){Gh=!0}}),window.addEventListener("test",An,An),window.removeEventListener("test",An,An)}catch{Gh=!1}function g0(r,t,i,n,e,o,a,s,l){var h=Array.prototype.slice.call(arguments,3);try{t.apply(i,h)}catch(u){this.onError(u)}}var so=!1,Ka=null,es=!1,Wh=null,v0={onError:function(r){so=!0,Ka=r}};function p0(r,t,i,n,e,o,a,s,l){so=!1,Ka=null,g0.apply(v0,arguments)}function m0(r,t,i,n,e,o,a,s,l){if(p0.apply(this,arguments),so){if(so){var h=Ka;so=!1,Ka=null}else throw Error(G(198));es||(es=!0,Wh=h)}}function wi(r){var t=r,i=r;if(r.alternate)for(;t.return;)t=t.return;else{r=t;do t=r,t.flags&4098&&(i=t.return),r=t.return;while(r)}return t.tag===3?i:null}function Lv(r){if(r.tag===13){var t=r.memoizedState;if(t===null&&(r=r.alternate,r!==null&&(t=r.memoizedState)),t!==null)return t.dehydrated}return null}function Ac(r){if(wi(r)!==r)throw Error(G(188))}function _0(r){var t=r.alternate;if(!t){if(t=wi(r),t===null)throw Error(G(188));return t!==r?null:r}for(var i=r,n=t;;){var e=i.return;if(e===null)break;var o=e.alternate;if(o===null){if(n=e.return,n!==null){i=n;continue}break}if(e.child===o.child){for(o=e.child;o;){if(o===i)return Ac(e),r;if(o===n)return Ac(e),t;o=o.sibling}throw Error(G(188))}if(i.return!==n.return)i=e,n=o;else{for(var a=!1,s=e.child;s;){if(s===i){a=!0,i=e,n=o;break}if(s===n){a=!0,n=e,i=o;break}s=s.sibling}if(!a){for(s=o.child;s;){if(s===i){a=!0,i=o,n=e;break}if(s===n){a=!0,n=o,i=e;break}s=s.sibling}if(!a)throw Error(G(189))}}if(i.alternate!==n)throw Error(G(190))}if(i.tag!==3)throw Error(G(188));return i.stateNode.current===i?r:t}function Dv(r){return r=_0(r),r!==null?bv(r):null}function bv(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var t=bv(r);if(t!==null)return t;r=r.sibling}return null}var Iv=xt.unstable_scheduleCallback,Oc=xt.unstable_cancelCallback,y0=xt.unstable_shouldYield,w0=xt.unstable_requestPaint,be=xt.unstable_now,x0=xt.unstable_getCurrentPriorityLevel,Ku=xt.unstable_ImmediatePriority,zv=xt.unstable_UserBlockingPriority,ts=xt.unstable_NormalPriority,C0=xt.unstable_LowPriority,jv=xt.unstable_IdlePriority,Ns=null,tr=null;function P0(r){if(tr&&typeof tr.onCommitFiberRoot=="function")try{tr.onCommitFiberRoot(Ns,r,void 0,(r.current.flags&128)===128)}catch{}}var Wt=Math.clz32?Math.clz32:M0,T0=Math.log,S0=Math.LN2;function M0(r){return r>>>=0,r===0?32:31-(T0(r)/S0|0)|0}var ta=64,ra=4194304;function Kn(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function rs(r,t){var i=r.pendingLanes;if(i===0)return 0;var n=0,e=r.suspendedLanes,o=r.pingedLanes,a=i&268435455;if(a!==0){var s=a&~e;s!==0?n=Kn(s):(o&=a,o!==0&&(n=Kn(o)))}else a=i&~e,a!==0?n=Kn(a):o!==0&&(n=Kn(o));if(n===0)return 0;if(t!==0&&t!==n&&!(t&e)&&(e=n&-n,o=t&-t,e>=o||e===16&&(o&4194240)!==0))return t;if(n&4&&(n|=i&16),t=r.entangledLanes,t!==0)for(r=r.entanglements,t&=n;0<t;)i=31-Wt(t),e=1<<i,n|=r[i],t&=~e;return n}function E0(r,t){switch(r){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function k0(r,t){for(var i=r.suspendedLanes,n=r.pingedLanes,e=r.expirationTimes,o=r.pendingLanes;0<o;){var a=31-Wt(o),s=1<<a,l=e[a];l===-1?(!(s&i)||s&n)&&(e[a]=E0(s,t)):l<=t&&(r.expiredLanes|=s),o&=~s}}function Vh(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function Nv(){var r=ta;return ta<<=1,!(ta&4194240)&&(ta=64),r}function yl(r){for(var t=[],i=0;31>i;i++)t.push(r);return t}function jo(r,t,i){r.pendingLanes|=t,t!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,t=31-Wt(t),r[t]=i}function R0(r,t){var i=r.pendingLanes&~t;r.pendingLanes=t,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=t,r.mutableReadLanes&=t,r.entangledLanes&=t,t=r.entanglements;var n=r.eventTimes;for(r=r.expirationTimes;0<i;){var e=31-Wt(i),o=1<<e;t[e]=0,n[e]=-1,r[e]=-1,i&=~o}}function ef(r,t){var i=r.entangledLanes|=t;for(r=r.entanglements;i;){var n=31-Wt(i),e=1<<n;e&t|r[n]&t&&(r[n]|=t),i&=~e}}var ce=0;function Fv(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var Hv,tf,Bv,Gv,Wv,Zh=!1,ia=[],Fr=null,Hr=null,Br=null,yo=new Map,wo=new Map,Lr=[],A0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lc(r,t){switch(r){case"focusin":case"focusout":Fr=null;break;case"dragenter":case"dragleave":Hr=null;break;case"mouseover":case"mouseout":Br=null;break;case"pointerover":case"pointerout":yo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":wo.delete(t.pointerId)}}function On(r,t,i,n,e,o){return r===null||r.nativeEvent!==o?(r={blockedOn:t,domEventName:i,eventSystemFlags:n,nativeEvent:o,targetContainers:[e]},t!==null&&(t=Fo(t),t!==null&&tf(t)),r):(r.eventSystemFlags|=n,t=r.targetContainers,e!==null&&t.indexOf(e)===-1&&t.push(e),r)}function O0(r,t,i,n,e){switch(t){case"focusin":return Fr=On(Fr,r,t,i,n,e),!0;case"dragenter":return Hr=On(Hr,r,t,i,n,e),!0;case"mouseover":return Br=On(Br,r,t,i,n,e),!0;case"pointerover":var o=e.pointerId;return yo.set(o,On(yo.get(o)||null,r,t,i,n,e)),!0;case"gotpointercapture":return o=e.pointerId,wo.set(o,On(wo.get(o)||null,r,t,i,n,e)),!0}return!1}function Vv(r){var t=ni(r.target);if(t!==null){var i=wi(t);if(i!==null){if(t=i.tag,t===13){if(t=Lv(i),t!==null){r.blockedOn=t,Wv(r.priority,function(){Bv(i)});return}}else if(t===3&&i.stateNode.current.memoizedState.isDehydrated){r.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Na(r){if(r.blockedOn!==null)return!1;for(var t=r.targetContainers;0<t.length;){var i=Uh(r.domEventName,r.eventSystemFlags,t[0],r.nativeEvent);if(i===null){i=r.nativeEvent;var n=new i.constructor(i.type,i);Hh=n,i.target.dispatchEvent(n),Hh=null}else return t=Fo(i),t!==null&&tf(t),r.blockedOn=i,!1;t.shift()}return!0}function Dc(r,t,i){Na(r)&&i.delete(t)}function L0(){Zh=!1,Fr!==null&&Na(Fr)&&(Fr=null),Hr!==null&&Na(Hr)&&(Hr=null),Br!==null&&Na(Br)&&(Br=null),yo.forEach(Dc),wo.forEach(Dc)}function Ln(r,t){r.blockedOn===t&&(r.blockedOn=null,Zh||(Zh=!0,xt.unstable_scheduleCallback(xt.unstable_NormalPriority,L0)))}function xo(r){function t(e){return Ln(e,r)}if(0<ia.length){Ln(ia[0],r);for(var i=1;i<ia.length;i++){var n=ia[i];n.blockedOn===r&&(n.blockedOn=null)}}for(Fr!==null&&Ln(Fr,r),Hr!==null&&Ln(Hr,r),Br!==null&&Ln(Br,r),yo.forEach(t),wo.forEach(t),i=0;i<Lr.length;i++)n=Lr[i],n.blockedOn===r&&(n.blockedOn=null);for(;0<Lr.length&&(i=Lr[0],i.blockedOn===null);)Vv(i),i.blockedOn===null&&Lr.shift()}var qi=xr.ReactCurrentBatchConfig,is=!0;function D0(r,t,i,n){var e=ce,o=qi.transition;qi.transition=null;try{ce=1,rf(r,t,i,n)}finally{ce=e,qi.transition=o}}function b0(r,t,i,n){var e=ce,o=qi.transition;qi.transition=null;try{ce=4,rf(r,t,i,n)}finally{ce=e,qi.transition=o}}function rf(r,t,i,n){if(is){var e=Uh(r,t,i,n);if(e===null)Rl(r,t,n,ns,i),Lc(r,n);else if(O0(e,r,t,i,n))n.stopPropagation();else if(Lc(r,n),t&4&&-1<A0.indexOf(r)){for(;e!==null;){var o=Fo(e);if(o!==null&&Hv(o),o=Uh(r,t,i,n),o===null&&Rl(r,t,n,ns,i),o===e)break;e=o}e!==null&&n.stopPropagation()}else Rl(r,t,n,null,i)}}var ns=null;function Uh(r,t,i,n){if(ns=null,r=qu(n),r=ni(r),r!==null)if(t=wi(r),t===null)r=null;else if(i=t.tag,i===13){if(r=Lv(t),r!==null)return r;r=null}else if(i===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;r=null}else t!==r&&(r=null);return ns=r,null}function Zv(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(x0()){case Ku:return 1;case zv:return 4;case ts:case C0:return 16;case jv:return 536870912;default:return 16}default:return 16}}var jr=null,nf=null,Fa=null;function Uv(){if(Fa)return Fa;var r,t=nf,i=t.length,n,e="value"in jr?jr.value:jr.textContent,o=e.length;for(r=0;r<i&&t[r]===e[r];r++);var a=i-r;for(n=1;n<=a&&t[i-n]===e[o-n];n++);return Fa=e.slice(r,1<n?1-n:void 0)}function Ha(r){var t=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&t===13&&(r=13)):r=t,r===10&&(r=13),32<=r||r===13?r:0}function na(){return!0}function bc(){return!1}function Pt(r){function t(i,n,e,o,a){this._reactName=i,this._targetInst=e,this.type=n,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var s in r)r.hasOwnProperty(s)&&(i=r[s],this[s]=i?i(o):o[s]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?na:bc,this.isPropagationStopped=bc,this}return Ee(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=na)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=na)},persist:function(){},isPersistent:na}),t}var Cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},of=Pt(Cn),No=Ee({},Cn,{view:0,detail:0}),I0=Pt(No),wl,xl,Dn,Fs=Ee({},No,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:af,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Dn&&(Dn&&r.type==="mousemove"?(wl=r.screenX-Dn.screenX,xl=r.screenY-Dn.screenY):xl=wl=0,Dn=r),wl)},movementY:function(r){return"movementY"in r?r.movementY:xl}}),Ic=Pt(Fs),z0=Ee({},Fs,{dataTransfer:0}),j0=Pt(z0),N0=Ee({},No,{relatedTarget:0}),Cl=Pt(N0),F0=Ee({},Cn,{animationName:0,elapsedTime:0,pseudoElement:0}),H0=Pt(F0),B0=Ee({},Cn,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),G0=Pt(B0),W0=Ee({},Cn,{data:0}),zc=Pt(W0),V0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Z0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},U0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $0(r){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(r):(r=U0[r])?!!t[r]:!1}function af(){return $0}var X0=Ee({},No,{key:function(r){if(r.key){var t=V0[r.key]||r.key;if(t!=="Unidentified")return t}return r.type==="keypress"?(r=Ha(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Z0[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:af,charCode:function(r){return r.type==="keypress"?Ha(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ha(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),J0=Pt(X0),Y0=Ee({},Fs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jc=Pt(Y0),Q0=Ee({},No,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:af}),q0=Pt(Q0),K0=Ee({},Cn,{propertyName:0,elapsedTime:0,pseudoElement:0}),ew=Pt(K0),tw=Ee({},Fs,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),rw=Pt(tw),iw=[9,13,27,32],sf=gr&&"CompositionEvent"in window,lo=null;gr&&"documentMode"in document&&(lo=document.documentMode);var nw=gr&&"TextEvent"in window&&!lo,$v=gr&&(!sf||lo&&8<lo&&11>=lo),Nc=String.fromCharCode(32),Fc=!1;function Xv(r,t){switch(r){case"keyup":return iw.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jv(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ji=!1;function ow(r,t){switch(r){case"compositionend":return Jv(t);case"keypress":return t.which!==32?null:(Fc=!0,Nc);case"textInput":return r=t.data,r===Nc&&Fc?null:r;default:return null}}function aw(r,t){if(ji)return r==="compositionend"||!sf&&Xv(r,t)?(r=Uv(),Fa=nf=jr=null,ji=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return $v&&t.locale!=="ko"?null:t.data;default:return null}}var sw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hc(r){var t=r&&r.nodeName&&r.nodeName.toLowerCase();return t==="input"?!!sw[r.type]:t==="textarea"}function Yv(r,t,i,n){Ev(n),t=os(t,"onChange"),0<t.length&&(i=new of("onChange","change",null,i,n),r.push({event:i,listeners:t}))}var ho=null,Co=null;function lw(r){sp(r,0)}function Hs(r){var t=Hi(r);if(wv(t))return r}function hw(r,t){if(r==="change")return t}var Qv=!1;if(gr){var Pl;if(gr){var Tl="oninput"in document;if(!Tl){var Bc=document.createElement("div");Bc.setAttribute("oninput","return;"),Tl=typeof Bc.oninput=="function"}Pl=Tl}else Pl=!1;Qv=Pl&&(!document.documentMode||9<document.documentMode)}function Gc(){ho&&(ho.detachEvent("onpropertychange",qv),Co=ho=null)}function qv(r){if(r.propertyName==="value"&&Hs(Co)){var t=[];Yv(t,Co,r,qu(r)),Ov(lw,t)}}function uw(r,t,i){r==="focusin"?(Gc(),ho=t,Co=i,ho.attachEvent("onpropertychange",qv)):r==="focusout"&&Gc()}function fw(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Hs(Co)}function cw(r,t){if(r==="click")return Hs(t)}function dw(r,t){if(r==="input"||r==="change")return Hs(t)}function gw(r,t){return r===t&&(r!==0||1/r===1/t)||r!==r&&t!==t}var Ut=typeof Object.is=="function"?Object.is:gw;function Po(r,t){if(Ut(r,t))return!0;if(typeof r!="object"||r===null||typeof t!="object"||t===null)return!1;var i=Object.keys(r),n=Object.keys(t);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var e=i[n];if(!kh.call(t,e)||!Ut(r[e],t[e]))return!1}return!0}function Wc(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Vc(r,t){var i=Wc(r);r=0;for(var n;i;){if(i.nodeType===3){if(n=r+i.textContent.length,r<=t&&n>=t)return{node:i,offset:t-r};r=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Wc(i)}}function Kv(r,t){return r&&t?r===t?!0:r&&r.nodeType===3?!1:t&&t.nodeType===3?Kv(r,t.parentNode):"contains"in r?r.contains(t):r.compareDocumentPosition?!!(r.compareDocumentPosition(t)&16):!1:!1}function ep(){for(var r=window,t=qa();t instanceof r.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)r=t.contentWindow;else break;t=qa(r.document)}return t}function lf(r){var t=r&&r.nodeName&&r.nodeName.toLowerCase();return t&&(t==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||t==="textarea"||r.contentEditable==="true")}function vw(r){var t=ep(),i=r.focusedElem,n=r.selectionRange;if(t!==i&&i&&i.ownerDocument&&Kv(i.ownerDocument.documentElement,i)){if(n!==null&&lf(i)){if(t=n.start,r=n.end,r===void 0&&(r=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(r,i.value.length);else if(r=(t=i.ownerDocument||document)&&t.defaultView||window,r.getSelection){r=r.getSelection();var e=i.textContent.length,o=Math.min(n.start,e);n=n.end===void 0?o:Math.min(n.end,e),!r.extend&&o>n&&(e=n,n=o,o=e),e=Vc(i,o);var a=Vc(i,n);e&&a&&(r.rangeCount!==1||r.anchorNode!==e.node||r.anchorOffset!==e.offset||r.focusNode!==a.node||r.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(e.node,e.offset),r.removeAllRanges(),o>n?(r.addRange(t),r.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),r.addRange(t)))}}for(t=[],r=i;r=r.parentNode;)r.nodeType===1&&t.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<t.length;i++)r=t[i],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var pw=gr&&"documentMode"in document&&11>=document.documentMode,Ni=null,$h=null,uo=null,Xh=!1;function Zc(r,t,i){var n=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Xh||Ni==null||Ni!==qa(n)||(n=Ni,"selectionStart"in n&&lf(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),uo&&Po(uo,n)||(uo=n,n=os($h,"onSelect"),0<n.length&&(t=new of("onSelect","select",null,t,i),r.push({event:t,listeners:n}),t.target=Ni)))}function oa(r,t){var i={};return i[r.toLowerCase()]=t.toLowerCase(),i["Webkit"+r]="webkit"+t,i["Moz"+r]="moz"+t,i}var Fi={animationend:oa("Animation","AnimationEnd"),animationiteration:oa("Animation","AnimationIteration"),animationstart:oa("Animation","AnimationStart"),transitionend:oa("Transition","TransitionEnd")},Sl={},tp={};gr&&(tp=document.createElement("div").style,"AnimationEvent"in window||(delete Fi.animationend.animation,delete Fi.animationiteration.animation,delete Fi.animationstart.animation),"TransitionEvent"in window||delete Fi.transitionend.transition);function Bs(r){if(Sl[r])return Sl[r];if(!Fi[r])return r;var t=Fi[r],i;for(i in t)if(t.hasOwnProperty(i)&&i in tp)return Sl[r]=t[i];return r}var rp=Bs("animationend"),ip=Bs("animationiteration"),np=Bs("animationstart"),op=Bs("transitionend"),ap=new Map,Uc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qr(r,t){ap.set(r,t),yi(t,[r])}for(var Ml=0;Ml<Uc.length;Ml++){var El=Uc[Ml],mw=El.toLowerCase(),_w=El[0].toUpperCase()+El.slice(1);Qr(mw,"on"+_w)}Qr(rp,"onAnimationEnd");Qr(ip,"onAnimationIteration");Qr(np,"onAnimationStart");Qr("dblclick","onDoubleClick");Qr("focusin","onFocus");Qr("focusout","onBlur");Qr(op,"onTransitionEnd");fn("onMouseEnter",["mouseout","mouseover"]);fn("onMouseLeave",["mouseout","mouseover"]);fn("onPointerEnter",["pointerout","pointerover"]);fn("onPointerLeave",["pointerout","pointerover"]);yi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yi("onBeforeInput",["compositionend","keypress","textInput","paste"]);yi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var eo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yw=new Set("cancel close invalid load scroll toggle".split(" ").concat(eo));function $c(r,t,i){var n=r.type||"unknown-event";r.currentTarget=i,m0(n,t,void 0,r),r.currentTarget=null}function sp(r,t){t=(t&4)!==0;for(var i=0;i<r.length;i++){var n=r[i],e=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var a=n.length-1;0<=a;a--){var s=n[a],l=s.instance,h=s.currentTarget;if(s=s.listener,l!==o&&e.isPropagationStopped())break e;$c(e,s,h),o=l}else for(a=0;a<n.length;a++){if(s=n[a],l=s.instance,h=s.currentTarget,s=s.listener,l!==o&&e.isPropagationStopped())break e;$c(e,s,h),o=l}}}if(es)throw r=Wh,es=!1,Wh=null,r}function ye(r,t){var i=t[Kh];i===void 0&&(i=t[Kh]=new Set);var n=r+"__bubble";i.has(n)||(lp(t,r,2,!1),i.add(n))}function kl(r,t,i){var n=0;t&&(n|=4),lp(i,r,n,t)}var aa="_reactListening"+Math.random().toString(36).slice(2);function To(r){if(!r[aa]){r[aa]=!0,vv.forEach(function(i){i!=="selectionchange"&&(yw.has(i)||kl(i,!1,r),kl(i,!0,r))});var t=r.nodeType===9?r:r.ownerDocument;t===null||t[aa]||(t[aa]=!0,kl("selectionchange",!1,t))}}function lp(r,t,i,n){switch(Zv(t)){case 1:var e=D0;break;case 4:e=b0;break;default:e=rf}i=e.bind(null,t,i,r),e=void 0,!Gh||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(e=!0),n?e!==void 0?r.addEventListener(t,i,{capture:!0,passive:e}):r.addEventListener(t,i,!0):e!==void 0?r.addEventListener(t,i,{passive:e}):r.addEventListener(t,i,!1)}function Rl(r,t,i,n,e){var o=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var s=n.stateNode.containerInfo;if(s===e||s.nodeType===8&&s.parentNode===e)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===e||l.nodeType===8&&l.parentNode===e))return;a=a.return}for(;s!==null;){if(a=ni(s),a===null)return;if(l=a.tag,l===5||l===6){n=o=a;continue e}s=s.parentNode}}n=n.return}Ov(function(){var h=o,u=qu(i),f=[];e:{var c=ap.get(r);if(c!==void 0){var d=of,g=r;switch(r){case"keypress":if(Ha(i)===0)break e;case"keydown":case"keyup":d=J0;break;case"focusin":g="focus",d=Cl;break;case"focusout":g="blur",d=Cl;break;case"beforeblur":case"afterblur":d=Cl;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=Ic;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=j0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=q0;break;case rp:case ip:case np:d=H0;break;case op:d=ew;break;case"scroll":d=I0;break;case"wheel":d=rw;break;case"copy":case"cut":case"paste":d=G0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=jc}var v=(t&4)!==0,y=!v&&r==="scroll",p=v?c!==null?c+"Capture":null:c;v=[];for(var m=h,_;m!==null;){_=m;var w=_.stateNode;if(_.tag===5&&w!==null&&(_=w,p!==null&&(w=_o(m,p),w!=null&&v.push(So(m,w,_)))),y)break;m=m.return}0<v.length&&(c=new d(c,g,null,i,u),f.push({event:c,listeners:v}))}}if(!(t&7)){e:{if(c=r==="mouseover"||r==="pointerover",d=r==="mouseout"||r==="pointerout",c&&i!==Hh&&(g=i.relatedTarget||i.fromElement)&&(ni(g)||g[vr]))break e;if((d||c)&&(c=u.window===u?u:(c=u.ownerDocument)?c.defaultView||c.parentWindow:window,d?(g=i.relatedTarget||i.toElement,d=h,g=g?ni(g):null,g!==null&&(y=wi(g),g!==y||g.tag!==5&&g.tag!==6)&&(g=null)):(d=null,g=h),d!==g)){if(v=Ic,w="onMouseLeave",p="onMouseEnter",m="mouse",(r==="pointerout"||r==="pointerover")&&(v=jc,w="onPointerLeave",p="onPointerEnter",m="pointer"),y=d==null?c:Hi(d),_=g==null?c:Hi(g),c=new v(w,m+"leave",d,i,u),c.target=y,c.relatedTarget=_,w=null,ni(u)===h&&(v=new v(p,m+"enter",g,i,u),v.target=_,v.relatedTarget=y,w=v),y=w,d&&g)t:{for(v=d,p=g,m=0,_=v;_;_=Ci(_))m++;for(_=0,w=p;w;w=Ci(w))_++;for(;0<m-_;)v=Ci(v),m--;for(;0<_-m;)p=Ci(p),_--;for(;m--;){if(v===p||p!==null&&v===p.alternate)break t;v=Ci(v),p=Ci(p)}v=null}else v=null;d!==null&&Xc(f,c,d,v,!1),g!==null&&y!==null&&Xc(f,y,g,v,!0)}}e:{if(c=h?Hi(h):window,d=c.nodeName&&c.nodeName.toLowerCase(),d==="select"||d==="input"&&c.type==="file")var C=hw;else if(Hc(c))if(Qv)C=dw;else{C=fw;var x=uw}else(d=c.nodeName)&&d.toLowerCase()==="input"&&(c.type==="checkbox"||c.type==="radio")&&(C=cw);if(C&&(C=C(r,h))){Yv(f,C,i,u);break e}x&&x(r,c,h),r==="focusout"&&(x=c._wrapperState)&&x.controlled&&c.type==="number"&&Ih(c,"number",c.value)}switch(x=h?Hi(h):window,r){case"focusin":(Hc(x)||x.contentEditable==="true")&&(Ni=x,$h=h,uo=null);break;case"focusout":uo=$h=Ni=null;break;case"mousedown":Xh=!0;break;case"contextmenu":case"mouseup":case"dragend":Xh=!1,Zc(f,i,u);break;case"selectionchange":if(pw)break;case"keydown":case"keyup":Zc(f,i,u)}var T;if(sf)e:{switch(r){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else ji?Xv(r,i)&&(P="onCompositionEnd"):r==="keydown"&&i.keyCode===229&&(P="onCompositionStart");P&&($v&&i.locale!=="ko"&&(ji||P!=="onCompositionStart"?P==="onCompositionEnd"&&ji&&(T=Uv()):(jr=u,nf="value"in jr?jr.value:jr.textContent,ji=!0)),x=os(h,P),0<x.length&&(P=new zc(P,r,null,i,u),f.push({event:P,listeners:x}),T?P.data=T:(T=Jv(i),T!==null&&(P.data=T)))),(T=nw?ow(r,i):aw(r,i))&&(h=os(h,"onBeforeInput"),0<h.length&&(u=new zc("onBeforeInput","beforeinput",null,i,u),f.push({event:u,listeners:h}),u.data=T))}sp(f,t)})}function So(r,t,i){return{instance:r,listener:t,currentTarget:i}}function os(r,t){for(var i=t+"Capture",n=[];r!==null;){var e=r,o=e.stateNode;e.tag===5&&o!==null&&(e=o,o=_o(r,i),o!=null&&n.unshift(So(r,o,e)),o=_o(r,t),o!=null&&n.push(So(r,o,e))),r=r.return}return n}function Ci(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Xc(r,t,i,n,e){for(var o=t._reactName,a=[];i!==null&&i!==n;){var s=i,l=s.alternate,h=s.stateNode;if(l!==null&&l===n)break;s.tag===5&&h!==null&&(s=h,e?(l=_o(i,o),l!=null&&a.unshift(So(i,l,s))):e||(l=_o(i,o),l!=null&&a.push(So(i,l,s)))),i=i.return}a.length!==0&&r.push({event:t,listeners:a})}var ww=/\r\n?/g,xw=/\u0000|\uFFFD/g;function Jc(r){return(typeof r=="string"?r:""+r).replace(ww,`
`).replace(xw,"")}function sa(r,t,i){if(t=Jc(t),Jc(r)!==t&&i)throw Error(G(425))}function as(){}var Jh=null,Yh=null;function Qh(r,t){return r==="textarea"||r==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var qh=typeof setTimeout=="function"?setTimeout:void 0,Cw=typeof clearTimeout=="function"?clearTimeout:void 0,Yc=typeof Promise=="function"?Promise:void 0,Pw=typeof queueMicrotask=="function"?queueMicrotask:typeof Yc<"u"?function(r){return Yc.resolve(null).then(r).catch(Tw)}:qh;function Tw(r){setTimeout(function(){throw r})}function Al(r,t){var i=t,n=0;do{var e=i.nextSibling;if(r.removeChild(i),e&&e.nodeType===8)if(i=e.data,i==="/$"){if(n===0){r.removeChild(e),xo(t);return}n--}else i!=="$"&&i!=="$?"&&i!=="$!"||n++;i=e}while(i);xo(t)}function Gr(r){for(;r!=null;r=r.nextSibling){var t=r.nodeType;if(t===1||t===3)break;if(t===8){if(t=r.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return r}function Qc(r){r=r.previousSibling;for(var t=0;r;){if(r.nodeType===8){var i=r.data;if(i==="$"||i==="$!"||i==="$?"){if(t===0)return r;t--}else i==="/$"&&t++}r=r.previousSibling}return null}var Pn=Math.random().toString(36).slice(2),qt="__reactFiber$"+Pn,Mo="__reactProps$"+Pn,vr="__reactContainer$"+Pn,Kh="__reactEvents$"+Pn,Sw="__reactListeners$"+Pn,Mw="__reactHandles$"+Pn;function ni(r){var t=r[qt];if(t)return t;for(var i=r.parentNode;i;){if(t=i[vr]||i[qt]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(r=Qc(r);r!==null;){if(i=r[qt])return i;r=Qc(r)}return t}r=i,i=r.parentNode}return null}function Fo(r){return r=r[qt]||r[vr],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Hi(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(G(33))}function Gs(r){return r[Mo]||null}var eu=[],Bi=-1;function qr(r){return{current:r}}function we(r){0>Bi||(r.current=eu[Bi],eu[Bi]=null,Bi--)}function pe(r,t){Bi++,eu[Bi]=r.current,r.current=t}var Xr={},tt=qr(Xr),dt=qr(!1),fi=Xr;function cn(r,t){var i=r.type.contextTypes;if(!i)return Xr;var n=r.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var e={},o;for(o in i)e[o]=t[o];return n&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=t,r.__reactInternalMemoizedMaskedChildContext=e),e}function gt(r){return r=r.childContextTypes,r!=null}function ss(){we(dt),we(tt)}function qc(r,t,i){if(tt.current!==Xr)throw Error(G(168));pe(tt,t),pe(dt,i)}function hp(r,t,i){var n=r.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return i;n=n.getChildContext();for(var e in n)if(!(e in t))throw Error(G(108,u0(r)||"Unknown",e));return Ee({},i,n)}function ls(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Xr,fi=tt.current,pe(tt,r),pe(dt,dt.current),!0}function Kc(r,t,i){var n=r.stateNode;if(!n)throw Error(G(169));i?(r=hp(r,t,fi),n.__reactInternalMemoizedMergedChildContext=r,we(dt),we(tt),pe(tt,r)):we(dt),pe(dt,i)}var hr=null,Ws=!1,Ol=!1;function up(r){hr===null?hr=[r]:hr.push(r)}function Ew(r){Ws=!0,up(r)}function Kr(){if(!Ol&&hr!==null){Ol=!0;var r=0,t=ce;try{var i=hr;for(ce=1;r<i.length;r++){var n=i[r];do n=n(!0);while(n!==null)}hr=null,Ws=!1}catch(e){throw hr!==null&&(hr=hr.slice(r+1)),Iv(Ku,Kr),e}finally{ce=t,Ol=!1}}return null}var Gi=[],Wi=0,hs=null,us=0,Rt=[],At=0,ci=null,ur=1,fr="";function ri(r,t){Gi[Wi++]=us,Gi[Wi++]=hs,hs=r,us=t}function fp(r,t,i){Rt[At++]=ur,Rt[At++]=fr,Rt[At++]=ci,ci=r;var n=ur;r=fr;var e=32-Wt(n)-1;n&=~(1<<e),i+=1;var o=32-Wt(t)+e;if(30<o){var a=e-e%5;o=(n&(1<<a)-1).toString(32),n>>=a,e-=a,ur=1<<32-Wt(t)+e|i<<e|n,fr=o+r}else ur=1<<o|i<<e|n,fr=r}function hf(r){r.return!==null&&(ri(r,1),fp(r,1,0))}function uf(r){for(;r===hs;)hs=Gi[--Wi],Gi[Wi]=null,us=Gi[--Wi],Gi[Wi]=null;for(;r===ci;)ci=Rt[--At],Rt[At]=null,fr=Rt[--At],Rt[At]=null,ur=Rt[--At],Rt[At]=null}var yt=null,mt=null,Ce=!1,Gt=null;function cp(r,t){var i=Ot(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=r,t=r.deletions,t===null?(r.deletions=[i],r.flags|=16):t.push(i)}function ed(r,t){switch(r.tag){case 5:var i=r.type;return t=t.nodeType!==1||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(r.stateNode=t,yt=r,mt=Gr(t.firstChild),!0):!1;case 6:return t=r.pendingProps===""||t.nodeType!==3?null:t,t!==null?(r.stateNode=t,yt=r,mt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(i=ci!==null?{id:ur,overflow:fr}:null,r.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},i=Ot(18,null,null,0),i.stateNode=t,i.return=r,r.child=i,yt=r,mt=null,!0):!1;default:return!1}}function tu(r){return(r.mode&1)!==0&&(r.flags&128)===0}function ru(r){if(Ce){var t=mt;if(t){var i=t;if(!ed(r,t)){if(tu(r))throw Error(G(418));t=Gr(i.nextSibling);var n=yt;t&&ed(r,t)?cp(n,i):(r.flags=r.flags&-4097|2,Ce=!1,yt=r)}}else{if(tu(r))throw Error(G(418));r.flags=r.flags&-4097|2,Ce=!1,yt=r}}}function td(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;yt=r}function la(r){if(r!==yt)return!1;if(!Ce)return td(r),Ce=!0,!1;var t;if((t=r.tag!==3)&&!(t=r.tag!==5)&&(t=r.type,t=t!=="head"&&t!=="body"&&!Qh(r.type,r.memoizedProps)),t&&(t=mt)){if(tu(r))throw dp(),Error(G(418));for(;t;)cp(r,t),t=Gr(t.nextSibling)}if(td(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(G(317));e:{for(r=r.nextSibling,t=0;r;){if(r.nodeType===8){var i=r.data;if(i==="/$"){if(t===0){mt=Gr(r.nextSibling);break e}t--}else i!=="$"&&i!=="$!"&&i!=="$?"||t++}r=r.nextSibling}mt=null}}else mt=yt?Gr(r.stateNode.nextSibling):null;return!0}function dp(){for(var r=mt;r;)r=Gr(r.nextSibling)}function dn(){mt=yt=null,Ce=!1}function ff(r){Gt===null?Gt=[r]:Gt.push(r)}var kw=xr.ReactCurrentBatchConfig;function Ht(r,t){if(r&&r.defaultProps){t=Ee({},t),r=r.defaultProps;for(var i in r)t[i]===void 0&&(t[i]=r[i]);return t}return t}var fs=qr(null),cs=null,Vi=null,cf=null;function df(){cf=Vi=cs=null}function gf(r){var t=fs.current;we(fs),r._currentValue=t}function iu(r,t,i){for(;r!==null;){var n=r.alternate;if((r.childLanes&t)!==t?(r.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),r===i)break;r=r.return}}function Ki(r,t){cs=r,cf=Vi=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&t&&(ct=!0),r.firstContext=null)}function bt(r){var t=r._currentValue;if(cf!==r)if(r={context:r,memoizedValue:t,next:null},Vi===null){if(cs===null)throw Error(G(308));Vi=r,cs.dependencies={lanes:0,firstContext:r}}else Vi=Vi.next=r;return t}var oi=null;function vf(r){oi===null?oi=[r]:oi.push(r)}function gp(r,t,i,n){var e=t.interleaved;return e===null?(i.next=i,vf(t)):(i.next=e.next,e.next=i),t.interleaved=i,pr(r,n)}function pr(r,t){r.lanes|=t;var i=r.alternate;for(i!==null&&(i.lanes|=t),i=r,r=r.return;r!==null;)r.childLanes|=t,i=r.alternate,i!==null&&(i.childLanes|=t),i=r,r=r.return;return i.tag===3?i.stateNode:null}var Rr=!1;function pf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vp(r,t){r=r.updateQueue,t.updateQueue===r&&(t.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function cr(r,t){return{eventTime:r,lane:t,tag:0,payload:null,callback:null,next:null}}function Wr(r,t,i){var n=r.updateQueue;if(n===null)return null;if(n=n.shared,le&2){var e=n.pending;return e===null?t.next=t:(t.next=e.next,e.next=t),n.pending=t,pr(r,i)}return e=n.interleaved,e===null?(t.next=t,vf(n)):(t.next=e.next,e.next=t),n.interleaved=t,pr(r,i)}function Ba(r,t,i){if(t=t.updateQueue,t!==null&&(t=t.shared,(i&4194240)!==0)){var n=t.lanes;n&=r.pendingLanes,i|=n,t.lanes=i,ef(r,i)}}function rd(r,t){var i=r.updateQueue,n=r.alternate;if(n!==null&&(n=n.updateQueue,i===n)){var e=null,o=null;if(i=i.firstBaseUpdate,i!==null){do{var a={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};o===null?e=o=a:o=o.next=a,i=i.next}while(i!==null);o===null?e=o=t:o=o.next=t}else e=o=t;i={baseState:n.baseState,firstBaseUpdate:e,lastBaseUpdate:o,shared:n.shared,effects:n.effects},r.updateQueue=i;return}r=i.lastBaseUpdate,r===null?i.firstBaseUpdate=t:r.next=t,i.lastBaseUpdate=t}function ds(r,t,i,n){var e=r.updateQueue;Rr=!1;var o=e.firstBaseUpdate,a=e.lastBaseUpdate,s=e.shared.pending;if(s!==null){e.shared.pending=null;var l=s,h=l.next;l.next=null,a===null?o=h:a.next=h,a=l;var u=r.alternate;u!==null&&(u=u.updateQueue,s=u.lastBaseUpdate,s!==a&&(s===null?u.firstBaseUpdate=h:s.next=h,u.lastBaseUpdate=l))}if(o!==null){var f=e.baseState;a=0,u=h=l=null,s=o;do{var c=s.lane,d=s.eventTime;if((n&c)===c){u!==null&&(u=u.next={eventTime:d,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var g=r,v=s;switch(c=t,d=i,v.tag){case 1:if(g=v.payload,typeof g=="function"){f=g.call(d,f,c);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=v.payload,c=typeof g=="function"?g.call(d,f,c):g,c==null)break e;f=Ee({},f,c);break e;case 2:Rr=!0}}s.callback!==null&&s.lane!==0&&(r.flags|=64,c=e.effects,c===null?e.effects=[s]:c.push(s))}else d={eventTime:d,lane:c,tag:s.tag,payload:s.payload,callback:s.callback,next:null},u===null?(h=u=d,l=f):u=u.next=d,a|=c;if(s=s.next,s===null){if(s=e.shared.pending,s===null)break;c=s,s=c.next,c.next=null,e.lastBaseUpdate=c,e.shared.pending=null}}while(1);if(u===null&&(l=f),e.baseState=l,e.firstBaseUpdate=h,e.lastBaseUpdate=u,t=e.shared.interleaved,t!==null){e=t;do a|=e.lane,e=e.next;while(e!==t)}else o===null&&(e.shared.lanes=0);gi|=a,r.lanes=a,r.memoizedState=f}}function id(r,t,i){if(r=t.effects,t.effects=null,r!==null)for(t=0;t<r.length;t++){var n=r[t],e=n.callback;if(e!==null){if(n.callback=null,n=i,typeof e!="function")throw Error(G(191,e));e.call(n)}}}var pp=new gv.Component().refs;function nu(r,t,i,n){t=r.memoizedState,i=i(n,t),i=i==null?t:Ee({},t,i),r.memoizedState=i,r.lanes===0&&(r.updateQueue.baseState=i)}var Vs={isMounted:function(r){return(r=r._reactInternals)?wi(r)===r:!1},enqueueSetState:function(r,t,i){r=r._reactInternals;var n=at(),e=Zr(r),o=cr(n,e);o.payload=t,i!=null&&(o.callback=i),t=Wr(r,o,e),t!==null&&(Vt(t,r,e,n),Ba(t,r,e))},enqueueReplaceState:function(r,t,i){r=r._reactInternals;var n=at(),e=Zr(r),o=cr(n,e);o.tag=1,o.payload=t,i!=null&&(o.callback=i),t=Wr(r,o,e),t!==null&&(Vt(t,r,e,n),Ba(t,r,e))},enqueueForceUpdate:function(r,t){r=r._reactInternals;var i=at(),n=Zr(r),e=cr(i,n);e.tag=2,t!=null&&(e.callback=t),t=Wr(r,e,n),t!==null&&(Vt(t,r,n,i),Ba(t,r,n))}};function nd(r,t,i,n,e,o,a){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(n,o,a):t.prototype&&t.prototype.isPureReactComponent?!Po(i,n)||!Po(e,o):!0}function mp(r,t,i){var n=!1,e=Xr,o=t.contextType;return typeof o=="object"&&o!==null?o=bt(o):(e=gt(t)?fi:tt.current,n=t.contextTypes,o=(n=n!=null)?cn(r,e):Xr),t=new t(i,o),r.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Vs,r.stateNode=t,t._reactInternals=r,n&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=e,r.__reactInternalMemoizedMaskedChildContext=o),t}function od(r,t,i,n){r=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==r&&Vs.enqueueReplaceState(t,t.state,null)}function ou(r,t,i,n){var e=r.stateNode;e.props=i,e.state=r.memoizedState,e.refs=pp,pf(r);var o=t.contextType;typeof o=="object"&&o!==null?e.context=bt(o):(o=gt(t)?fi:tt.current,e.context=cn(r,o)),e.state=r.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(nu(r,t,o,i),e.state=r.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof e.getSnapshotBeforeUpdate=="function"||typeof e.UNSAFE_componentWillMount!="function"&&typeof e.componentWillMount!="function"||(t=e.state,typeof e.componentWillMount=="function"&&e.componentWillMount(),typeof e.UNSAFE_componentWillMount=="function"&&e.UNSAFE_componentWillMount(),t!==e.state&&Vs.enqueueReplaceState(e,e.state,null),ds(r,i,e,n),e.state=r.memoizedState),typeof e.componentDidMount=="function"&&(r.flags|=4194308)}function bn(r,t,i){if(r=i.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(G(309));var n=i.stateNode}if(!n)throw Error(G(147,r));var e=n,o=""+r;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(a){var s=e.refs;s===pp&&(s=e.refs={}),a===null?delete s[o]:s[o]=a},t._stringRef=o,t)}if(typeof r!="string")throw Error(G(284));if(!i._owner)throw Error(G(290,r))}return r}function ha(r,t){throw r=Object.prototype.toString.call(t),Error(G(31,r==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":r))}function ad(r){var t=r._init;return t(r._payload)}function _p(r){function t(p,m){if(r){var _=p.deletions;_===null?(p.deletions=[m],p.flags|=16):_.push(m)}}function i(p,m){if(!r)return null;for(;m!==null;)t(p,m),m=m.sibling;return null}function n(p,m){for(p=new Map;m!==null;)m.key!==null?p.set(m.key,m):p.set(m.index,m),m=m.sibling;return p}function e(p,m){return p=Ur(p,m),p.index=0,p.sibling=null,p}function o(p,m,_){return p.index=_,r?(_=p.alternate,_!==null?(_=_.index,_<m?(p.flags|=2,m):_):(p.flags|=2,m)):(p.flags|=1048576,m)}function a(p){return r&&p.alternate===null&&(p.flags|=2),p}function s(p,m,_,w){return m===null||m.tag!==6?(m=Nl(_,p.mode,w),m.return=p,m):(m=e(m,_),m.return=p,m)}function l(p,m,_,w){var C=_.type;return C===zi?u(p,m,_.props.children,w,_.key):m!==null&&(m.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===kr&&ad(C)===m.type)?(w=e(m,_.props),w.ref=bn(p,m,_),w.return=p,w):(w=$a(_.type,_.key,_.props,null,p.mode,w),w.ref=bn(p,m,_),w.return=p,w)}function h(p,m,_,w){return m===null||m.tag!==4||m.stateNode.containerInfo!==_.containerInfo||m.stateNode.implementation!==_.implementation?(m=Fl(_,p.mode,w),m.return=p,m):(m=e(m,_.children||[]),m.return=p,m)}function u(p,m,_,w,C){return m===null||m.tag!==7?(m=li(_,p.mode,w,C),m.return=p,m):(m=e(m,_),m.return=p,m)}function f(p,m,_){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Nl(""+m,p.mode,_),m.return=p,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case qo:return _=$a(m.type,m.key,m.props,null,p.mode,_),_.ref=bn(p,null,m),_.return=p,_;case Ii:return m=Fl(m,p.mode,_),m.return=p,m;case kr:var w=m._init;return f(p,w(m._payload),_)}if(qn(m)||Rn(m))return m=li(m,p.mode,_,null),m.return=p,m;ha(p,m)}return null}function c(p,m,_,w){var C=m!==null?m.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return C!==null?null:s(p,m,""+_,w);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case qo:return _.key===C?l(p,m,_,w):null;case Ii:return _.key===C?h(p,m,_,w):null;case kr:return C=_._init,c(p,m,C(_._payload),w)}if(qn(_)||Rn(_))return C!==null?null:u(p,m,_,w,null);ha(p,_)}return null}function d(p,m,_,w,C){if(typeof w=="string"&&w!==""||typeof w=="number")return p=p.get(_)||null,s(m,p,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case qo:return p=p.get(w.key===null?_:w.key)||null,l(m,p,w,C);case Ii:return p=p.get(w.key===null?_:w.key)||null,h(m,p,w,C);case kr:var x=w._init;return d(p,m,_,x(w._payload),C)}if(qn(w)||Rn(w))return p=p.get(_)||null,u(m,p,w,C,null);ha(m,w)}return null}function g(p,m,_,w){for(var C=null,x=null,T=m,P=m=0,S=null;T!==null&&P<_.length;P++){T.index>P?(S=T,T=null):S=T.sibling;var E=c(p,T,_[P],w);if(E===null){T===null&&(T=S);break}r&&T&&E.alternate===null&&t(p,T),m=o(E,m,P),x===null?C=E:x.sibling=E,x=E,T=S}if(P===_.length)return i(p,T),Ce&&ri(p,P),C;if(T===null){for(;P<_.length;P++)T=f(p,_[P],w),T!==null&&(m=o(T,m,P),x===null?C=T:x.sibling=T,x=T);return Ce&&ri(p,P),C}for(T=n(p,T);P<_.length;P++)S=d(T,p,P,_[P],w),S!==null&&(r&&S.alternate!==null&&T.delete(S.key===null?P:S.key),m=o(S,m,P),x===null?C=S:x.sibling=S,x=S);return r&&T.forEach(function(D){return t(p,D)}),Ce&&ri(p,P),C}function v(p,m,_,w){var C=Rn(_);if(typeof C!="function")throw Error(G(150));if(_=C.call(_),_==null)throw Error(G(151));for(var x=C=null,T=m,P=m=0,S=null,E=_.next();T!==null&&!E.done;P++,E=_.next()){T.index>P?(S=T,T=null):S=T.sibling;var D=c(p,T,E.value,w);if(D===null){T===null&&(T=S);break}r&&T&&D.alternate===null&&t(p,T),m=o(D,m,P),x===null?C=D:x.sibling=D,x=D,T=S}if(E.done)return i(p,T),Ce&&ri(p,P),C;if(T===null){for(;!E.done;P++,E=_.next())E=f(p,E.value,w),E!==null&&(m=o(E,m,P),x===null?C=E:x.sibling=E,x=E);return Ce&&ri(p,P),C}for(T=n(p,T);!E.done;P++,E=_.next())E=d(T,p,P,E.value,w),E!==null&&(r&&E.alternate!==null&&T.delete(E.key===null?P:E.key),m=o(E,m,P),x===null?C=E:x.sibling=E,x=E);return r&&T.forEach(function(A){return t(p,A)}),Ce&&ri(p,P),C}function y(p,m,_,w){if(typeof _=="object"&&_!==null&&_.type===zi&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case qo:e:{for(var C=_.key,x=m;x!==null;){if(x.key===C){if(C=_.type,C===zi){if(x.tag===7){i(p,x.sibling),m=e(x,_.props.children),m.return=p,p=m;break e}}else if(x.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===kr&&ad(C)===x.type){i(p,x.sibling),m=e(x,_.props),m.ref=bn(p,x,_),m.return=p,p=m;break e}i(p,x);break}else t(p,x);x=x.sibling}_.type===zi?(m=li(_.props.children,p.mode,w,_.key),m.return=p,p=m):(w=$a(_.type,_.key,_.props,null,p.mode,w),w.ref=bn(p,m,_),w.return=p,p=w)}return a(p);case Ii:e:{for(x=_.key;m!==null;){if(m.key===x)if(m.tag===4&&m.stateNode.containerInfo===_.containerInfo&&m.stateNode.implementation===_.implementation){i(p,m.sibling),m=e(m,_.children||[]),m.return=p,p=m;break e}else{i(p,m);break}else t(p,m);m=m.sibling}m=Fl(_,p.mode,w),m.return=p,p=m}return a(p);case kr:return x=_._init,y(p,m,x(_._payload),w)}if(qn(_))return g(p,m,_,w);if(Rn(_))return v(p,m,_,w);ha(p,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,m!==null&&m.tag===6?(i(p,m.sibling),m=e(m,_),m.return=p,p=m):(i(p,m),m=Nl(_,p.mode,w),m.return=p,p=m),a(p)):i(p,m)}return y}var gn=_p(!0),yp=_p(!1),Ho={},rr=qr(Ho),Eo=qr(Ho),ko=qr(Ho);function ai(r){if(r===Ho)throw Error(G(174));return r}function mf(r,t){switch(pe(ko,t),pe(Eo,r),pe(rr,Ho),r=t.nodeType,r){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:jh(null,"");break;default:r=r===8?t.parentNode:t,t=r.namespaceURI||null,r=r.tagName,t=jh(t,r)}we(rr),pe(rr,t)}function vn(){we(rr),we(Eo),we(ko)}function wp(r){ai(ko.current);var t=ai(rr.current),i=jh(t,r.type);t!==i&&(pe(Eo,r),pe(rr,i))}function _f(r){Eo.current===r&&(we(rr),we(Eo))}var Te=qr(0);function gs(r){for(var t=r;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break;for(;t.sibling===null;){if(t.return===null||t.return===r)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ll=[];function yf(){for(var r=0;r<Ll.length;r++)Ll[r]._workInProgressVersionPrimary=null;Ll.length=0}var Ga=xr.ReactCurrentDispatcher,Dl=xr.ReactCurrentBatchConfig,di=0,Me=null,je=null,Be=null,vs=!1,fo=!1,Ro=0,Rw=0;function Qe(){throw Error(G(321))}function wf(r,t){if(t===null)return!1;for(var i=0;i<t.length&&i<r.length;i++)if(!Ut(r[i],t[i]))return!1;return!0}function xf(r,t,i,n,e,o){if(di=o,Me=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ga.current=r===null||r.memoizedState===null?Dw:bw,r=i(n,e),fo){o=0;do{if(fo=!1,Ro=0,25<=o)throw Error(G(301));o+=1,Be=je=null,t.updateQueue=null,Ga.current=Iw,r=i(n,e)}while(fo)}if(Ga.current=ps,t=je!==null&&je.next!==null,di=0,Be=je=Me=null,vs=!1,t)throw Error(G(300));return r}function Cf(){var r=Ro!==0;return Ro=0,r}function Qt(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Be===null?Me.memoizedState=Be=r:Be=Be.next=r,Be}function It(){if(je===null){var r=Me.alternate;r=r!==null?r.memoizedState:null}else r=je.next;var t=Be===null?Me.memoizedState:Be.next;if(t!==null)Be=t,je=r;else{if(r===null)throw Error(G(310));je=r,r={memoizedState:je.memoizedState,baseState:je.baseState,baseQueue:je.baseQueue,queue:je.queue,next:null},Be===null?Me.memoizedState=Be=r:Be=Be.next=r}return Be}function Ao(r,t){return typeof t=="function"?t(r):t}function bl(r){var t=It(),i=t.queue;if(i===null)throw Error(G(311));i.lastRenderedReducer=r;var n=je,e=n.baseQueue,o=i.pending;if(o!==null){if(e!==null){var a=e.next;e.next=o.next,o.next=a}n.baseQueue=e=o,i.pending=null}if(e!==null){o=e.next,n=n.baseState;var s=a=null,l=null,h=o;do{var u=h.lane;if((di&u)===u)l!==null&&(l=l.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),n=h.hasEagerState?h.eagerState:r(n,h.action);else{var f={lane:u,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};l===null?(s=l=f,a=n):l=l.next=f,Me.lanes|=u,gi|=u}h=h.next}while(h!==null&&h!==o);l===null?a=n:l.next=s,Ut(n,t.memoizedState)||(ct=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,i.lastRenderedState=n}if(r=i.interleaved,r!==null){e=r;do o=e.lane,Me.lanes|=o,gi|=o,e=e.next;while(e!==r)}else e===null&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function Il(r){var t=It(),i=t.queue;if(i===null)throw Error(G(311));i.lastRenderedReducer=r;var n=i.dispatch,e=i.pending,o=t.memoizedState;if(e!==null){i.pending=null;var a=e=e.next;do o=r(o,a.action),a=a.next;while(a!==e);Ut(o,t.memoizedState)||(ct=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),i.lastRenderedState=o}return[o,n]}function xp(){}function Cp(r,t){var i=Me,n=It(),e=t(),o=!Ut(n.memoizedState,e);if(o&&(n.memoizedState=e,ct=!0),n=n.queue,Pf(Sp.bind(null,i,n,r),[r]),n.getSnapshot!==t||o||Be!==null&&Be.memoizedState.tag&1){if(i.flags|=2048,Oo(9,Tp.bind(null,i,n,e,t),void 0,null),Ve===null)throw Error(G(349));di&30||Pp(i,t,e)}return e}function Pp(r,t,i){r.flags|=16384,r={getSnapshot:t,value:i},t=Me.updateQueue,t===null?(t={lastEffect:null,stores:null},Me.updateQueue=t,t.stores=[r]):(i=t.stores,i===null?t.stores=[r]:i.push(r))}function Tp(r,t,i,n){t.value=i,t.getSnapshot=n,Mp(t)&&Ep(r)}function Sp(r,t,i){return i(function(){Mp(t)&&Ep(r)})}function Mp(r){var t=r.getSnapshot;r=r.value;try{var i=t();return!Ut(r,i)}catch{return!0}}function Ep(r){var t=pr(r,1);t!==null&&Vt(t,r,1,-1)}function sd(r){var t=Qt();return typeof r=="function"&&(r=r()),t.memoizedState=t.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ao,lastRenderedState:r},t.queue=r,r=r.dispatch=Lw.bind(null,Me,r),[t.memoizedState,r]}function Oo(r,t,i,n){return r={tag:r,create:t,destroy:i,deps:n,next:null},t=Me.updateQueue,t===null?(t={lastEffect:null,stores:null},Me.updateQueue=t,t.lastEffect=r.next=r):(i=t.lastEffect,i===null?t.lastEffect=r.next=r:(n=i.next,i.next=r,r.next=n,t.lastEffect=r)),r}function kp(){return It().memoizedState}function Wa(r,t,i,n){var e=Qt();Me.flags|=r,e.memoizedState=Oo(1|t,i,void 0,n===void 0?null:n)}function Zs(r,t,i,n){var e=It();n=n===void 0?null:n;var o=void 0;if(je!==null){var a=je.memoizedState;if(o=a.destroy,n!==null&&wf(n,a.deps)){e.memoizedState=Oo(t,i,o,n);return}}Me.flags|=r,e.memoizedState=Oo(1|t,i,o,n)}function ld(r,t){return Wa(8390656,8,r,t)}function Pf(r,t){return Zs(2048,8,r,t)}function Rp(r,t){return Zs(4,2,r,t)}function Ap(r,t){return Zs(4,4,r,t)}function Op(r,t){if(typeof t=="function")return r=r(),t(r),function(){t(null)};if(t!=null)return r=r(),t.current=r,function(){t.current=null}}function Lp(r,t,i){return i=i!=null?i.concat([r]):null,Zs(4,4,Op.bind(null,t,r),i)}function Tf(){}function Dp(r,t){var i=It();t=t===void 0?null:t;var n=i.memoizedState;return n!==null&&t!==null&&wf(t,n[1])?n[0]:(i.memoizedState=[r,t],r)}function bp(r,t){var i=It();t=t===void 0?null:t;var n=i.memoizedState;return n!==null&&t!==null&&wf(t,n[1])?n[0]:(r=r(),i.memoizedState=[r,t],r)}function Ip(r,t,i){return di&21?(Ut(i,t)||(i=Nv(),Me.lanes|=i,gi|=i,r.baseState=!0),t):(r.baseState&&(r.baseState=!1,ct=!0),r.memoizedState=i)}function Aw(r,t){var i=ce;ce=i!==0&&4>i?i:4,r(!0);var n=Dl.transition;Dl.transition={};try{r(!1),t()}finally{ce=i,Dl.transition=n}}function zp(){return It().memoizedState}function Ow(r,t,i){var n=Zr(r);if(i={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null},jp(r))Np(t,i);else if(i=gp(r,t,i,n),i!==null){var e=at();Vt(i,r,n,e),Fp(i,t,n)}}function Lw(r,t,i){var n=Zr(r),e={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null};if(jp(r))Np(t,e);else{var o=r.alternate;if(r.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var a=t.lastRenderedState,s=o(a,i);if(e.hasEagerState=!0,e.eagerState=s,Ut(s,a)){var l=t.interleaved;l===null?(e.next=e,vf(t)):(e.next=l.next,l.next=e),t.interleaved=e;return}}catch{}finally{}i=gp(r,t,e,n),i!==null&&(e=at(),Vt(i,r,n,e),Fp(i,t,n))}}function jp(r){var t=r.alternate;return r===Me||t!==null&&t===Me}function Np(r,t){fo=vs=!0;var i=r.pending;i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t}function Fp(r,t,i){if(i&4194240){var n=t.lanes;n&=r.pendingLanes,i|=n,t.lanes=i,ef(r,i)}}var ps={readContext:bt,useCallback:Qe,useContext:Qe,useEffect:Qe,useImperativeHandle:Qe,useInsertionEffect:Qe,useLayoutEffect:Qe,useMemo:Qe,useReducer:Qe,useRef:Qe,useState:Qe,useDebugValue:Qe,useDeferredValue:Qe,useTransition:Qe,useMutableSource:Qe,useSyncExternalStore:Qe,useId:Qe,unstable_isNewReconciler:!1},Dw={readContext:bt,useCallback:function(r,t){return Qt().memoizedState=[r,t===void 0?null:t],r},useContext:bt,useEffect:ld,useImperativeHandle:function(r,t,i){return i=i!=null?i.concat([r]):null,Wa(4194308,4,Op.bind(null,t,r),i)},useLayoutEffect:function(r,t){return Wa(4194308,4,r,t)},useInsertionEffect:function(r,t){return Wa(4,2,r,t)},useMemo:function(r,t){var i=Qt();return t=t===void 0?null:t,r=r(),i.memoizedState=[r,t],r},useReducer:function(r,t,i){var n=Qt();return t=i!==void 0?i(t):t,n.memoizedState=n.baseState=t,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:t},n.queue=r,r=r.dispatch=Ow.bind(null,Me,r),[n.memoizedState,r]},useRef:function(r){var t=Qt();return r={current:r},t.memoizedState=r},useState:sd,useDebugValue:Tf,useDeferredValue:function(r){return Qt().memoizedState=r},useTransition:function(){var r=sd(!1),t=r[0];return r=Aw.bind(null,r[1]),Qt().memoizedState=r,[t,r]},useMutableSource:function(){},useSyncExternalStore:function(r,t,i){var n=Me,e=Qt();if(Ce){if(i===void 0)throw Error(G(407));i=i()}else{if(i=t(),Ve===null)throw Error(G(349));di&30||Pp(n,t,i)}e.memoizedState=i;var o={value:i,getSnapshot:t};return e.queue=o,ld(Sp.bind(null,n,o,r),[r]),n.flags|=2048,Oo(9,Tp.bind(null,n,o,i,t),void 0,null),i},useId:function(){var r=Qt(),t=Ve.identifierPrefix;if(Ce){var i=fr,n=ur;i=(n&~(1<<32-Wt(n)-1)).toString(32)+i,t=":"+t+"R"+i,i=Ro++,0<i&&(t+="H"+i.toString(32)),t+=":"}else i=Rw++,t=":"+t+"r"+i.toString(32)+":";return r.memoizedState=t},unstable_isNewReconciler:!1},bw={readContext:bt,useCallback:Dp,useContext:bt,useEffect:Pf,useImperativeHandle:Lp,useInsertionEffect:Rp,useLayoutEffect:Ap,useMemo:bp,useReducer:bl,useRef:kp,useState:function(){return bl(Ao)},useDebugValue:Tf,useDeferredValue:function(r){var t=It();return Ip(t,je.memoizedState,r)},useTransition:function(){var r=bl(Ao)[0],t=It().memoizedState;return[r,t]},useMutableSource:xp,useSyncExternalStore:Cp,useId:zp,unstable_isNewReconciler:!1},Iw={readContext:bt,useCallback:Dp,useContext:bt,useEffect:Pf,useImperativeHandle:Lp,useInsertionEffect:Rp,useLayoutEffect:Ap,useMemo:bp,useReducer:Il,useRef:kp,useState:function(){return Il(Ao)},useDebugValue:Tf,useDeferredValue:function(r){var t=It();return je===null?t.memoizedState=r:Ip(t,je.memoizedState,r)},useTransition:function(){var r=Il(Ao)[0],t=It().memoizedState;return[r,t]},useMutableSource:xp,useSyncExternalStore:Cp,useId:zp,unstable_isNewReconciler:!1};function pn(r,t){try{var i="",n=t;do i+=h0(n),n=n.return;while(n);var e=i}catch(o){e=`
Error generating stack: `+o.message+`
`+o.stack}return{value:r,source:t,stack:e,digest:null}}function zl(r,t,i){return{value:r,source:null,stack:i??null,digest:t??null}}function au(r,t){try{console.error(t.value)}catch(i){setTimeout(function(){throw i})}}var zw=typeof WeakMap=="function"?WeakMap:Map;function Hp(r,t,i){i=cr(-1,i),i.tag=3,i.payload={element:null};var n=t.value;return i.callback=function(){_s||(_s=!0,pu=n),au(r,t)},i}function Bp(r,t,i){i=cr(-1,i),i.tag=3;var n=r.type.getDerivedStateFromError;if(typeof n=="function"){var e=t.value;i.payload=function(){return n(e)},i.callback=function(){au(r,t)}}var o=r.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(i.callback=function(){au(r,t),typeof n!="function"&&(Vr===null?Vr=new Set([this]):Vr.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),i}function hd(r,t,i){var n=r.pingCache;if(n===null){n=r.pingCache=new zw;var e=new Set;n.set(t,e)}else e=n.get(t),e===void 0&&(e=new Set,n.set(t,e));e.has(i)||(e.add(i),r=Yw.bind(null,r,t,i),t.then(r,r))}function ud(r){do{var t;if((t=r.tag===13)&&(t=r.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return r;r=r.return}while(r!==null);return null}function fd(r,t,i,n,e){return r.mode&1?(r.flags|=65536,r.lanes=e,r):(r===t?r.flags|=65536:(r.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(t=cr(-1,1),t.tag=2,Wr(i,t,1))),i.lanes|=1),r)}var jw=xr.ReactCurrentOwner,ct=!1;function ot(r,t,i,n){t.child=r===null?yp(t,null,i,n):gn(t,r.child,i,n)}function cd(r,t,i,n,e){i=i.render;var o=t.ref;return Ki(t,e),n=xf(r,t,i,n,o,e),i=Cf(),r!==null&&!ct?(t.updateQueue=r.updateQueue,t.flags&=-2053,r.lanes&=~e,mr(r,t,e)):(Ce&&i&&hf(t),t.flags|=1,ot(r,t,n,e),t.child)}function dd(r,t,i,n,e){if(r===null){var o=i.type;return typeof o=="function"&&!Lf(o)&&o.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(t.tag=15,t.type=o,Gp(r,t,o,n,e)):(r=$a(i.type,null,n,t,t.mode,e),r.ref=t.ref,r.return=t,t.child=r)}if(o=r.child,!(r.lanes&e)){var a=o.memoizedProps;if(i=i.compare,i=i!==null?i:Po,i(a,n)&&r.ref===t.ref)return mr(r,t,e)}return t.flags|=1,r=Ur(o,n),r.ref=t.ref,r.return=t,t.child=r}function Gp(r,t,i,n,e){if(r!==null){var o=r.memoizedProps;if(Po(o,n)&&r.ref===t.ref)if(ct=!1,t.pendingProps=n=o,(r.lanes&e)!==0)r.flags&131072&&(ct=!0);else return t.lanes=r.lanes,mr(r,t,e)}return su(r,t,i,n,e)}function Wp(r,t,i){var n=t.pendingProps,e=n.children,o=r!==null?r.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},pe(Ui,pt),pt|=i;else{if(!(i&1073741824))return r=o!==null?o.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:r,cachePool:null,transitions:null},t.updateQueue=null,pe(Ui,pt),pt|=r,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:i,pe(Ui,pt),pt|=n}else o!==null?(n=o.baseLanes|i,t.memoizedState=null):n=i,pe(Ui,pt),pt|=n;return ot(r,t,e,i),t.child}function Vp(r,t){var i=t.ref;(r===null&&i!==null||r!==null&&r.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function su(r,t,i,n,e){var o=gt(i)?fi:tt.current;return o=cn(t,o),Ki(t,e),i=xf(r,t,i,n,o,e),n=Cf(),r!==null&&!ct?(t.updateQueue=r.updateQueue,t.flags&=-2053,r.lanes&=~e,mr(r,t,e)):(Ce&&n&&hf(t),t.flags|=1,ot(r,t,i,e),t.child)}function gd(r,t,i,n,e){if(gt(i)){var o=!0;ls(t)}else o=!1;if(Ki(t,e),t.stateNode===null)Va(r,t),mp(t,i,n),ou(t,i,n,e),n=!0;else if(r===null){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,h=i.contextType;typeof h=="object"&&h!==null?h=bt(h):(h=gt(i)?fi:tt.current,h=cn(t,h));var u=i.getDerivedStateFromProps,f=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==n||l!==h)&&od(t,a,n,h),Rr=!1;var c=t.memoizedState;a.state=c,ds(t,n,a,e),l=t.memoizedState,s!==n||c!==l||dt.current||Rr?(typeof u=="function"&&(nu(t,i,u,n),l=t.memoizedState),(s=Rr||nd(t,i,s,n,c,l,h))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=h,n=s):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,vp(r,t),s=t.memoizedProps,h=t.type===t.elementType?s:Ht(t.type,s),a.props=h,f=t.pendingProps,c=a.context,l=i.contextType,typeof l=="object"&&l!==null?l=bt(l):(l=gt(i)?fi:tt.current,l=cn(t,l));var d=i.getDerivedStateFromProps;(u=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==f||c!==l)&&od(t,a,n,l),Rr=!1,c=t.memoizedState,a.state=c,ds(t,n,a,e);var g=t.memoizedState;s!==f||c!==g||dt.current||Rr?(typeof d=="function"&&(nu(t,i,d,n),g=t.memoizedState),(h=Rr||nd(t,i,h,n,c,g,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,g,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,g,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===r.memoizedProps&&c===r.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===r.memoizedProps&&c===r.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),a.props=n,a.state=g,a.context=l,n=h):(typeof a.componentDidUpdate!="function"||s===r.memoizedProps&&c===r.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===r.memoizedProps&&c===r.memoizedState||(t.flags|=1024),n=!1)}return lu(r,t,i,n,o,e)}function lu(r,t,i,n,e,o){Vp(r,t);var a=(t.flags&128)!==0;if(!n&&!a)return e&&Kc(t,i,!1),mr(r,t,o);n=t.stateNode,jw.current=t;var s=a&&typeof i.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,r!==null&&a?(t.child=gn(t,r.child,null,o),t.child=gn(t,null,s,o)):ot(r,t,s,o),t.memoizedState=n.state,e&&Kc(t,i,!0),t.child}function Zp(r){var t=r.stateNode;t.pendingContext?qc(r,t.pendingContext,t.pendingContext!==t.context):t.context&&qc(r,t.context,!1),mf(r,t.containerInfo)}function vd(r,t,i,n,e){return dn(),ff(e),t.flags|=256,ot(r,t,i,n),t.child}var hu={dehydrated:null,treeContext:null,retryLane:0};function uu(r){return{baseLanes:r,cachePool:null,transitions:null}}function Up(r,t,i){var n=t.pendingProps,e=Te.current,o=!1,a=(t.flags&128)!==0,s;if((s=a)||(s=r!==null&&r.memoizedState===null?!1:(e&2)!==0),s?(o=!0,t.flags&=-129):(r===null||r.memoizedState!==null)&&(e|=1),pe(Te,e&1),r===null)return ru(t),r=t.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(t.mode&1?r.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,r=n.fallback,o?(n=t.mode,o=t.child,a={mode:"hidden",children:a},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=Xs(a,n,0,null),r=li(r,n,i,null),o.return=t,r.return=t,o.sibling=r,t.child=o,t.child.memoizedState=uu(i),t.memoizedState=hu,r):Sf(t,a));if(e=r.memoizedState,e!==null&&(s=e.dehydrated,s!==null))return Nw(r,t,a,n,s,e,i);if(o){o=n.fallback,a=t.mode,e=r.child,s=e.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&t.child!==e?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Ur(e,l),n.subtreeFlags=e.subtreeFlags&14680064),s!==null?o=Ur(s,o):(o=li(o,a,i,null),o.flags|=2),o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,a=r.child.memoizedState,a=a===null?uu(i):{baseLanes:a.baseLanes|i,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=r.childLanes&~i,t.memoizedState=hu,n}return o=r.child,r=o.sibling,n=Ur(o,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=i),n.return=t,n.sibling=null,r!==null&&(i=t.deletions,i===null?(t.deletions=[r],t.flags|=16):i.push(r)),t.child=n,t.memoizedState=null,n}function Sf(r,t){return t=Xs({mode:"visible",children:t},r.mode,0,null),t.return=r,r.child=t}function ua(r,t,i,n){return n!==null&&ff(n),gn(t,r.child,null,i),r=Sf(t,t.pendingProps.children),r.flags|=2,t.memoizedState=null,r}function Nw(r,t,i,n,e,o,a){if(i)return t.flags&256?(t.flags&=-257,n=zl(Error(G(422))),ua(r,t,a,n)):t.memoizedState!==null?(t.child=r.child,t.flags|=128,null):(o=n.fallback,e=t.mode,n=Xs({mode:"visible",children:n.children},e,0,null),o=li(o,e,a,null),o.flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,t.mode&1&&gn(t,r.child,null,a),t.child.memoizedState=uu(a),t.memoizedState=hu,o);if(!(t.mode&1))return ua(r,t,a,null);if(e.data==="$!"){if(n=e.nextSibling&&e.nextSibling.dataset,n)var s=n.dgst;return n=s,o=Error(G(419)),n=zl(o,n,void 0),ua(r,t,a,n)}if(s=(a&r.childLanes)!==0,ct||s){if(n=Ve,n!==null){switch(a&-a){case 4:e=2;break;case 16:e=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:e=32;break;case 536870912:e=268435456;break;default:e=0}e=e&(n.suspendedLanes|a)?0:e,e!==0&&e!==o.retryLane&&(o.retryLane=e,pr(r,e),Vt(n,r,e,-1))}return Of(),n=zl(Error(G(421))),ua(r,t,a,n)}return e.data==="$?"?(t.flags|=128,t.child=r.child,t=Qw.bind(null,r),e._reactRetry=t,null):(r=o.treeContext,mt=Gr(e.nextSibling),yt=t,Ce=!0,Gt=null,r!==null&&(Rt[At++]=ur,Rt[At++]=fr,Rt[At++]=ci,ur=r.id,fr=r.overflow,ci=t),t=Sf(t,n.children),t.flags|=4096,t)}function pd(r,t,i){r.lanes|=t;var n=r.alternate;n!==null&&(n.lanes|=t),iu(r.return,t,i)}function jl(r,t,i,n,e){var o=r.memoizedState;o===null?r.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:e}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=i,o.tailMode=e)}function $p(r,t,i){var n=t.pendingProps,e=n.revealOrder,o=n.tail;if(ot(r,t,n.children,i),n=Te.current,n&2)n=n&1|2,t.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=t.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&pd(r,i,t);else if(r.tag===19)pd(r,i,t);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}n&=1}if(pe(Te,n),!(t.mode&1))t.memoizedState=null;else switch(e){case"forwards":for(i=t.child,e=null;i!==null;)r=i.alternate,r!==null&&gs(r)===null&&(e=i),i=i.sibling;i=e,i===null?(e=t.child,t.child=null):(e=i.sibling,i.sibling=null),jl(t,!1,e,i,o);break;case"backwards":for(i=null,e=t.child,t.child=null;e!==null;){if(r=e.alternate,r!==null&&gs(r)===null){t.child=e;break}r=e.sibling,e.sibling=i,i=e,e=r}jl(t,!0,i,null,o);break;case"together":jl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Va(r,t){!(t.mode&1)&&r!==null&&(r.alternate=null,t.alternate=null,t.flags|=2)}function mr(r,t,i){if(r!==null&&(t.dependencies=r.dependencies),gi|=t.lanes,!(i&t.childLanes))return null;if(r!==null&&t.child!==r.child)throw Error(G(153));if(t.child!==null){for(r=t.child,i=Ur(r,r.pendingProps),t.child=i,i.return=t;r.sibling!==null;)r=r.sibling,i=i.sibling=Ur(r,r.pendingProps),i.return=t;i.sibling=null}return t.child}function Fw(r,t,i){switch(t.tag){case 3:Zp(t),dn();break;case 5:wp(t);break;case 1:gt(t.type)&&ls(t);break;case 4:mf(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,e=t.memoizedProps.value;pe(fs,n._currentValue),n._currentValue=e;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(pe(Te,Te.current&1),t.flags|=128,null):i&t.child.childLanes?Up(r,t,i):(pe(Te,Te.current&1),r=mr(r,t,i),r!==null?r.sibling:null);pe(Te,Te.current&1);break;case 19:if(n=(i&t.childLanes)!==0,r.flags&128){if(n)return $p(r,t,i);t.flags|=128}if(e=t.memoizedState,e!==null&&(e.rendering=null,e.tail=null,e.lastEffect=null),pe(Te,Te.current),n)break;return null;case 22:case 23:return t.lanes=0,Wp(r,t,i)}return mr(r,t,i)}var Xp,fu,Jp,Yp;Xp=function(r,t){for(var i=t.child;i!==null;){if(i.tag===5||i.tag===6)r.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};fu=function(){};Jp=function(r,t,i,n){var e=r.memoizedProps;if(e!==n){r=t.stateNode,ai(rr.current);var o=null;switch(i){case"input":e=Dh(r,e),n=Dh(r,n),o=[];break;case"select":e=Ee({},e,{value:void 0}),n=Ee({},n,{value:void 0}),o=[];break;case"textarea":e=zh(r,e),n=zh(r,n),o=[];break;default:typeof e.onClick!="function"&&typeof n.onClick=="function"&&(r.onclick=as)}Nh(i,n);var a;i=null;for(h in e)if(!n.hasOwnProperty(h)&&e.hasOwnProperty(h)&&e[h]!=null)if(h==="style"){var s=e[h];for(a in s)s.hasOwnProperty(a)&&(i||(i={}),i[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(po.hasOwnProperty(h)?o||(o=[]):(o=o||[]).push(h,null));for(h in n){var l=n[h];if(s=e!=null?e[h]:void 0,n.hasOwnProperty(h)&&l!==s&&(l!=null||s!=null))if(h==="style")if(s){for(a in s)!s.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(i||(i={}),i[a]="");for(a in l)l.hasOwnProperty(a)&&s[a]!==l[a]&&(i||(i={}),i[a]=l[a])}else i||(o||(o=[]),o.push(h,i)),i=l;else h==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(o=o||[]).push(h,l)):h==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(h,""+l):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(po.hasOwnProperty(h)?(l!=null&&h==="onScroll"&&ye("scroll",r),o||s===l||(o=[])):(o=o||[]).push(h,l))}i&&(o=o||[]).push("style",i);var h=o;(t.updateQueue=h)&&(t.flags|=4)}};Yp=function(r,t,i,n){i!==n&&(t.flags|=4)};function In(r,t){if(!Ce)switch(r.tailMode){case"hidden":t=r.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?r.tail=null:i.sibling=null;break;case"collapsed":i=r.tail;for(var n=null;i!==null;)i.alternate!==null&&(n=i),i=i.sibling;n===null?t||r.tail===null?r.tail=null:r.tail.sibling=null:n.sibling=null}}function qe(r){var t=r.alternate!==null&&r.alternate.child===r.child,i=0,n=0;if(t)for(var e=r.child;e!==null;)i|=e.lanes|e.childLanes,n|=e.subtreeFlags&14680064,n|=e.flags&14680064,e.return=r,e=e.sibling;else for(e=r.child;e!==null;)i|=e.lanes|e.childLanes,n|=e.subtreeFlags,n|=e.flags,e.return=r,e=e.sibling;return r.subtreeFlags|=n,r.childLanes=i,t}function Hw(r,t,i){var n=t.pendingProps;switch(uf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qe(t),null;case 1:return gt(t.type)&&ss(),qe(t),null;case 3:return n=t.stateNode,vn(),we(dt),we(tt),yf(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(r===null||r.child===null)&&(la(t)?t.flags|=4:r===null||r.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Gt!==null&&(yu(Gt),Gt=null))),fu(r,t),qe(t),null;case 5:_f(t);var e=ai(ko.current);if(i=t.type,r!==null&&t.stateNode!=null)Jp(r,t,i,n,e),r.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(G(166));return qe(t),null}if(r=ai(rr.current),la(t)){n=t.stateNode,i=t.type;var o=t.memoizedProps;switch(n[qt]=t,n[Mo]=o,r=(t.mode&1)!==0,i){case"dialog":ye("cancel",n),ye("close",n);break;case"iframe":case"object":case"embed":ye("load",n);break;case"video":case"audio":for(e=0;e<eo.length;e++)ye(eo[e],n);break;case"source":ye("error",n);break;case"img":case"image":case"link":ye("error",n),ye("load",n);break;case"details":ye("toggle",n);break;case"input":Sc(n,o),ye("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},ye("invalid",n);break;case"textarea":Ec(n,o),ye("invalid",n)}Nh(i,o),e=null;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];a==="children"?typeof s=="string"?n.textContent!==s&&(o.suppressHydrationWarning!==!0&&sa(n.textContent,s,r),e=["children",s]):typeof s=="number"&&n.textContent!==""+s&&(o.suppressHydrationWarning!==!0&&sa(n.textContent,s,r),e=["children",""+s]):po.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&ye("scroll",n)}switch(i){case"input":Ko(n),Mc(n,o,!0);break;case"textarea":Ko(n),kc(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=as)}n=e,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=e.nodeType===9?e:e.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Pv(i)),r==="http://www.w3.org/1999/xhtml"?i==="script"?(r=a.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof n.is=="string"?r=a.createElement(i,{is:n.is}):(r=a.createElement(i),i==="select"&&(a=r,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):r=a.createElementNS(r,i),r[qt]=t,r[Mo]=n,Xp(r,t,!1,!1),t.stateNode=r;e:{switch(a=Fh(i,n),i){case"dialog":ye("cancel",r),ye("close",r),e=n;break;case"iframe":case"object":case"embed":ye("load",r),e=n;break;case"video":case"audio":for(e=0;e<eo.length;e++)ye(eo[e],r);e=n;break;case"source":ye("error",r),e=n;break;case"img":case"image":case"link":ye("error",r),ye("load",r),e=n;break;case"details":ye("toggle",r),e=n;break;case"input":Sc(r,n),e=Dh(r,n),ye("invalid",r);break;case"option":e=n;break;case"select":r._wrapperState={wasMultiple:!!n.multiple},e=Ee({},n,{value:void 0}),ye("invalid",r);break;case"textarea":Ec(r,n),e=zh(r,n),ye("invalid",r);break;default:e=n}Nh(i,e),s=e;for(o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="style"?Mv(r,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Tv(r,l)):o==="children"?typeof l=="string"?(i!=="textarea"||l!=="")&&mo(r,l):typeof l=="number"&&mo(r,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(po.hasOwnProperty(o)?l!=null&&o==="onScroll"&&ye("scroll",r):l!=null&&Xu(r,o,l,a))}switch(i){case"input":Ko(r),Mc(r,n,!1);break;case"textarea":Ko(r),kc(r);break;case"option":n.value!=null&&r.setAttribute("value",""+$r(n.value));break;case"select":r.multiple=!!n.multiple,o=n.value,o!=null?Ji(r,!!n.multiple,o,!1):n.defaultValue!=null&&Ji(r,!!n.multiple,n.defaultValue,!0);break;default:typeof e.onClick=="function"&&(r.onclick=as)}switch(i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return qe(t),null;case 6:if(r&&t.stateNode!=null)Yp(r,t,r.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(G(166));if(i=ai(ko.current),ai(rr.current),la(t)){if(n=t.stateNode,i=t.memoizedProps,n[qt]=t,(o=n.nodeValue!==i)&&(r=yt,r!==null))switch(r.tag){case 3:sa(n.nodeValue,i,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&sa(n.nodeValue,i,(r.mode&1)!==0)}o&&(t.flags|=4)}else n=(i.nodeType===9?i:i.ownerDocument).createTextNode(n),n[qt]=t,t.stateNode=n}return qe(t),null;case 13:if(we(Te),n=t.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(Ce&&mt!==null&&t.mode&1&&!(t.flags&128))dp(),dn(),t.flags|=98560,o=!1;else if(o=la(t),n!==null&&n.dehydrated!==null){if(r===null){if(!o)throw Error(G(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(G(317));o[qt]=t}else dn(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;qe(t),o=!1}else Gt!==null&&(yu(Gt),Gt=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=i,t):(n=n!==null,n!==(r!==null&&r.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(r===null||Te.current&1?Ne===0&&(Ne=3):Of())),t.updateQueue!==null&&(t.flags|=4),qe(t),null);case 4:return vn(),fu(r,t),r===null&&To(t.stateNode.containerInfo),qe(t),null;case 10:return gf(t.type._context),qe(t),null;case 17:return gt(t.type)&&ss(),qe(t),null;case 19:if(we(Te),o=t.memoizedState,o===null)return qe(t),null;if(n=(t.flags&128)!==0,a=o.rendering,a===null)if(n)In(o,!1);else{if(Ne!==0||r!==null&&r.flags&128)for(r=t.child;r!==null;){if(a=gs(r),a!==null){for(t.flags|=128,In(o,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=i,i=t.child;i!==null;)o=i,r=n,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=r,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,r=a.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),i=i.sibling;return pe(Te,Te.current&1|2),t.child}r=r.sibling}o.tail!==null&&be()>mn&&(t.flags|=128,n=!0,In(o,!1),t.lanes=4194304)}else{if(!n)if(r=gs(a),r!==null){if(t.flags|=128,n=!0,i=r.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),In(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!Ce)return qe(t),null}else 2*be()-o.renderingStartTime>mn&&i!==1073741824&&(t.flags|=128,n=!0,In(o,!1),t.lanes=4194304);o.isBackwards?(a.sibling=t.child,t.child=a):(i=o.last,i!==null?i.sibling=a:t.child=a,o.last=a)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=be(),t.sibling=null,i=Te.current,pe(Te,n?i&1|2:i&1),t):(qe(t),null);case 22:case 23:return Af(),n=t.memoizedState!==null,r!==null&&r.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?pt&1073741824&&(qe(t),t.subtreeFlags&6&&(t.flags|=8192)):qe(t),null;case 24:return null;case 25:return null}throw Error(G(156,t.tag))}function Bw(r,t){switch(uf(t),t.tag){case 1:return gt(t.type)&&ss(),r=t.flags,r&65536?(t.flags=r&-65537|128,t):null;case 3:return vn(),we(dt),we(tt),yf(),r=t.flags,r&65536&&!(r&128)?(t.flags=r&-65537|128,t):null;case 5:return _f(t),null;case 13:if(we(Te),r=t.memoizedState,r!==null&&r.dehydrated!==null){if(t.alternate===null)throw Error(G(340));dn()}return r=t.flags,r&65536?(t.flags=r&-65537|128,t):null;case 19:return we(Te),null;case 4:return vn(),null;case 10:return gf(t.type._context),null;case 22:case 23:return Af(),null;case 24:return null;default:return null}}var fa=!1,Ke=!1,Gw=typeof WeakSet=="function"?WeakSet:Set,$=null;function Zi(r,t){var i=r.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(n){ke(r,t,n)}else i.current=null}function cu(r,t,i){try{i()}catch(n){ke(r,t,n)}}var md=!1;function Ww(r,t){if(Jh=is,r=ep(),lf(r)){if("selectionStart"in r)var i={start:r.selectionStart,end:r.selectionEnd};else e:{i=(i=r.ownerDocument)&&i.defaultView||window;var n=i.getSelection&&i.getSelection();if(n&&n.rangeCount!==0){i=n.anchorNode;var e=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{i.nodeType,o.nodeType}catch{i=null;break e}var a=0,s=-1,l=-1,h=0,u=0,f=r,c=null;t:for(;;){for(var d;f!==i||e!==0&&f.nodeType!==3||(s=a+e),f!==o||n!==0&&f.nodeType!==3||(l=a+n),f.nodeType===3&&(a+=f.nodeValue.length),(d=f.firstChild)!==null;)c=f,f=d;for(;;){if(f===r)break t;if(c===i&&++h===e&&(s=a),c===o&&++u===n&&(l=a),(d=f.nextSibling)!==null)break;f=c,c=f.parentNode}f=d}i=s===-1||l===-1?null:{start:s,end:l}}else i=null}i=i||{start:0,end:0}}else i=null;for(Yh={focusedElem:r,selectionRange:i},is=!1,$=t;$!==null;)if(t=$,r=t.child,(t.subtreeFlags&1028)!==0&&r!==null)r.return=t,$=r;else for(;$!==null;){t=$;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var v=g.memoizedProps,y=g.memoizedState,p=t.stateNode,m=p.getSnapshotBeforeUpdate(t.elementType===t.type?v:Ht(t.type,v),y);p.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var _=t.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(G(163))}}catch(w){ke(t,t.return,w)}if(r=t.sibling,r!==null){r.return=t.return,$=r;break}$=t.return}return g=md,md=!1,g}function co(r,t,i){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var e=n=n.next;do{if((e.tag&r)===r){var o=e.destroy;e.destroy=void 0,o!==void 0&&cu(t,i,o)}e=e.next}while(e!==n)}}function Us(r,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var i=t=t.next;do{if((i.tag&r)===r){var n=i.create;i.destroy=n()}i=i.next}while(i!==t)}}function du(r){var t=r.ref;if(t!==null){var i=r.stateNode;switch(r.tag){case 5:r=i;break;default:r=i}typeof t=="function"?t(r):t.current=r}}function Qp(r){var t=r.alternate;t!==null&&(r.alternate=null,Qp(t)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(t=r.stateNode,t!==null&&(delete t[qt],delete t[Mo],delete t[Kh],delete t[Sw],delete t[Mw])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function qp(r){return r.tag===5||r.tag===3||r.tag===4}function _d(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||qp(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function gu(r,t,i){var n=r.tag;if(n===5||n===6)r=r.stateNode,t?i.nodeType===8?i.parentNode.insertBefore(r,t):i.insertBefore(r,t):(i.nodeType===8?(t=i.parentNode,t.insertBefore(r,i)):(t=i,t.appendChild(r)),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=as));else if(n!==4&&(r=r.child,r!==null))for(gu(r,t,i),r=r.sibling;r!==null;)gu(r,t,i),r=r.sibling}function vu(r,t,i){var n=r.tag;if(n===5||n===6)r=r.stateNode,t?i.insertBefore(r,t):i.appendChild(r);else if(n!==4&&(r=r.child,r!==null))for(vu(r,t,i),r=r.sibling;r!==null;)vu(r,t,i),r=r.sibling}var $e=null,Bt=!1;function Tr(r,t,i){for(i=i.child;i!==null;)Kp(r,t,i),i=i.sibling}function Kp(r,t,i){if(tr&&typeof tr.onCommitFiberUnmount=="function")try{tr.onCommitFiberUnmount(Ns,i)}catch{}switch(i.tag){case 5:Ke||Zi(i,t);case 6:var n=$e,e=Bt;$e=null,Tr(r,t,i),$e=n,Bt=e,$e!==null&&(Bt?(r=$e,i=i.stateNode,r.nodeType===8?r.parentNode.removeChild(i):r.removeChild(i)):$e.removeChild(i.stateNode));break;case 18:$e!==null&&(Bt?(r=$e,i=i.stateNode,r.nodeType===8?Al(r.parentNode,i):r.nodeType===1&&Al(r,i),xo(r)):Al($e,i.stateNode));break;case 4:n=$e,e=Bt,$e=i.stateNode.containerInfo,Bt=!0,Tr(r,t,i),$e=n,Bt=e;break;case 0:case 11:case 14:case 15:if(!Ke&&(n=i.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){e=n=n.next;do{var o=e,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&cu(i,t,a),e=e.next}while(e!==n)}Tr(r,t,i);break;case 1:if(!Ke&&(Zi(i,t),n=i.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=i.memoizedProps,n.state=i.memoizedState,n.componentWillUnmount()}catch(s){ke(i,t,s)}Tr(r,t,i);break;case 21:Tr(r,t,i);break;case 22:i.mode&1?(Ke=(n=Ke)||i.memoizedState!==null,Tr(r,t,i),Ke=n):Tr(r,t,i);break;default:Tr(r,t,i)}}function yd(r){var t=r.updateQueue;if(t!==null){r.updateQueue=null;var i=r.stateNode;i===null&&(i=r.stateNode=new Gw),t.forEach(function(n){var e=qw.bind(null,r,n);i.has(n)||(i.add(n),n.then(e,e))})}}function jt(r,t){var i=t.deletions;if(i!==null)for(var n=0;n<i.length;n++){var e=i[n];try{var o=r,a=t,s=a;e:for(;s!==null;){switch(s.tag){case 5:$e=s.stateNode,Bt=!1;break e;case 3:$e=s.stateNode.containerInfo,Bt=!0;break e;case 4:$e=s.stateNode.containerInfo,Bt=!0;break e}s=s.return}if($e===null)throw Error(G(160));Kp(o,a,e),$e=null,Bt=!1;var l=e.alternate;l!==null&&(l.return=null),e.return=null}catch(h){ke(e,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)em(t,r),t=t.sibling}function em(r,t){var i=r.alternate,n=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(jt(t,r),Yt(r),n&4){try{co(3,r,r.return),Us(3,r)}catch(v){ke(r,r.return,v)}try{co(5,r,r.return)}catch(v){ke(r,r.return,v)}}break;case 1:jt(t,r),Yt(r),n&512&&i!==null&&Zi(i,i.return);break;case 5:if(jt(t,r),Yt(r),n&512&&i!==null&&Zi(i,i.return),r.flags&32){var e=r.stateNode;try{mo(e,"")}catch(v){ke(r,r.return,v)}}if(n&4&&(e=r.stateNode,e!=null)){var o=r.memoizedProps,a=i!==null?i.memoizedProps:o,s=r.type,l=r.updateQueue;if(r.updateQueue=null,l!==null)try{s==="input"&&o.type==="radio"&&o.name!=null&&xv(e,o),Fh(s,a);var h=Fh(s,o);for(a=0;a<l.length;a+=2){var u=l[a],f=l[a+1];u==="style"?Mv(e,f):u==="dangerouslySetInnerHTML"?Tv(e,f):u==="children"?mo(e,f):Xu(e,u,f,h)}switch(s){case"input":bh(e,o);break;case"textarea":Cv(e,o);break;case"select":var c=e._wrapperState.wasMultiple;e._wrapperState.wasMultiple=!!o.multiple;var d=o.value;d!=null?Ji(e,!!o.multiple,d,!1):c!==!!o.multiple&&(o.defaultValue!=null?Ji(e,!!o.multiple,o.defaultValue,!0):Ji(e,!!o.multiple,o.multiple?[]:"",!1))}e[Mo]=o}catch(v){ke(r,r.return,v)}}break;case 6:if(jt(t,r),Yt(r),n&4){if(r.stateNode===null)throw Error(G(162));e=r.stateNode,o=r.memoizedProps;try{e.nodeValue=o}catch(v){ke(r,r.return,v)}}break;case 3:if(jt(t,r),Yt(r),n&4&&i!==null&&i.memoizedState.isDehydrated)try{xo(t.containerInfo)}catch(v){ke(r,r.return,v)}break;case 4:jt(t,r),Yt(r);break;case 13:jt(t,r),Yt(r),e=r.child,e.flags&8192&&(o=e.memoizedState!==null,e.stateNode.isHidden=o,!o||e.alternate!==null&&e.alternate.memoizedState!==null||(kf=be())),n&4&&yd(r);break;case 22:if(u=i!==null&&i.memoizedState!==null,r.mode&1?(Ke=(h=Ke)||u,jt(t,r),Ke=h):jt(t,r),Yt(r),n&8192){if(h=r.memoizedState!==null,(r.stateNode.isHidden=h)&&!u&&r.mode&1)for($=r,u=r.child;u!==null;){for(f=$=u;$!==null;){switch(c=$,d=c.child,c.tag){case 0:case 11:case 14:case 15:co(4,c,c.return);break;case 1:Zi(c,c.return);var g=c.stateNode;if(typeof g.componentWillUnmount=="function"){n=c,i=c.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(v){ke(n,i,v)}}break;case 5:Zi(c,c.return);break;case 22:if(c.memoizedState!==null){xd(f);continue}}d!==null?(d.return=c,$=d):xd(f)}u=u.sibling}e:for(u=null,f=r;;){if(f.tag===5){if(u===null){u=f;try{e=f.stateNode,h?(o=e.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(s=f.stateNode,l=f.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=Sv("display",a))}catch(v){ke(r,r.return,v)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=h?"":f.memoizedProps}catch(v){ke(r,r.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===r)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===r)break e;for(;f.sibling===null;){if(f.return===null||f.return===r)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:jt(t,r),Yt(r),n&4&&yd(r);break;case 21:break;default:jt(t,r),Yt(r)}}function Yt(r){var t=r.flags;if(t&2){try{e:{for(var i=r.return;i!==null;){if(qp(i)){var n=i;break e}i=i.return}throw Error(G(160))}switch(n.tag){case 5:var e=n.stateNode;n.flags&32&&(mo(e,""),n.flags&=-33);var o=_d(r);vu(r,o,e);break;case 3:case 4:var a=n.stateNode.containerInfo,s=_d(r);gu(r,s,a);break;default:throw Error(G(161))}}catch(l){ke(r,r.return,l)}r.flags&=-3}t&4096&&(r.flags&=-4097)}function Vw(r,t,i){$=r,tm(r)}function tm(r,t,i){for(var n=(r.mode&1)!==0;$!==null;){var e=$,o=e.child;if(e.tag===22&&n){var a=e.memoizedState!==null||fa;if(!a){var s=e.alternate,l=s!==null&&s.memoizedState!==null||Ke;s=fa;var h=Ke;if(fa=a,(Ke=l)&&!h)for($=e;$!==null;)a=$,l=a.child,a.tag===22&&a.memoizedState!==null?Cd(e):l!==null?(l.return=a,$=l):Cd(e);for(;o!==null;)$=o,tm(o),o=o.sibling;$=e,fa=s,Ke=h}wd(r)}else e.subtreeFlags&8772&&o!==null?(o.return=e,$=o):wd(r)}}function wd(r){for(;$!==null;){var t=$;if(t.flags&8772){var i=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ke||Us(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ke)if(i===null)n.componentDidMount();else{var e=t.elementType===t.type?i.memoizedProps:Ht(t.type,i.memoizedProps);n.componentDidUpdate(e,i.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&id(t,o,n);break;case 3:var a=t.updateQueue;if(a!==null){if(i=null,t.child!==null)switch(t.child.tag){case 5:i=t.child.stateNode;break;case 1:i=t.child.stateNode}id(t,a,i)}break;case 5:var s=t.stateNode;if(i===null&&t.flags&4){i=s;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&i.focus();break;case"img":l.src&&(i.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var u=h.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&xo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(G(163))}Ke||t.flags&512&&du(t)}catch(c){ke(t,t.return,c)}}if(t===r){$=null;break}if(i=t.sibling,i!==null){i.return=t.return,$=i;break}$=t.return}}function xd(r){for(;$!==null;){var t=$;if(t===r){$=null;break}var i=t.sibling;if(i!==null){i.return=t.return,$=i;break}$=t.return}}function Cd(r){for(;$!==null;){var t=$;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{Us(4,t)}catch(l){ke(t,i,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var e=t.return;try{n.componentDidMount()}catch(l){ke(t,e,l)}}var o=t.return;try{du(t)}catch(l){ke(t,o,l)}break;case 5:var a=t.return;try{du(t)}catch(l){ke(t,a,l)}}}catch(l){ke(t,t.return,l)}if(t===r){$=null;break}var s=t.sibling;if(s!==null){s.return=t.return,$=s;break}$=t.return}}var Zw=Math.ceil,ms=xr.ReactCurrentDispatcher,Mf=xr.ReactCurrentOwner,Dt=xr.ReactCurrentBatchConfig,le=0,Ve=null,ze=null,Je=0,pt=0,Ui=qr(0),Ne=0,Lo=null,gi=0,$s=0,Ef=0,go=null,ft=null,kf=0,mn=1/0,lr=null,_s=!1,pu=null,Vr=null,ca=!1,Nr=null,ys=0,vo=0,mu=null,Za=-1,Ua=0;function at(){return le&6?be():Za!==-1?Za:Za=be()}function Zr(r){return r.mode&1?le&2&&Je!==0?Je&-Je:kw.transition!==null?(Ua===0&&(Ua=Nv()),Ua):(r=ce,r!==0||(r=window.event,r=r===void 0?16:Zv(r.type)),r):1}function Vt(r,t,i,n){if(50<vo)throw vo=0,mu=null,Error(G(185));jo(r,i,n),(!(le&2)||r!==Ve)&&(r===Ve&&(!(le&2)&&($s|=i),Ne===4&&Dr(r,Je)),vt(r,n),i===1&&le===0&&!(t.mode&1)&&(mn=be()+500,Ws&&Kr()))}function vt(r,t){var i=r.callbackNode;k0(r,t);var n=rs(r,r===Ve?Je:0);if(n===0)i!==null&&Oc(i),r.callbackNode=null,r.callbackPriority=0;else if(t=n&-n,r.callbackPriority!==t){if(i!=null&&Oc(i),t===1)r.tag===0?Ew(Pd.bind(null,r)):up(Pd.bind(null,r)),Pw(function(){!(le&6)&&Kr()}),i=null;else{switch(Fv(n)){case 1:i=Ku;break;case 4:i=zv;break;case 16:i=ts;break;case 536870912:i=jv;break;default:i=ts}i=hm(i,rm.bind(null,r))}r.callbackPriority=t,r.callbackNode=i}}function rm(r,t){if(Za=-1,Ua=0,le&6)throw Error(G(327));var i=r.callbackNode;if(en()&&r.callbackNode!==i)return null;var n=rs(r,r===Ve?Je:0);if(n===0)return null;if(n&30||n&r.expiredLanes||t)t=ws(r,n);else{t=n;var e=le;le|=2;var o=nm();(Ve!==r||Je!==t)&&(lr=null,mn=be()+500,si(r,t));do try{Xw();break}catch(s){im(r,s)}while(1);df(),ms.current=o,le=e,ze!==null?t=0:(Ve=null,Je=0,t=Ne)}if(t!==0){if(t===2&&(e=Vh(r),e!==0&&(n=e,t=_u(r,e))),t===1)throw i=Lo,si(r,0),Dr(r,n),vt(r,be()),i;if(t===6)Dr(r,n);else{if(e=r.current.alternate,!(n&30)&&!Uw(e)&&(t=ws(r,n),t===2&&(o=Vh(r),o!==0&&(n=o,t=_u(r,o))),t===1))throw i=Lo,si(r,0),Dr(r,n),vt(r,be()),i;switch(r.finishedWork=e,r.finishedLanes=n,t){case 0:case 1:throw Error(G(345));case 2:ii(r,ft,lr);break;case 3:if(Dr(r,n),(n&130023424)===n&&(t=kf+500-be(),10<t)){if(rs(r,0)!==0)break;if(e=r.suspendedLanes,(e&n)!==n){at(),r.pingedLanes|=r.suspendedLanes&e;break}r.timeoutHandle=qh(ii.bind(null,r,ft,lr),t);break}ii(r,ft,lr);break;case 4:if(Dr(r,n),(n&4194240)===n)break;for(t=r.eventTimes,e=-1;0<n;){var a=31-Wt(n);o=1<<a,a=t[a],a>e&&(e=a),n&=~o}if(n=e,n=be()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Zw(n/1960))-n,10<n){r.timeoutHandle=qh(ii.bind(null,r,ft,lr),n);break}ii(r,ft,lr);break;case 5:ii(r,ft,lr);break;default:throw Error(G(329))}}}return vt(r,be()),r.callbackNode===i?rm.bind(null,r):null}function _u(r,t){var i=go;return r.current.memoizedState.isDehydrated&&(si(r,t).flags|=256),r=ws(r,t),r!==2&&(t=ft,ft=i,t!==null&&yu(t)),r}function yu(r){ft===null?ft=r:ft.push.apply(ft,r)}function Uw(r){for(var t=r;;){if(t.flags&16384){var i=t.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var n=0;n<i.length;n++){var e=i[n],o=e.getSnapshot;e=e.value;try{if(!Ut(o(),e))return!1}catch{return!1}}}if(i=t.child,t.subtreeFlags&16384&&i!==null)i.return=t,t=i;else{if(t===r)break;for(;t.sibling===null;){if(t.return===null||t.return===r)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Dr(r,t){for(t&=~Ef,t&=~$s,r.suspendedLanes|=t,r.pingedLanes&=~t,r=r.expirationTimes;0<t;){var i=31-Wt(t),n=1<<i;r[i]=-1,t&=~n}}function Pd(r){if(le&6)throw Error(G(327));en();var t=rs(r,0);if(!(t&1))return vt(r,be()),null;var i=ws(r,t);if(r.tag!==0&&i===2){var n=Vh(r);n!==0&&(t=n,i=_u(r,n))}if(i===1)throw i=Lo,si(r,0),Dr(r,t),vt(r,be()),i;if(i===6)throw Error(G(345));return r.finishedWork=r.current.alternate,r.finishedLanes=t,ii(r,ft,lr),vt(r,be()),null}function Rf(r,t){var i=le;le|=1;try{return r(t)}finally{le=i,le===0&&(mn=be()+500,Ws&&Kr())}}function vi(r){Nr!==null&&Nr.tag===0&&!(le&6)&&en();var t=le;le|=1;var i=Dt.transition,n=ce;try{if(Dt.transition=null,ce=1,r)return r()}finally{ce=n,Dt.transition=i,le=t,!(le&6)&&Kr()}}function Af(){pt=Ui.current,we(Ui)}function si(r,t){r.finishedWork=null,r.finishedLanes=0;var i=r.timeoutHandle;if(i!==-1&&(r.timeoutHandle=-1,Cw(i)),ze!==null)for(i=ze.return;i!==null;){var n=i;switch(uf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ss();break;case 3:vn(),we(dt),we(tt),yf();break;case 5:_f(n);break;case 4:vn();break;case 13:we(Te);break;case 19:we(Te);break;case 10:gf(n.type._context);break;case 22:case 23:Af()}i=i.return}if(Ve=r,ze=r=Ur(r.current,null),Je=pt=t,Ne=0,Lo=null,Ef=$s=gi=0,ft=go=null,oi!==null){for(t=0;t<oi.length;t++)if(i=oi[t],n=i.interleaved,n!==null){i.interleaved=null;var e=n.next,o=i.pending;if(o!==null){var a=o.next;o.next=e,n.next=a}i.pending=n}oi=null}return r}function im(r,t){do{var i=ze;try{if(df(),Ga.current=ps,vs){for(var n=Me.memoizedState;n!==null;){var e=n.queue;e!==null&&(e.pending=null),n=n.next}vs=!1}if(di=0,Be=je=Me=null,fo=!1,Ro=0,Mf.current=null,i===null||i.return===null){Ne=1,Lo=t,ze=null;break}e:{var o=r,a=i.return,s=i,l=t;if(t=Je,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var h=l,u=s,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var c=u.alternate;c?(u.updateQueue=c.updateQueue,u.memoizedState=c.memoizedState,u.lanes=c.lanes):(u.updateQueue=null,u.memoizedState=null)}var d=ud(a);if(d!==null){d.flags&=-257,fd(d,a,s,o,t),d.mode&1&&hd(o,h,t),t=d,l=h;var g=t.updateQueue;if(g===null){var v=new Set;v.add(l),t.updateQueue=v}else g.add(l);break e}else{if(!(t&1)){hd(o,h,t),Of();break e}l=Error(G(426))}}else if(Ce&&s.mode&1){var y=ud(a);if(y!==null){!(y.flags&65536)&&(y.flags|=256),fd(y,a,s,o,t),ff(pn(l,s));break e}}o=l=pn(l,s),Ne!==4&&(Ne=2),go===null?go=[o]:go.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var p=Hp(o,l,t);rd(o,p);break e;case 1:s=l;var m=o.type,_=o.stateNode;if(!(o.flags&128)&&(typeof m.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Vr===null||!Vr.has(_)))){o.flags|=65536,t&=-t,o.lanes|=t;var w=Bp(o,s,t);rd(o,w);break e}}o=o.return}while(o!==null)}am(i)}catch(C){t=C,ze===i&&i!==null&&(ze=i=i.return);continue}break}while(1)}function nm(){var r=ms.current;return ms.current=ps,r===null?ps:r}function Of(){(Ne===0||Ne===3||Ne===2)&&(Ne=4),Ve===null||!(gi&268435455)&&!($s&268435455)||Dr(Ve,Je)}function ws(r,t){var i=le;le|=2;var n=nm();(Ve!==r||Je!==t)&&(lr=null,si(r,t));do try{$w();break}catch(e){im(r,e)}while(1);if(df(),le=i,ms.current=n,ze!==null)throw Error(G(261));return Ve=null,Je=0,Ne}function $w(){for(;ze!==null;)om(ze)}function Xw(){for(;ze!==null&&!y0();)om(ze)}function om(r){var t=lm(r.alternate,r,pt);r.memoizedProps=r.pendingProps,t===null?am(r):ze=t,Mf.current=null}function am(r){var t=r;do{var i=t.alternate;if(r=t.return,t.flags&32768){if(i=Bw(i,t),i!==null){i.flags&=32767,ze=i;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Ne=6,ze=null;return}}else if(i=Hw(i,t,pt),i!==null){ze=i;return}if(t=t.sibling,t!==null){ze=t;return}ze=t=r}while(t!==null);Ne===0&&(Ne=5)}function ii(r,t,i){var n=ce,e=Dt.transition;try{Dt.transition=null,ce=1,Jw(r,t,i,n)}finally{Dt.transition=e,ce=n}return null}function Jw(r,t,i,n){do en();while(Nr!==null);if(le&6)throw Error(G(327));i=r.finishedWork;var e=r.finishedLanes;if(i===null)return null;if(r.finishedWork=null,r.finishedLanes=0,i===r.current)throw Error(G(177));r.callbackNode=null,r.callbackPriority=0;var o=i.lanes|i.childLanes;if(R0(r,o),r===Ve&&(ze=Ve=null,Je=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||ca||(ca=!0,hm(ts,function(){return en(),null})),o=(i.flags&15990)!==0,i.subtreeFlags&15990||o){o=Dt.transition,Dt.transition=null;var a=ce;ce=1;var s=le;le|=4,Mf.current=null,Ww(r,i),em(i,r),vw(Yh),is=!!Jh,Yh=Jh=null,r.current=i,Vw(i),w0(),le=s,ce=a,Dt.transition=o}else r.current=i;if(ca&&(ca=!1,Nr=r,ys=e),o=r.pendingLanes,o===0&&(Vr=null),P0(i.stateNode),vt(r,be()),t!==null)for(n=r.onRecoverableError,i=0;i<t.length;i++)e=t[i],n(e.value,{componentStack:e.stack,digest:e.digest});if(_s)throw _s=!1,r=pu,pu=null,r;return ys&1&&r.tag!==0&&en(),o=r.pendingLanes,o&1?r===mu?vo++:(vo=0,mu=r):vo=0,Kr(),null}function en(){if(Nr!==null){var r=Fv(ys),t=Dt.transition,i=ce;try{if(Dt.transition=null,ce=16>r?16:r,Nr===null)var n=!1;else{if(r=Nr,Nr=null,ys=0,le&6)throw Error(G(331));var e=le;for(le|=4,$=r.current;$!==null;){var o=$,a=o.child;if($.flags&16){var s=o.deletions;if(s!==null){for(var l=0;l<s.length;l++){var h=s[l];for($=h;$!==null;){var u=$;switch(u.tag){case 0:case 11:case 15:co(8,u,o)}var f=u.child;if(f!==null)f.return=u,$=f;else for(;$!==null;){u=$;var c=u.sibling,d=u.return;if(Qp(u),u===h){$=null;break}if(c!==null){c.return=d,$=c;break}$=d}}}var g=o.alternate;if(g!==null){var v=g.child;if(v!==null){g.child=null;do{var y=v.sibling;v.sibling=null,v=y}while(v!==null)}}$=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,$=a;else e:for(;$!==null;){if(o=$,o.flags&2048)switch(o.tag){case 0:case 11:case 15:co(9,o,o.return)}var p=o.sibling;if(p!==null){p.return=o.return,$=p;break e}$=o.return}}var m=r.current;for($=m;$!==null;){a=$;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,$=_;else e:for(a=m;$!==null;){if(s=$,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:Us(9,s)}}catch(C){ke(s,s.return,C)}if(s===a){$=null;break e}var w=s.sibling;if(w!==null){w.return=s.return,$=w;break e}$=s.return}}if(le=e,Kr(),tr&&typeof tr.onPostCommitFiberRoot=="function")try{tr.onPostCommitFiberRoot(Ns,r)}catch{}n=!0}return n}finally{ce=i,Dt.transition=t}}return!1}function Td(r,t,i){t=pn(i,t),t=Hp(r,t,1),r=Wr(r,t,1),t=at(),r!==null&&(jo(r,1,t),vt(r,t))}function ke(r,t,i){if(r.tag===3)Td(r,r,i);else for(;t!==null;){if(t.tag===3){Td(t,r,i);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Vr===null||!Vr.has(n))){r=pn(i,r),r=Bp(t,r,1),t=Wr(t,r,1),r=at(),t!==null&&(jo(t,1,r),vt(t,r));break}}t=t.return}}function Yw(r,t,i){var n=r.pingCache;n!==null&&n.delete(t),t=at(),r.pingedLanes|=r.suspendedLanes&i,Ve===r&&(Je&i)===i&&(Ne===4||Ne===3&&(Je&130023424)===Je&&500>be()-kf?si(r,0):Ef|=i),vt(r,t)}function sm(r,t){t===0&&(r.mode&1?(t=ra,ra<<=1,!(ra&130023424)&&(ra=4194304)):t=1);var i=at();r=pr(r,t),r!==null&&(jo(r,t,i),vt(r,i))}function Qw(r){var t=r.memoizedState,i=0;t!==null&&(i=t.retryLane),sm(r,i)}function qw(r,t){var i=0;switch(r.tag){case 13:var n=r.stateNode,e=r.memoizedState;e!==null&&(i=e.retryLane);break;case 19:n=r.stateNode;break;default:throw Error(G(314))}n!==null&&n.delete(t),sm(r,i)}var lm;lm=function(r,t,i){if(r!==null)if(r.memoizedProps!==t.pendingProps||dt.current)ct=!0;else{if(!(r.lanes&i)&&!(t.flags&128))return ct=!1,Fw(r,t,i);ct=!!(r.flags&131072)}else ct=!1,Ce&&t.flags&1048576&&fp(t,us,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Va(r,t),r=t.pendingProps;var e=cn(t,tt.current);Ki(t,i),e=xf(null,t,n,r,e,i);var o=Cf();return t.flags|=1,typeof e=="object"&&e!==null&&typeof e.render=="function"&&e.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,gt(n)?(o=!0,ls(t)):o=!1,t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,pf(t),e.updater=Vs,t.stateNode=e,e._reactInternals=t,ou(t,n,r,i),t=lu(null,t,n,!0,o,i)):(t.tag=0,Ce&&o&&hf(t),ot(null,t,e,i),t=t.child),t;case 16:n=t.elementType;e:{switch(Va(r,t),r=t.pendingProps,e=n._init,n=e(n._payload),t.type=n,e=t.tag=ex(n),r=Ht(n,r),e){case 0:t=su(null,t,n,r,i);break e;case 1:t=gd(null,t,n,r,i);break e;case 11:t=cd(null,t,n,r,i);break e;case 14:t=dd(null,t,n,Ht(n.type,r),i);break e}throw Error(G(306,n,""))}return t;case 0:return n=t.type,e=t.pendingProps,e=t.elementType===n?e:Ht(n,e),su(r,t,n,e,i);case 1:return n=t.type,e=t.pendingProps,e=t.elementType===n?e:Ht(n,e),gd(r,t,n,e,i);case 3:e:{if(Zp(t),r===null)throw Error(G(387));n=t.pendingProps,o=t.memoizedState,e=o.element,vp(r,t),ds(t,n,null,i);var a=t.memoizedState;if(n=a.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){e=pn(Error(G(423)),t),t=vd(r,t,n,i,e);break e}else if(n!==e){e=pn(Error(G(424)),t),t=vd(r,t,n,i,e);break e}else for(mt=Gr(t.stateNode.containerInfo.firstChild),yt=t,Ce=!0,Gt=null,i=yp(t,null,n,i),t.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(dn(),n===e){t=mr(r,t,i);break e}ot(r,t,n,i)}t=t.child}return t;case 5:return wp(t),r===null&&ru(t),n=t.type,e=t.pendingProps,o=r!==null?r.memoizedProps:null,a=e.children,Qh(n,e)?a=null:o!==null&&Qh(n,o)&&(t.flags|=32),Vp(r,t),ot(r,t,a,i),t.child;case 6:return r===null&&ru(t),null;case 13:return Up(r,t,i);case 4:return mf(t,t.stateNode.containerInfo),n=t.pendingProps,r===null?t.child=gn(t,null,n,i):ot(r,t,n,i),t.child;case 11:return n=t.type,e=t.pendingProps,e=t.elementType===n?e:Ht(n,e),cd(r,t,n,e,i);case 7:return ot(r,t,t.pendingProps,i),t.child;case 8:return ot(r,t,t.pendingProps.children,i),t.child;case 12:return ot(r,t,t.pendingProps.children,i),t.child;case 10:e:{if(n=t.type._context,e=t.pendingProps,o=t.memoizedProps,a=e.value,pe(fs,n._currentValue),n._currentValue=a,o!==null)if(Ut(o.value,a)){if(o.children===e.children&&!dt.current){t=mr(r,t,i);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var s=o.dependencies;if(s!==null){a=o.child;for(var l=s.firstContext;l!==null;){if(l.context===n){if(o.tag===1){l=cr(-1,i&-i),l.tag=2;var h=o.updateQueue;if(h!==null){h=h.shared;var u=h.pending;u===null?l.next=l:(l.next=u.next,u.next=l),h.pending=l}}o.lanes|=i,l=o.alternate,l!==null&&(l.lanes|=i),iu(o.return,i,t),s.lanes|=i;break}l=l.next}}else if(o.tag===10)a=o.type===t.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(G(341));a.lanes|=i,s=a.alternate,s!==null&&(s.lanes|=i),iu(a,i,t),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===t){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}ot(r,t,e.children,i),t=t.child}return t;case 9:return e=t.type,n=t.pendingProps.children,Ki(t,i),e=bt(e),n=n(e),t.flags|=1,ot(r,t,n,i),t.child;case 14:return n=t.type,e=Ht(n,t.pendingProps),e=Ht(n.type,e),dd(r,t,n,e,i);case 15:return Gp(r,t,t.type,t.pendingProps,i);case 17:return n=t.type,e=t.pendingProps,e=t.elementType===n?e:Ht(n,e),Va(r,t),t.tag=1,gt(n)?(r=!0,ls(t)):r=!1,Ki(t,i),mp(t,n,e),ou(t,n,e,i),lu(null,t,n,!0,r,i);case 19:return $p(r,t,i);case 22:return Wp(r,t,i)}throw Error(G(156,t.tag))};function hm(r,t){return Iv(r,t)}function Kw(r,t,i,n){this.tag=r,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ot(r,t,i,n){return new Kw(r,t,i,n)}function Lf(r){return r=r.prototype,!(!r||!r.isReactComponent)}function ex(r){if(typeof r=="function")return Lf(r)?1:0;if(r!=null){if(r=r.$$typeof,r===Yu)return 11;if(r===Qu)return 14}return 2}function Ur(r,t){var i=r.alternate;return i===null?(i=Ot(r.tag,t,r.key,r.mode),i.elementType=r.elementType,i.type=r.type,i.stateNode=r.stateNode,i.alternate=r,r.alternate=i):(i.pendingProps=t,i.type=r.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=r.flags&14680064,i.childLanes=r.childLanes,i.lanes=r.lanes,i.child=r.child,i.memoizedProps=r.memoizedProps,i.memoizedState=r.memoizedState,i.updateQueue=r.updateQueue,t=r.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=r.sibling,i.index=r.index,i.ref=r.ref,i}function $a(r,t,i,n,e,o){var a=2;if(n=r,typeof r=="function")Lf(r)&&(a=1);else if(typeof r=="string")a=5;else e:switch(r){case zi:return li(i.children,e,o,t);case Ju:a=8,e|=8;break;case Rh:return r=Ot(12,i,t,e|2),r.elementType=Rh,r.lanes=o,r;case Ah:return r=Ot(13,i,t,e),r.elementType=Ah,r.lanes=o,r;case Oh:return r=Ot(19,i,t,e),r.elementType=Oh,r.lanes=o,r;case _v:return Xs(i,e,o,t);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case pv:a=10;break e;case mv:a=9;break e;case Yu:a=11;break e;case Qu:a=14;break e;case kr:a=16,n=null;break e}throw Error(G(130,r==null?r:typeof r,""))}return t=Ot(a,i,t,e),t.elementType=r,t.type=n,t.lanes=o,t}function li(r,t,i,n){return r=Ot(7,r,n,t),r.lanes=i,r}function Xs(r,t,i,n){return r=Ot(22,r,n,t),r.elementType=_v,r.lanes=i,r.stateNode={isHidden:!1},r}function Nl(r,t,i){return r=Ot(6,r,null,t),r.lanes=i,r}function Fl(r,t,i){return t=Ot(4,r.children!==null?r.children:[],r.key,t),t.lanes=i,t.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},t}function tx(r,t,i,n,e){this.tag=t,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yl(0),this.expirationTimes=yl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yl(0),this.identifierPrefix=n,this.onRecoverableError=e,this.mutableSourceEagerHydrationData=null}function Df(r,t,i,n,e,o,a,s,l){return r=new tx(r,t,i,s,l),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Ot(3,null,null,t),r.current=o,o.stateNode=r,o.memoizedState={element:n,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},pf(o),r}function rx(r,t,i){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ii,key:n==null?null:""+n,children:r,containerInfo:t,implementation:i}}function um(r){if(!r)return Xr;r=r._reactInternals;e:{if(wi(r)!==r||r.tag!==1)throw Error(G(170));var t=r;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(gt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(G(171))}if(r.tag===1){var i=r.type;if(gt(i))return hp(r,i,t)}return t}function fm(r,t,i,n,e,o,a,s,l){return r=Df(i,n,!0,r,e,o,a,s,l),r.context=um(null),i=r.current,n=at(),e=Zr(i),o=cr(n,e),o.callback=t??null,Wr(i,o,e),r.current.lanes=e,jo(r,e,n),vt(r,n),r}function Js(r,t,i,n){var e=t.current,o=at(),a=Zr(e);return i=um(i),t.context===null?t.context=i:t.pendingContext=i,t=cr(o,a),t.payload={element:r},n=n===void 0?null:n,n!==null&&(t.callback=n),r=Wr(e,t,a),r!==null&&(Vt(r,e,a,o),Ba(r,e,a)),a}function xs(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function Sd(r,t){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var i=r.retryLane;r.retryLane=i!==0&&i<t?i:t}}function bf(r,t){Sd(r,t),(r=r.alternate)&&Sd(r,t)}function ix(){return null}var cm=typeof reportError=="function"?reportError:function(r){console.error(r)};function If(r){this._internalRoot=r}Ys.prototype.render=If.prototype.render=function(r){var t=this._internalRoot;if(t===null)throw Error(G(409));Js(r,t,null,null)};Ys.prototype.unmount=If.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var t=r.containerInfo;vi(function(){Js(null,r,null,null)}),t[vr]=null}};function Ys(r){this._internalRoot=r}Ys.prototype.unstable_scheduleHydration=function(r){if(r){var t=Gv();r={blockedOn:null,target:r,priority:t};for(var i=0;i<Lr.length&&t!==0&&t<Lr[i].priority;i++);Lr.splice(i,0,r),i===0&&Vv(r)}};function zf(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function Qs(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Md(){}function nx(r,t,i,n,e){if(e){if(typeof n=="function"){var o=n;n=function(){var h=xs(a);o.call(h)}}var a=fm(t,n,r,0,null,!1,!1,"",Md);return r._reactRootContainer=a,r[vr]=a.current,To(r.nodeType===8?r.parentNode:r),vi(),a}for(;e=r.lastChild;)r.removeChild(e);if(typeof n=="function"){var s=n;n=function(){var h=xs(l);s.call(h)}}var l=Df(r,0,!1,null,null,!1,!1,"",Md);return r._reactRootContainer=l,r[vr]=l.current,To(r.nodeType===8?r.parentNode:r),vi(function(){Js(t,l,i,n)}),l}function qs(r,t,i,n,e){var o=i._reactRootContainer;if(o){var a=o;if(typeof e=="function"){var s=e;e=function(){var l=xs(a);s.call(l)}}Js(t,a,r,e)}else a=nx(i,t,r,e,n);return xs(a)}Hv=function(r){switch(r.tag){case 3:var t=r.stateNode;if(t.current.memoizedState.isDehydrated){var i=Kn(t.pendingLanes);i!==0&&(ef(t,i|1),vt(t,be()),!(le&6)&&(mn=be()+500,Kr()))}break;case 13:vi(function(){var n=pr(r,1);if(n!==null){var e=at();Vt(n,r,1,e)}}),bf(r,1)}};tf=function(r){if(r.tag===13){var t=pr(r,134217728);if(t!==null){var i=at();Vt(t,r,134217728,i)}bf(r,134217728)}};Bv=function(r){if(r.tag===13){var t=Zr(r),i=pr(r,t);if(i!==null){var n=at();Vt(i,r,t,n)}bf(r,t)}};Gv=function(){return ce};Wv=function(r,t){var i=ce;try{return ce=r,t()}finally{ce=i}};Bh=function(r,t,i){switch(t){case"input":if(bh(r,i),t=i.name,i.type==="radio"&&t!=null){for(i=r;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var n=i[t];if(n!==r&&n.form===r.form){var e=Gs(n);if(!e)throw Error(G(90));wv(n),bh(n,e)}}}break;case"textarea":Cv(r,i);break;case"select":t=i.value,t!=null&&Ji(r,!!i.multiple,t,!1)}};Rv=Rf;Av=vi;var ox={usingClientEntryPoint:!1,Events:[Fo,Hi,Gs,Ev,kv,Rf]},zn={findFiberByHostInstance:ni,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ax={bundleType:zn.bundleType,version:zn.version,rendererPackageName:zn.rendererPackageName,rendererConfig:zn.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xr.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Dv(r),r===null?null:r.stateNode},findFiberByHostInstance:zn.findFiberByHostInstance||ix,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var da=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!da.isDisabled&&da.supportsFiber)try{Ns=da.inject(ax),tr=da}catch{}}Ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ox;Ct.createPortal=function(r,t){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zf(t))throw Error(G(200));return rx(r,t,null,i)};Ct.createRoot=function(r,t){if(!zf(r))throw Error(G(299));var i=!1,n="",e=cm;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(e=t.onRecoverableError)),t=Df(r,1,!1,null,null,i,!1,n,e),r[vr]=t.current,To(r.nodeType===8?r.parentNode:r),new If(t)};Ct.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var t=r._reactInternals;if(t===void 0)throw typeof r.render=="function"?Error(G(188)):(r=Object.keys(r).join(","),Error(G(268,r)));return r=Dv(t),r=r===null?null:r.stateNode,r};Ct.flushSync=function(r){return vi(r)};Ct.hydrate=function(r,t,i){if(!Qs(t))throw Error(G(200));return qs(null,r,t,!0,i)};Ct.hydrateRoot=function(r,t,i){if(!zf(r))throw Error(G(405));var n=i!=null&&i.hydratedSources||null,e=!1,o="",a=cm;if(i!=null&&(i.unstable_strictMode===!0&&(e=!0),i.identifierPrefix!==void 0&&(o=i.identifierPrefix),i.onRecoverableError!==void 0&&(a=i.onRecoverableError)),t=fm(t,null,r,1,i??null,e,!1,o,a),r[vr]=t.current,To(r),n)for(r=0;r<n.length;r++)i=n[r],e=i._getVersion,e=e(i._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[i,e]:t.mutableSourceEagerHydrationData.push(i,e);return new Ys(t)};Ct.render=function(r,t,i){if(!Qs(t))throw Error(G(200));return qs(null,r,t,!1,i)};Ct.unmountComponentAtNode=function(r){if(!Qs(r))throw Error(G(40));return r._reactRootContainer?(vi(function(){qs(null,null,r,!1,function(){r._reactRootContainer=null,r[vr]=null})}),!0):!1};Ct.unstable_batchedUpdates=Rf;Ct.unstable_renderSubtreeIntoContainer=function(r,t,i,n){if(!Qs(i))throw Error(G(200));if(r==null||r._reactInternals===void 0)throw Error(G(38));return qs(r,t,i,!1,n)};Ct.version="18.2.0-next-9e3b772b8-20220608";function dm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dm)}catch(r){console.error(r)}}dm(),fv.exports=Ct;var sx=fv.exports,Ed=sx;Eh.createRoot=Ed.createRoot,Eh.hydrateRoot=Ed.hydrateRoot;const lx=async r=>{const t=`https://nominatim.openstreetmap.org/search?q=${r}&format=json&addressdetails=1&limit=1`,n=await(await fetch(t)).json();return n.length==0?null:n[0]};class hx{constructor(){ei(this,"getPlaceDetail",lx)}}const ux=async(r,t)=>{const n=`https://data.police.uk/api/crimes-street/all-crime?poly=${r.map(o=>`${o[0]},${o[1]}`).join(":")}&date=${t}`;return(await fetch(n)).json()},fx=async()=>(await fetch("https://data.police.uk/api/crime-categories")).json();class cx{constructor(){ei(this,"getStreetCrimes",ux);ei(this,"getCrimeCategories",fx)}}const gm=r=>{const t=r*Math.PI/180,i=111132.92-559.82*Math.cos(2*t)+1.175*Math.cos(4*t)-.0023*Math.cos(6*t),n=111412.84*Math.cos(t)-93.5*Math.cos(3*t)+.118*Math.cos(5*t);return{mPerLat:i,mPerLon:n}},dx=(r,t)=>{const{mPerLat:i,mPerLon:n}=gm(r[0]),e=r[0]+t/2/i,o=r[0]-t/2/i,a=r[1]+t/2/n,s=r[1]-t/2/n;return[[e,s],[e,a],[o,a],[o,s]]};class gx{constructor(t){ei(this,"latMeanToMetrePerLatLon",gm);ei(this,"getBoundingSquareLatLonPolygon",dx);ei(this,"getLatLonFromAddress",async t=>{const i=await this.nominatimApiClient.getPlaceDetail(t);if(i==null)return null;const n=parseFloat(i.lat),e=parseFloat(i.lon);return[n,e]});this.nominatimApiClient=t}}class vx{constructor(t,i){this.policeApiClient=t,this.coordinateConversionService=i}async getStreetCrimesAroundCoordinate(t,i,n){const e=this.coordinateConversionService.getBoundingSquareLatLonPolygon(t,i);return await this.policeApiClient.getStreetCrimes(e,n)}}const px=new cx,mx=new hx,Do=new gx(mx),_x=new vx(px,Do),jf=Xe.createContext(void 0),yx=({children:r})=>{const t="NW1 2RT",[i,n]=Xe.useState(t),[e,o]=Xe.useState([0,0]);return Xe.useEffect(()=>{async function a(){const s=await Do.getLatLonFromAddress(i);s!=null&&o(s)}a()},[i]),We.jsx(jf.Provider,{value:{defaultAddress:t,address:i,setAddress:n,coordinate:e},children:r})},Nf=Xe.createContext(void 0),wx=({children:r})=>{const[t,i]=Xe.useState([]);return We.jsx(Nf.Provider,{value:{streetCrimes:t,setStreetCrimes:i},children:r})},xx=()=>{const{defaultAddress:r,setAddress:t}=Xe.useContext(jf),{setStreetCrimes:i}=Xe.useContext(Nf),[n,e]=Xe.useState(r),o=async s=>{const l=await Do.getLatLonFromAddress(s),h=await _x.getStreetCrimesAroundCoordinate(l,1e3,"2023-04");i(h)},a=async()=>{t(n),o(n)};return Xe.useEffect(()=>{o(r)},[]),We.jsxs(We.Fragment,{children:[We.jsx("input",{type:"text",id:"addressField","data-testid":"address",value:n,onChange:s=>{e(s.target.value)}}),We.jsx("div",{id:"searchButton","data-testid":"searchButton",onClick:a,children:"Search"})]})};var vm={exports:{}};(function(r){(function(t){var i,n,e="fulfilled",o="undefined",a=function(){var u=[],f=0;function c(){for(;u.length-f;){try{u[f]()}catch(g){t.console&&t.console.error(g)}u[f++]=n,f==1024&&(u.splice(0,1024),f=0)}}var d=function(){if(typeof MutationObserver===o)return typeof process!==o&&typeof process.nextTick=="function"?function(){process.nextTick(c)}:typeof setImmediate!==o?function(){setImmediate(c)}:function(){setTimeout(c,0)};var g=document.createElement("div");return new MutationObserver(c).observe(g,{attributes:!0}),function(){g.setAttribute("a",0)}}();return function(g){u.push(g),u.length-f==1&&d()}}();function s(u){if(!(this instanceof s))throw new TypeError("Zousan must be created with the new keyword");if(typeof u=="function"){var f=this;try{u(function(c){f.resolve(c)},function(c){f.reject(c)})}catch(c){f.reject(c)}}else if(0<arguments.length)throw new TypeError("Zousan resolver "+u+" is not a function")}function l(u,f){if(typeof u.y=="function")try{var c=u.y.call(n,f);u.p.resolve(c)}catch(d){u.p.reject(d)}else u.p.resolve(f)}function h(u,f){if(typeof u.n=="function")try{var c=u.n.call(n,f);u.p.resolve(c)}catch(d){u.p.reject(d)}else u.p.reject(f)}s.prototype={resolve:function(u){if(this.state===i){if(u===this)return this.reject(new TypeError("Attempt to resolve promise with self"));var f=this;if(u&&(typeof u=="function"||typeof u=="object"))try{var c=!0,d=u.then;if(typeof d=="function")return void d.call(u,function(g){c&&(c=!1,f.resolve(g))},function(g){c&&(c=!1,f.reject(g))})}catch(g){return void(c&&this.reject(g))}this.state=e,this.v=u,f.c&&a(function(){for(var g=0,v=f.c.length;g<v;g++)l(f.c[g],u)})}},reject:function(u){if(this.state===i){var f=this;this.state="rejected",this.v=u;var c=this.c;a(c?function(){for(var d=0,g=c.length;d<g;d++)h(c[d],u)}:function(){f.handled||!s.suppressUncaughtRejectionError&&t.console&&s.warn("You upset Zousan. Please catch rejections: ",u,u?u.stack:null)})}},then:function(u,f){var c=new s,d={y:u,n:f,p:c};if(this.state===i)this.c?this.c.push(d):this.c=[d];else{var g=this.state,v=this.v;this.handled=!0,a(function(){g===e?l(d,v):h(d,v)})}return c},catch:function(u){return this.then(null,u)},finally:function(u){return this.then(u,u)},timeout:function(u,f){f=f||"Timeout";var c=this;return new s(function(d,g){setTimeout(function(){g(Error(f))},u),c.then(function(v){d(v)},function(v){g(v)})})}},s.resolve=function(u){var f=new s;return f.resolve(u),f},s.reject=function(u){var f=new s;return f.c=[],f.reject(u),f},s.all=function(u){var f=[],c=0,d=new s;function g(y,p){y&&typeof y.then=="function"||(y=s.resolve(y)),y.then(function(m){f[p]=m,++c==u.length&&d.resolve(f)},function(m){d.reject(m)})}for(var v=0;v<u.length;v++)g(u[v],v);return u.length||d.resolve(f),d},s.warn=console.warn,r.exports&&(r.exports=s),t.define&&t.define.amd&&t.define([],function(){return s}),(t.Zousan=s).soon=a})(Ia)})(vm);var Cx=vm.exports;const Px=zs(Cx);var Ff={exports:{}},pm={exports:{}};(function(r,t){(function(i,n){r.exports=n()})(Ia,function(){function i(a,s,l,h,u){n(a,s,l||0,h||a.length-1,u||o)}function n(a,s,l,h,u){for(;h>l;){if(h-l>600){var f=h-l+1,c=s-l+1,d=Math.log(f),g=.5*Math.exp(2*d/3),v=.5*Math.sqrt(d*g*(f-g)/f)*(c-f/2<0?-1:1),y=Math.max(l,Math.floor(s-c*g/f+v)),p=Math.min(h,Math.floor(s+(f-c)*g/f+v));n(a,s,y,p,u)}var m=a[s],_=l,w=h;for(e(a,l,s),u(a[h],m)>0&&e(a,l,h);_<w;){for(e(a,_,w),_++,w--;u(a[_],m)<0;)_++;for(;u(a[w],m)>0;)w--}u(a[l],m)===0?e(a,l,w):(w++,e(a,w,h)),w<=s&&(l=w+1),s<=w&&(h=w-1)}}function e(a,s,l){var h=a[s];a[s]=a[l],a[l]=h}function o(a,s){return a<s?-1:a>s?1:0}return i})})(pm);var Tx=pm.exports;Ff.exports=bo;Ff.exports.default=bo;var Sx=Tx;function bo(r,t){if(!(this instanceof bo))return new bo(r,t);this._maxEntries=Math.max(4,r||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),t&&this._initFormat(t),this.clear()}bo.prototype={all:function(){return this._all(this.data,[])},search:function(r){var t=this.data,i=[],n=this.toBBox;if(!va(r,t))return i;for(var e=[],o,a,s,l;t;){for(o=0,a=t.children.length;o<a;o++)s=t.children[o],l=t.leaf?n(s):s,va(r,l)&&(t.leaf?i.push(s):Bl(r,l)?this._all(s,i):e.push(s));t=e.pop()}return i},collides:function(r){var t=this.data,i=this.toBBox;if(!va(r,t))return!1;for(var n=[],e,o,a,s;t;){for(e=0,o=t.children.length;e<o;e++)if(a=t.children[e],s=t.leaf?i(a):a,va(r,s)){if(t.leaf||Bl(r,s))return!0;n.push(a)}t=n.pop()}return!1},load:function(r){if(!(r&&r.length))return this;if(r.length<this._minEntries){for(var t=0,i=r.length;t<i;t++)this.insert(r[t]);return this}var n=this._build(r.slice(),0,r.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var e=this.data;this.data=n,n=e}this._insert(n,this.data.height-n.height-1,!0)}return this},insert:function(r){return r&&this._insert(r,this.data.height-1),this},clear:function(){return this.data=Li([]),this},remove:function(r,t){if(!r)return this;for(var i=this.data,n=this.toBBox(r),e=[],o=[],a,s,l,h;i||e.length;){if(i||(i=e.pop(),s=e[e.length-1],a=o.pop(),h=!0),i.leaf&&(l=Mx(r,i.children,t),l!==-1))return i.children.splice(l,1),e.push(i),this._condense(e),this;!h&&!i.leaf&&Bl(i,n)?(e.push(i),o.push(a),a=0,s=i,i=i.children[0]):s?(a++,i=s.children[a],h=!1):i=null}return this},toBBox:function(r){return r},compareMinX:kd,compareMinY:Rd,toJSON:function(){return this.data},fromJSON:function(r){return this.data=r,this},_all:function(r,t){for(var i=[];r;)r.leaf?t.push.apply(t,r.children):i.push.apply(i,r.children),r=i.pop();return t},_build:function(r,t,i,n){var e=i-t+1,o=this._maxEntries,a;if(e<=o)return a=Li(r.slice(t,i+1)),Pi(a,this.toBBox),a;n||(n=Math.ceil(Math.log(e)/Math.log(o)),o=Math.ceil(e/Math.pow(o,n-1))),a=Li([]),a.leaf=!1,a.height=n;var s=Math.ceil(e/o),l=s*Math.ceil(Math.sqrt(o)),h,u,f,c;for(Ad(r,t,i,l,this.compareMinX),h=t;h<=i;h+=l)for(f=Math.min(h+l-1,i),Ad(r,h,f,s,this.compareMinY),u=h;u<=f;u+=s)c=Math.min(u+s-1,f),a.children.push(this._build(r,u,c,n-1));return Pi(a,this.toBBox),a},_chooseSubtree:function(r,t,i,n){for(var e,o,a,s,l,h,u,f;n.push(t),!(t.leaf||n.length-1===i);){for(u=f=1/0,e=0,o=t.children.length;e<o;e++)a=t.children[e],l=Hl(a),h=Ex(r,a)-l,h<f?(f=h,u=l<u?l:u,s=a):h===f&&l<u&&(u=l,s=a);t=s||t.children[0]}return t},_insert:function(r,t,i){var n=this.toBBox,e=i?r:n(r),o=[],a=this._chooseSubtree(e,this.data,t,o);for(a.children.push(r),ro(a,e);t>=0&&o[t].children.length>this._maxEntries;)this._split(o,t),t--;this._adjustParentBBoxes(e,o,t)},_split:function(r,t){var i=r[t],n=i.children.length,e=this._minEntries;this._chooseSplitAxis(i,e,n);var o=this._chooseSplitIndex(i,e,n),a=Li(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,Pi(i,this.toBBox),Pi(a,this.toBBox),t?r[t-1].children.push(a):this._splitRoot(i,a)},_splitRoot:function(r,t){this.data=Li([r,t]),this.data.height=r.height+1,this.data.leaf=!1,Pi(this.data,this.toBBox)},_chooseSplitIndex:function(r,t,i){var n,e,o,a,s,l,h,u;for(l=h=1/0,n=t;n<=i-t;n++)e=to(r,0,n,this.toBBox),o=to(r,n,i,this.toBBox),a=kx(e,o),s=Hl(e)+Hl(o),a<l?(l=a,u=n,h=s<h?s:h):a===l&&s<h&&(h=s,u=n);return u},_chooseSplitAxis:function(r,t,i){var n=r.leaf?this.compareMinX:kd,e=r.leaf?this.compareMinY:Rd,o=this._allDistMargin(r,t,i,n),a=this._allDistMargin(r,t,i,e);o<a&&r.children.sort(n)},_allDistMargin:function(r,t,i,n){r.children.sort(n);var e=this.toBBox,o=to(r,0,t,e),a=to(r,i-t,i,e),s=ga(o)+ga(a),l,h;for(l=t;l<i-t;l++)h=r.children[l],ro(o,r.leaf?e(h):h),s+=ga(o);for(l=i-t-1;l>=t;l--)h=r.children[l],ro(a,r.leaf?e(h):h),s+=ga(a);return s},_adjustParentBBoxes:function(r,t,i){for(var n=i;n>=0;n--)ro(t[n],r)},_condense:function(r){for(var t=r.length-1,i;t>=0;t--)r[t].children.length===0?t>0?(i=r[t-1].children,i.splice(i.indexOf(r[t]),1)):this.clear():Pi(r[t],this.toBBox)},_initFormat:function(r){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(r[0])),this.compareMinY=new Function("a","b",t.join(r[1])),this.toBBox=new Function("a","return {minX: a"+r[0]+", minY: a"+r[1]+", maxX: a"+r[2]+", maxY: a"+r[3]+"};")}};function Mx(r,t,i){if(!i)return t.indexOf(r);for(var n=0;n<t.length;n++)if(i(r,t[n]))return n;return-1}function Pi(r,t){to(r,0,r.children.length,t,r)}function to(r,t,i,n,e){e||(e=Li(null)),e.minX=1/0,e.minY=1/0,e.maxX=-1/0,e.maxY=-1/0;for(var o=t,a;o<i;o++)a=r.children[o],ro(e,r.leaf?n(a):a);return e}function ro(r,t){return r.minX=Math.min(r.minX,t.minX),r.minY=Math.min(r.minY,t.minY),r.maxX=Math.max(r.maxX,t.maxX),r.maxY=Math.max(r.maxY,t.maxY),r}function kd(r,t){return r.minX-t.minX}function Rd(r,t){return r.minY-t.minY}function Hl(r){return(r.maxX-r.minX)*(r.maxY-r.minY)}function ga(r){return r.maxX-r.minX+(r.maxY-r.minY)}function Ex(r,t){return(Math.max(t.maxX,r.maxX)-Math.min(t.minX,r.minX))*(Math.max(t.maxY,r.maxY)-Math.min(t.minY,r.minY))}function kx(r,t){var i=Math.max(r.minX,t.minX),n=Math.max(r.minY,t.minY),e=Math.min(r.maxX,t.maxX),o=Math.min(r.maxY,t.maxY);return Math.max(0,e-i)*Math.max(0,o-n)}function Bl(r,t){return r.minX<=t.minX&&r.minY<=t.minY&&t.maxX<=r.maxX&&t.maxY<=r.maxY}function va(r,t){return t.minX<=r.maxX&&t.minY<=r.maxY&&t.maxX>=r.minX&&t.maxY>=r.minY}function Li(r){return{children:r,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ad(r,t,i,n,e){for(var o=[t,i],a;o.length;)i=o.pop(),t=o.pop(),!(i-t<=n)&&(a=t+Math.ceil((i-t)/n/2)*n,Sx(r,a,t,i,e),o.push(t,a,a,i))}var Rx=Ff.exports;const Ax=zs(Rx);var mm={exports:{}};(function(r){(function(){function t(s,l){var h=s.x-l.x,u=s.y-l.y;return h*h+u*u}function i(s,l,h){var u=l.x,f=l.y,c=h.x-u,d=h.y-f;if(c!==0||d!==0){var g=((s.x-u)*c+(s.y-f)*d)/(c*c+d*d);g>1?(u=h.x,f=h.y):g>0&&(u+=c*g,f+=d*g)}return c=s.x-u,d=s.y-f,c*c+d*d}function n(s,l){for(var h=s[0],u=[h],f,c=1,d=s.length;c<d;c++)f=s[c],t(f,h)>l&&(u.push(f),h=f);return h!==f&&u.push(f),u}function e(s,l,h,u,f){for(var c=u,d,g=l+1;g<h;g++){var v=i(s[g],s[l],s[h]);v>c&&(d=g,c=v)}c>u&&(d-l>1&&e(s,l,d,u,f),f.push(s[d]),h-d>1&&e(s,d,h,u,f))}function o(s,l){var h=s.length-1,u=[s[0]];return e(s,0,h,l,u),u.push(s[h]),u}function a(s,l,h){if(s.length<=2)return s;var u=l!==void 0?l*l:1;return s=h?s:n(s,u),s=o(s,u),s}r.exports=a,r.exports.default=a})()})(mm);var Ox=mm.exports;const Lx=zs(Ox);/*!
* Contains code from THREE.js
* MIT License
* https://github.com/mrdoob/three.js
*/var Ar=[];for(var Gl=0;Gl<6;Gl++)Ar[Gl]=[];var pa=[];function Wl(r,t,i){Dx(r);for(var n=0;n<6;n++)if(!(i&&i.charAt(n)==="0")){var e=Ar[n];if(pa[0]=e[0]>0?t[1][0]:t[0][0],pa[1]=e[1]>0?t[1][1]:t[0][1],pa[2]=e[2]>0?t[1][2]:t[0][2],bx(e,pa)<0)return!1}return!0}function Dx(r){var t=r,i=t[0],n=t[1],e=t[2],o=t[3],a=t[4],s=t[5],l=t[6],h=t[7],u=t[8],f=t[9],c=t[10],d=t[11],g=t[12],v=t[13],y=t[14],p=t[15];Ti(Ar[0],o-i,h-a,d-u,p-g),Ti(Ar[1],o+i,h+a,d+u,p+g),Ti(Ar[2],o+n,h+s,d+f,p+v),Ti(Ar[3],o-n,h-s,d-f,p-v),Ti(Ar[4],o-e,h-l,d-c,p-y),Ti(Ar[5],o+e,h+l,d+c,p+y)}var ma=1/6;function Ti(r,t,i,n,e){return r[0]=t*ma,r[1]=i*ma,r[2]=n*ma,r[3]=e*ma,r}function bx(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]}/*!
 * maptalks v1.0.0-rc.25
 * LICENSE : BSD-3-Clause
 * (c) 2016-2023 maptalks.org
 */var Ix="1.0.0-rc.25",Bo="_maptalks__internal_layer_",_m=["MultiPoint","MultiLineString","MultiPolygon","GeometryCollection"],zx=["FeatureCollection","Feature","Point","LineString","Polygon"].concat(_m),ym=["markerFile","polygonPatternFile","linePatternFile","markerFillPatternFile","markerLinePatternFile"],jx=[["markerWidth","markerHeight"],[],[null,"lineWidth"],[],[null,"markerLineWidth"]],Nx={lineWidth:1,lineOpacity:1,lineDx:1,lineDy:1,polygonOpacity:1,markerWidth:1,markerHeight:1,markerDx:1,markerDy:1,markerOpacity:1,markerFillOpacity:1,markerLineWidth:1,markerLineOpacity:1,textSize:1,textOpacity:1,textHaloRadius:1,textWrapWidth:1,textLineSpacing:1,textDx:1,textDy:1},Fx=["lineColor","polygonFill","markerFill","markerLineColor","textFill"],wm=14;function ve(){return Date.now()}function W(r){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)r[n]=i[n]}return r}function M(r){return r==null}function V(r){return typeof r=="number"&&!isNaN(r)}function $i(r){return(r|0)===r}function Zt(r){return typeof r=="object"&&!!r}function ie(r){return M(r)?!1:typeof r=="string"||r.constructor!==null&&r.constructor===String}function oe(r){return M(r)?!1:typeof r=="function"||r.constructor!==null&&r.constructor===Function}var Hx=Object.prototype.hasOwnProperty;function Go(r,t){return Hx.call(r,t)}var xm=Math.PI/180;function De(r){return r*xm}function Cm(r){return r/xm}var Fe=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]"&&!process.versions.electron&&!process.versions.nw&&!process.versions["node-webkit"],Ft={},_a={};function Od(){return window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI}if(!Fe){var Nt=navigator.userAgent.toLowerCase(),Vl=document.documentElement||{style:{}},Si="ActiveXObject"in window,Zl=Nt.indexOf("webkit")!==-1,Ul=Nt.indexOf("phantom")!==-1,Ld=Nt.search("android [23]")!==-1,$l=Nt.indexOf("chrome")!==-1,Dd=Nt.indexOf("gecko")!==-1&&!Zl&&!window.opera&&!Si,Bx=/iphone/i.test(Nt)&&/micromessenger/i.test(Nt),jn=typeof orientation<"u"||Nt.indexOf("mobile")!==-1,bd=!window.PointerEvent&&window.MSPointerEvent,Id=window.PointerEvent&&navigator.pointerEnabled||bd,zd=Si&&"transition"in Vl.style,Xl="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ld,jd="MozPerspective"in Vl.style,Nd="OTransition"in Vl.style,Gx=(zd||Xl||jd)&&!Nd&&!Ul,Wx=typeof window<"u"&&oe(window.createImageBitmap),Vx=typeof window<"u"&&oe(window.ResizeObserver),Zx=typeof window<"u"&&oe(window.btoa),Ux=typeof window<"u"&&oe(window.Proxy),Fd=0;$l&&(Fd=Nt.match(/chrome\/([\d.]+)/)[1]);var $x=!Ul&&(Id||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),Xx=typeof window<"u"&&"WebGLRenderingContext"in window,Hd=Od(),Jl=!1;try{var Jx=new OffscreenCanvas(2,2);Jx.getContext("2d"),Jl=!0}catch{Jl=!1}var Bd=!1;try{window.addEventListener("testPassive",function(){},{get passive(){Bd=!0}})}catch{}if(Ft={ie:Si,ielt9:Si&&!document.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in document),webkit:Zl,gecko:Dd,android:Nt.indexOf("android")!==-1,android23:Ld,chrome:$l,chromeVersion:Fd,safari:!$l&&Nt.indexOf("safari")!==-1,phantomjs:Ul,ie3d:zd,webkit3d:Xl,gecko3d:jd,opera12:Nd,any3d:Gx,iosWeixin:Bx,mobile:jn,mobileWebkit:jn&&Zl,mobileWebkit3d:jn&&Xl,mobileOpera:jn&&window.opera,mobileGecko:jn&&Dd,touch:!!$x,msPointer:!!bd,pointer:!!Id,retina:Hd>1,devicePixelRatio:Hd,language:navigator.browserLanguage?navigator.browserLanguage:navigator.language,ie9:Si&&document.documentMode===9,ie10:Si&&document.documentMode===10,webgl:Xx,imageBitMap:Wx,resizeObserver:Vx,btoa:Zx,decodeImageInWorker:Jl,monitorDPRChange:!0,supportsPassive:Bd,proxy:Ux,removeDPRListening:function(t){t&&delete _a[t.id]},checkDevicePixelRatio:function(){if(typeof window<"u"&&Ft.monitorDPRChange){var t=Od(),i=t!==Ft.devicePixelRatio;return i&&(Ft.devicePixelRatio=t),i}return!1},addDPRListening:function(t){t&&(_a[t.id]=t)}},typeof window<"u"&&window.matchMedia)for(var Yl=1;Yl<500;Yl++){var Yx=(Yl*.01).toFixed(2),Nn=window.matchMedia("screen and (resolution: "+Yx+"dppx)");Nn&&(Nn.addEventListener?Nn.addEventListener("change",Ft.checkDevicePixelRatio):Nn.addListener&&Nn.addListener(Ft.checkDevicePixelRatio))}if(Ft.devicePixelRatio){var Ql=Ft.devicePixelRatio;Object.defineProperty(Ft,"devicePixelRatio",{get:function(){return Ql},set:function(t){if(t!==Ql&&(Ql=t,!!Ft.monitorDPRChange))for(var i in _a){var n=_a[i];if(!(!n||!n.options||n.options.devicePixelRatio||!n.checkSize||!n.getRenderer)){var e=n.getRenderer();e&&n.checkSize(!0)}}}})}}var K=Ft;function Gd(r,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,Kx(n.key),n)}}function Qx(r,t,i){return t&&Gd(r.prototype,t),i&&Gd(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r}function wu(){return wu=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r[n]=i[n])}return r},wu.apply(this,arguments)}function F(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,xu(r,t)}function xu(r,t){return xu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,e){return n.__proto__=e,n},xu(r,t)}function Ie(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function qx(r,t){if(typeof r!="object"||r===null)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var n=i.call(r,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function Kx(r){var t=qx(r,"string");return typeof t=="symbol"?t:String(t)}var Pm=function(){function r(i,n,e){if(!M(i)&&!M(n)?(this.x=+i,this.y=+n,this.z=e):!M(i.x)&&!M(i.y)?(this.x=+i.x,this.y=+i.y,this.z=i.z):Array.isArray(i)&&(this.x=+i[0],this.y=+i[1],this.z=i[2]),this._isNaN())throw new Error("Position is NaN")}var t=r.prototype;return t.set=function(n,e,o){return this.x=n,this.y=e,this.z=o||0,this},t.abs=function(){return new this.constructor(Math.abs(this.x),Math.abs(this.y))},t._abs=function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this},t._round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.round=function(){return new this.constructor(Math.round(this.x),Math.round(this.y))},t._ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},t.ceil=function(){return new this.constructor(Math.ceil(this.x),Math.ceil(this.y))},t.distanceTo=function(n){var e=n.x-this.x,o=n.y-this.y;return Math.sqrt(e*e+o*o)},t.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t._floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},t.floor=function(){return new this.constructor(Math.floor(this.x),Math.floor(this.y))},t.copy=function(){return new this.constructor(this.x,this.y,this.z)},t._add=function(n,e){return M(n.x)?M(n[0])?(this.x+=n,this.y+=e):(this.x+=n[0],this.y+=n[1]):(this.x+=n.x,this.y+=n.y),this},t.add=function(n,e){var o,a;return M(n.x)?M(n[0])?(o=this.x+n,a=this.y+e):(o=this.x+n[0],a=this.y+n[1]):(o=this.x+n.x,a=this.y+n.y),new this.constructor(o,a)},t._sub=function(n,e){return M(n.x)?M(n[0])?(this.x-=n,this.y-=e):(this.x-=n[0],this.y-=n[1]):(this.x-=n.x,this.y-=n.y),this},t._substract=function(){return this._sub.apply(this,arguments)},t.sub=function(n,e){var o,a;return M(n.x)?M(n[0])?(o=this.x-n,a=this.y-e):(o=this.x-n[0],a=this.y-n[1]):(o=this.x-n.x,a=this.y-n.y),new this.constructor(o,a)},t.substract=function(){return this.sub.apply(this,arguments)},t.multi=function(n){return new this.constructor(this.x*n,this.y*n)},t._multi=function(n){return this.x*=n,this.y*=n,this},t.div=function(n){return this.multi(1/n)},t._div=function(n){return this._multi(1/n)},t.equals=function(n){return n instanceof this.constructor?this.x===n.x&&this.y===n.y&&this.z===n.z:!1},t._isNaN=function(){return isNaN(this.x)||isNaN(this.y)||V(this.z)&&isNaN(this.z)},t.isZero=function(){return this.x===0&&this.y===0},t.toArray=function(){return V(this.z)?[this.x,this.y,this.z]:[this.x,this.y]},t.toFixed=function(n){return new this.constructor(this.x.toFixed(n),this.y.toFixed(n),V(this.z)?this.z.toFixed:void 0)},t.toJSON=function(){var n={x:this.x,y:this.y};return V(this.z)&&(n.z=this.z),n},r}(),k=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.closeTo=function(e,o){return o||(o=0),this.x>=e.x-o&&this.x<=e.x+o&&this.y>=e.y-o&&this.y<=e.y+o},i.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},i.unit=function(){return this.copy()._unit()},i._unit=function(){return this._div(this.mag()),this},i.perp=function(){return this.copy()._perp()},i._perp=function(){var e=this.y;return this.y=this.x,this.x=-e,this},i.angleWith=function(e){return this.angleWithSep(e.x,e.y)},i.angleWithSep=function(e,o){return Math.atan2(this.x*o-this.y*e,this.x*e+this.y*o)},i._rotate=function(e){var o=Math.cos(e),a=Math.sin(e),s=o*this.x-a*this.y,l=a*this.x+o*this.y;return this.x=s,this.y=l,this},i.rotate=function(e){return this.copy()._rotate(e)},t}(Pm),_r,Cs;(function(){if(Fe){_r=function(a){return setTimeout(a,16)},Cs=clearTimeout;return}var r,t,i=1e3/30;function n(o){return setTimeout(o,i)}function e(o){return window["webkit"+o]||window["moz"+o]||window["ms"+o]}typeof window<"u"?(r=window.requestAnimationFrame||e("RequestAnimationFrame")||n,t=window.cancelAnimationFrame||e("CancelAnimationFrame")||e("CancelRequestAnimationFrame")||function(o){window.clearTimeout(o)}):(r=n,t=clearTimeout),_r=function(a){return r(a)},Cs=function(a){a&&t(a)}})();function tn(r){var t="data:image/svg+xml";return r.length>4&&r.slice(-4)===".svg"?1:r.slice(0,t.length)===t?2:0}function Ps(r,t){if(Fe&&Ps.node){Ps.node(r,t);return}r.src=t[0]}var e1=0;function Tn(){return e1++}function Hf(r){return!r||!ie(r)?r:JSON.parse(r)}function pi(r){for(var t=1;t<arguments.length;t++){var i=arguments[t];if(i)for(var n=0,e=i.length;n<e;n++)r.push(i[n])}return r.length}function Cu(r,t){var i=t.indexOf(r);i>-1&&t.splice(i,1)}function _n(r,t,i){if(!Array.isArray(r))return i?t.call(i,r):t(r);for(var n=[],e,o,a=0,s=r.length;a<s;a++){if(e=r[a],M(e)){n.push(null);continue}Array.isArray(e)?n.push(_n(e,t,i)):(o=i?t.call(i,e):t(e),n.push(o))}return n}function U(r,t){return r===void 0?t:r}function et(r){return Math.sign?Math.sign(r):(r=+r,r===0||isNaN(r)?Number(r):r>0?1:-1)}function Pu(r,t,i){return r*(1-i)+t*i}function Jr(r,t,i){if(r===i||r===t)return r;var n=i-t,e=((r-t)%n+n)%n+t;return e}function Tu(r,t,i){return Math.min(i,Math.max(t,r))}function he(r){return Array.isArray(r)&&r.length>0}var Tm=/^url\((['"])(.+)\1\)$/i,Sm=/^url\(([^'"].*[^'"])\)$/i;function t1(r){return ie(r)?Sm.test(r)?1:Tm.test(r)?2:3:0}function Bf(r){var t=t1(r),i;return t===3?r:t===1?(i=Sm.exec(r),i[1]):t===2?(i=Tm.exec(r),i[2]):r}var r1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function i1(r){if(K.btoa)return window.btoa(r);for(var t=String(r),i="",n,e,o=0,a=r1;t.charAt(o|0)||(a="=",o%1);i+=a.charAt(63&n>>8-o%1*8)){if(e=t.charCodeAt(o+=3/4),e>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");n=n<<8|e}return i}function n1(r,t){for(var i=atob(r),n=new ArrayBuffer(i.length),e=new Uint8Array(n),o=0;o<i.length;o++)e[o]=i.charCodeAt(o)&255;var a=new Blob([n],{type:t});return a}function Su(r,t,i,n){var e=i-r,o=n-t;return Math.atan2(o,e)}var Mm="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";function Mu(r,t){if(!r&&!t)return!0;if(!r||!t)return!1;for(var i in r)if(i==="center"){if(!t[i]||!Wd(r[i][0],t[i][0])||!Wd(r[i][1],t[i][1]))return!1}else if(r[i]!==t[i])return!1;return!0}function Wd(r,t,i){return i==null&&(i=1e-6),r>=t-i&&r<=t+i}function Em(r,t,i,n){r||(r=100),t||(t=4);var e=this,o=this.isVisible();t*=2,this._flashTimeout&&clearTimeout(this._flashTimeout);function a(){if(t===0){o?e.show():e.hide(),i&&(n?i.call(n):i());return}t%2===0?e.hide():e.show(),t--,e._flashTimeout=setTimeout(a,r)}return this._flashTimeout=setTimeout(a,r),this}function Ts(r,t){r===void 0&&(r=[]),t===void 0&&(t="_pt");for(var i=[],n=0,e=r.length;n<e;n++){var o=r[n];if(!o){i.push(null);continue}o[t]||(o[t]=new k(0,0));var a=o[t];a.x=0,a.y=0,i.push(a)}return i}function km(r,t){t(r.data)}function Rm(r){if(r&&r.indexOf("http://")===0||r.indexOf("https://")===0)return r;var t=document.createElement("a");return t.href=r,r=t.href,t=null,r}var Fn={cssWidth:"1px",cssHeight:"1px",width:1,height:1};function Am(r,t){t===void 0&&(t=1);var i=r.width,n=r.height;return Fn.cssWidth=i+"px",Fn.cssHeight=n+"px",Fn.width=Math.round(i*t),Fn.height=Math.round(n*t),Fn}var Mi,Eu={width:100,height:10};function o1(){if(!Mi){var r=Eu.width,t=Eu.height;OffscreenCanvas?Mi=new OffscreenCanvas(r,t):(Mi=document.createElement("canvas"),Mi.width=r,Mi.height=t)}return Mi}var Vd=function(){function r(i,n){if(n===void 0&&(n={}),!Array.isArray(i)){console.error("colors is not array");return}if(i.length<2){console.error("colors.length should >1");return}this.colors=i;for(var e=1/0,o=-1/0,a=0,s=i.length;a<s;a++){var l=i[a][0];e=Math.min(l,e),o=Math.max(l,o)}this.min=e,this.max=o,this.valueOffset=this.max-this.min,this.options=Object.assign({},Eu,n),this._initImgData()}var t=r.prototype;return t.getImageData=function(){return this.imgData},t._initImgData=function(){var n=o1(),e=this.options,o=e.width,a=e.height;n.width=o,n.height=a;var s=n.getContext("2d");s.clearRect(0,0,n.width,n.height);for(var l=s.createLinearGradient(0,0,n.width,0),h=this.colors,u=this.valueOffset,f=0,c=h.length;f<c;f++){var d=h[f],g=d[0],v=d[1],y=(g-this.min)/u;l.addColorStop(y,v)}s.fillStyle=l,s.fillRect(0,0,n.width,n.height),this.imgData=s.getImageData(0,0,n.width,n.height)},t.getColor=function(n){n=Math.max(this.min,n),n=Math.min(n,this.max);var e=(n-this.min)/this.valueOffset,o=Math.round(e*this.imgData.width);o=Math.min(o,this.imgData.width-1);var a=o*4,s=this.imgData.data[a],l=this.imgData.data[a+1],h=this.imgData.data[a+2],u=this.imgData.data[a+3];return[s,l,h,u]},r}(),a1=typeof Map=="function",io;a1&&(io=new Map);function Om(r,t){var i,n,e;if(!de(r))i=function(){return r},n=!0,e=!0;else{var o=r.stops&&typeof r.stops[0][0]=="object",a=o||r.property!==void 0,s=o||!a,l=r.type||t||"exponential",h;if(l==="exponential")h=Zd;else if(l==="interval")h=h1;else if(l==="categorical")h=l1;else if(l==="identity")h=f1;else if(l==="color-interpolate")h=u1;else throw new Error('Unknown function type "'+l+'"');if(o){for(var u={},f=[],c=0;c<r.stops.length;c++){var d=r.stops[c];u[d[0].zoom]===void 0&&(u[d[0].zoom]={zoom:d[0].zoom,type:r.type,property:r.property,default:r.default,stops:[]}),u[d[0].zoom].stops.push([d[0].value,d[1]])}for(var g in u)f.push([u[g].zoom,Om(u[g])]);i=function(y,p){var m=Zd({stops:f,base:r.base},y)(y,p);return typeof m=="function"?m(y,p):m},n=!1,e=!1}else s?(i=function(y){var p=h(r,y);return typeof p=="function"?p(y):p},n=!0,e=!1):(i=function(y,p){var m=h(r,p?p[r.property]:null);return typeof m=="function"?m(y,p):m},n=!1,e=!0)}return i.isZoomConstant=e,i.isFeatureConstant=n,i}function s1(r,t,i){return r!==void 0?r:t!==void 0?t:i!==void 0?i:null}function l1(r,t){for(var i=0;i<r.stops.length;i++)if(t===r.stops[i][0])return r.stops[i][1];return r.default}function h1(r,t){for(var i=0;i<r.stops.length&&!(t<r.stops[i][0]);i++);return r.stops[Math.max(i-1,0)][1]}function Zd(r,t){for(var i=r.base!==void 0?r.base:1,n=0;!(n>=r.stops.length);){if(t<=r.stops[n][0])break;n++}return n===0?r.stops[n][1]:n===r.stops.length?r.stops[n-1][1]:Lm(t,i,r.stops[n-1][0],r.stops[n][0],r.stops[n-1][1],r.stops[n][1])}var Ud={width:100,height:1};function u1(r,t){var i=r.stops;if(i&&i.length>1){var n;if(io){var e=JSON.stringify(i);if(!io.has(e)){var o=new Vd(i,Ud);io.set(e,o)}n=io.get(e)}else n=new Vd(i,Ud);var a=n.getColor(t),s=a[0],l=a[1],h=a[2],u=a[3];return[s/255,l/255,h/255,u/255]}else if(i&&i.length===1)return i[0][1];return null}function f1(r,t){return s1(t,r.default)}function Lm(r,t,i,n,e,o){return typeof e=="function"?function(){var a=e.apply(void 0,arguments),s=o.apply(void 0,arguments);return Lm(r,t,i,n,a,s)}:e.length?c1(r,t,i,n,e,o):Dm(r,t,i,n,e,o)}function Dm(r,t,i,n,e,o){var a=n-i,s=r-i,l;return t===1?l=s/a:l=(Math.pow(t,s)-1)/(Math.pow(t,a)-1),e*(1-l)+o*l}function c1(r,t,i,n,e,o){for(var a=[],s=0;s<e.length;s++)a[s]=Dm(r,t,i,n,e[s],o[s]);return a}function de(r){return r&&typeof r=="object"&&(r.stops||r.property&&r.type==="identity")}function bm(r){for(var t in r)if(de(r[t]))return!0;return!1}function Ss(r){return Im(r,"exponential")}function Gf(r,t){if(!r)return null;var i=!1;if(Array.isArray(r)){for(var n=[],e,o=0;o<r.length;o++)e=Gf(r[o],t),e?(n.push(e),i=!0):n.push(r[o]);return i?n:r}var a={__fn_types_loaded:!0},s=[],l;for(l in r)r.hasOwnProperty(l)&&s.push(l);for(var h=function(d){Object.defineProperty(a,d,{get:function(){return this["__fn_"+d]||(this["__fn_"+d]=Ss(this["_"+d])),this["__fn_"+d].apply(this,t())},set:function(v){this["_"+d]=v},configurable:!0,enumerable:!0})},u=0,f=s.length;u<f;u++)l=s[u],de(r[l])?(i=!0,a["_"+l]=r[l],h(l)):a[l]=r[l];return i?a:r}function $d(r){if(!r||!r.stops)return[];for(var t=[],i=0,n=r.stops.length;i<n;i++)t.push(r.stops[i][1]);return t}function Im(r,t){if(!de(r))return function(){return r};r=JSON.parse(JSON.stringify(r));var i=!0,n=!0,e=r.stops;if(e){for(var o=0;o<e.length;o++)if(de(e[o][1])){var a=Im(e[o][1],t);i=i&&a.isZoomConstant,n=n&&a.isFeatureConstant,e[o]=[e[o][0],a]}}var s=Om(r,t);return s.isZoomConstant=i&&s.isZoomConstant,s.isFeatureConstant=n&&s.isFeatureConstant,s}var Wf=["Unknown","Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon","GeometryCollection"];function d1(r){return typeof r=="object"&&!!r}function Vf(r){return new Function("f","var p = (f && f.properties || {}); return "+zm(r))}function zm(r){if(!r)return"true";var t=r[0];if(r.length<=1)return t==="any"?"false":"true";var i=t==="=="?ql(r[1],r[2],"===",!1):t==="!="?ql(r[1],r[2],"!==",!1):t==="<"||t===">"||t==="<="||t===">="?ql(r[1],r[2],t,!0):t==="any"?Kl(r.slice(1),"||"):t==="all"?Kl(r.slice(1),"&&"):t==="none"?eh(Kl(r.slice(1),"||")):t==="in"?Xd(r[1],r.slice(2)):t==="!in"?eh(Xd(r[1],r.slice(2))):t==="has"?Jd(r[1]):t==="!has"?eh(Jd(r[1])):t==="contains"?v1(r[1],r[2],r[3]):"true";return"("+i+")"}function g1(r,t,i,n){var e=r.property,o=r.op,a=Ks(e);if(o==="length")a="(("+a+"+='').length)";else return console.error("not support "+o+" op"),"false";return jm(a,e,t,i,n)}function v1(r,t,i){var n=Ks(r);return i!==void 0?"("+n+` + '').indexOf("`+t+'") === '+i:"("+n+` + '').indexOf("`+t+'") >= 0'}function Ks(r){return r[0]==="$"?"f."+r.substring(1):"p["+JSON.stringify(r)+"]"}function ql(r,t,i,n){if(d1(r)&&r.op)return g1(r,t,i,n);var e=Ks(r);return jm(e,r,t,i,n)}function jm(r,t,i,n,e){var o=t==="$type"?Wf.indexOf(i):JSON.stringify(i);return(e?"typeof "+r+"=== typeof "+o+"&&":"")+r+n+o}function Kl(r,t){return r.map(zm).join(t)}function Xd(r,t){r==="$type"&&(t=t.map(function(e){return Wf.indexOf(e)}));var i=JSON.stringify(t.sort(p1)),n=Ks(r);return t.length<=200?i+".indexOf("+n+") !== -1":`function(v, a, i, j) {
        while (i <= j) { var m = (i + j) >> 1;
            if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;
        }
    return false; }(`+n+", "+i+",0,"+(t.length-1)+")"}function Jd(r){return r==="$id"?'"id" in f':JSON.stringify(r)+" in p"}function eh(r){return"!("+r+")"}function p1(r,t){return r<t?-1:r>t?1:0}function ku(r){var t=r._toJSON(),i=t.feature;return i.type=Wf.indexOf(i.geometry.type),i.subType=t.subType,i}function Nm(r){if(!Array.isArray(r))return Nm([r]);for(var t=[],i=0;i<r.length;i++){var n=void 0;r[i].filter===!0?n=function(){return!0}:n=Vf(r[i].filter),t.push(m1({},r[i],{filter:n}))}return t}function m1(r){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)r[n]=i[n]}return r}var _1=[],y1={};function Ms(r,t){return Gf(r,function(){var i=t.getMap();return w1(_1,i?i.getZoom():12,W({},t.getProperties(),x1(y1,i&&i.getBearing()||0,i&&i.getPitch()||0,i?i.getZoom():10)))})}function w1(r,t,i){return r[0]=t,r[1]=i,r}function x1(r,t,i,n){return r["{bearing}"]=t,r["{pitch}"]=i,r["{zoom}"]=n,r}function C1(r){var t={stroke:{stroke:r.markerLineColor,"stroke-width":r.markerLineWidth,"stroke-opacity":r.markerLineOpacity,"stroke-dasharray":null,"stroke-linecap":"butt","stroke-linejoin":"round"},fill:{fill:r.markerFill,"fill-opacity":r.markerFillOpacity}};return t.stroke["stroke-width"]===0&&(t.stroke["stroke-opacity"]=0),t}function Es(r,t,i){if(!r.markerPath)return null;var n=1,e=C1(r);V(r.markerOpacity)&&(n=r.markerOpacity),V(r.opacity)&&(n*=r.opacity);var o={};if(e){for(var a in e.stroke)e.stroke.hasOwnProperty(a)&&(M(e.stroke[a])||(o[a]=e.stroke[a]));for(var s in e.fill)e.fill.hasOwnProperty(s)&&(M(e.fill[s])||(o[s]=e.fill[s]))}for(var l=Array.isArray(r.markerPath)?r.markerPath:[r.markerPath],h,u=[],f=0;f<l.length;f++)h=ie(l[f])?{path:l[f]}:l[f],h=W({},h,o),h.d=h.path,delete h.path,u.push(h);var c=['<svg version="1.1"','xmlns="http://www.w3.org/2000/svg"'];n<1&&c.push('opacity="'+n+'"'),r.markerPathWidth&&r.markerPathHeight&&c.push('viewBox="0 0 '+r.markerPathWidth+" "+r.markerPathHeight+'"'),c.push('preserveAspectRatio="none"'),t&&c.push('width="'+t+'"'),i&&c.push('height="'+i+'"'),c.push("><defs></defs>");for(var d=0;d<u.length;d++){var g="<path ";for(var v in u[d])u[d].hasOwnProperty(v)&&(g+=" "+v+'="'+u[d][v]+'"');g+="></path>",c.push(g)}c.push("</svg>");var y="data:image/svg+xml;base64,"+i1(c.join(" "));return y}function el(r,t){if(!r)return[];var i=r;Array.isArray(r)||(i=[r]);for(var n=[],e=ym,o,a,s,l,h=i.length-1;h>=0;h--)if(r=i[h],!!r){t&&(r=Ru(r));for(var u=0;u<e.length;u++)if(o=r[e[u]],de(o)&&(o=$d(o)),!!o){Array.isArray(o)||(o=[o]);for(var f=0;f<o.length;f++)o[f].slice(0,4)==="url("&&(o[f]=Bf(o[f])),a=jx[u],n.push([o[f],r[a[0]],r[a[1]]])}if(r.markerType==="path"&&r.markerPath)if(s=de(r.markerWidth)?200:r.markerWidth,l=de(r.markerHeight)?200:r.markerHeight,de(r.markerPath)){o=$d(r.markerPath);for(var c=r.markerPath,d=0;d<o.length;d++)r.markerPath=o[d],n.push([Es(r),s,l]);r.markerPath=c}else n.push([Es(r),s,l])}return n}function Ru(r){if(!r)return null;var t=r;if(Fe)return t;for(var i=ym,n,e=0,o=i.length;e<o;e++)n=t[i[e]],n&&(t[i[e]]=Fm(n));return t}function Fm(r){if(de(r)){for(var t=r.stops,i=0;i<t.length;i++)t[i][1]=Fm(t[i][1]);return r}return r.slice(0,4)==="url("&&(r=Bf(r)),r}var Ae=function(){function r(i,n){V(i)&&V(n)?(this.width=i,this.height=n):V(i.width)?(this.width=i.width,this.height=i.height):Array.isArray(i)&&(this.width=i[0],this.height=i[1])}var t=r.prototype;return t.copy=function(){return new r(this.width,this.height)},t.add=function(n,e){var o,a;return n instanceof r?(o=this.width+n.width,a=this.height+n.height):(o=this.width+n,a=this.height+e),new r(o,a)},t.equals=function(n){return this.width===n.width&&this.height===n.height},t.multi=function(n){return new r(this.width*n,this.height*n)},t._multi=function(n){return this.width*=n,this.height*=n,this},t._round=function(){return this.width=Math.round(this.width),this.height=Math.round(this.height),this},t.toPoint=function(){return new k(this.width,this.height)},t.toArray=function(){return[this.width,this.height]},t.toJSON=function(){return{width:this.width,height:this.height}},r}();function Hm(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}var P1=/[\b\t\r\v\f]/igm;function Zf(r){return ie(r)?r.replace(P1,""):r}function T1(r){return Hm(r).split(/\s+/)}var Yd=typeof document<"u"?document.createElement("canvas").getContext("2d"):null;function hi(r,t){return hi.node?hi.node(r,t):(Yd.font=t,Yd.measureText(r).width)}function Bm(r,t,i){var n=hi(r,t);return new Ae(n,i||wm)}function Qd(r,t,i,n){if(!r||r.length===0)return[{text:"",width:0}];var e=M(n)?hi(r,t):n,o=e/r.length,a=Math.floor(i/o/2);if(o>=i||a<=0)return[{text:"",width:i}];if(e<=i)return[{text:r,width:e}];for(var s=[],l=r.substring(0,a),h=o*a,u=a,f=r.length;u<f;u++){var c=r[u],d=hi(l+c);d>=i?(s.push({text:l,width:h}),l=r.substring(u,a+u),u+=a-1,h=o*a):(l+=c,h=d),u>=f-1&&(h=hi(l),s.push({text:l,width:h}))}return s}var S1=/\{([\w_]+)\}/g;function Au(r,t){return ie(r)?r.replace(S1,function(i,n){if(!t)return"";var e=t[n];return M(e)?"":Array.isArray(e)?e.join():e}):r}function Ou(r,t){V(r)&&(r+=""),r=r||"";var i=t.textMaxHeight||0,n=Wm(r,t);return i&&i<n.size.height&&(n.size.height=i),n}function mi(r,t,i){var n=r.width,e=r.height,o,a;return t==="left"?o=-n:t==="right"?o=0:o=-n/2,i==="top"?a=-e:i==="bottom"?a=0:a=-e/2,new k(o,a)}var M1="monospace";function Gm(r){return r.textFont?r.textFont:(r.textStyle&&r.textStyle!=="normal"?r.textStyle+" ":"")+(r.textWeight&&r.textWeight!=="normal"?r.textWeight+" ":"")+r.textSize+"px "+(r.textFaceName?r.textFaceName[0]==='"'?r.textFaceName:'"'+r.textFaceName+'"':M1)}function Wm(r,t){var i=Gm(t),n=t.textLineSpacing||0,e=Bm(r,i,t.textSize),o=e.width,a=e.height,s=t.textWrapCharacter,l=[],h=t.textWrapWidth;(!h||h>o)&&(h=o),ie(r)||(r+="");var u=0;if(s&&r.indexOf(s)>=0)for(var f=r.split(s),c=0,d=f.length;c<d;c++){var g=f[c],v=hi(g,i);if(v>h)for(var y=Qd(g,i,h,v),p=0,m=y.length;p<m;p++){var _=y[p].width;_>u&&(u=_),l.push({text:y[p].text,size:new Ae(_,a)})}else v>u&&(u=v),l.push({text:g,size:new Ae(v,a)})}else if(o>h)for(var w=Qd(r,i,h,o),C=0;C<w.length;C++){var x=w[C].width;x>u&&(u=x),l.push({text:w[C].text,size:new Ae(x,a)})}else o>u&&(u=o),l.push({text:r,size:e});var T=l.length,P=new Ae(u,a*T+n*(T-1));return{total:T,size:P,rows:l,rawSize:e}}function Vm(r){var t=0,i=r&&r.length||0;if(!i)return t;for(var n,e=0;e<i;e++)n=r.charCodeAt(e),t=(t<<5)-t+n,t=t&t;return t}function Yr(r){return r&&r.colorStops}function qd(r){var t=[r.type];if(r.places&&t.push(r.places.join()),r.colorStops){for(var i=[],n=r.colorStops.length-1;n>=0;n--)i.push(r.colorStops[n].join());t.push(i.join(","))}return t.join("_")}function Uf(r,t){if(!r)return 1;var i=[];if(Array.isArray(r)){for(var n=0;n<r.length;n++)i.push(Uf(r[n],t));return i.sort().join(",")}var e=Object.keys(r).sort(),o=e.reduce(function(s,l){return(!t||l.indexOf(t)===0)&&(s[l]=r[l]),s},{}),a=Vm(JSON.stringify(o));return a}function Lu(r,t){function i(a,s){var l=a.opacity;M(l)?a.opacity=s:a.opacity*=s}var n;if(Array.isArray(r)){n=[];for(var e=0;e<r.length;e++){var o=W({},r[e]);i(o,t),n.push(o)}}else n=W({},r),i(n,t);return n}function Kt(r){var t=Array.prototype.slice.call(arguments,1);if((!t||!t.length)&&(t=[{}]),Array.isArray(r)){for(var i,n,e=[],o=0,a=r.length;o<a;o++){i=r[o],n={};for(var s=0,l=t.length;s<l;s++)Array.isArray(t[s])?M(t[s][o])?W(n,i||{}):W(n,i,t[s][o]):W(n,i,t[s]?t[s]:{});e.push(n)}return e}else{var h=[{},r];return h.push.apply(h,t),W.apply(this,h)}}function E1(r){if(r.symbol&&(r=[r]),Array.isArray(r))return r;var t=r.$root,i=r.$iconset;if(r=r.style,t||i){t&&t[t.length-1]==="/"&&(t=t.substring(0,t.length-1)),i&&i[i.length-1]==="/"&&(i=i.substring(0,i.length-1));var n=function(o){return o==="{$root}"?t:o==="{$iconset}"?i:null};k1(r,n)}return r}function k1(r,t){for(var i=0;i<r.length;i++){var n=r[i].symbol;n&&Zm(n,t)}}var Du=/(\{\$root\}|\{\$iconset\})/g;function Zm(r,t){for(var i in r)r.hasOwnProperty(i)&&i!=="textName"&&(ie(r[i])&&r[i].length>2?r[i]=r[i].replace(Du,t):de(r[i])?r[i]=Um(r[i],t):Zt(r[i])&&Zm(r[i],t))}function Um(r,t){var i=r.default;ie(i)&&(r.default=i.replace(Du,t));for(var n=r.stops,e=0;e<n.length;e++)Array.isArray(n[e])&&(ie(n[e][1])?n[e][1]=n[e][1].replace(Du,t):de(n[e][1])&&(n[e][1]=Um(n[e][1],t)));return r}function R1(r){r===void 0&&(r=[]),Array.isArray(r)||(r=[r]);for(var t=r.length,i=0;i<t;i++){var n=r[i];if(n.style){var e=n.style,o=e.lineDasharray,a=e.lineWidth;if(a&&V(a)&&a>0&&o&&Array.isArray(o)&&o.length)return!0}}return!1}var A1=function(t){return t[0]},tl=Fe?A1:function(r){for(var t=document.documentElement&&document.documentElement.style||{},i=0;i<r.length;i++)if(r[i]in t)return r[i];return!1},Di=tl(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),O1=tl(["transformOrigin","WebkitTransformOrigin","OTransformOrigin","MozTransformOrigin","msTransformOrigin"]),ya=tl(["transition","WebkitTransition","OTransition","MozTransition","msTransition"]);tl(["filter","WebkitFilter","OFilter","MozFilter","msFilter"]);function Y(r,t){var i=document.createElement(r);return t&&$f(i,t),i}function Kd(r,t,i){var n=Y(r);return t&&il(n,t),i&&i.appendChild(n),n}function yn(r){if(!r)return this;if(K.ielt9||K.ie9){var t=Y("div");t.appendChild(r),t.innerHTML="",t=null}else r.parentNode&&r.parentNode.removeChild(r);return this}function ir(r,t,i,n){if(!r||!r.addEventListener||!t||!i)return this;for(var e=function(u){u||(u=window.event),i.call(n||r,u)},o=t.split(" "),a=o.length-1;a>=0;a--){var s=o[a];if(s){r["Z__"+s]||(r["Z__"+s]=[]);var l=$m(r,s,i);l>=0&&(console.warn(r,"find '"+s+"' handler:",i," The old listener function will be removed"),dr(r,s,i)),r["Z__"+s].push({callback:e,src:i}),r.addEventListener(s,e,K.supportsPassive?{capture:!1,passive:!1}:!1)}}return this}function dr(r,t,i){function n(c,d){c==="mousewheel"&&K.gecko&&(c="DOMMouseScroll"),r.removeEventListener(c,d,!1)}if(!r||!r.removeEventListener||!t)return this;for(var e=t.split(" "),o=e.length-1;o>=0;o--){var a=e[o];if(a){if(!i&&r["Z__"+a]){for(var s=r["Z__"+a],l=0,h=s.length;l<h;l++)n(s[l].callback);return delete r["Z__"+a],this}var u=$m(r,a,i);if(u<0)return this;var f=r["Z__"+a][u];n(a,f.callback),r["Z__"+a].splice(u,1)}}return this}function $m(r,t,i){if(!r||!r["Z__"+t]||!i)return-1;for(var n=r["Z__"+t],e=0,o=n.length;e<o;e++)if(n[e].src===i)return e;return-1}function yr(r){return r.preventDefault?r.preventDefault():r.returnValue=!1,this}function wt(r){return r._cancelBubble=!0,r.stopPropagation?r.stopPropagation():r.cancelBubble=!0,this}function L1(r){return r.onselectstart=function(){return!1},r.ondragstart=function(){return!1},r.setAttribute("unselectable","on"),this}function wa(r,t){return r?(K.any3d?b1(r,t):(r.style.left=t.x+"px",r.style.top=t.y+"px"),t):null}function rl(r){var t=window.getComputedStyle(r),i=[parseInt(t["padding-left"]),parseInt(t["padding-top"])],n=r.getBoundingClientRect(),e=r.offsetWidth,o=r.offsetHeight,a=e?n.width/e:1,s=o?n.height/o:1;return r.__position=[n.left+i[0],n.top+i[1],a,s],r.__position}function _t(r,t){r||(r=window.event);var i=t.__position;return i||(i=rl(t)),new k((r.clientX-i[0]-t.clientLeft)/i[2],(r.clientY-i[1]-t.clientTop)/i[3])}function D1(r,t){var i=r.length-t.length;return i>=0&&r.indexOf(t,i)===i}function il(r,t){var i=r.style.cssText;return D1(i,";")||(i+=";"),r.style.cssText=i+t,this}function Xm(r,t){if(r.classList!==void 0)return r.classList.contains(t);var i=Jm(r);return i.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(i)}function rn(r,t){if(r.classList!==void 0&&!Xm(r,t))for(var i=T1(t),n=0,e=i.length;n<e;n++)r.classList.add(i[n]);else{var o=Jm(r);$f(r,(o?o+" ":"")+t)}return this}function $f(r,t){return M(r.className.baseVal)?r.className=t:r.className.baseVal=t,this}function Jm(r){return M(r.className.baseVal)?r.className:r.className.baseVal}function b1(r,t){var i=t||new k(0,0);return r.style[Di]=K.any3d?"translate3d("+i.x+"px,"+i.y+"px,0px)":"translate("+i.x+"px,"+i.y+"px)",this}function I1(r){return/<[a-z\][\s\S]*>/i.test(r)}function z1(r,t){var i=j1(r);ie(t)?i.innerHTML=t:i.appendChild(t);var n=new Ae(i.clientWidth,i.clientHeight);return yn(i),n}function j1(r){var t=document.createElement(r);return t.style.cssText="position:absolute;left:-10000px;top:-10000px;",document.body.appendChild(t),t}var Pe=ir,Re=dr;function Ym(r){return r&&(r==="mousemove"||r==="touchmove")}var Qm=typeof Map=="function",qm=function(){},N1=function(){function r(i,n){this.max=i,this.onRemove=n||qm,this.reset()}var t=r.prototype;return t.reset=function(){for(var n in this.data)this.onRemove(this.data[n]);return this.data={},this.order=[],this},t.clear=function(){this.reset(),delete this.onRemove},t.add=function(n,e){if(this.has(n))this.order.splice(this.order.indexOf(n),1),this.data[n]=e,this.order.push(n);else if(this.data[n]=e,this.order.push(n),this.order.length>this.max){var o=this.getAndRemove(this.order[0]);o&&this.onRemove(o)}return this},t.has=function(n){return n in this.data},t.keys=function(){return this.order},t.getAndRemove=function(n){if(!this.has(n))return null;var e=this.data[n];return delete this.data[n],this.order.splice(this.order.indexOf(n),1),e},t.get=function(n){if(!this.has(n))return null;var e=this.data[n];return e},t.remove=function(n){if(!this.has(n))return this;var e=this.data[n];return delete this.data[n],this.onRemove(e),this.order.splice(this.order.indexOf(n),1),this},t.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var e=this.getAndRemove(this.order[0]);e&&this.onRemove(e)}return this},r}(),Km;Qm&&(Km=function(){function r(i,n){this.max=i,this.onRemove=n||qm,this.reset()}var t=r.prototype;return t.reset=function(){if(this.data)for(var n=this.data.values(),a=n,e=Array.isArray(a),o=0,a=e?a:a[Symbol.iterator]();;){var s;if(e){if(o>=a.length)break;s=a[o++]}else{if(o=a.next(),o.done)break;s=o.value}var l=s;this.onRemove(l)}return this.data=new Map,this},t.clear=function(){this.reset(),delete this.onRemove},t.add=function(n,e){return e?(this.has(n)?(this.data.delete(n),this.data.set(n,e)):this.data.set(n,e),this):this},t.keys=function(){for(var n=new Array(this.data.size),e=0,o=this.data.keys(),l=o,a=Array.isArray(l),s=0,l=a?l:l[Symbol.iterator]();;){var h;if(a){if(s>=l.length)break;h=l[s++]}else{if(s=l.next(),s.done)break;h=s.value}var u=h;n[e++]=u}return n},t.shrink=function(){for(var n=this.data.keys(),e=n.next();this.data.size>this.max;){var o=this.getAndRemove(e.value);o&&this.onRemove(o),e=n.next()}},t.has=function(n){return this.data.has(n)},t.getAndRemove=function(n){if(!this.has(n))return null;var e=this.data.get(n);return this.data.delete(n),e},t.get=function(n){if(!this.has(n))return null;var e=this.data.get(n);return e},t.remove=function(n){if(!this.has(n))return this;var e=this.data.get(n);return this.data.delete(n),this.onRemove(e),this},t.setMaxSize=function(n){return this.max=n,this.data.size>this.max&&this.shrink(),this},r}());var e_=Qm?Km:N1,ut={jsonp:function(t,i){var n="_maptalks_jsonp_"+Tn();t.match(/\?/)?t+="&callback="+n:t+="?callback="+n;var e=document.createElement("script");return e.type="text/javascript",e.src=t,window[n]=function(o){i(null,o),document.getElementsByTagName("head")[0].removeChild(e),e=null,delete window[n]},document.getElementsByTagName("head")[0].appendChild(e),this},get:function(t,i,n){if(oe(i)){var e=n;n=i,i=e}if(Fe&&ut.get.node)return ut.get.node(t,n,i);var o=ut._getClient(n);if(o.open("GET",t,!0),i){for(var a in i.headers)o.setRequestHeader(a,i.headers[a]);o.withCredentials=i.credentials==="include",i.responseType&&(o.responseType=i.responseType)}return o.send(null),o},post:function(t,i,n){var e;if(ie(t)){if(oe(i)){var a=n;n=i,i=a}i=i||{},e=i.postData}else{var o=n;e=i,i=t,t=i.url,n=o}if(Fe&&ut.post.node)return i.url=t,ut.post.node(i,e,n);var s=ut._getClient(n);if(s.open("POST",i.url,!0),i.headers||(i.headers={}),i.headers["Content-Type"]||(i.headers["Content-Type"]="application/x-www-form-urlencoded"),"setRequestHeader"in s)for(var l in i.headers)i.headers.hasOwnProperty(l)&&s.setRequestHeader(l,i.headers[l]);return ie(e)||(e=JSON.stringify(e)),s.send(e),s},_wrapCallback:function(t,i){return function(){if(t.readyState===4)if(t.status===200)if(t.responseType==="arraybuffer"){var n=t.response;n.byteLength===0?i(new Error("http status 200 returned without content.")):i(null,{data:t.response,cacheControl:t.getResponseHeader("Cache-Control"),expires:t.getResponseHeader("Expires"),contentType:t.getResponseHeader("Content-Type")})}else i(null,t.responseText);else i(new Error(t.statusText+","+t.status))}},_getClient:function(t){var i;try{i=new XMLHttpRequest}catch{try{i=new ActiveXObject("Msxml2.XMLHTTP")}catch{try{i=new ActiveXObject("Microsoft.XMLHTTP")}catch{}}}return i.onreadystatechange=ut._wrapCallback(i,t),i},getArrayBuffer:function(t,i,n){if(oe(i)){var e=n;n=i,i=e}return i||(i={}),i.responseType="arraybuffer",ut.get(t,i,n)},getImage:function(t,i,n){return ut.getArrayBuffer(i,n,function(e,o){if(e)t.onerror&&t.onerror(e);else if(o){var a=window.URL||window.webkitURL,s=t.onload;t.onload=function(){s&&s(),a.revokeObjectURL(t.src)};var l=new Blob([new Uint8Array(o.data)],{type:o.contentType});t.cacheControl=o.cacheControl,t.expires=o.expires,t.src=o.data.byteLength?a.createObjectURL(l):Mm}})}};ut.getJSON=function(r,t,i){if(oe(t)){var n=i;i=t,t=n}var e=function(a,s){var l=s?Hf(s):null;i(a,l)};return t&&t.jsonp?ut.jsonp(r,e):ut.get(r,t,e)};var t_=1/0,r_=1/0,i_=-1/0,n_=-1/0;function nl(){return[t_,r_,i_,n_]}var nn=nl();function Io(r){r[0]=t_,r[1]=r_,r[2]=i_,r[3]=n_}function o_(r,t){if(r)if(Array.isArray(r[0]))for(var i=0,n=r.length;i<n;i++)o_(r[i],t);else if(Array.isArray(r))for(var e=0,o=r.length;e<o;e++){var a=r[e],s=a.x,l=a.y;t[0]=Math.min(s,t[0]),t[1]=Math.min(l,t[1]),t[2]=Math.max(s,t[2]),t[3]=Math.max(l,t[3])}else{var s=r.x,l=r.y;t[0]=Math.min(s,t[0]),t[1]=Math.min(l,t[1]),t[2]=Math.max(s,t[2]),t[3]=Math.max(l,t[3])}}function ol(r,t,i,n,e){t!==0&&!t||(Array.isArray(t)&&(i=t[1],n=t[2],e=t[3],t=t[0]),r[0]=Math.min(t,r[0]),r[1]=Math.min(i,r[1]),r[2]=Math.max(n,r[2]),r[3]=Math.max(e,r[3]))}function ks(r){return r&&r[0]!==1/0&&r[0]!==void 0}function F1(r,t){t===void 0&&(t=0),r[0]-=t,r[1]-=t,r[2]+=t,r[3]+=t}var eg="#000",H1="rgba(255,255,255,0)",B1="#000",xa=!1,Ei=null,ki=Math.PI/180,tg=1,j={getCanvas2DContext:function(t){return t.getContext("2d",{willReadFrequently:!0})},setHitTesting:function(t){xa=t},createCanvas:function(t,i,n){var e;return Fe?e=new n(t,i):(e=Y("canvas"),e.width=t,e.height=i),e},prepareCanvasFont:function(t,i){t.textBaseline="top",t.font=Gm(i);var n=i.textFill;n||(n=B1),t.fillStyle=j.getRgba(n,i.textOpacity)},prepareCanvas:function(t,i,n,e){if(i){var o=i.lineWidth;!M(o)&&t.lineWidth!==o&&(t.lineWidth=o);var a=i.linePatternFile,s=i.lineColor||eg;if(e)t.strokeStyle="#000";else if(a&&n){var l;(i.linePatternDx||i.linePatternDy)&&(l=[i.linePatternDx,i.linePatternDy]),j._setStrokePattern(t,a,o,l,n),i.lineDasharray=[]}else Yr(s)?i.lineGradientExtent?t.strokeStyle=j._createGradient(t,s,i.lineGradientExtent):t.strokeStyle=eg:(Array.isArray(s)&&(s=j.normalizeColorToRGBA(s)),t.strokeStyle=s);i.lineJoin&&(t.lineJoin=i.lineJoin),i.lineCap&&(t.lineCap=i.lineCap),t.setLineDash&&he(i.lineDasharray)&&t.setLineDash(i.lineDasharray);var h=i.polygonPatternFile,u=i.polygonFill||H1;if(e)t.fillStyle="#000";else if(h&&n){var f=ig(h),c=n.getImage([f,null,null]);if(c||(c=n.getImage([f+"-texture",null,o])),tn(f)&&c instanceof Image&&(K.edge||K.ie)){var d=c.width||20,g=c.height||20,v=j.createCanvas(d,g);j.image(v.getContext("2d"),c,0,0,d,g),c=v}c?(t.fillStyle=t.createPattern(c,"repeat"),(i.polygonPatternDx||i.polygonPatternDy)&&(t.fillStyle.polygonPatternOffset=[i.polygonPatternDx,i.polygonPatternDy])):typeof console<"u"&&console.warn("img not found for",f)}else Yr(u)?i.polygonGradientExtent?t.fillStyle=j._createGradient(t,u,i.polygonGradientExtent):t.fillStyle="rgba(255,255,255,0)":(Array.isArray(u)&&(u=j.normalizeColorToRGBA(u)),t.fillStyle=u)}},_createGradient:function(t,i,n){var e=null,o=i.places,a=n.getMin(),s=n.getMax(),l=n.getWidth(),h=n.getHeight();if(!i.type||i.type==="linear"){if(!o)o=[a.x,a.y,s.x,a.y];else{if(o.length!==4)throw new Error("A linear gradient's places should have 4 numbers.");o=[a.x+o[0]*l,a.y+o[1]*h,a.x+o[2]*l,a.y+o[3]*h]}e=t.createLinearGradient.apply(t,o)}else if(i.type==="radial"){if(o){if(o.length!==6)throw new Error("A radial gradient's places should have 6 numbers.");o=[a.x+o[0]*l,a.y+o[1]*h,l*o[2],a.x+o[3]*l,a.y+o[4]*h,l*o[5]]}else{var u=n.getCenter()._round();o=[u.x,u.y,Math.abs(u.x-a.x),u.x,u.y,0]}e=t.createRadialGradient.apply(t,o)}return i.colorStops.forEach(function(f){e.addColorStop.apply(e,f)}),e},_setStrokePattern:function(t,i,n,e,o){var a=ig(i),s;if(Fe)s=o.getImage([a,null,n]);else{var l=a+"-texture-"+n;if(s=o.getImage(l),!s){var h=o.getImage([a,null,null]);if(h){var u;!h.width||!h.height?u=n:u=Math.round(h.width*n/h.height);var f=j.createCanvas(u,n,t.canvas.constructor);j.image(f.getContext("2d"),h,0,0,u,n),o.addResource([l,null,n],f),s=f}}}s?(t.strokeStyle=t.createPattern(s,"repeat"),t.strokeStyle.linePatternOffset=e):typeof console<"u"&&console.warn("img not found for",a)},clearRect:function(t,i,n,e,o){t.canvas._drawn=!1,t.clearRect(i,n,e,o)},fillCanvas:function(t,i,n,e){if(xa&&(i=1),t.canvas._drawn=!0,i!==0){var o=j._isPattern(t.fillStyle),a=t.fillStyle&&t.fillStyle.polygonPatternOffset,s=a?a[0]:0,l=a?a[1]:0;M(i)&&(i=1);var h;i<1&&(h=t.globalAlpha,t.globalAlpha*=i),o&&(n=n||0,e=e||0,t.translate(n+s,e+l)),t.fill(),o&&t.translate(-n-s,-e-l),i<1&&(t.globalAlpha=h)}},getRgba:function(t,i){if(M(i)&&(i=1),t[0]!=="#")return Array.isArray(t)&&(t=j.normalizeColorToRGBA(t,i)),t;var n,e,o;return t.length===7?(n=parseInt(t.substring(1,3),16),e=parseInt(t.substring(3,5),16),o=parseInt(t.substring(5,7),16)):(n=parseInt(t.substring(1,2),16)*17,e=parseInt(t.substring(2,3),16)*17,o=parseInt(t.substring(3,4),16)*17),"rgba("+n+","+e+","+o+","+i+")"},normalizeColorToRGBA:function(t,i){return i===void 0&&(i=1),"rgba("+t[0]*255+","+t[1]*255+","+t[2]*255+","+(t.length===4?t[3]:1)*i+")"},image:function(t,i,n,e,o,a){t.canvas._drawn=!0;try{V(o)&&V(a)?t.drawImage(i,n,e,o,a):t.drawImage(i,n,e)}catch(s){console&&(console.warn("error when drawing image on canvas:",s),console.warn(i))}},text:function(t,i,n,e,o){return j._textOnMultiRow(t,o.rows,e,n,o.size,o.rawSize)},_textOnMultiRow:function(t,i,n,e,o,a){var s=mi(o,n.textHorizontalAlignment,n.textVerticalAlignment),l=a.height+n.textLineSpacing,h=e.add(0,s.y),u=n.textMaxHeight,f,c,d=0;Io(nn);for(var g=0,v=i.length;g<v;g++){f=i[g].text,c=mi(i[g].size,n.textHorizontalAlignment,n.textVerticalAlignment);var y=h.add(c.x,g*l);j._textOnLine(t,f,y,n.textHaloRadius,n.textHaloFill,n.textHaloOpacity);var p=i[g].size,m=y.x,_=y.y,w=m+p.width,C=_+p.height;if(ol(nn,m,_,w,C),u>0&&(d+=l,d+p.height>=u))break}return nn},_textOnLine:function(t,i,n,e,o,a){xa&&(a=1);var s=a!==0&&e!==0;t.textBaseline="top";var l,h,u=t.shadowBlur,f=t.shadowOffsetX,c=t.shadowOffsetY;if(s){var d=t.globalAlpha;t.globalAlpha*=a,t.miterLimit=2,t.lineJoin="round",t.lineCap="round",t.lineWidth=e*2,Array.isArray(o)&&(o=j.normalizeColorToRGBA(o)),t.strokeStyle=o,t.strokeText(i,n.x,n.y+tg),t.miterLimit=10,t.globalAlpha=d,l=t.globalCompositeOperation,t.globalCompositeOperation="destination-out",h=t.fillStyle,t.fillStyle="#000"}u&&s&&(t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0),j.fillText(t,i,n),l&&(t.globalCompositeOperation=l,j.fillText(t,i,n,h),u&&(t.shadowBlur=u,t.shadowOffsetX=f,t.shadowOffsetY=c))},fillText:function(t,i,n,e){t.canvas._drawn=!0,e&&(t.fillStyle=e),t.fillText(i,n.x,n.y+tg)},_stroke:function(t,i,n,e){if(xa&&(i=1),t.canvas._drawn=!0,i!==0){var o=t.strokeStyle&&t.strokeStyle.linePatternOffset,a=o?o[0]:0,s=o?o[1]:0,l=j._isPattern(t.strokeStyle)&&(!M(n)&&!M(e)||!M(a)&&!M(s));M(i)&&(i=1);var h;i<1&&(h=t.globalAlpha,t.globalAlpha*=i),l&&(n=n||0,e=e||0,t.translate(n+a,e+s)),t.stroke(),l&&t.translate(-n-a,-e-s),i<1&&(t.globalAlpha=h)}},_path:function(t,i,n,e,o){if(!he(i))return;function a(g,v){var y=Su(g.x,g.y,v.x,v.y);t.save();var p=Math.cos(y);Math.abs(p)<1e-7?t.translate(g.x-t.lineWidth/2,g.y):t.translate(g.x,g.y-t.lineWidth/2/p),t.rotate(y),j._stroke(t,e),t.restore()}for(var s=he(n),l=o===!0?!1:j._isPattern(t.strokeStyle),h,u,f,c=0,d=i.length;c<d;c++)if(h=i[c],!s||t.setLineDash)t.lineTo(h.x,h.y),l&&c>0&&(u=i[c-1],a(u,h),t.beginPath(),t.moveTo(h.x,h.y));else if(s){if(c===d-1)break;f=i[c+1],G1(t,h,f,n)}},path:function(t,i,n,e,o){he(i)&&(t.beginPath(),t.moveTo(i[0].x,i[0].y),j._path(t,i,o,n),j._stroke(t,n))},_multiClip:function(t,i){if(!(!i||i.length===0)){i=i[0];for(var n=0,e=i.length;n<e;n++){var o=i[n],a=o.x,s=o.y;n===0?t.moveTo(a,s):t.lineTo(a,s),n===e-1&&(a=i[0].x,s=i[0].y,t.lineTo(a,s))}}},polygon:function(t,i,n,e,o,a){if(t.isMultiClip){j._multiClip(t,i);return}if(t.isClip){j._multiClip(t,Array.isArray(i[0])?i:[i]);return}if(he(i)){var s=j._isPattern(t.strokeStyle),l=he(o)&&!t.setLineDash||s&&!a;he(i[0])||(i=[i]);var h=t;i.length>1&&!Fe&&(Ei||(Ei=j.createCanvas(1,1)),t.canvas._drawn=!1,Ei.width=t.canvas.width,Ei.height=t.canvas.height,t=Ei.getContext("2d"),ng(t,h));var u,f,c;if(l){for(t.save(),f=0,c=i.length;f<c;f++)he(i[f])&&(j._ring(t,i[f],null,0,!0),u=e,f>0&&(t.globalCompositeOperation="destination-out",u=1),j.fillCanvas(t,u,i[f][0].x,i[f][0].y),f>0?t.globalCompositeOperation="source-over":c>1&&(t.fillStyle="#fff"),j._stroke(t,0));t.restore()}var d=t.fillStyle;for(f=0,c=i.length;f<c;f++)he(i[f])&&(a?(j.paintSmoothLine(t,i[f],n,a,!0),t.closePath()):j._ring(t,i[f],o,n),l||(u=e,f>0&&(t.globalCompositeOperation="destination-out",u=1),j.fillCanvas(t,u,i[f][0].x,i[f][0].y),f>0?t.globalCompositeOperation="source-over":c>1&&(t.fillStyle="#fff")),j._stroke(t,n));t.fillStyle!==d&&(t.fillStyle=d),i.length>1&&!Fe&&(h.drawImage(Ei,0,0),h.canvas._drawn=t.canvas._drawn,ng(h,t))}},_ring:function(t,i,n,e,o){var a=j._isPattern(t.strokeStyle);!o&&a&&!i[0].equals(i[i.length-1])&&(i=i.concat([i[0]])),t.beginPath(),t.moveTo(i[0].x,i[0].y),j._path(t,i,n,e,o),a||t.closePath()},paintSmoothLine:function(t,i,n,e,o,a,s){if(!i)return;if(i.length<=2||!e){j.path(t,i,n);return}function l(P,S,E,D,A,I,L,O,H,B){var R=1-P,b=1-S,N=E*R*R+A*2*P*R+L*P*P,Z=E*b*b+A*2*S*b+L*S*S,X=A*R*R+L*2*P*R+H*P*P,ne=A*b*b+L*2*S*b+H*S*S,te=D*R*R+I*2*P*R+O*P*P,J=D*b*b+I*2*S*b+O*S*S,q=I*R*R+O*2*P*R+B*P*P,ue=I*b*b+O*2*S*b+B*S*S,me=N*b+X*S,re=Z*R+ne*P,He=Z*b+ne*S,nt=te*b+q*S,_e=J*R+ue*P,Le=J*b+ue*S;return[me,nt,re,_e,He,Le]}function h(P,S,E,D,A,I,L,O,H,B){var R=(P+E)/2,b=(S+D)/2,N=(E+A)/2,Z=(D+I)/2,X=(A+L)/2,ne=(I+O)/2,te=Math.sqrt((E-P)*(E-P)+(D-S)*(D-S)),J=Math.sqrt((A-E)*(A-E)+(I-D)*(I-D)),q=Math.sqrt((L-A)*(L-A)+(O-I)*(O-I)),ue=te/(te+J),me=J/(J+q),re=R+(N-R)*ue,He=b+(Z-b)*ue,nt=N+(X-N)*me,_e=Z+(ne-Z)*me,Le=re+(N-re)*H+E-re,Tt=He+(Z-He)*H+D-He,ar=nt+(N-nt)*H+A-nt,fe=_e+(Z-_e)*H+I-_e,Pr=[Le,Tt,ar,fe];return B<1?l(0,B,E,D,Le,Tt,ar,fe,A,I):Pr}var u=i.length,f=o?u:u-1;t.beginPath(),t.moveTo(i[0].x,i[0].y),s!==void 0&&(f-=Math.max(f-a-1,0));for(var c,d=0;d<f;d++){var g=i[d].x,v=i[d].y,y=void 0,p=void 0,m=void 0,_=void 0,w=void 0,C=void 0;d-1<0?o?(y=i[f-1].x,p=i[f-1].y):(y=i[d+1].x,p=i[d+1].y):(y=i[d-1].x,p=i[d-1].y),d+1<u?(m=i[d+1].x,_=i[d+1].y):(m=i[d+1-u].x,_=i[d+1-u].y),d+2<u?(w=i[d+2].x,C=i[d+2].y):o?(w=i[d+2-u].x,C=i[d+2-u].y):(w=i[d].x,C=i[d].y);var x=h(y,p,g,v,m,_,w,C,e,d===f-1?s:1);if(d===f-1&&s>=0&&s<1){t.bezierCurveTo(x[0],x[1],x[2],x[3],x[4],x[5]),i.splice(f-1,u-(f-1)-1);var T=new k(x[4],x[5]);T.prevCtrlPoint=new k(x[2],x[3]),i.push(T),u=i.length}else t.bezierCurveTo(x[0],x[1],x[2],x[3],m,_);i[d].nextCtrlPoint=x.slice(0,2),i[d].prevCtrlPoint=c?c.slice(2):null,c=x}!o&&i[1].prevCtrlPoint&&(i[0].nextCtrlPoint=i[1].prevCtrlPoint,delete i[0].prevCtrlPoint),i[u-1].prevCtrlPoint||(i[u-1].prevCtrlPoint=i[u-2].nextCtrlPoint),j._stroke(t,n)},_arcBetween:function(t,i,n,e){var o=e,a=i.distanceTo(n),s=a/2/Math.sin(o/2),l=Math.asin((n.y-i.y)/a);i.x>n.x&&(l=Math.PI-l);var h=90*ki-o/2,u=l-h,f=Math.cos(u)*s,c=Math.sin(u)*s,d=i.x+f,g=i.y+c,v=Math.asin((n.y-g)/s);d>n.x&&(v=Math.PI-v);var y=v+o;return t.beginPath(),t.arc(d,g,s,v,y),[d,g]},_lineTo:function(t,i){t.lineTo(i.x,i.y)},bezierCurveAndFill:function(t,i,n,e){t.beginPath();var o=i[0];t.moveTo(o.x,o.y);var a=[t];a.push.apply(a,i.splice(1)),j._bezierCurveTo.apply(j,a),j.fillCanvas(t,e),j._stroke(t,n)},_bezierCurveTo:function(t,i,n,e){t.bezierCurveTo(i.x,i.y,n.x,n.y,e.x,e.y)},ellipse:function(t,i,n,e,o,a,s){function l(h,u,f,c,d){var g=.5522848,v=f*g,y=c*g,p=d*g;t.moveTo(h-f,u),t.bezierCurveTo(h-f,u-y,h-v,u-c,h,u-c),t.bezierCurveTo(h+v,u-c,h+f,u-y,h+f,u),t.bezierCurveTo(h+f,u+p,h+v,u+d,h,u+d),t.bezierCurveTo(h-v,u+d,h-f,u+p,h-f,u),t.closePath()}t.beginPath(),n===e&&n===o?t.arc(i.x,i.y,n,0,2*Math.PI):t.ellipse?e!==o?(t.ellipse(i.x,i.y,n,e,0,ki*180,ki*360,!1),t.ellipse(i.x,i.y,n,o,0,0,ki*180,!1)):t.ellipse(i.x,i.y,n,e,0,0,ki*360,!1):l(i.x,i.y,n,e,o),j.fillCanvas(t,s,i.x-n,i.y-e),j._stroke(t,a,i.x-n,i.y-e)},rectangle:function(t,i,n,e,o){var a=i.x,s=i.y;t.beginPath(),t.rect(a,s,n.width,n.height),j.fillCanvas(t,o,a,s),j._stroke(t,e,a,s)},sector:function(t,i,n,e,o,a){var s=ki,l=e[0],h=e[1];function u(f,c,d,g,v,y){var p=s*-y,m=s*-v;f.beginPath(),f.moveTo(c,d),f.arc(c,d,g,p,m),f.lineTo(c,d),j.fillCanvas(f,a,c-g,d-g),j._stroke(f,o,c-g,d-g)}u(t,i.x,i.y,n,l,h)},_isPattern:function(t){return!ie(t)&&!("addColorStop"in t)},drawCross:function(t,i,n,e,o){t.canvas._drawn=!0,t.strokeStyle=o,t.lineWidth=e,t.beginPath(),t.moveTo(i-5,n),t.lineTo(i+5,n),t.moveTo(i,n-5),t.lineTo(i,n+5),t.stroke()},copy:function(t,i){var n=i||Y("canvas");return n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(t,0,0),n},pixelRect:function(t,i,n,e){var o=t.lineWidth,a=t.globalAlpha,s=!1;if(o>0&&n>0)s=!0,n<1&&(t.globalAlpha*=n);else if(e>0)e<1&&(t.globalAlpha*=e);else return;t.canvas._drawn=!0,s?t.strokeRect(i[0],i[1],1,1):t.fillRect(i[0],i[1],1,1),t.globalAlpha!==a&&(t.globalAlpha=a)}};function G1(r,t,i,n){var e=t.x,o=t.y,a=i.x,s=i.y,l=n,h=function(x,T){return x<=T},u=function(x,T){return x>=T},f=function(x,T){return Math.min(x,T)},c=function(x,T){return Math.max(x,T)},d={thereYet:u,cap:f},g={thereYet:u,cap:f};o-s>0&&(g.thereYet=h,g.cap=c),e-a>0&&(d.thereYet=h,d.cap=c),r.moveTo(e,o);for(var v=e,y=o,p=0,m=!0,_,w;!(d.thereYet(v,a)&&g.thereYet(y,s));)_=Math.atan2(s-o,a-e),w=l[p],v=d.cap(a,v+Math.cos(_)*w),y=g.cap(s,y+Math.sin(_)*w),m?r.lineTo(v,y):r.moveTo(v,y),p=(p+1)%l.length,m=!m}var rg="data:image/";function ig(r){return r.substring(0,rg.length)===rg?r:Bf(r)}function ng(r,t){r.filter=t.filter,r.fillStyle=t.fillStyle,r.globalAlpha=t.globalAlpha,r.lineCap=t.lineCap,r.lineDashOffset=t.lineDashOffset,r.lineJoin=t.lineJoin,r.lineWidth=t.lineWidth,r.shadowBlur=t.shadowBlur,r.shadowColor=t.shadowColor,r.shadowOffsetX=t.shadowOffsetX,r.shadowOffsetY=t.shadowOffsetY,r.strokeStyle=t.strokeStyle}var bu;typeof Promise<"u"?bu=Promise:bu=Px;var og=bu,Cr=function(t){return function(i){F(n,i);function n(){return i.apply(this,arguments)||this}var e=n.prototype;return e.on=function(a,s,l){if(!a)return this;if(!ie(a))return this._switch("on",a,s);if(!s)return this;this._eventMap||(this._eventMap={});var h=a.toLowerCase().split(" "),u;l||(l=this);for(var f,c=0,d=h.length;c<d;c++){u=h[c],f=this._eventMap[u],f||(f=[],this._eventMap[u]=f);var g=f.length;if(g>0){for(var v=0;v<g;v++)if(s===f[v].handler&&f[v].context===l)return K.isTest||console.warn(this,"find '"+a+"' handler:",s," The old listener function will be removed"),this}f.push({handler:s,context:l})}return this},e.addEventListener=function(){return this.on.apply(this,arguments)},e.once=function(a,s,l){if(!ie(a)){var h={};for(var u in a)a.hasOwnProperty(u)&&(h[u]=this._wrapOnceHandler(u,a[u],l));return this._switch("on",h)}for(var f=a.split(" "),c=0,d=f.length;c<d;c++)this.on(f[c],this._wrapOnceHandler(f[c],s,l));return this},e.off=function(a,s,l){if(!this._eventMap||!a)return this;if(!ie(a))return this._switch("off",a,s);if(!s)return this;var h=a.split(" "),u,f,c;l||(l=this);for(var d=0,g=h.length;d<g;d++){if(u=h[d].toLowerCase(),c="Z__"+u,f=this._eventMap[u],!f)return this;for(var v=f.length-1;v>=0;v--){var y=f[v];(s===y.handler||s===y.handler[c])&&y.context===l&&(delete y.handler[c],f.splice(v,1))}f.length||delete this._eventMap[u]}return this},e.removeEventListener=function(){return this.off.apply(this,arguments)},e.listens=function(a,s,l){if(!this._eventMap||!ie(a))return 0;var h=this._eventMap[a.toLowerCase()];if(!h||!h.length)return 0;if(!s)return h.length;for(var u=0,f=h.length;u<f;u++)if(s===h[u].handler&&(M(l)||h[u].context===l))return 1;return 0},e.getListeningEvents=function(){return this._eventMap?Object.keys(this._eventMap):[]},e.copyEventListeners=function(a){var s=a._eventMap;if(!s)return this;var l;for(var h in s){l=s[h];for(var u=0,f=l.length;u<f;u++)this.on(h,l[u].handler,l[u].context)}return this},e.fire=function(){return this._eventParent?this._eventParent.fire.apply(this._eventParent,arguments):this._fire.apply(this,arguments)},e._wrapOnceHandler=function(a,s,l){var h=this,u="Z__"+a,f=!1,c=function d(){f||(delete c[u],f=!0,l?s.apply(l,arguments):s.apply(this,arguments),h.off(a,d,this))};return c[u]=s,c},e._switch=function(a,s,l){for(var h in s)s.hasOwnProperty(h)&&this[a](h,s[h],l);return this},e._clearListeners=function(a){if(!(!this._eventMap||!ie(a))){var s=this._eventMap[a.toLowerCase()];s&&(this._eventMap[a]=null)}},e._clearAllListeners=function(){this._eventMap=null},e._setEventParent=function(a){return this._eventParent=a,this},e._setEventTarget=function(a){return this._eventTarget=a,this},e._fire=function(a,s){if(!this._eventMap)return this;var l=this._eventMap[a.toLowerCase()];if(!l)return this;s||(s={}),s.type=a,s.target=this._eventTarget||this;for(var h=l.slice(0),u,f,c,d=0,g=h.length;d<g;d++)h[d]&&(u=h[d].context,f=!0,c=W({},s),u?f=h[d].handler.call(u,c):f=h[d].handler(c),f===!1&&s.domEvent&&wt(s.domEvent));return this},n}(t)},W1=function(){function r(i){this.target=i}var t=r.prototype;return t.enable=function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},t.disable=function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},t.enabled=function(){return!!this._enabled},t.remove=function(){this.disable(),delete this.target,delete this.dom},r}(),Xt=Cr(W1),zt=function(){function r(i){if(!this||!this.setOptions)throw new Error('Class instance is being created without "new" operator.');this.setOptions(i),this.callInitHooks(),this._isUpdatingOptions=!1}var t=r.prototype;return t.proxyOptions=function(){var n=this;return K.proxy?this.options.isExtensible?this:(this.options=new Proxy(this.options,{set:function(o,a,s){if(o[a]===s||(o[a]=s,n._isUpdatingOptions))return!0;var l={};return l[a]=s,n.config(l),!0}}),this):this},t.callInitHooks=function(){var n=Object.getPrototypeOf(this);return this._visitInitHooks(n),this},t.setOptions=function(n){if(this.hasOwnProperty("options")||(this.options=this.options?Object.create(this.options):{}),!n)return this;for(var e in n)this.options[e]=n[e];return this},t.config=function(n){if(this._isUpdatingOptions=!0,n){if(arguments.length===2){var a={};a[n]=arguments[1],n=a}for(var s in n)this.options[s]=n[s],this[s]&&this[s]instanceof Xt&&(n[s]?this[s].enable():this[s].disable());this.onConfig(n),this._isUpdatingOptions=!1}else{var e={};for(var o in this.options)this.options.hasOwnProperty(o)&&(e[o]=this.options[o]);return this._isUpdatingOptions=!1,e}return this},t.onConfig=function(){},t._visitInitHooks=function(n){if(!this._initHooksCalled){var e=Object.getPrototypeOf(n);e._visitInitHooks&&e._visitInitHooks.call(this,e),this._initHooksCalled=!0;var o=n._initHooks;if(o&&o!==e._initHooks)for(var a=0;a<o.length;a++)o[a].call(this)}},r.addInitHook=function(n){for(var e=arguments.length,o=new Array(e>1?e-1:0),a=1;a<e;a++)o[a-1]=arguments[a];var s=typeof n=="function"?n:function(){this[n].apply(this,o)},l=this.prototype,h=Object.getPrototypeOf(l);return(!l._initHooks||l._initHooks===h._initHooks)&&(l._initHooks=[]),l._initHooks.push(s),this},r.include=function(){for(var n=0;n<arguments.length;n++)W(this.prototype,n<0||arguments.length<=n?void 0:arguments[n]);return this},r.mergeOptions=function(n){var e=this.prototype,o=Object.getPrototypeOf(e);return(!e.options||e.options===o.options)&&(e.options=e.options?Object.create(e.options):{}),W(e.options,n),this},r}(),Hn={},a_=function(r){return function(t){F(i,t);function i(){return t.apply(this,arguments)||this}i.registerJSONType=function(o){return o?Hn[o]?(console.error(o+" has register. please use Different name for:",this),this):(Hn[o]=this,this):this},i.getJSONClass=function(o){return o?Hn[o]:null};var n=i.prototype;return n.getJSONType=function(){if(this._jsonType===void 0){var o=Object.getPrototypeOf(this).constructor;for(var a in Hn)if(Hn[a]===o){this._jsonType=a;break}}if(!this._jsonType)throw new Error("Found an unregistered Layer/Geometry class!");return this._jsonType},i}(r)},Bn={},al=function(){function r(){this._tree=Ax(9,["[0]","[1]","[2]","[3]"])}var t=r.prototype;return t.collides=function(n){return Bn.minX=n[0],Bn.minY=n[1],Bn.maxX=n[2],Bn.maxY=n[3],this._tree.collides(Bn)},t.insertBox=function(n){var e=this._tree;return e.insert(n),this},t.bulkInsertBox=function(n){return this._tree.load(n),this},t.clear=function(){return this._tree.clear(),this},r}();function Xf(r){return function(t){F(i,t);function i(){return t.apply(this,arguments)||this}var n=i.prototype;return n.addHandler=function(o,a){if(!a)return this;if(this._handlers||(this._handlers=[]),this[o])return this[o].enable(),this;var s=this[o]=new a(this);return this._handlers.push(s),this.options[o]&&s.enable(),this},n.removeHandler=function(o){if(!o)return this;var a=this[o];if(a){var s=this._handlers.indexOf(a);s>=0&&this._handlers.splice(s,1),this[o].remove(),delete this[o]}return this},n._clearHandlers=function(){for(var o=0,a=this._handlers.length;o<a;o++)this._handlers[o].remove();this._handlers=[]},i}(r)}var ag="touchstart mousedown",Ca={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},th={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Wo=function(r){F(t,r);function t(n,e){var o;return e===void 0&&(e={}),o=r.call(this,null)||this,o.dom=n,o.options=e,o}var i=t.prototype;return i.enable=function(){return this.dom?(this._onMouseDown=function(e){return this.onMouseDown(e)},Pe(this.dom,ag,this._onMouseDown,this),this):this},i.disable=function(){return this.dom?(this._offEvents(),Re(this.dom,ag,this._onMouseDown),delete this._onMouseDown,this):this},i.onMouseDown=function(e){if(!(!this.options.rightclick&&e.button===2)&&!(e.touches&&e.touches.length>1)&&!(this.options.cancelOn&&this.options.cancelOn(e)===!0)){var o=this.dom;o.setCapture?o.setCapture():window.captureEvents&&window.captureEvents(window.Event.MOUSEMOVE|window.Event.MOUSEUP),o.ondragstart=function(){return!1},delete this.moved;var a=e.touches?e.touches[0]:e;this.startPos=new k(a.clientX,a.clientY),Re(document,Ca[e.type],this.onMouseMove),Re(document,th[e.type],this.onMouseUp),Pe(document,Ca[e.type],this.onMouseMove,this),Pe(document,th[e.type],this.onMouseUp,this),this.options.ignoreMouseleave||(Re(this.dom,"mouseleave",this.onMouseUp),Pe(this.dom,"mouseleave",this.onMouseUp,this)),this.fire("mousedown",{domEvent:e,mousePos:new k(a.clientX,a.clientY)})}},i.onMouseMove=function(e){if(e.touches&&e.touches.length>1){this.moved&&(this.interupted=!0,this.onMouseUp(e));return}var o=e.touches?e.touches[0]:e,a=new k(o.clientX,o.clientY),s=a.sub(this.startPos);!s.x&&!s.y||(this.moved?this.fire("dragging",{domEvent:e,mousePos:new k(o.clientX,o.clientY)}):(this.fire("dragstart",{domEvent:e,mousePos:this.startPos.copy()}),this.moved=!0))},i.onMouseUp=function(e){var o=e.changedTouches?e.changedTouches[0]:e;this._offEvents();var a={domEvent:e};V(o.clientX)&&(a.mousePos=new k(parseInt(o.clientX,0),parseInt(o.clientY,0))),this.moved&&(a.interupted=this.interupted,this.fire("dragend",a),delete this.interupted,delete this.moved),this.fire("mouseup",a)},i._offEvents=function(){var e=this.dom;if(Re(e,"mouseleave",this.onMouseUp),!(typeof document>"u"||typeof window>"u")){for(var o in Ca)Re(document,Ca[o],this.onMouseMove),Re(document,th[o],this.onMouseUp);e.releaseCapture?e.releaseCapture():window.captureEvents&&window.captureEvents(window.Event.MOUSEMOVE|window.Event.MOUSEUP)}},t}(Xt),z=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}return t.toNumberArrays=function(n){return Array.isArray(n)?_n(n,function(e){return[e.x,e.y]}):[n.x,n.y]},t.toCoordinates=function(n){if(V(n[0])&&V(n[1]))return new t(n);if(n instanceof t)return n;for(var e=[],o=0,a=n.length;o<a;o++){var s=n[o];Array.isArray(s)?V(s[0])?e.push(new t(s)):e.push(t.toCoordinates(s)):s instanceof t?e.push(s):e.push(new t(s))}return e},t}(Pm),rt=function(){function r(t,i){this.type=t,this.properties=i}return r.createProj4=function(i){return new r("proj4",{proj:i})},r.fromProjectionCode=function(i){return i?(i=i.toUpperCase().replace(":",""),r[i]||null):null},r}();rt.WGS84=rt.createProj4("+proj=longlat +datum=WGS84 +no_defs");rt.EPSG4326=rt.WGS84;rt.EPSG3857=rt.createProj4("+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs");rt.IDENTITY=rt.createProj4("+proj=identity +no_defs");rt.CGCS2000=rt.createProj4("+proj=longlat +datum=CGCS2000");rt.EPSG4490=rt.CGCS2000;rt.BD09LL=rt.createProj4("+proj=longlat +datum=BD09");rt.GCJ02=rt.createProj4("+proj=longlat +datum=GCJ02");var V1=new k(0,0),Z1=new z(0,0),rh=new z(0,0),ih=new z(0,0),nh=new z(0,0),oh=new z(0,0),U1=new z(0,0),sg=new z(0,0),lg=new z(0,0),ah=[],bi,Gn=[],ge=function(){function r(i,n,e,o){this._clazz=z;var a=arguments.length,s=a>0?arguments[a-1]:null;s&&s.unproject&&(this.projection=arguments[a-1]),this._dirty=!0,this._initialize(i,n,e,o)}var t=r.prototype;return t._initialize=function(n,e,o,a){if(this.xmin=null,this.xmax=null,this.ymin=null,this.ymax=null,!M(n)){var s=this.projection;if(V(n)&&V(e)&&V(o)&&V(a)){s?this.set(n,e,o,a):this.set(Math.min(n,o),Math.min(e,a),Math.max(n,o),Math.max(e,a));return}else Array.isArray(n)?s?this.set(n[0],n[1],n[2],n[3]):this.set(Math.min(n[0],n[2]),Math.min(n[1],n[3]),Math.max(n[0],n[2]),Math.max(n[1],n[3])):V(n.x)&&V(e.x)&&V(n.y)&&V(e.y)?s?this.set(n.x,n.y,e.x,e.y):(n.x>e.x?(this.xmin=e.x,this.xmax=n.x):(this.xmin=n.x,this.xmax=e.x),n.y>e.y?(this.ymin=e.y,this.ymax=n.y):(this.ymin=n.y,this.ymax=e.y)):V(n.xmin)&&V(n.xmax)&&V(n.ymin)&&V(n.ymax)&&this.set(n.xmin,n.ymin,n.xmax,n.ymax)}},t._add=function(n){return this._dirty=!0,M(n.x)?M(n.xmin)?M(n[0])||(this.xmin+=n[0],this.ymin+=n[1],this.xmax+=n[0],this.ymax+=n[1]):(this.xmin+=n.xmin,this.ymin+=n.ymin,this.xmax+=n.xmax,this.ymax+=n.ymax):(this.xmin+=n.x,this.ymin+=n.y,this.xmax+=n.x,this.ymax+=n.y),this},t.add=function(){var n=new this.constructor(this.xmin,this.ymin,this.xmax,this.ymax,this.projection);return n._add.apply(n,arguments)},t._scale=function(n){return this._dirty=!0,this.xmin*=n,this.ymin*=n,this.xmax*=n,this.ymax*=n,this},t._sub=function(n){return this._dirty=!0,M(n.x)?M(n.xmin)?M(n[0])||(this.xmin-=n[0],this.ymin-=n[1],this.xmax-=n[0],this.ymax-=n[1]):(this.xmin-=n.xmin,this.ymin-=n.ymin,this.xmax-=n.xmax,this.ymax-=n.ymax):(this.xmin-=n.x,this.ymin-=n.y,this.xmax-=n.x,this.ymax-=n.y),this},t._substract=function(){return this._sub.apply(this,arguments)},t.sub=function(){var n=new this.constructor(this.xmin,this.ymin,this.xmax,this.ymax,this.projection);return n._sub.apply(n,arguments)},t.substract=function(){return this.sub.apply(this,arguments)},t.round=function(){return new this.constructor(Math.round(this.xmin),Math.round(this.ymin),Math.round(this.xmax),Math.round(this.ymax),this.projection)},t._round=function(){return this._dirty=!0,this.xmin=Math.round(this.xmin),this.ymin=Math.round(this.ymin),this.xmax=Math.round(this.xmax),this.ymax=Math.round(this.ymax),this},t.getMin=function(n){return n?(n.set(this.xmin,this.ymin),n):new this._clazz(this.xmin,this.ymin)},t.getMax=function(n){return n?(n.set(this.xmax,this.ymax),n):new this._clazz(this.xmax,this.ymax)},t.getCenter=function(n){var e=(this.xmin+this.xmax)/2,o=(this.ymin+this.ymax)/2;return n?(n.set(e,o),n):new this._clazz(e,o)},t.isValid=function(){return!M(this.xmin)&&!M(this.ymin)&&!M(this.xmax)&&!M(this.ymax)},t.equals=function(n){return this.xmin===n.xmin&&this.xmax===n.xmax&&this.ymin===n.ymin&&this.ymax===n.ymax},t.intersects=function(n){this._project(this),this._project(n);var e=Math.max(this.pxmin,n.pxmin),o=Math.max(this.pymin,n.pymin),a=Math.min(this.pxmax,n.pxmax),s=Math.min(this.pymax,n.pymax),l=!(e>a||o>s);return l},t.within=function(n){return this._project(this),this._project(n),this.pxmin>=n.pxmin&&this.pxmax<=n.pxmax&&this.pymin>=n.pymin&&this.pymax<=n.pymax},t.contains=function(n){if(!n)return!1;this._project(this);var e=this.projection;if(e)if(n.x!==void 0){var o=Z1;Array.isArray(n)?(o.x=n[0],o.y=n[1]):(o.x=n.x,o.y=n.y),n=e.project(o,o)}else n.xmin!==void 0&&this._project(n);return(n.x||n.pxmin||0)>=this.pxmin&&(n.x||n.pxmax||0)<=this.pxmax&&(n.y||n.pymin||0)>=this.pymin&&(n.y||n.pymax||0)<=this.pymax},t.getWidth=function(){return Math.abs(this.xmax-this.xmin)},t.getHeight=function(){return Math.abs(this.ymax-this.ymin)},t.getSize=function(){return new Ae(this.getWidth(),this.getHeight())},t.set=function(n,e,o,a){return this.xmin=n,this.ymin=e,this.xmax=o,this.ymax=a,this._dirty=!0,this},t.__combine=function(n){n.x!==void 0&&(bi.xmin=bi.xmax=n.x,bi.ymin=bi.ymax=n.y,n=bi),this._project(n),this._project(this);var e=V(this.pxmin),o,a,s,l;e?(o=Math.min(this.pxmin,n.pxmin),a=Math.min(this.pymin,n.pymin),s=Math.max(this.pxmax,n.pxmax),l=Math.max(this.pymax,n.pymax)):(o=n.pxmin,a=n.pymin,s=n.pxmax,l=n.pymax);var h=this.projection;if(h){rh.set(o,a),ih.set(s,l);var u=h.unproject(rh,rh),f=h.unproject(ih,ih);o=u.x,a=u.y,s=f.x,l=f.y}return Gn[0]=o,Gn[1]=a,Gn[2]=s,Gn[3]=l,Gn},t._combine=function(n){if(!n||n.isValid&&!n.isValid())return this;var e=this.__combine(n);return this.set(e[0],e[1],e[2],e[3]),this._dirty=!0,this},t.combine=function(n){if(!n||n.isValid&&!n.isValid())return this;var e=this.__combine(n);return new this.constructor(e[0],e[1],e[2],e[3],this.projection)},t.intersection=function(n){if(!this.intersects(n))return null;nh.x=Math.max(this.pxmin,n.pxmin),nh.y=Math.max(this.pymin,n.pymin),oh.x=Math.min(this.pxmax,n.pxmax),oh.y=Math.min(this.pymax,n.pymax);var e=nh,o=oh,a=this.projection;return a&&(e=a.unproject(e,e),o=a.unproject(o,o)),new this.constructor(e,o,a)},t.expand=function(n){var e,o;return V(n)?e=o=n:(e=n.width||n.x||n[0]||0,o=n.height||n.y||n[1]||0),new this.constructor(this.xmin-e,this.ymin-o,this.xmax+e,this.ymax+o,this.projection)},t._expand=function(n){var e,o;return V(n)?e=o=n:(e=n.width||n.x||n[0]||0,o=n.height||n.y||n[1]||0),this.xmin-=e,this.ymin-=o,this.xmax+=e,this.ymax+=o,this._dirty=!0,this},t.toJSON=function(){return{xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax}},t.toArray=function(n){var e=this.xmin,o=this.ymin,a=this.xmax,s=this.ymax;return n?(n[0].x=e,n[0].y=s,n[1].x=a,n[1].y=s,n[2].x=a,n[2].y=o,n[3].x=e,n[3].y=o,n[4].x=e,n[4].y=s,n):[new this._clazz([e,s]),new this._clazz([a,s]),new this._clazz([a,o]),new this._clazz([e,o]),new this._clazz([e,s])]},t.toString=function(){return this.xmin+","+this.ymin+","+this.xmax+","+this.ymax},t.copy=function(){return new this.constructor(this.xmin,this.ymin,this.xmax,this.ymax,this.projection)},t.convertTo=function(n,e){if(!this.isValid())return null;var o=e||new this.constructor;e&&o.set(null,null,null,null);var a;return this._clazz===z?a=U1:this._clazz===k&&(a=V1),a.x=this.xmin,a.y=this.ymax,o._combine(n(a)),a.x=this.xmax,o._combine(n(a)),a.y=this.ymin,o._combine(n(a)),a.x=this.xmin,o._combine(n(a)),o},t._project=function(n){if(!n||!n.isValid()){n&&(n.pxmin=n.pxmax=n.pymin=n.pymax=null);return}var e=this.projection;if(e){if(n._dirty){sg.set(n.xmax,n.ymin),lg.set(n.xmin,n.ymax),ah[0]=sg,ah[1]=lg;var o=e.projectCoords(ah),a=o[0],s=o[1];n.pxmin=Math.min(a.x,s.x),n.pymin=Math.min(a.y,s.y),n.pxmax=Math.max(a.x,s.x),n.pymax=Math.max(a.y,s.y)}delete n._dirty}else n.pxmin=n.xmin,n.pxmax=n.xmax,n.pymin=n.ymin,n.pymax=n.ymax},r}();bi=new ge(0,0,0,0);var ee=function(r){F(t,r);function t(i,n,e,o){var a;return a=r.call(this,i,n,e,o)||this,a._clazz=k,a}return t}(ge),s_=function(){function r(i){this.matrix=i}var t=r.prototype;return t.transform=function(n,e,o){var a=this.matrix[0]*(n.x-this.matrix[2])/e,s=-this.matrix[1]*(n.y-this.matrix[3])/e;return o?(o.x=a,o.y=s,o):new k(a,s)},t.untransform=function(n,e,o){var a=n.x*e/this.matrix[0]+this.matrix[2],s=n.y*e/-this.matrix[1]+this.matrix[3];return o?(o.x=a,o.y=s,o):new z(a,s)},r}(),Sn={project:function(){},unproject:function(){},projectCoords:function(t,i){var n=this;if(!t)return[];if(!Array.isArray(t))return this.project(t);if(t.length===0)return[];if(!this.isSphere())return _n(t,this.project,this);if(Array.isArray(t[0]))return t.map(function(_){return n.projectCoords(_,i)});for(var e=i!==!1,o=this.getCircum(),a=this.getSphereExtent(),s=a.sx,l=a.sy,h,u,f=t[0],c,d,g,v,y=[this.project(f)],p=1,m=t.length;p<m;p++)c=t[p],d=c.x-f.x,g=c.y-f.y,v=this.project(c),Math.abs(d)>180&&e&&(h===void 0&&(h=c.x>f.x),h&&(v._add(-o.x*et(d)*s,0),c._add(-360*et(d),0))),Math.abs(g)>90&&e&&(u===void 0&&(u=c.y<f.y),u&&(v._add(0,-o.y*et(g)*l),c._add(0,-180*et(g)))),f=c,y.push(v);return y},unprojectCoords:function(t){return t?Array.isArray(t)?_n(t,this.unproject,this):this.unproject(t):[]},isSphere:function(){return!!this.sphere},isOutSphere:function(t){if(!this.isSphere())return!1;var i=this.getSphereExtent();return!i.contains(t)},wrapCoord:function(t){if(!this.isSphere())return t;var i=this.getSphereExtent(),n=new z(t);return i.contains(n)||(n.x=Jr(t.x,i.xmin,i.xmax),n.y=Jr(t.y,i.ymin,i.ymax)),n},getCircum:function(){if(!this.circum&&this.isSphere()){var t=this.getSphereExtent();this.circum={x:t.getWidth(),y:t.getHeight()}}return this.circum},getSphereExtent:function(){if(!this.extent&&this.isSphere()){var t=this.project(new z(180,90)),i=this.project(new z(-180,-90));this.extent=new ge(i,t,this),this.extent.sx=t.x>i.x?1:-1,this.extent.sy=t.y>i.y?1:-1}return this.extent}},Jf={measureLength:function(t,i){if(!Array.isArray(t))return this.measureLenBetween(t,i);for(var n=0,e=0,o=t.length;e<o-1;e++)n+=this.measureLenBetween(t[e],t[e+1]);return n}},l_=W({measure:"IDENTITY",measureLenBetween:function(t,i){if(!t||!i)return 0;try{return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))}catch{return 0}},measureArea:function(t){if(!Array.isArray(t))return 0;for(var i=0,n=0,e=t.length;n<e;n++){var o=t[n],a=null;n===e-1?a=t[0]:a=t[n+1],i+=o.x*a.y-o.y*a.x}return Math.abs(i/2)},locate:function(t,i,n,e){return e=e||new z(0,0),e.set(t.x,t.y),this._locate(e,i,n)},_locate:function(t,i,n){return t?(i||(i=0),n||(n=0),!i&&!n||(t.x=t.x+i,t.y=t.y+n),t):null},rotate:function(t,i,n){return t=new z(t.x,t.y),this._rotate(t,i,n)},_rotate:function(){var r=new k(0,0);return function(t,i,n){return r.x=t.x-i.x,r.y=t.y-i.y,r._rotate(n*Math.PI/180),t.x=i.x+r.x,t.y=i.y+r.y,t}}()},Jf),h_=function(){function r(i){this.radius=i}var t=r.prototype;return t.measureLenBetween=function(n,e){if(!n||!e)return 0;var o=De(n.y),a=De(e.y),s=o-a,l=De(n.x)-De(e.x);return o=2*Math.asin(Math.sqrt(Math.pow(Math.sin(s/2),2)+Math.cos(o)*Math.cos(a)*Math.pow(Math.sin(l/2),2))),o*=this.radius,o},t.measureArea=function(n){var e=De(this.radius),o=0,a=n,s=a.length;if(s<3)return 0;var l;for(l=0;l<s-1;l++){var h=a[l],u=a[l+1];o+=h.x*e*Math.cos(De(h.y))*u.y*e-u.x*e*Math.cos(De(u.y))*h.y*e}return s=a[l],a=a[0],o+=s.x*e*Math.cos(De(s.y))*a.y*e-a.x*e*Math.cos(De(a.y))*s.y*e,.5*Math.abs(o)},t.locate=function(n,e,o,a){return a=a||new z(0,0),a.set(n.x,n.y),this._locate(a,e,o)},t._locate=function(n,e,o){if(!n)return null;if(e||(e=0),o||(o=0),!e&&!o)return n;var a,s,l=De(n.y);if(o!==0){var h=Math.abs(o),u=Math.sin(h/(2*this.radius))*2;l=l+u*(o>0?1:-1),s=Jr(l*180/Math.PI,-90,90)}else s=n.y;if(e!==0){var f=Math.abs(e),c=De(n.x),d=2*Math.sqrt(Math.pow(Math.sin(f/(2*this.radius)),2)/Math.pow(Math.cos(l),2));c=c+d*(e>0?1:-1),a=Jr(c*180/Math.PI,-180,180)}else a=n.x;return n.x=a,n.y=s,n},t.rotate=function(n,e,o){return n=new z(n),this._rotate(n,e,o)},t._rotate=function(n,e,o){var a=$1(e,n),s=a-o,l=this.measureLenBetween(e,n);return n.x=e.x,n.y=e.y,X1(n,l,s,this.radius)},r}();function $1(r,t,i){i===void 0&&(i={});var n;i.final?n=hg(t,r):n=hg(r,t);var e=n>180?-(360-n):n;return e}function hg(r,t){var i=De(r.y),n=De(t.y),e=De(t.x-r.x);e>Math.PI&&(e-=2*Math.PI),e<-Math.PI&&(e+=2*Math.PI);var o=Math.log(Math.tan(n/2+Math.PI/4)/Math.tan(i/2+Math.PI/4)),a=Math.atan2(e,o);return(Cm(a)+360)%360}function X1(r,t,i,n){var e=t/n,o=r.x*Math.PI/180,a=De(r.y),s=De(i),l=e*Math.cos(s),h=a+l;Math.abs(h)>Math.PI/2&&(h=h>0?Math.PI-h:-Math.PI-h);var u=Math.log(Math.tan(h/2+Math.PI/4)/Math.tan(a/2+Math.PI/4)),f=Math.abs(u)>1e-11?l/u:Math.cos(a),c=e*Math.sin(s)/f,d=o+c;return r.x=(d*180/Math.PI+540)%360-180,r.y=h*180/Math.PI,r}var sl=W({measure:"EPSG:4326",sphere:new h_(6378137),measureLenBetween:function(){return this.sphere.measureLenBetween.apply(this.sphere,arguments)},measureArea:function(){return this.sphere.measureArea.apply(this.sphere,arguments)},_locate:function(){return this.sphere._locate.apply(this.sphere,arguments)},locate:function(){return this.sphere.locate.apply(this.sphere,arguments)},_rotate:function(){return this.sphere._rotate.apply(this.sphere,arguments)},rotate:function(){return this.sphere.rotate.apply(this.sphere,arguments)}},Jf),u_=W({measure:"BAIDU",sphere:new h_(637099681e-2),measureLenBetween:function(){return this.sphere.measureLenBetween.apply(this.sphere,arguments)},measureArea:function(){return this.sphere.measureArea.apply(this.sphere,arguments)},_locate:function(){return this.sphere._locate.apply(this.sphere,arguments)},locate:function(){return this.sphere.locate.apply(this.sphere,arguments)},_rotate:function(){return this.sphere._rotate.apply(this.sphere,arguments)},rotate:function(){return this.sphere.rotate.apply(this.sphere,arguments)}},Jf),J1=sl,no={};function Yf(r){no[r.measure]=r}Yf(l_);Yf(sl);Yf(u_);var sh={getInstance:function(t){if(!t)return J1;for(var i in no)if(Go(no,i)){var n=no[i].measure;if(!n)continue;if(t.toLowerCase()===n.toLowerCase())return no[i]}return null}},ug=1e-7,f_=W({},Sn,{code:"EPSG:3857",rad:Math.PI/180,metersPerDegree:6378137*Math.PI/180,maxLatitude:85.0511287798,project:function(t,i){var n=this.rad,e=this.metersPerDegree,o=this.maxLatitude,a=t.x,s=Math.max(Math.min(o,t.y),-o),l;s===0?l=0:l=Math.log(Math.tan((90+s)*n/2))/n;var h=a*e,u=l*e;return i?(i.x=h,i.y=u,i):new z(h,u)},unproject:function(t,i){var n=this.rad,e=this.metersPerDegree,o=t.x/e,a=t.y,s;a===0?s=0:(s=a/e,s=(2*Math.atan(Math.exp(s*n))-Math.PI/2)/n),Math.abs(Math.abs(o)-180)<ug&&(o=et(o)*180),Math.abs(Math.abs(s)-this.maxLatitude)<ug&&(s=et(s)*this.maxLatitude);var l=Jr(o,-180,180),h=Jr(s,-this.maxLatitude,this.maxLatitude);return i?(i.x=l,i.y=h,i):new z(l,h)}},sl),c_=W({},Sn,{code:"EPSG:4326",project:function(t,i){return i?(i.x=t.x,i.y=t.y,i):new z(t)},unproject:function(t,i){return i?(i.x=t.x,i.y=t.y,i):new z(t)}},sl),Y1=W({},c_,{code:"EPSG:4490"}),Q1=W({},Sn,{code:"BAIDU",project:function(t,i){return this.convertLL2MC(t,i)},unproject:function(t,i){return this.convertMC2LL(t,i)}},u_,{EARTHRADIUS:637099681e-2,MCBAND:[1289059486e-2,836237787e-2,5591021,348198983e-2,167804312e-2,0],LLBAND:[75,60,45,30,15,0],MC2LL:[[1410526172116255e-23,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,173379812e-1],[-7435856389565537e-24,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,1026014486e-2],[-3030883460898826e-23,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,685681737e-2],[-1981981304930552e-23,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,448277706e-2],[309191371068437e-23,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,25551644e-1],[2890871144776878e-24,8983055095805407e-21,-3068298e-14,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],LL2MC:[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,6477955746671607e-7,-4082003173641316e-6,1077490566351142e-5,-1517187553151559e-5,1205306533862167e-5,-5124939663577472e-6,9133119359512032e-7,67.5],[.00337398766765,111320.7020202162,4481351045890365e-9,-2339375119931662e-8,7968221547186455e-8,-1159649932797253e-7,9723671115602145e-8,-4366194633752821e-8,8477230501135234e-9,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837749470245e-9,992013.7397791013,-122195221711287e-8,1340652697009075e-9,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758690035394e-9,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],convertMC2LL:function(t,i){for(var n,e=0,o=this.MCBAND.length;e<o;e++)if(Math.abs(t.y)>=this.MCBAND[e]){n=this.MC2LL[e];break}var a=this.convertor(t,n,i);return a},convertLL2MC:function(t,i){var n,e,o;t.x=this.getLoop(t.x,-180,180),t.y=this.getRange(t.y,-74,74);var a=new z(t.x,t.y);for(e=0,o=this.LLBAND.length;e<o;e++)if(a.y>=this.LLBAND[e]){n=this.LL2MC[e];break}if(!n){for(e=this.LLBAND.length-1;e>=0;e--)if(a.y<=-this.LLBAND[e]){n=this.LL2MC[e];break}}var s=this.convertor(t,n,i);return s},convertor:function(t,i,n){if(!t||!i)return null;var e=i[0]+i[1]*Math.abs(t.x),o=Math.abs(t.y)/i[9],a=i[2]+i[3]*o+i[4]*o*o+i[5]*o*o*o+i[6]*o*o*o*o+i[7]*o*o*o*o*o+i[8]*o*o*o*o*o*o;return e*=t.x<0?-1:1,a*=t.y<0?-1:1,n?(n.x=e,n.y=a,n):new z(e,a)},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},getRange:function(t,i,n){return i!=null&&(t=Math.max(t,i)),n!=null&&(t=Math.min(t,n)),t},getLoop:function(t,i,n){if(t===1/0)return n;if(t===-1/0)return i;for(;t>n;)t-=n-i;for(;t<i;)t+=n-i;return t}}),q1=W({},Sn,{code:"IDENTITY",project:function(t,i){return i?(i.x=t.x,i.y=t.y,i):t.copy()},unproject:function(t,i){return i?(i.x=t.x,i.y=t.y,i):t.copy()}},l_),d_=f_,Pa=Object.freeze({EPSG3857:f_,DEFAULT:d_,EPSG4326:c_,EPSG4490:Y1,BAIDU:Q1,IDENTITY:q1,Common:Sn}),g_=function(r){return function(t){F(i,t);function i(){return t.apply(this,arguments)||this}return i.registerRenderer=function(e,o){var a=this.prototype,s=Object.getPrototypeOf(a);return(!a._rendererClasses||a._rendererClasses===s._rendererClasses)&&(a._rendererClasses=a._rendererClasses?Object.create(a._rendererClasses):{}),a._rendererClasses[e.toLowerCase()]=o,this},i.getRendererClass=function(e){var o=this.prototype;return o._rendererClasses?o._rendererClasses[e.toLowerCase()]:null},i}(r)},Qf="core-fetch-image",v_;function K1(r){v_=r}function eC(){return v_}var p_=!1;function tC(){p_=!0}function rC(){return p_}var m_=[];function __(r){return m_.indexOf(r)>-1}function y_(r){__(r)||m_.push(r)}var ui={};function iC(r,t){ui[r]=t}var nC=`
    var adapters = {};
    // Dynamic Create Adapter
    function createAdapter(key,code){
        if(adapters[key]||!code){
            return;
        }
        var func=new Function('exports',code+'(exports)');
        var workerExports={};
        func(workerExports,self);
        adapters[key]=workerExports;
        workerExports.initialize && workerExports.initialize(self);
        
    }
    onmessage = function (msg) {
        msg = msg.data;
        //createAdapter
        if (msg.messageType === 'createAdapter') {
           var key=msg.key;
           var code=msg.code;
           createAdapter(key,code);
           postMessage({adapterName:key});
           return;
        }
        if (msg.messageType === 'batch') {
            const messages = msg.messages;
            if (messages) {
                for (let i = 0; i < messages.length; i++) {
                    dispatch(messages[i]);
                }
            }
        } else {
            dispatch(msg);
        }
    };

    function dispatch(msg) {
        var workerKey = msg.workerKey;
        var adapter = adapters[workerKey];
        if (!adapter) {
            post(msg.callback, 'Unregistered worker adapters for ' + workerKey);
            return;
        }
        try {
            adapter.onmessage(msg, wrap(msg.callback));
        } catch (err) {
            post(msg.callback, workerKey + ':' + err.message);
            console.error(err);
            throw err;
        }
    }

    function post(callback, err, data, buffers) {
        var msg = {
            callback : callback
        };
        if (err) {
            msg.error = err;
        } else {
            msg.data = data;
        }
        if (buffers && buffers.length > 0) {
            postMessage(msg, buffers);
        } else {
            postMessage(msg);
        }
    }
    function wrap(callback) {
        return function (err, data, buffers) {
            post(callback, err, data, buffers);
        };
    }
    var workerExports;
`,oC=`
    workerExports = null;
`;function aC(){var r=nC;for(var t in ui){var i=ui[t];y_(t),oe(i)&&i.length===0&&(i=i()),r+=`
    workerExports = {};
    (`+i+`)(workerExports, self);
    adapters['`+t+"'] = workerExports",r+=`
    workerExports.initialize && workerExports.initialize(self);
        `}return r+=oC,r}var lh;function sC(){if(typeof window>"u")return null;if(!lh){var r=aC();lh=window.URL.createObjectURL(new Blob([r],{type:"text/javascript"})),ui={}}return lh}function lC(r,t){if(!ui[r]){console.error("not find "+r+" adapter");return}var i=ui[r];oe(i)&&i.length===0&&(i=i()),i="("+i+")";var n=eC();if(n){var e=n.workers||[];e.length===0&&console.error("workerpool workers count is 0");var o=0,a=function s(l){l=l.data||{},l.adapterName===r&&(o++,o===e.length&&(e.forEach(function(h){h.removeEventListener("message",s)}),delete ui[r],t()))};e.forEach(function(s){s.addEventListener("message",a),s.postMessage({key:r,code:i,messageType:"createAdapter"})})}}var hC=typeof window<"u"?window.navigator.hardwareConcurrency||4:0,uC=Math.max(Math.floor(hC/2),1),fg=function(){function r(i){i===void 0&&(i=50),this._limit=i,this._messages=[],this.buffers=[]}var t=r.prototype;return t.addMessage=function(n,e){if(this._messages.push(n),!!Array.isArray(e))for(var o=0;o<e.length;o++)this.buffers.indexOf(e[o])<0&&this.buffers.push(e[o])},t.isFull=function(){return this._messages.length>=this._limit},t.getMessage=function(){return{messageType:"batch",messages:this._messages}},r}(),fC=function(){function r(){this.active={},this.workerCount=typeof window<"u"?window.MAPTALKS_WORKER_COUNT||uC:0,this._messages=[],this._messageBuffers=[]}var t=r.prototype;return t.acquire=function(n){if(!this.workers){this.workers=[];for(var e=sC(),o=0;o<this.workerCount;o++){var a=new Worker(e);a.id=o,this.workers.push(a)}URL.revokeObjectURL(e),tC()}return this.active[n]=!0,this.workers.slice()},t.release=function(n){delete this.active[n],Object.keys(this.active).length===0&&(this.workers.forEach(function(e){e.terminate()}),this.workers=null)},t.addMessage=function(n,e,o){var a=this._messages[n];(!a||!a.length)&&(a=this._messages[n]=[new fg]);var s=a[a.length-1];s.isFull()&&(s=new fg,this._messages[n].push(s)),s.addMessage(e,o)},t.commit=function(){if(this.workers&&this._messages.length){for(var n=0;n<this._messages.length;n++)if(!(!this._messages[n]||!this._messages[n].length)){var e=this._messages[n].shift();this.workers[n].postMessage(e.getMessage(),e.buffers)}}},r}(),Ta;function w_(){return Ta||(Ta=new fC,K1(Ta)),Ta}function x_(){w_().commit(),_r(x_)}_r&&_r(x_);var hh=0,cg=[],C_=function(){function r(i){var n=this;this._delayMessages=[],this.initializing=!1;var e=__(i);rC()&&!e&&(this.initializing=!0,console.log("Injecting codes in worker with worker key: :"+i),lC(i,function(){n.initializing=!1,n.created()})),this.workerKey=i,this.workerPool=w_(),this.currentActor=0,this.actorId=Tn(),this.workers=this.workerPool.acquire(this.actorId),this.callbacks={},this.callbackID=0,this.receiveFn=this.receive.bind(this),this.workers.forEach(function(o){o.addEventListener("message",n.receiveFn,!1)}),y_(i)}var t=r.prototype;return t.created=function(){var n=this;this._delayMessages.forEach(function(e){var o=e.command,a=e.data,s=e.buffers,l=e.cb,h=e.workerId;n[o](a,s,l,h)}),this._delayMessages=[]},t.isActive=function(){return!!this.workers},t.broadcast=function(n,e,o){var a=this;return this.initializing?(this._delayMessages.push({command:"broadcast",data:n,buffers:e,cb:o}),this):(o=o||function(){},cC(this.workers,function(s,l){a.send(n,e,l,s.id)},o),this)},t.send=function(n,e,o,a){if(this.initializing)return this._delayMessages.push({command:"send",data:n,buffers:e,cb:o,workerId:a}),this;var s=o?this.actorId+":"+this.callbackID++:null;return o&&(this.callbacks[s]=o),this.post({data:n,callback:String(s)},e,a),this},t.receive=function(n){var e=this,o=n.data,a=o.callback,s=this.callbacks[a];delete this.callbacks[a],o.type==="<request>"?this.actorId===o.actorId&&this[o.command](o.params,function(l,h,u){var f={type:"<response>",callback:o.callback};l?f.error=l.message:f.data=h,e.post(f,u||cg,o.workerId)}):s&&o.error?s(o.error):s&&s(null,o.data)},t.remove=function(){var n=this;this.workers.forEach(function(e){e.removeEventListener("message",n.receiveFn,!1)}),delete this.receiveFn,delete this.workers,delete this.callbacks,delete this.workerPool},t.post=function(n,e,o){return(typeof o!="number"||isNaN(o))&&(o=this.currentActor=(this.currentActor+1)%this.workerPool.workerCount),n.workerId=o,n.workerKey=this.workerKey,n.actorId=this.actorId,this.workerPool.addMessage(o,n,e||cg),o},t.getDedicatedWorker=function(){return hh=(hh+1)%this.workerPool.workerCount,hh},r}();function cC(r,t,i){r.length||i(null,[]);var n=r.length,e=new Array(r.length),o=null;r.forEach(function(a,s){t(a,function(l,h){l&&(o=l),e[s]=h,--n===0&&i(o,e)})})}var dC=[],gC=function(r){F(t,r);function t(){return r.call(this,Qf)||this}var i=t.prototype;return i.fetchImage=function(e,o){var a={url:e};this.send(a,dC,o)},t}(C_),Vo=function(r){F(t,r);function t(n){var e;return e=r.call(this)||this,e.layer=n,e._painted=!1,e._drawTime=0,K.decodeImageInWorker&&!K.safari&&!K.iosWeixin&&(e._resWorkerConn=new gC),e.setToRedraw(),e}var i=t.prototype;return i.render=function(e){this.prepareRender(),!(!this.getMap()||!this.layer.isVisible())&&(this.resources||(this.resources=new wn),this.checkAndDraw(this._tryToDraw,e))},i.checkAndDraw=function(e){var o=this;this._toRedraw=!1;for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];if(this.checkResources){var h=this.checkResources();h.length>0?(this._loadingResource=!0,this.loadResources(h).then(function(){if(o._loadingResource=!1,o.layer){o.layer.fire("resourceload");var u=o.layer.getMap();o.setToRedraw(),u.getRenderer().callInNextFrame(function(){o.setToRedraw()})}})):e.call.apply(e,[this].concat(s))}else e.call.apply(e,[this].concat(s))},i.testIfNeedRedraw=function(){var e=this.getMap();return this._loadingResource?!1:this._toRedraw?!0:e.isInteracting()&&!this.drawOnInteracting?!1:!!this.needToRedraw()},i.needToRedraw=function(){var e=this.getMap();return e.isInteracting()||e.getRenderer().isViewChanged()?!(!e.getPitch()&&e.isMoving()&&!e.isZooming()&&!e.isRotating()&&!this.layer.options.forceRenderOnMoving):!1},i.onSkipDrawOnInteracting=function(){},i.isLoadingResource=function(){return this._loadingResource},i.isRenderComplete=function(){return!!this._renderComplete},i.mustRenderOnInteracting=function(){return!this._painted},i.setToRedraw=function(){return this._toRedraw=!0,this},i.setCanvasUpdated=function(){return this._canvasUpdated=!0,this},i.isCanvasUpdated=function(){return!!this._canvasUpdated},i.remove=function(){this.onRemove(),delete this._loadingResource,delete this.southWest,delete this.canvas,delete this.context,delete this.canvasExtent2D,delete this._extent2D,this.resources&&this.resources.remove(),delete this.resources,this._resWorkerConn&&(this._resWorkerConn.remove(),delete this._resWorkerConn),delete this.layer},i.onRemove=function(){},i.onAdd=function(){},i.getMap=function(){return this.layer?this.layer.getMap():null},i.getCanvasImage=function(){var e=this.getMap();if(this._canvasUpdated=!1,this._renderZoom!==e.getZoom()||!this.canvas||!this._extent2D||this.isBlank()||this.layer.isEmpty&&this.layer.isEmpty())return null;var o=e._pointToContainerPoint(this.southWest)._add(0,-e.height);return{image:this.canvas,layer:this.layer,point:o}},i.clear=function(){this.clearCanvas()},i.isBlank=function(){return!this._painted},i.show=function(){this.setToRedraw()},i.hide=function(){this.clear(),this.setToRedraw()},i.setZIndex=function(){this.setToRedraw()},i.hitDetect=function(e){if(!this.context||this.layer.isEmpty&&this.layer.isEmpty()||this.isBlank()||this._errorThrown||this.layer.isVisible&&!this.layer.isVisible())return!1;var o=this.getMap(),a=o.getDevicePixelRatio(),s=o.getSize();if(e.x<0||e.x>s.width*a||e.y<0||e.y>s.height*a)return!1;var l=this.getImageData&&this.getImageData();if(l){var h=Math.round(a*e.x),u=Math.round(a*e.y),f=u*l.width*4+h*4;return l.data[f+3]>0}try{var c=this.context.getImageData(a*e.x,a*e.y,1,1).data;if(c[3]>0)return!0}catch(d){return this._errorThrown||(console&&console.warn(`hit detect failed with tainted canvas, some geometries have external resources in another domain:
`,d),this._errorThrown=!0),!1}return!1},i.loadResources=function(e){this.resources||(this.resources=new wn);var o=this.resources,a=[];if(he(e))for(var s={},l=e.length-1;l>=0;l--){var h=e[l];!h||!h.length||s[h.join("-")]||(s[h.join("-")]=1,o.isResourceLoaded(h,!0)||a.push(new og(this._promiseResource(h))))}return og.all(a)},i.prepareRender=function(){delete this._renderComplete;var e=this.getMap();this._renderZoom=e.getZoom(),this.canvasExtent2D=this._extent2D=e._get2DExtent(),this.southWest=e._containerPointToPoint(new k(0,e.height))},i.createCanvas=function(){if(!this.canvas){var e=this.getMap(),o=e.getSize(),a=e.getDevicePixelRatio(),s=Math.round(a*o.width),l=Math.round(a*o.height);if(this.layer._canvas){var h=this.layer._canvas;h.width=s,h.height=l,h.style&&(h.style.width=o.width+"px",h.style.height=o.height+"px"),this.canvas=this.layer._canvas}else this.canvas=j.createCanvas(s,l,e.CanvasClass);this.onCanvasCreate()}},i.onCanvasCreate=function(){},i.createContext=function(){if(!(this.gl&&this.gl.canvas===this.canvas||this.context)&&(this.context=j.getCanvas2DContext(this.canvas),!!this.context)){this.layer.options.globalCompositeOperation&&(this.context.globalCompositeOperation=this.layer.options.globalCompositeOperation);var e=this.getMap().getDevicePixelRatio();e!==1&&this.context.scale(e,e)}},i.resetCanvasTransform=function(){if(this.context){var e=this.getMap().getDevicePixelRatio();this.context.setTransform(e,0,0,e,0,0)}},i.resizeCanvas=function(e){var o=this.canvas;if(o){var a=e||this.getMap().getSize(),s=this.getMap().getDevicePixelRatio(),l=Am(a,s),h=l.width,u=l.height,f=l.cssWidth,c=l.cssHeight;this.layer._canvas&&(o.style.width!==f||o.style.height!==c)&&(o.style.width=f,o.style.height=c),!(o.width===h&&o.height===u)&&(o.height=u,o.width=h,s!==1&&this.context&&this.context.scale(s,s))}},i.clearCanvas=function(){if(!(!this.context||!this.getMap())){var e=this.getMap().getDevicePixelRatio(),o=1/e,a=this.canvas.width*o,s=this.canvas.height*o;j.clearRect(this.context,0,0,Math.max(a,this.canvas.width),Math.max(s,this.canvas.height))}},i.prepareCanvas=function(){this.canvas?(this.resetCanvasTransform(),this.clearCanvas(),this.resizeCanvas()):(this.createCanvas(),this.createContext(),this.layer.onCanvasCreate(),this.layer.fire("canvascreate",{context:this.context,gl:this.gl})),delete this._maskExtent;var e=this.layer.getMask();if(!e)return this.layer.fire("renderstart",{context:this.context,gl:this.gl}),null;var o=this._maskExtent=e._getMaskPainter().get2DExtent();return o.intersects(this._extent2D)?(this.layer.fire("renderstart",{context:this.context,gl:this.gl}),o):(this.layer.fire("renderstart",{context:this.context,gl:this.gl}),o)},i.clipCanvas=function(e){var o=this.layer.getMask();if(!o)return!1;var a=this.southWest,s=this.getMap();this.southWest=s._containerPointToPoint(new k(0,s.height)),e.save();var l=s.getDevicePixelRatio();if(l!==1&&(e.save(),e.scale(l,l)),o.getGeometries){e.isMultiClip=!0;var h=o.getGeometries()||[];e.beginPath(),h.forEach(function(f){var c=f._getMaskPainter();c.paint(null,e)}),e.stroke(),e.isMultiClip=!1}else{e.isClip=!0,e.beginPath();var u=o._getMaskPainter();u.paint(null,e),e.isClip=!1}return l!==1&&e.restore(),e.clip(),this.southWest=a,!0},i.getViewExtent=function(){return{extent:this._extent2D,maskExtent:this._maskExtent,zoom:this._renderZoom,southWest:this.southWest}},i.completeRender=function(){this.getMap()&&(this._renderComplete=!0,this.layer.fire("renderend",{context:this.context,gl:this.gl}),this.setCanvasUpdated())},i.getEvents=function(){return{_zoomstart:this.onZoomStart,_zooming:this.onZooming,_zoomend:this.onZoomEnd,_resize:this.onResize,_movestart:this.onMoveStart,_moving:this.onMoving,_moveend:this.onMoveEnd,_dragrotatestart:this.onDragRotateStart,_dragrotating:this.onDragRotating,_dragrotateend:this.onDragRotateEnd,_spatialreferencechange:this.onSpatialReferenceChange}},i.onZoomStart=function(){},i.onZoomEnd=function(){this.setToRedraw()},i.onZooming=function(){},i.onMoveStart=function(){},i.onMoving=function(){},i.onMoveEnd=function(){this.setToRedraw()},i.onResize=function(){delete this._extent2D,this.resizeCanvas(),this.setToRedraw()},i.onDragRotateStart=function(){},i.onDragRotating=function(){},i.onDragRotateEnd=function(){this.setToRedraw()},i.onSpatialReferenceChange=function(){},i.getDrawTime=function(){return this._drawTime},i._tryToDraw=function(e){if(this._toRedraw=!1,!this.canvas&&this.layer.isEmpty&&this.layer.isEmpty()){this._renderComplete=!0;return}this._drawAndRecord(e)},i._drawAndRecord=function(e){if(this.getMap()){var o=this._painted;this._painted=!0;var a=ve();this.draw(e),a=ve()-a,this._drawTime=o?a:a/2,o&&this.layer&&this.layer.options.logDrawTime&&console.log(this.layer.getId(),"frameTimeStamp:",e,"drawTime:",this._drawTime)}},i._promiseResource=function(e){var o=this.layer,a=this,s=this.resources,l=o.options.crossOrigin,h=o.options.renderer||"";return function(u){if(s.isResourceLoaded(e,!0)){u(e);return}var f=!tn(e[0])&&a._resWorkerConn&&(o.options.renderer!=="canvas"||o.options.decodeImageInWorker);if(f){var c=Rm(e[0]);a._resWorkerConn.fetchImage(c,function(g,v){if(g){g&&typeof console<"u"&&console.warn(g),u(e);return}km(v,function(y){a._cacheResource(e,y),u(e)})})}else{var d=new Image;M(l)?h!=="canvas"&&(d.crossOrigin=""):d.crossOrigin=l,tn(e[0])&&!Fe&&(e[1]&&(e[1]*=2),e[2]&&(e[2]*=2)),d.onload=function(){a._cacheResource(e,d),u(e)},d.onabort=function(g){console&&console.warn("image loading aborted: "+e[0]),g&&console&&console.warn(g),u(e)},d.onerror=function(g){g&&typeof console<"u"&&console.warn(g),s.markErrorResource(e),u(e)},Ps(d,e)}}},i._cacheResource=function(e,o){if(!(!this.layer||!this.resources)){var a=e[1],s=e[2];if(this.layer.options.cacheSvgOnCanvas&&tn(e[0])===1&&(K.edge||K.ie)){M(a)&&(a=o.width||this.layer.options.defaultIconSize[0]),M(s)&&(s=o.height||this.layer.options.defaultIconSize[1]);var l=j.createCanvas(a,s);j.image(l.getContext("2d"),o,0,0,a,s),o=l}this.resources.addResource(e,o)}},t}(zt),wn=function(){function r(){this.resources={},this._errors={}}var t=r.prototype;return t.addResource=function(n,e){var o=this;if(this.resources[n[0]]={image:e,width:+n[1],height:+n[2],refCnt:0},e&&e.width&&e.height&&!e.close&&K.imageBitMap&&!K.safari&&!K.iosWeixin){if(e.src&&tn(e.src))return;createImageBitmap(e).then(function(a){o.resources[n[0]]&&(o.resources[n[0]].image=a)})}},t.isResourceLoaded=function(n,e){if(!n)return!1;var o=this._getImgUrl(n);if(this._errors[o])return!0;var a=this.resources[o];return!(!a||e&&tn(n[0])&&(+n[1]>a.width||+n[2]>a.height))},t.login=function(n){var e=this.resources[n];e&&e.refCnt++},t.logout=function(n){var e=this.resources[n];e&&e.refCnt--<=0&&(e.image&&e.image.close&&e.image.close(),delete this.resources[n])},t.getImage=function(n){var e=this._getImgUrl(n);return!this.isResourceLoaded(n)||this._errors[e]?null:this.resources[e].image},t.markErrorResource=function(n){this._errors[this._getImgUrl(n)]=1},t.merge=function(n){if(!n)return this;for(var e in n.resources){var o=n.resources[e];this.addResource([e,o.width,o.height],o.image)}return this},t.forEach=function(n){if(!this.resources)return this;for(var e in this.resources)Go(this.resources,e)&&n(e,this.resources[e]);return this},t._getImgUrl=function(n){return Array.isArray(n)?n[0]:n},t.remove=function(){for(var n in this.resources){var e=this.resources[n];e&&e.image&&e.image.close&&e.image.close()}this.resources={}},r}(),vC=`
function (exports) {
    exports.onmessage = function (msg, postResponse) {
        var url = msg.data.url;
        var fetchOptions = msg.data.fetchOptions;
        requestImageOffscreen(url, function (err, data) {
            var buffers = [];
            if (data && data.data) {
                buffers.push(data.data);
            }
            postResponse(err, data, buffers);
        }, fetchOptions);
    };

    function requestImageOffscreen(url, cb, fetchOptions) {
        fetch(url, fetchOptions ? fetchOptions : {})
            .then(response => response.arrayBuffer())
            .then(arrayBuffer => {
                const blob=new Blob([arrayBuffer]);
                return createImageBitmap(blob);
            })
            .then(bitmap => {
                cb(null, {data:bitmap});
            }).catch(err => {
                console.warn('error when loading tile:', url);
                console.warn(err);
                cb(err);
            });
    }
}`;function pC(){K.decodeImageInWorker&&iC(Qf,function(){return vC})}pC();var on={markerWidth:10,markerHeight:10,markerLineWidth:1},uh=new k(0,0);function mC(r){if(!r)return 0;var t=r.x,i=r.y;if(t===0&&i===0)return 0;if(t===0||!t){if(i<0)return-Math.PI/2;if(i>0)return Math.PI/2}var n=i/t;return i<0&&t<0?Math.atan(n)-Math.PI:i>0&&t<0?Math.atan(n)+Math.PI:Math.atan(n)}function _C(r,t,i){var n=Math.PI/2+i,e=Math.PI/4+i,o=i,a=t,s=Math.sqrt(r*r+t*t),l=r,h=0,u=0,f=Math.cos(n)*a,c=Math.sin(n)*a,d=Math.cos(e)*s,g=Math.sin(e)*s,v=Math.cos(o)*l,y=Math.sin(o)*l,p=Math.min(f,d,v,h),m=Math.min(c,g,y,u),_=Math.max(f,d,v,h),w=Math.max(c,g,y,u);return[p,m,_-p,w-m]}function qf(r,t,i,n,e,o){var a=e.x+o.x,s=e.y+o.y;uh.x=a,uh.y=s;var l=mC(uh),h=Math.sqrt(a*a+s*s),u=Math.cos(t+l)*h,f=Math.sin(t+l)*h,c=0,d=0;c+=u,d+=f;var g=_C(i,n,t),v=g[0],y=g[1],p=g[2],m=g[3];c+=v,d+=y;var _=c+Math.max(i,p),w=d+Math.max(n,m);return r.set(c,d,_,w),r}function P_(){return .5}var yC=new k(0,0);function Kf(r,t,i,n,e,o,a){var s=yC.set(t,i);if(n)return qf(r,n,o,a,s,e);var l=r.set(s.x,s.y,s.x+o,s.y+a);return l._add(e),n&&xC(l,n),l}var wC=[];function T_(r,t,i){i=i||k_(wC,t);var n=E_(t,i[0],i[1]);return Kf(r,t.markerDx||0,t.markerDy||0,ll(t),n,i[0],i[1])}function S_(r){return r==="rectangle"?"right":"middle"}function M_(r){return r==="bar"||r==="pie"||r==="pin"?"top":r==="rectangle"?"bottom":"middle"}var an=new Ae(0,0);function E_(r,t,i){var n=P_(),e=2*(r.shadowBlur||0),o=e+n;an.width=t,an.height=i;var a=r.markerType,s=mi(an,r.markerHorizontalAlignment||S_(a),r.markerVerticalAlignment||M_(a));return s.x!==-t/2&&(s.x-=et(s.x+t/2)*o),s.y!==-i/2&&(s.y-=et(s.y+i/2)*o),s}function k_(r,t){var i=P_(),n=U(t.markerWidth,on.markerWidth),e=U(t.markerHeight,on.markerHeight),o=U(t.markerLineWidth,on.markerLineWidth),a=2*((t.shadowBlur||0)+Math.max(Math.abs(t.shadowOffsetX||0)+Math.abs(t.shadowOffsetY||0))),s=Math.round(n+o+a+i*2),l=Math.round(e+o+a+i*2);return r[0]=s,r[1]=l,r}var dg=new ee;function xC(r,t){var i=r.xmin,n=r.ymin,e=r.xmax,o=r.ymax;return dg.set(i,n,e,o),dg.convertTo(function(a){return a._rotate(t)},r)}function ll(r,t){t===void 0&&(t="markerRotation");var i=r[t];return V(i)?-i*Math.PI/180:0}function Iu(r,t,i){var n=t.markerFile,e=i?i.getImage(n):null,o=t.markerWidth||(e?e.width:0),a=t.markerHeight||(e?e.height:0);an.width=o,an.height=a;var s=mi(an,t.markerHorizontalAlignment||"middle",t.markerVerticalAlignment||"top");return Kf(r,t.markerDx||0,t.markerDy||0,ll(t),s,o,a)}function R_(r,t,i){var n=i.size,e=mi(n,t.textHorizontalAlignment,t.textVerticalAlignment);if(t.textHaloRadius){var o=t.textHaloRadius;n=n.add(o*2,o*2)}return Kf(r,t.textDx||0,t.textDy||0,ll(t,"textRotation"),e,n.width,n.height)}var Sa=new ee;function zu(r,t,i,n){var e=r||new ee;if(Array.isArray(t)){for(var o=t,a=0;a<o.length;a++)zu(e,o[a],i,n[a]);return e}return Rs(t)&&e._combine(R_(Sa,t,n)),ec(t)&&e._combine(Iu(Sa,t,i)),As(t)&&e._combine(T_(Sa,t)),tc(t)&&e._combine(Iu(Sa,t)),e}function Rs(r){return r?!M(r.textName):!1}function ec(r){return r?!M(r.markerFile):!1}function As(r){return r?!!(M(r.markerFile)&&!M(r.markerType)&&r.markerType!=="path"):!1}function tc(r){return r?!!(M(r.markerFile)&&r.markerType==="path"):!1}var fh=["markerWidth","markerHeight","markerHorizontalAlignment","markerVerticalAlignment","markerDx","markerDy","markerRotation","textName","textSize","textDx","textDy","textVerticalAlignment","textHorizontalAlignment","textRotation"],ch=["textName","markerType","markerFile","textHaloRadius","shadowBlur","shadowOffsetX","shadowOffsetY","textWrapWidth"];function Xa(r,t,i,n){for(var e=[],o=0,a,s=0,l=r.length;s<l-1;s++)a=CC(r[s],r[s+1],t,s,i,n),a&&(e[o]=e[o]||[],e[o].push({point:a[0],index:s}),(a[1]!==r[s+1]||s===l-2)&&(e[o].push({point:a[1],index:s+1}),o++));return e}var gg;function CC(r,t,i,n,e,o){var a=n?gg:sn(r,i),s=sn(t,i),l,h,u;for(gg=s;;){if(!(a|s))return[r,t];if(a&s)return!1;if(o)return[r,t];l=a||s,h=ju(r,t,l,i,e),u=sn(h,i),l===a?(r=h,a=u):(t=h,s=u)}}function Ja(r,t,i){var n=[1,4,2,8],e,o,a,s,l,h,u,f,c;for(o=0,u=r.length;o<u;o++)r[o]._code=sn(r[o],t);for(s=0;s<4;s++){for(f=n[s],e=[],o=0,u=r.length,a=u-1;o<u;a=o++)l=r[o],h=r[a],l._code&f?h._code&f||(c=ju(h,l,f,t,i),c._code=sn(c,t),e.push(c)):(h._code&f&&(c=ju(h,l,f,t,i),c._code=sn(c,t),e.push(c)),e.push(l));r=e}return r}function ju(r,t,i,n,e){var o=t.x-r.x,a=t.y-r.y,s=n.getMin(),l=n.getMax(),h,u;i&8?(h=r.x+o*(l.y-r.y)/a,u=l.y):i&4?(h=r.x+o*(s.y-r.y)/a,u=s.y):i&2?(h=l.x,u=r.y+a*(l.x-r.x)/o):i&1&&(h=s.x,u=r.y+a*(s.x-r.x)/o);var f=new k(h,u);return e&&f._round(),f}function sn(r,t){var i=0;return r.x<t.getMin().x?i|=1:r.x>t.getMax().x&&(i|=2),r.y<t.getMin().y?i|=4:r.y>t.getMax().y&&(i|=8),i}function A_(r,t,i,n){r=new k(r);var e=Math.abs(i.x-t.x),o=Math.abs(i.y-t.y),a=Math.sqrt(Math.abs(e*e-o*o)),s=e>=o,l,h,u;return s?(l=new k(t.x-a,t.y),h=new k(t.x+a,t.y),u=e*2):(l=new k(t.x,t.y-a),h=new k(t.x,t.y+a),u=o*2),r.distanceTo(l)+r.distanceTo(h)<=u+2*n}var PC=function(){function r(){this.bbox=nl()}var t=r.prototype;return t._setBBOX=function(n,e,o,a,s){return n.isHitTesting||ol(this.bbox,e,o,a,s),this},t._bufferBBOX=function(n,e){return e===void 0&&(e=0),n.isHitTesting||F1(this.bbox,e),this},t.getMap=function(){return this.geometry.getMap()},t.getPainter=function(){return this.painter},t.isDynamicSize=function(){return!1},r.testColor=function(n){return!n||!ie(n)?!1:Fx.indexOf(n)>=0},r}(),O_=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i._prepareContext=function(e){if(de(this.symbol.opacity)?this._opacityFn||(this._opacityFn=Ss(this.symbol.opacity)):delete this._opacityFn,V(this.symbol.opacity))e.globalAlpha!==this.symbol.opacity&&(e.globalAlpha=this.symbol.opacity);else if(this._opacityFn){var o=this.getMap();e.globalAlpha=this._opacityFn(o.getZoom())}else e.globalAlpha!==1&&(e.globalAlpha=1)},i.prepareCanvas=function(e,o,a){e.setLineDash&&he(o.lineDasharray)&&e.setLineDash(o.lineDasharray);var s=this.getPainter().isHitTesting();j.prepareCanvas(e,o,a,s)},i.remove=function(){},i.setZIndex=function(){},i.show=function(){},i.hide=function(){},i._defineStyle=function(e){return Ms(e,this.geometry)},t}(PC);function TC(r,t){var i=r&&r.getImage(t);return i||null}function L_(r,t,i,n){var e=D_(i),o=i,a=o.markerType.toLowerCase(),s=b_(a,o.markerWidth,o.markerHeight),l=e.lineOpacity,h=e.polygonOpacity,u=Yr(e.polygonFill);if(u){var f;Yr(e.polygonFill)&&(f||(f=SC(t,o.markerWidth,o.markerHeight)),e.polygonGradientExtent=f)}j.prepareCanvas(r,e,n);var c=o.markerWidth,d=o.markerHeight,g=o.markerLineWidth/2;if(a==="ellipse")j.ellipse(r,t,c/2,d/2,d/2,l,h);else if(a==="cross"||a==="x"){for(var v=s.length-1;v>=0;v--)s[v]._add(t);j.path(r,s.slice(0,2),l),j.path(r,s.slice(2,4),l)}else if(a==="diamond"||a==="bar"||a==="square"||a==="rectangle"||a==="triangle"){a==="bar"?t=t.add(0,-g):a==="rectangle"&&(t=t.add(g,g));for(var y=s.length-1;y>=0;y--)s[y]._add(t);j.polygon(r,s,l,h)}else if(a==="pin"){t=t.add(0,-g);for(var p=s.length-1;p>=0;p--)s[p]._add(t);var m=r.lineCap;r.lineCap="round",j.bezierCurveAndFill(r,s,l,h),r.lineCap=m}else if(a==="pie"){t=t.add(0,-g);var _=Math.atan(c/2/d)*180/Math.PI,w=r.lineCap;r.lineCap="round",j.sector(r,t,d,[90-_,90+_],l,h),r.lineCap=w}else throw new Error("unsupported markerType: "+a);return r.canvas}function SC(r,t,i){var n=new ee;return n._combine(r),n.xmin+=-t/2,n.ymin+=-i/2,n.xmax+=t/2,n.ymax+=i/2,n}function D_(r){var t={lineColor:r.markerLineColor,linePatternFile:r.markerLinePatternFile,lineWidth:r.markerLineWidth,lineOpacity:r.markerLineOpacity,lineDasharray:r.markerLineDasharray,lineCap:"butt",lineJoin:"round",polygonFill:r.markerFill,polygonPatternFile:r.markerFillPatternFile,polygonOpacity:r.markerFillOpacity};return t.lineWidth===0&&(t.lineOpacity=0),t}function b_(r,t,i){var n=i/2,e=t/2,o=0,a=0,s,l,h,u;if(r==="triangle")return s=new k(o,a-n),l=new k(o-e,a+n),h=new k(o+e,a+n),[s,l,h];if(r==="cross")return s=new k(o-e,a),l=new k(o+e,a),h=new k(o,a-n),u=new k(o,a+n),[s,l,h,u];if(r==="diamond")return s=new k(o-e,a),l=new k(o,a-n),h=new k(o+e,a),u=new k(o,a+n),[s,l,h,u];if(r==="square")return s=new k(o-e,a+n),l=new k(o+e,a+n),h=new k(o+e,a-n),u=new k(o-e,a-n),[s,l,h,u];if(r==="rectangle")return s=new k(o,a),l=s.add(t,0),h=s.add(t,i),u=s.add(0,i),[s,l,h,u];if(r==="x")return s=new k(o-e,a+n),l=new k(o+e,a-n),h=new k(o+e,a+n),u=new k(o-e,a-n),[s,l,h,u];if(r==="bar")return s=new k(o-e,a-i),l=new k(o+e,a-i),h=new k(o+e,a),u=new k(o-e,a),[s,l,h,u];if(r==="pin"||r==="pie"){var f=i*Math.atan(e/n);return s=new k(o,a),l=new k(o-f,a-i),h=new k(o+f,a-i),u=new k(o,a),[s,l,h,u]}return[]}var MC=new k(0,0),EC=new k(0,0),kC=new k(0,0),RC=new k(0,0),Mn=function(r){F(t,r);function t(n,e,o){var a;return a=r.call(this)||this,a.symbol=n,a.geometry=e,a.painter=o,a}var i=t.prototype;return i.get2DExtent=function(){for(var e=this.getMap(),o=e.getGLRes(),a=new ee,s=this._getRenderPoints()[0],l=s.length-1;l>=0;l--)s[l]&&a._combine(e._pointAtResToPoint(s[l],o));return a},i.isDynamicSize=function(){var e=this.symbol;return de(e.markerWidth)||de(e.markerHeight)||de(e.textSize)},i._rotateExtent=function(e,o){return e.convertTo(function(a){return a._rotate(o)})},i._getRenderPoints=function(){var e=this.getPainter(),o=e.isSpriting()?"center":this.getPlacement();return this.getPainter().getRenderPoints(o)},i._getRenderContainerPoints=function(e){var o=this.getPainter();if(o.isSpriting())return this._getRenderPoints()[0];var a=this.geometry,s=this.getDxDy(),l;if(a._cPoint&&!e){var h=e?kC:RC;h.set(a._cPoint.x,a._cPoint.y);var u=o.containerOffset;h._sub(u);var f=s.x,c=s.y;(f||c)&&h._add(f||0,c||0),l=[h]}else{var d=this._getRenderPoints()[0];l=this.painter._pointContainerPoints(d,s.x,s.y,e,!0,this.getPlacement())}if(!l||!Array.isArray(l[0]))return l;for(var g=[],v=0,y=l.length;v<y;v++)for(var p=0,m=l[v].length;p<m;p++)g.push(l[v][p]);return g},i.getPlacement=function(){return this.symbol.markerPlacement},i.getRotation=function(){return ll(this.style)},i.getDxDy=function(){var e=this.style,o=e.markerDx,a=e.markerDy;return new k(o,a)},i._getRotationAt=function(e){var o=this.getRotation();o||(o=0);var a=this._getRenderPoints()[1];if(!a||!a[e])return o;var s=this.getMap(),l=a[e][0],h=a[e][1];if(s.isTransforming()){var u=s.getGLRes();return l=s._pointAtResToContainerPoint(a[e][0],u,0,MC),h=s._pointAtResToContainerPoint(a[e][1],u,0,EC),o+Su(l.x,l.y,h.x,h.y)}else return o+-Su(l.x,l.y,h.x,h.y)},i._rotate=function(e,o,a){if(a){var s=this.getDxDy(),l=o.sub(s);return e.save(),e.translate(l.x,l.y),e.rotate(a),s}return null},t}(O_),AC=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.getPlacement=function(){return"point"},i.getDxDy=function(){return new k(0,0)},i.symbolize=function(e){var o=this.geometry,a=o.getLayer();if(!(!o.options.debug&&a&&!a.options.debug)){var s=this.getMap();if(!(!s||s.isZooming())){var l=a.options.debugOutline,h=1;e.strokeStyle=l,e.fillStyle=l;var u=o.getContainerExtent().toArray();j.polygon(e,[u],h,0);for(var f=this._getRenderContainerPoints(),c=this.geometry.getId(),d=b_("cross",10,10),g=0;g<f.length;g++){var v=f[g];M(c)||j.fillText(e,c,v.add(8,-4),l);for(var y=[],p=0;p<d.length;p++)y.push(d[p].add(v));j.path(e,y.slice(0,2),h),j.path(e,y.slice(2,4),h)}}}},t}(Mn),dh=new Ae(1,1),OC=new ee,rc=function(r){F(t,r),t.test=function(e){return ec(e)};function t(n,e,o){var a;return a=r.call(this,n,e,o)||this,a.style=a._defineStyle(a.translate()),a}var i=t.prototype;return i.symbolize=function(e,o){var a=this.style;if(!(!this.painter.isHitTesting()&&(a.markerWidth===0||a.markerHeight===0||a.markerOpacity===0))){var s=this._getRenderContainerPoints();if(he(s)){var l=this._getImage(o);if(!l){typeof console<"u"&&console.warn("no img found for "+(this.style.markerFile||this._url[0]));return}this._prepareContext(e);var h=a.markerWidth,u=a.markerHeight;if(!V(h)||!V(u)){h=l.width,u=l.height,a.markerWidth=h,a.markerHeight=u;var f=a.markerFile;o.isResourceLoaded(f)||o.addResource(f,l);var c=this.getPainter();c.isSpriting()||c.removeCache()}var d;this.symbol.markerType!=="path"&&V(a.markerOpacity)&&a.markerOpacity<1&&(d=e.globalAlpha,e.globalAlpha*=a.markerOpacity),dh.width=h,dh.height=u;for(var g=mi(dh,a.markerHorizontalAlignment,a.markerVerticalAlignment),v=0,y=s.length;v<y;v++){var p=s[v],m=this.getRotation()?this._rotate(e,p,this._getRotationAt(v)):null,_=void 0;if(m){var w=p.sub(m);p=m;var C=this._getRotationAt(v);_=qf(OC,C,h,u,p,g),_._add(w)}var x=p.x+g.x,T=p.y+g.y;j.image(e,l,x,T,h,u),m&&e.restore(),m?this._setBBOX(e,_.xmin,_.ymin,_.xmax,_.ymax):this._setBBOX(e,x,T,x+h,T+u)}d!==void 0&&(e.globalAlpha=d)}}},i._getImage=function(e){return TC(e,this.style.markerFile)},i.getFixedExtent=function(e){return this._fixedExtent=this._fixedExtent||new ee,Iu(this._fixedExtent,this.style,e)},i.translate=function(){var e=this.symbol;return{markerFile:e.markerFile,markerOpacity:U(e.markerOpacity,1),markerWidth:U(e.markerWidth,null),markerHeight:U(e.markerHeight,null),markerRotation:U(e.markerRotation,0),markerDx:U(e.markerDx,0),markerDy:U(e.markerDy,0),markerHorizontalAlignment:U(e.markerHorizontalAlignment,"middle"),markerVerticalAlignment:U(e.markerVerticalAlignment,"top")}},t}(Mn),LC=new z(0,0),DC=new z(0,0),I_=function(r){F(t,r),t.test=function(e,o){if(!e||o&&o.type==="Point")return!1;for(var a in e){var s=a.slice(0,4);if(s==="line"||s==="poly")return!0}return!1};function t(n,e,o){var a;return a=r.call(this)||this,a.symbol=n,a.geometry=e,a.painter=o,e.type==="Point"?Ie(a):(a.style=a._defineStyle(a.translate()),a)}var i=t.prototype;return i.symbolize=function(e,o){var a=this.style;if(!(a.polygonOpacity===0&&a.lineOpacity===0&&!this.painter.isHitTesting())){var s=this._getPaintParams();if(s){this._prepareContext(e);var l=Yr(a.lineColor),h=this.geometry.getJSONType()==="Polygon"||this.geometry.type==="LineString";l&&(a.lineColor.places||!h)&&(a.lineGradientExtent=this.geometry.getContainerExtent()._expand(a.lineWidth)),Yr(a.polygonFill)&&(a.polygonGradientExtent=this.geometry.getContainerExtent());var u=this.geometry.getLayer().options.geometryEventTolerance||0,f=this.geometry._hitTestTolerance()+u,c=s[0],d=this.geometry.getJSONType()==="Polygon"&&c.length>0&&Array.isArray(c[0][0])||this.geometry.type==="LineString"&&c.length>0&&Array.isArray(c[0]);if(d)for(var g=0;g<c.length;g++){this.prepareCanvas(e,a,o),l&&h&&!a.lineColor.places&&this._createGradient(e,c[g],a.lineColor);var v=[e,c[g]];s.length>1&&v.push.apply(v,s.slice(1)),v.push(a.lineOpacity,a.polygonOpacity,a.lineDasharray);var y=this.geometry._paintOn.apply(this.geometry,v);this._setBBOX(e,y),this._bufferBBOX(e,f)}else{this.prepareCanvas(e,a,o),l&&h&&!a.lineColor.places&&this._createGradient(e,c,a.lineColor);var p=[e];p.push.apply(p,s),p.push(a.lineOpacity,a.polygonOpacity,a.lineDasharray);var m=this.geometry._paintOn.apply(this.geometry,p);this._setBBOX(e,m),this._bufferBBOX(e,f)}e.setLineDash&&Array.isArray(a.lineDasharray)&&e.setLineDash([])}}},i.get2DExtent=function(){var e=this.getMap(),o=this.geometry._getPrjExtent();if(!o)return null;(!this._extMin||!this._extMax)&&(this._extMin=new z(0,0),this._extMax=new z(0,0)),this._extMin.x=o.xmin,this._extMin.y=o.ymin,this._extMax.x=o.xmax,this._extMax.y=o.ymax;var a=e._prjToPoint(this._extMin,void 0,LC),s=e._prjToPoint(this._extMax,void 0,DC);return this._pxExtent?this._pxExtent.set(Math.min(a.x,s.x),Math.min(a.y,s.y),Math.max(a.x,s.x),Math.max(a.y,s.y)):this._pxExtent=new ee(a,s),this._pxExtent},i.getFixedExtent=function(){var e=this.style.lineWidth/2;return new ee(-e,-e,e,e)},i._getPaintParams=function(){return this.getPainter().getPaintParams(this.style.lineDx,this.style.lineDy)},i.translate=function(){var e=this.symbol,o={lineColor:U(e.lineColor,"#000"),lineWidth:U(e.lineWidth,2),lineOpacity:U(e.lineOpacity,1),lineDasharray:U(e.lineDasharray,[]),lineCap:U(e.lineCap,"butt"),lineJoin:U(e.lineJoin,"miter"),linePatternFile:U(e.linePatternFile,null),lineDx:U(e.lineDx,0),lineDy:U(e.lineDy,0),polygonFill:U(e.polygonFill,null),polygonOpacity:U(e.polygonOpacity,1),polygonPatternFile:U(e.polygonPatternFile,null),polygonPatternDx:U(e.polygonPatternDx,0),polygonPatternDy:U(e.polygonPatternDy,0),linePatternDx:U(e.linePatternDx,0),linePatternDy:U(e.linePatternDy,0)};return o.lineWidth===0&&(o.lineOpacity=0),this.geometry.type==="LineString"&&!o.polygonFill&&(o.polygonFill=o.lineColor),o},i._createGradient=function(e,o,a){if(!(!Array.isArray(o)||!o.length)){var s=o.length,l=e.createLinearGradient(o[0].x,o[0].y,o[s-1].x,o[s-1].y);a.colorStops.forEach(function(h){l.addColorStop.apply(l,h)}),e.strokeStyle=l}},t}(O_),bC=function(r){F(t,r),t.test=function(e){return Rs(e)};function t(n,e,o){var a;a=r.call(this,n,e,o)||this;var s=a.translate();return a._dynamic=bm(s),a.style=a._defineStyle(s),a.style.textWrapWidth===0?Ie(a):(a.strokeAndFill=a._defineStyle(a.translateLineAndFill(a.style)),a)}var i=t.prototype;return i.symbolize=function(e,o){if(!(!this.painter.isHitTesting()&&(this.style.textSize===0||!this.style.textOpacity&&(!this.style.textHaloRadius||!this.style.textHaloOpacity)||this.style.textWrapWidth===0))){var a=this._getRenderContainerPoints();if(he(a)){var s=this.style,l=this.strokeAndFill,h=Au(this.style.textName,this.geometry.getProperties());this._dynamic&&delete this._textDesc;var u=this._textDesc=this._textDesc||Ou(h,this.style);this._prepareContext(e),this.prepareCanvas(e,l,o),j.prepareCanvasFont(e,s);for(var f=0,c=a.length;f<c;f++){var d=a[f],g=this.getRotation()?this._rotate(e,d,this._getRotationAt(f)):null;g&&(d=g);var v=j.text(e,h,d,s,u);this._setBBOX(e,v),g&&e.restore()}}}},i.getPlacement=function(){return this.symbol.textPlacement},i.getRotation=function(){var e=this.style.textRotation;return V(e)?-e*Math.PI/180:null},i.getDxDy=function(){var e=this.style;return new k(e.textDx,e.textDy)},i.getFixedExtent=function(){var e=this.geometry.getTextDesc();return Array.isArray(e)&&(e=e[this._index]),this._fixedExtent=this._fixedExtent||new ee,e?R_(this._fixedExtent,this.style,e):this._fixedExtent},i.translate=function(){var e=this.symbol,o={textName:e.textName,textFaceName:U(e.textFaceName,"monospace"),textWeight:U(e.textWeight,"normal"),textStyle:U(e.textStyle,"normal"),textSize:U(e.textSize,wm),textFont:U(e.textFont,null),textFill:U(e.textFill,"#000"),textOpacity:U(e.textOpacity,1),textHaloFill:U(e.textHaloFill,"#ffffff"),textHaloRadius:U(e.textHaloRadius,0),textHaloOpacity:U(e.textHaloOpacity,1),textWrapWidth:U(e.textWrapWidth,null),textWrapCharacter:U(e.textWrapCharacter,`
`),textLineSpacing:U(e.textLineSpacing,0),textDx:U(e.textDx,0),textDy:U(e.textDy,0),textHorizontalAlignment:U(e.textHorizontalAlignment,"middle"),textVerticalAlignment:U(e.textVerticalAlignment,"middle"),textAlign:U(e.textAlign,"center"),textRotation:U(e.textRotation,0),textMaxWidth:U(e.textMaxWidth,0),textMaxHeight:U(e.textMaxHeight,0)};return o.textMaxWidth>0&&(!o.textWrapWidth||o.textWrapWidth>o.textMaxWidth)&&(o.textWrapWidth||(o.textMaxHeight=1),o.textWrapWidth=o.textMaxWidth),o},i.translateLineAndFill=function(e){return{lineColor:e.textHaloRadius?e.textHaloFill:e.textFill,lineWidth:e.textHaloRadius,lineOpacity:e.textOpacity,lineDasharray:null,lineCap:"butt",lineJoin:"round",polygonFill:e.textFill,polygonOpacity:e.textOpacity}},t}(Mn),IC=[],zC=new ee,z_=function(r){F(t,r),t.test=function(e){return As(e)};function t(n,e,o){var a;a=r.call(this,n,e,o)||this;var s=a.translate();return a._dynamic=bm(s),a.style=a._defineStyle(s),a.strokeAndFill=a._defineStyle(D_(a.style)),a.padding=0,a}var i=t.prototype;return i.symbolize=function(e,o){var a=this.style;if(!(!this.painter.isHitTesting()&&(a.markerWidth===0||a.markerHeight===0||a.polygonOpacity===0&&a.lineOpacity===0))){var s=this._getRenderContainerPoints();he(s)&&(this._prepareContext(e),this.getPainter().isSpriting()||this.geometry.getLayer().getMask()===this.geometry||this._dynamic||this.geometry.getLayer().options.cacheVectorOnCanvas===!1?this._drawMarkers(e,s,o):this._drawMarkersWithCache(e,s,o))}},i._drawMarkers=function(e,o,a){for(var s=o.length-1;s>=0;s--){var l=o[s],h=this.getRotation()?this._rotate(e,l,this._getRotationAt(s)):null;h&&(l=h),this._drawVectorMarker(e,l,a),h&&e.restore()}},i._drawMarkersWithCache=function(e,o,a){var s=this._stampSymbol(),l=a.getImage(s);l||(l=this._createMarkerImage(e,a),a.addResource([s,l.width,l.height],l));for(var h=E_(this.style,l.width,l.height),u=o.length-1;u>=0;u--){var f=o[u],c=this.getRotation()?this._rotate(e,f,this._getRotationAt(u)):null,d=void 0;if(c){var g=f.sub(c);f=c;var v=this._getRotationAt(u);d=qf(zC,v,l.width,l.height,f,h),d._add(g)}var y=f.x+h.x,p=f.y+h.y;j.image(e,l,y,p),c?(e.restore(),this._setBBOX(e,d.xmin,d.ymin,d.xmax,d.ymax)):this._setBBOX(e,y,p,y+l.width,p+l.height)}},i._createMarkerImage=function(e,o){var a=e.canvas.constructor,s=k_(IC,this.style),l=j.createCanvas(s[0],s[1],a),h=this._getCacheImageAnchor(s[0],s[1]),u=l.getContext("2d");return this._drawVectorMarker(u,h,o),l},i._stampSymbol=function(){return this._stamp||(this._stamp=Vm([this.style.markerType,Yr(this.style.markerFill)?qd(this.style.markerFill):this.style.markerFill,this.style.markerFillOpacity,this.style.markerFillPatternFile,Yr(this.style.markerLineColor)?qd(this.style.markerLineColor):this.style.markerLineColor,this.style.markerLineWidth,this.style.markerLineOpacity,this.style.markerLineDasharray?this.style.markerLineDasharray.join(","):"",this.style.markerLinePatternFile,this.style.markerWidth,this.style.markerHeight,this.style.markerHorizontalAlignment,this.style.markerVerticalAlignment].join("_"))),this._stamp},i._getCacheImageAnchor=function(e,o){var a=2*(this.symbol.shadowBlur||0),s=a+this.padding,l=this.style.markerType;return l==="bar"||l==="pie"||l==="pin"?new k(e/2,o-s):l==="rectangle"?new k(s,s):new k(e/2,o/2)},i._getGraidentExtent=function(e){var o=new ee,a=this.getDxDy(),s=this.getFixedExtent();if(Array.isArray(e))for(var l=e.length-1;l>=0;l--)o._combine(e[l]);else o._combine(e);return o.xmin+=s.xmin-a.x,o.ymin+=s.ymin-a.y,o.xmax+=s.xmax-a.x,o.ymax+=s.ymax-a.y,o},i._drawVectorMarker=function(e,o,a){L_(e,o,this.style,a)},i.getFixedExtent=function(){var e=this.isDynamicSize(),o=this.style.markerWidth,a=this.style.markerHeight;return this._fixedExtent=this._fixedExtent||new ee,T_(this._fixedExtent,this.style,e?[128,128*(o===0?1:a/o)]:null)},i.translate=function(){var e=this.symbol,o={markerType:U(e.markerType,"ellipse"),markerFill:U(e.markerFill,"#00f"),markerFillOpacity:U(e.markerFillOpacity,1),markerFillPatternFile:U(e.markerFillPatternFile,null),markerLineColor:U(e.markerLineColor,"#000"),markerLineWidth:U(e.markerLineWidth,on.markerLineWidth),markerLineOpacity:U(e.markerLineOpacity,1),markerLineDasharray:U(e.markerLineDasharray,[]),markerLinePatternFile:U(e.markerLinePatternFile,null),markerDx:U(e.markerDx,0),markerDy:U(e.markerDy,0),markerWidth:U(e.markerWidth,on.markerWidth),markerHeight:U(e.markerHeight,on.markerHeight),markerRotation:U(e.markerRotation,0),shadowBlur:U(e.shadowBlur,0),shadowOffsetX:U(e.shadowOffsetX,0),shadowOffsetY:U(e.shadowOffsetY,0)},a=o.markerType,s=S_(a),l=M_(a);return o.markerHorizontalAlignment=U(e.markerHorizontalAlignment,s),o.markerVerticalAlignment=U(e.markerVerticalAlignment,l),V(e.markerOpacity)&&(V(e.markerFillOpacity)&&(o.markerFillOpacity*=e.markerOpacity),V(e.markerLineOpacity)&&(o.markerLineOpacity*=e.markerOpacity)),o},t}(Mn),j_=function(r){F(t,r),t.test=function(e){return tc(e)};function t(n,e,o){var a;M(n.markerWidth)&&(n.markerWidth=80),M(n.markerHeight)&&(n.markerHeight=80),a=r.call(this,n,e,o)||this,n=W(n,a.translate());var s=a.style=a._defineStyle(n);return K.gecko?a._url=[Es(s,s.markerWidth,s.markerHeight),s.markerWidth,s.markerHeight]:a._url=[Es(s),s.markerWidth,s.markerHeight],a}var i=t.prototype;return i._prepareContext=function(){},i._getImage=function(e){var o=this;if(e&&e.isResourceLoaded(this._url))return e.getImage(this._url);var a=this.painter,s=new Image;return s.onload=function(){var l=a.getLayer()&&a.getLayer().getRenderer();l&&l.setToRedraw()},s.onerror=function(l){l&&typeof console<"u"&&console.warn(l),e.markErrorResource(o._url)},s.src=this._url[0],e&&e.addResource(this._url,s),s},t}(rc),jC={lineWidth:1,polygonFill:"#fff",polygonOpacity:.5},NC=function(r){F(t,r),t.test=function(e,o){var a=o.getLayer();if(!a)return!1;var s=o.getJSONType();return s==="Marker"||s==="LineString"};function t(n,e,o){var a;return a=r.call(this,n,e,o)||this,a.style=e.getLayer().options.drawAltitude,(!a.style||!Zt(a.style))&&(a.style={lineWidth:2}),a.style.lineWidth||(a.style.lineWidth=0),a.dxdy=a._defineStyle({dx:n.textDx||n.markerDx,dy:n.textDy||n.markerDy}),a}var i=t.prototype;return i.symbolize=function(e){var o=this.geometry.getLayer();if(o.options.drawAltitude){var a=this.geometry.getProperties();if(!(!a||!a[o.options.altitudeProperty])){var s=this._getStyle();if(this._prepareContext(e),this.geometry.type==="LineString"){var l=this._getPaintParams(s.lineDx,s.lineDy,!1,!0);if(!l)return;var h=this.getPainter().getPaintParams(s.lineDx,s.lineDy,!0,!0,"_groundpt")[0];this._drawLineAltitude(e,l[0],h)}else{var u=this._getRenderContainerPoints(),f=this._getRenderContainerPoints(!0);if(!u||u.length===0)return;this._drawMarkerAltitude(e,u[0],f[0])}}}},i.getDxDy=function(){var e=this.dxdy;return new k(e.dx||0,e.dy||0)},i.get2DExtent=function(){return this.geometry.type==="LineString"?I_.prototype.get2DExtent.apply(this):r.prototype.get2DExtent.call(this)},i.getPlacement=function(){return"point"},i._getPaintParams=function(e,o){return this.getPainter().getPaintParams(e||0,o||0,null,!0,"_altpt")},i._drawMarkerAltitude=function(e,o,a){var s=this._getStyle();this.prepareCanvas(e,s),j.path(e,[o,a],s.lineOpacity,null,s.lineDasharray)},i._drawLineAltitude=function(e,o,a){var s=this._getStyle(),l=o.length>0&&Array.isArray(o[0]);if(l)for(var h=0;h<o.length;h++)this._drawLine(e,o[h],a[h]);else this._drawLine(e,o,a);e.setLineDash&&Array.isArray(s.lineDasharray)&&e.setLineDash([])},i._drawLine=function(e,o,a){var s=this._getStyle();this.prepareCanvas(e,s);for(var l=0,h=o.length-1;l<h;l++)j.polygon(e,[o[l],o[l+1],a[l+1],a[l]],s.lineOpacity,s.polygonOpacity,s.lineDasharray)},i._getStyle=function(){var e=this.geometry.getLayer().options.drawAltitude;return Zt(e)||(e=jC),e.lineWidth||(e.lineWidth=0,e.lineOpacity=0),e},t}(Mn),FC=[NC,I_,rc,j_,z_,bC],ti,vg=new k(0,0),HC=new ee,Ma=new ee,St=new ee,BC=new ee,Sr=new ee,GC={},Wn={minx:1/0,miny:1/0,maxx:-1/0,maxy:-1/0},ic=function(r){F(t,r);function t(n){var e;return e=r.call(this)||this,e.geometry=n,e.symbolizers=e._createSymbolizers(),e._altAtGL=e._getGeometryAltitude(),e.bbox=nl(),e._drawTime=0,e}var i=t.prototype;return i._setDrawTime=function(e){return this._drawTime=e,this},i.getRenderBBOX=function(){var e=this.getLayer();if(e&&e._drawTime!==this._drawTime)return null;Io(this.bbox);for(var o=this.symbolizers.length-1;o>=0;o--){var a=this.symbolizers[o],s=a.bbox;ks(s)&&ol(this.bbox,s)}return ks(this.bbox)?this.bbox:null},i.getMap=function(){return this.geometry.getMap()},i.getLayer=function(){return this.geometry&&this.geometry.getLayer()},i._createSymbolizers=function(){var e=this.getSymbol(),o=[],a=FC,s=e;Array.isArray(e)||(s=[e]);for(var l=s.length-1;l>=0;l--)for(var h=s[l],u=a.length-1;u>=0;u--)if(a[u].test(h,this.geometry)){var f=new a[u](h,this.geometry,this);f._index=l,o.push(f),f instanceof Mn&&(this._hasPoint=!0)}if(!o.length&&console){var c=this.geometry.getId();console.warn("invalid symbol for geometry("+(this.geometry?this.geometry.getType()+(c?":"+c:""):"")+") to draw : "+JSON.stringify(e))}return this._debugSymbolizer=new AC(e,this.geometry,this),o},i.hasPoint=function(){return!!this._hasPoint},i.getRenderPoints=function(e){return this._verifyProjection(),this._renderPoints||(this._renderPoints={}),e||(e="center"),this._renderPoints[e]||(this._renderPoints[e]=this.geometry._getRenderPoints(e)),this._renderPoints[e]},i.getPaintParams=function(e,o,a,s,l){l===void 0&&(l="_pt");var h=this.getLayer()._getRenderer(),u=h.mapStateCache,f,c,d,g,v,y=this.getMap();u&&!this._hitPoint?(f=u.resolution,c=u.pitch,d=u.bearing,g=u.glScale,v=u.containerExtent):(f=y.getResolution(),c=y.getPitch(),d=y.getBearing(),g=y.getGLScale(),v=y.getContainerExtent());var p=this.geometry,m=f,_=c!==0,w=d!==0,C=this._cachedParams,x=p._paintAsPath&&p._paintAsPath();if(x&&this._unsimpledParams&&m<=this._unsimpledParams._res)C=this._unsimpledParams;else if(!C||C._res!==f||this._pitched!==_&&p._redrawWhenPitch()||this._rotated!==w&&p._redrawWhenRotate()){if(C=p._getPaintParams(),!C)return null;C._res=m,!p._simplified&&x&&(this._unsimpledParams||(this._unsimpledParams=C),m>this._unsimpledParams._res&&(this._unsimpledParams._res=m)),this._cachedParams=C}if(!C)return null;this._pitched=_,this._rotated=w;var T=g,P=[],S=C[0],E=v,D=this._pointContainerPoints(S,e,o,a,s||this._hitPoint&&!E.contains(this._hitPoint),null,l);if(!D)return null;P.push(D);for(var A=1,I=C.length;A<I;A++)V(C[A])||C[A]instanceof Ae?V(C[A])?P.push(C[A]/T):P.push(C[A].multi(1/T)):P.push(C[A]);return P},i._pointContainerPoints=function(e,o,a,s,l,h,u){if(u===void 0&&(u="_pt"),this._aboveCamera())return null;var f=this.getLayer()._getRenderer(),c=f.mapStateCache,d=this.getMap(),g=this.geometry,v=this.containerOffset,y,p;c?(y=c.glRes,p=c.containerExtent):(y=d.getGLRes(),p=d.getContainerExtent());var m,_=this.getLayer().options.roundPoint,w=1/0,C=1/0,x=-1/0,T=-1/0,P=!l,S=f.layer.options.clipBBoxBufferSize||3,E=this.symbolizers;function D(ue,me){ue===void 0&&(ue=[]),me===void 0&&(me=[]);var re=Ts(ue,u);re=d._pointsAtResToContainerPoints(ue,y,me,re);for(var He=0,nt=re.length;He<nt;He++){var _e=re[He];_e._sub(v),(o||a)&&_e._add(o||0,a||0),_&&(_e.x=Math.ceil(_e.x),_e.y=Math.ceil(_e.y)),w=Math.min(_e.x,w),C=Math.min(_e.y,C),x=Math.max(_e.x,x),T=Math.max(_e.y,T)}if(P&&R1(E)){if(Sr.ymin=p.ymin,Sr.ymin<S&&(Sr.ymin=p.ymin-S),Sr.xmin=p.xmin-S,Sr.xmax=p.xmax+S,Sr.ymax=p.ymax+S,g.getShell&&g.getHoles)return Ja(re,Sr);var Le=Xa(re,Sr,!1);if(Le.length){var Tt=[];return Le.forEach(function(ar){for(var fe=0,Pr=ar.length;fe<Pr;fe++)Tt.push(ar[fe].point)}),Tt}}return re}var A=this.getAltitude();if(Array.isArray(e)){var I=this.geometry,L;!l&&I.options.enableClip?(L=this._clip(e,A),L.inView&&(P=!1)):L={points:e,altitude:A};var O=L.points;A=L.altitude,s&&(A=0);var H=A;m=[];for(var B=[],R=V(A),b=0,N=O.length;b<N;b++){var Z=O[b];if(Array.isArray(Z)){if(R){var X=D(Z,A);m.push(X);continue}for(var ne=[],te=0,J=Z.length;te<J;te++)Array.isArray(A)&&(A[b]?H=A[b][te]:H=0),ne.push(H);var q=D(Z,ne);m.push(q)}else Array.isArray(A)&&(h==="vertex-last"?H=A[A.length-1-b]:h==="line"?H=(A[b]+A[b+1])/2:H=A[b]),B.push(H)}B.length&&(m=D(O,B))}else e instanceof k&&(s&&(A=0),m=d._pointAtResToContainerPoint(e,y,A)._sub(v),(o||a)&&m._add(o,a));return Wn.minx=w,Wn.miny=C,Wn.maxx=x,Wn.maxy=T,this._containerBbox=Wn,m},i._clip=function(e,o){if(V(o)&&o!==0)return{points:e,altitude:o};if(Array.isArray(o)){for(var a=!1,s=0,l=o.length;s<l;s++)if(o[s]!==0){a=!0;break}if(a)return{points:e,altitude:o}}var h=this.getMap(),u=this.geometry,f=this.getSymbol().lineWidth;V(f)||(f=4);var c=this.getLayer()._getRenderer(),d=c.mapStateCache,g,v,y;d?(g=d._2DExtent,v=d.glExtent,y=d.pitch):(g=h._get2DExtent(),v=h._get2DExtentAtRes(h.getGLRes()),y=h.getPitch());var p=g._expand(f);if(y>0&&o){var m=h.cameraLookAt,_=h.cameraPosition;vg.set(_.x,_.y),p=p._combine(vg._add(et(m[0]-_[0]),et(m[1]-_[1])))}var w=this.get2DExtent(null,BC),C=e;if(w.within(p))return{points:C,altitude:o,inView:!0};var x=v._expand(f*h._glScale);St.xmin=x.xmin,St.xmax=x.xmax,St.ymin=x.ymin,St.ymax=x.ymax;var T=u.options.smoothness;if(u.getShell&&this.geometry.getHoles&&!T){var P=x.xmin,S=x.ymin,E=x.xmax,D=x.ymax,A=Math.abs(E-P),I=Math.abs(D-S),L=Math.sqrt(A*A+I*I),O=(L-A)/2,H=(L-I)/2;if(St.xmin=x.xmin-O,St.xmax=x.xmax+O,St.ymin=x.ymin-H,St.ymax=x.ymax+H,!Array.isArray(e[0]))C=Ja(e,St);else{C=[];for(var B=0;B<e.length;B++){var R=Ja(e[B],St);R.length&&C.push(R)}}}else if(u.getJSONType()==="LineString"&&!T){if(!Array.isArray(e[0]))C=Xa(e,St,!1,!!T);else{C=[];for(var b=0;b<e.length;b++)pi(C,Xa(e[b],St,!1,!!T))}return this._interpolateSegAlt(C,e,o)}return{points:C,altitude:o}},i._interpolateSegAlt=function(e,o,a){if(!Array.isArray(a)){var s=function(f){return f.point};return{points:e.map(function(u){return Array.isArray(u)?u.map(s):u.point}),altitude:a}}var l=N_(e,o,a);a=[];var h=l.map(function(u){if(Array.isArray(u)){var f=[],c=u.map(function(d){return f.push(d.altitude),d.point});return a.push(f),c}return a.push(u.altitude),u.point});return{points:h,altitude:a}},i.getSymbol=function(){return this.geometry._getInternalSymbol()},i._resetSymbolizersBBOX=function(){for(var e=this.symbolizers.length-1;e>=0;e--){var o=this.symbolizers[e],a=o.bbox;Io(a)}return this},i.paint=function(e,o,a){if(this.symbolizers){var s=this.getLayer(),l=s._getRenderer();if(!(!l||!l.context&&!o)){var h=l.mapStateCache||{};if(!(!this.geometry._isCheck&&e&&!e.intersects(this.get2DExtent(l.resources,HC)))){var u=this.getMap();if(!this._aboveCamera()){this.containerOffset=a||h.offset||u._pointToContainerPoint(l.southWest)._add(0,-u.height),this._beforePaint();var f=o||l.context;f.isHitTesting||this._resetSymbolizersBBOX();for(var c=[f,l.resources],d=this.symbolizers.length-1;d>=0;d--)(f.shadowBlur||this.symbolizers[d].symbol.shadowBlur)&&this._prepareShadow(f,this.symbolizers[d].symbol),this.symbolizers[d].symbolize.apply(this.symbolizers[d],c);this._afterPaint(),this._painted=!0,(this.geometry.options.debug||s.options.debug)&&this._debugSymbolizer.symbolize.apply(this._debugSymbolizer,c)}}}}},i.getSprite=function(e,o){if(this.geometry.type!=="Point")return null;if(this._spriting=!0,!this._sprite&&this.symbolizers.length>0){var a=new ee;this.symbolizers.forEach(function(v){var y=v.getFixedExtent(e);a._combine(y)});var s=a.getMin().multi(-1),l=o||(this.getMap()?this.getMap().CanvasClass:null),h=j.createCanvas(a.getWidth(),a.getHeight(),l),u;this._renderPoints&&(u=this._renderPoints);for(var f=h.getContext("2d"),c=[f,e],d=this.symbolizers.length-1;d>=0;d--){var g=this.symbolizers[d].getDxDy();this._renderPoints={center:[[s.add(g)]]},this._prepareShadow(f,this.symbolizers[d].symbol),this.symbolizers[d].symbolize.apply(this.symbolizers[d],c)}u&&(this._renderPoints=u),this._sprite={canvas:h,offset:a.getCenter()}}return this._spriting=!1,this._sprite},i.isSpriting=function(){return!!this._spriting},i.hitTest=function(e,o){if((!o||o<.5)&&(o=.5),this._hitPoint=e.sub(o,o),!ti){var a=this.getMap()?this.getMap().CanvasClass:null;ti=j.createCanvas(1,1,a)}j.setHitTesting(!0),ti.width=ti.height=2*o;var s=j.getCanvas2DContext(ti);s.isHitTesting=!0;try{this.paint(null,s,this._hitPoint)}catch(f){throw f}finally{j.setHitTesting(!1)}delete this._hitPoint;for(var l=s.getImageData(0,0,ti.width,ti.height).data,h=3,u=l.length;h<u;h+=4)if(l[h]>0)return!0;return!1},i.isHitTesting=function(){return!!this._hitPoint},i._prepareShadow=function(e,o){o.shadowBlur?(e.shadowBlur=this.isHitTesting()?0:o.shadowBlur,e.shadowColor=o.shadowColor||"#000",e.shadowOffsetX=o.shadowOffsetX||0,e.shadowOffsetY=o.shadowOffsetY||0):e.shadowBlur&&(e.shadowBlur=null,e.shadowColor=null,e.shadowOffsetX=null,e.shadowOffsetY=null)},i._eachSymbolizer=function(e,o){if(this.symbolizers){o||(o=this);for(var a=this.symbolizers.length-1;a>=0;a--)e.apply(o,[this.symbolizers[a]])}},i.get2DExtent=function(e,o){this._verifyProjection();var a=this.getMap();e=e||this.getLayer()._getRenderer().resources;var s=a.getZoom(),l=this._isDynamicSize();if((!this._extent2D||this._extent2D._zoom!==s||!this._fixedExtent)&&(this._extent2D&&this._extent2D._zoom!==s&&delete this._extent2D,this.symbolizers&&(this._extent2D||(this._extent2D=this._computeExtent2D(new ee),this._extent2D._zoom=s),this._fixedExtent||(this._fixedExtent=this._computeFixedExtent(e,new ee)))),!this._extent2D)return l&&delete this._fixedExtent,null;var h=this._fixedExtent,u=h.xmin,f=h.ymin,c=h.xmax,d=h.ymax;return l&&delete this._fixedExtent,Ma.set(u,-d,c,-f),o?(o.set(this._extent2D.xmin,this._extent2D.ymin,this._extent2D.xmax,this._extent2D.ymax),o._add(Ma),o):this._extent2D.add(Ma)},i._computeExtent2D=function(e){for(var o=this.symbolizers.length-1;o>=0;o--){var a=this.symbolizers[o];e._combine(a.get2DExtent())}return e},i._computeFixedExtent=function(e,o){for(var a=this.symbolizers.length-1;a>=0;a--){var s=this.symbolizers[a];s.getFixedExtent&&o._combine(s.getFixedExtent(e))}return o},i._isDynamicSize=function(){for(var e=this.symbolizers.length-1;e>=0;e--){var o=this.symbolizers[e];if(o.isDynamicSize())return!0}return!1},i._aboveCamera=function(){var e=this.getMinAltitude(),o=this.getMap(),a=o.getGLRes();e=o.altitudeToPoint(e,a)*et(e);var s=o.getFrustumAltitude();return e&&s&&s<e},i.getFixedExtent=function(){var e=this.getMap(),o=e.getZoom();return this._isDynamicSize()?this._computeFixedExtent(null,new ee):((!this._extent2D||this._extent2D._zoom!==o)&&this.get2DExtent(null,Ma),this._fixedExtent)},i.setZIndex=function(e){this._eachSymbolizer(function(o){o.setZIndex(e)})},i.show=function(){if(this._painted)this.removeCache(),this._eachSymbolizer(function(o){o.show()});else{var e=this.getLayer();e.isCanvasRender()||this.paint()}},i.hide=function(){this._eachSymbolizer(function(e){e.hide()})},i.repaint=function(){this._altAtGL=this._getGeometryAltitude(),this.removeCache();var e=this.getLayer();if(e){var o=e.getRenderer();!o||!o.setToRedraw()||o.setToRedraw()}},i.refreshSymbol=function(){this.removeCache(),this._removeSymbolizers(),this.symbolizers=this._createSymbolizers()},i.remove=function(){this.removeCache(),this._removeSymbolizers()},i._removeSymbolizers=function(){this._eachSymbolizer(function(e){delete e.painter,e.remove()}),delete this.symbolizers},i.removeCache=function(){delete this._renderPoints,delete this._paintParams,delete this._sprite,delete this._extent2D,delete this._fixedExtent,delete this._cachedParams,delete this._unsimpledParams},i.getAltitude=function(){var e=this.geometry._getAltitude();return e!==this._propAlt&&(this._altAtGL=this._getGeometryAltitude()),this._altAtGL?this._altAtGL:0},i.getMinAltitude=function(){return this.minAltitude?this.minAltitude:0},i.getMaxAltitude=function(){return this.maxAltitude?this.maxAltitude:0},i._getGeometryAltitude=function(){var e=this,o=this.getMap();if(!o)return 0;var a=this.geometry._getAltitude();if(this._propAlt=a,!a)return this.minAltitude=this.maxAltitude=0,0;var s=this.geometry.getCenter();return s?Array.isArray(a)?(this.minAltitude=Number.MAX_VALUE,this.maxAltitude=Number.MIN_VALUE,a.map(function(l){var h=l;return h<e.minAltitude&&(e.minAltitude=h),h>e.maxAltitude&&(e.maxAltitude=h),h})):(this.minAltitude=this.maxAltitude=a,this.minAltitude):0},i._verifyProjection=function(){var e=this.geometry._getProjection()||GC;this._projCode&&this._projCode!==e.code&&this.removeCache(),this._projCode=e.code},i._beforePaint=function(){},i._afterPaint=function(){},t}(zt);function N_(r,t,i){if(!Array.isArray(i))return r;for(var n=[],e=0,o=r.length;e<o;e++)if(Array.isArray(r[e]))n.push(N_(r[e],t,i));else{var a=r[e];if(a.point.equals(t[a.index]))a.altitude=i[a.index],n.push(a);else{var s=void 0,l=void 0;a.index===0?(s=a.index,l=a.index+1):(s=a.index-1,l=a.index);var h=a.point.distanceTo(t[l]),u=h/(h+t[s].distanceTo(a.point)),f=Pu(i[s],i[l],1-u);a.altitude=f,n.push(a)}}return n}var WC=new ee,F_=function(r){F(t,r);function t(n,e){var o;return o=r.call(this)||this,o.geometry=n,o.isMask=e,o.bbox=nl(),o._drawTime=0,o}var i=t.prototype;return i._setDrawTime=function(e){return this._drawTime=e,this._eachPainter(function(o){o._setDrawTime(e)}),this},i.getRenderBBOX=function(){var e=this,o=this.getLayer();return o&&o._drawTime!==this._drawTime?null:(Io(this.bbox),this._eachPainter(function(a){var s=a.getRenderBBOX();ks(s)&&ol(e.bbox,s)}),ks(this.bbox)?this.bbox:null)},i._eachPainter=function(e){for(var o=this.geometry.getGeometries(),a,s=0,l=o.length;s<l&&(a=this.isMask?o[s]._getMaskPainter():o[s]._getPainter(),!(!!a&&a&&e.call(this,a)===!1));s++);},i.getLayer=function(){return this.geometry&&this.geometry.getLayer()},i.paint=function(e){this.geometry&&this._eachPainter(function(o){o.paint(e)})},i.get2DExtent=function(e,o){o&&o.set(null,null,null,null);var a=o||new ee;return this._eachPainter(function(s){a=a._combine(s.get2DExtent(e,WC))}),a},i.remove=function(){var e=arguments;this._eachPainter(function(o){o.remove.apply(o,e)})},i.setZIndex=function(){var e=arguments;this._eachPainter(function(o){o.setZIndex.apply(o,e)})},i.show=function(){var e=arguments;this._eachPainter(function(o){o.show.apply(o,e)})},i.hide=function(){var e=arguments;this._eachPainter(function(o){o.hide.apply(o,e)})},i.repaint=function(){var e=arguments;this._eachPainter(function(o){o.repaint.apply(o,e)})},i.refreshSymbol=function(){var e=arguments;this._eachPainter(function(o){o.refreshSymbol.apply(o,e)})},i.hasPoint=function(){var e=!1;return this._eachPainter(function(o){return o.hasPoint()?(e=!0,!1):!0}),e},i.getMinAltitude=function(){var e=!0,o=0;return this._eachPainter(function(a){var s=a.getMinAltitude();(e||s<o)&&(e=!1,o=s)}),o},i.getMaxAltitude=function(){var e=0;return this._eachPainter(function(o){var a=o.getMaxAltitude();a>e&&(e=a)}),e},t}(zt),Vn=23,Or={"EPSG:3857":{projection:"EPSG:3857",resolutions:function(){for(var r=[],t=12756274*Math.PI,i=0;i<Vn;i++)r[i]=t/(256*Math.pow(2,i));return r}(),fullExtent:{top:6378137*Math.PI,left:-6378137*Math.PI,bottom:-6378137*Math.PI,right:6378137*Math.PI}},"EPSG:4326":{projection:"EPSG:4326",fullExtent:{top:90,left:-180,bottom:-90,right:180},resolutions:function(){for(var r=[],t=0;t<Vn;t++)r[t]=180/(Math.pow(2,t)*128);return r}()},BAIDU:{projection:"baidu",resolutions:function(){for(var r=Math.pow(2,18),t=[],i=0;i<Vn;i++)t[i]=r,r*=.5;return t}(),fullExtent:{top:33554432,left:-33554432,bottom:-33554432,right:33554432}},IDENTITY:{projection:"identity",resolutions:function(){for(var r=Math.pow(2,8),t=[],i=0;i<Vn;i++)t[i]=r,r*=.5;return t}(),fullExtent:{top:2e5,left:-2e5,bottom:-2e5,right:2e5}},"PRESET-VT-3857":{projection:"EPSG:3857",resolutions:function(){for(var r=[],t=6378137*Math.PI,i=0;i<Vn;i++)r[i]=t/(256*Math.pow(2,i));return r}(),fullExtent:{top:6378137*Math.PI,left:-6378137*Math.PI,bottom:-6378137*Math.PI,right:6378137*Math.PI}}};Or["EPSG:4490"]=Or["EPSG:4326"];var er=function(){function r(i){i===void 0&&(i={}),this.options=i,this._initSpatialRef()}r.registerPreset=function(n,e){if(n=n&&n.toUpperCase(),Or[n])throw new Error("Spatial reference "+n+" already existed.");Or[n]=e},r.getPreset=function(n){return Or[n.toUpperCase()]},r.getAllPresets=function(){return Object.keys(Or)},r.getProjectionInstance=function(n){if(!n)return null;if(Zt(n))return n.locate||(n=W({},n),n.measure==="identity"?W(n,sh.getInstance("IDENTITY")):W(n,sh.getInstance("EPSG:4326"))),n;n=(n+"").toLowerCase();for(var e in Pa)if(Go(Pa,e)){var o=Pa[e].code;if(o&&o.toLowerCase()===n)return Pa[e]}return null},r.equals=function(n,e){if(ie(n)||ie(e))return n===e;if(!n&&!e)return!0;if(!n||!e||n.projection!==e.projection)return!1;var o=n.fullExtent,a=e.fullExtent;if(o&&!a||!o&&a||o&&a&&(o.top!==a.top||o.bottom!==a.bottom||o.left!==a.left||o.right!==a.right))return!1;var s=n.resolutions,l=e.resolutions;if(s&&l){if(s.length!==l.length)return!1;for(var h=0;h<s.length;h++)if(s[h]!==l[h])return!1}else if(s||l)return!1;return!0};var t=r.prototype;return t._initSpatialRef=function(){var n=this.options.projection;if(n?n=r.getProjectionInstance(n):n=d_,!n)throw new Error("must provide a valid projection in map's spatial reference.");n=W({},Sn,n),n.measureLength||W(n,sh.DEFAULT),this._projection=n;var e,o=this.options.resolutions;if(!o&&(n.code&&(e=Or[n.code.toUpperCase()],e&&(o=e.resolutions,this.isEPSG=n.code!=="IDENTITY")),!o))throw new Error("must provide valid resolutions in map's spatial reference.");if(this._resolutions=o,this._pyramid=!0,this._pyramid){for(var a=0;a<o.length;a++)if(o[a]&&o[a-1]&&o[a-1]/o[a]!==2){this._pyramid=!1;break}}var s=this.options.fullExtent;if(!s&&(n.code&&(e=Or[n.code.toUpperCase()],e&&(s=e.fullExtent)),!s))throw new Error("must provide a valid fullExtent in map's spatial reference.");if(M(s.left)?(this._fullExtent=new ge(s),s.left=s.xmin,s.right=s.xmax,s.top=s.ymax,s.bottom=s.ymin):this._fullExtent=new ge(new z(s.left,s.top),new z(s.right,s.bottom)),M(s.top)||M(s.bottom)||M(s.left)||M(s.right))throw new Error("must provide valid top/bottom/left/right in fullExtent.");W(this._fullExtent,s),this._projection.fullExtent=s;var l=s.right>=s.left?1:-1,h=s.top>=s.bottom?-1:1;this._transformation=new s_([l,h,0,0])},t.getResolutions=function(){return this._resolutions||[]},t.getResolution=function(n){var e=n|0;e<0?e=0:e>this._resolutions.length-1&&(e=this._resolutions.length-1);var o=this._resolutions[e];if(e!==n&&n>0&&e<this._resolutions.length-1){var a=this._resolutions[e+1];return o+(a-o)*(n-e)}return o},t.getProjection=function(){return this._projection},t.getFullExtent=function(){return this._fullExtent},t.getTransformation=function(){return this._transformation},t.getMinZoom=function(){for(var n=0;n<this._resolutions.length;n++)if(!M(this._resolutions[n]))return n;return 0},t.getMaxZoom=function(){for(var n=this._resolutions.length-1;n>=0;n--)if(!M(this._resolutions[n]))return n;return this._resolutions.length-1},t.getZoomDirection=function(){return et(this._resolutions[this.getMinZoom()]-this._resolutions[this.getMaxZoom()])},t.toJSON=function(){return this.json||(this.json={resolutions:this._resolutions,fullExtent:{top:this._fullExtent.top,left:this._fullExtent.left,bottom:this._fullExtent.bottom,right:this._fullExtent.right},projection:this._projection.code}),this.json},t.isPyramid=function(){return this._pyramid},r}(),gh=new k(0,0),pg=new ee,vh={},VC={id:null,visible:!0,interactive:!0,editable:!0,cursor:null,antiMeridian:!1,defaultProjection:"EPSG:4326"},ae=function(r){F(t,r);function t(n){var e,o=W({},n),a=o.symbol,s=o.properties,l=o.id;return delete o.symbol,delete o.id,delete o.properties,e=r.call(this,o)||this,a?e.setSymbol(a):e._genSizeSymbol(),s&&e.setProperties(s),M(l)||e.setId(l),e}var i=t.prototype;return i.getFirstCoordinate=function(){if(this.type==="GeometryCollection"){var e=this.getGeometries();return e.length?e[0].getFirstCoordinate():null}var o=this.getCoordinates();if(!Array.isArray(o))return o;do o=o[0];while(Array.isArray(o)&&o.length>0);return o},i.getLastCoordinate=function(){if(this.type==="GeometryCollection"){var e=this.getGeometries();return e.length?e[e.length-1].getLastCoordinate():null}var o=this.getCoordinates();if(!Array.isArray(o))return o;do o=o[o.length-1];while(Array.isArray(o)&&o.length>0);return o},i.addTo=function(e,o){return e.addGeometry(this,o),this},i.getLayer=function(){return this._layer?this._layer:null},i.getMap=function(){return this._layer?this._layer.getMap():null},i.getId=function(){return this._id},i.setId=function(e){var o=this.getId();return this._id=e,this._fireEvent("idchange",{old:o,new:e}),this},i.getProperties=function(){return this.properties?this.properties:this._getParent()?this._getParent().getProperties():null},i.setProperties=function(e){var o=this.properties;return this.properties=Zt(e)?W({},e):e,this._repaint(),this._fireEvent("propertieschange",{old:o,new:e}),this},i.getType=function(){return this.type},i.getSymbol=function(){var e=this._symbol;return e?Array.isArray(e)?Kt(e):W({},e):null},i.setSymbol=function(e){return this._symbolUpdated=e,this._symbol=this._prepareSymbol(e),this.onSymbolChanged(),delete this._compiledSymbol,delete this._symbolHash,this},i.getSymbolHash=function(){return this._symbolHash||(this._symbolHash=Uf(this._symbolUpdated)),this._symbolHash},i.updateSymbol=function(e){if(!e)return this;var o=this._getSymbol();if(Array.isArray(o)){if(!Array.isArray(e))throw new Error("Parameter of updateSymbol is not an array.");for(var a=0;a<e.length;a++)Rs(e[a])&&delete this._textDesc,o[a]&&e[a]&&(o[a]=Kt(o[a],e[a]))}else{if(Array.isArray(e))throw new Error("Geometry's symbol is not an array to update.");Rs(o)&&delete this._textDesc,o?o=Kt(o,e):o=Kt(this._getInternalSymbol(),e)}return this._eventSymbolProperties=e,delete this._compiledSymbol,this.setSymbol(o)},i.getTextContent=function(){var e=this._getInternalSymbol();if(Array.isArray(e)){for(var o=[],a=!1,s=0;s<e.length;s++)o[s]=Au(e[s]&&e[s].textName,this.getProperties()),M(o[s])||(a=!0);return a?o:null}return Au(e&&e.textName,this.getProperties())},i.getTextDesc=function(){if(!this._textDesc){var e=this.getTextContent(),o=this._sizeSymbol,a=Array.isArray(e);Array.isArray(o)?this._textDesc=o.map(function(s,l){return Ou(a?e[l]:"",s)}):this._textDesc=Ou(e,o)}return this._textDesc},i.getCenter=function(){return this._computeCenter(this._getMeasurer())},i.getExtent=function(){var e=this._getPrjExtent(),o=this._getProjection();if(e&&o){var a=o.unproject(new z(e.xmin,e.ymin)),s=o.unproject(new z(e.xmax,e.ymax));return new ge(a,s,o)}else return this._computeExtent(this._getMeasurer())},i.getContainerExtent=function(e){var o=this.get2DExtent();if(!o||!o.isValid())return null;var a=this.getMap(),s=a.getGLRes(),l=this.getMinAltitude(),h=o.convertTo(function(v){return a._pointAtResToContainerPoint(v,s,l,gh)},e),u=this.getMaxAltitude();if(u!==l){var f=o.convertTo(function(v){return a._pointAtResToContainerPoint(v,s,u,gh)},pg);h._combine(f)}var c=this.getLayer();if(c&&this.type==="LineString"&&u&&c.options.drawAltitude){var d=o.convertTo(function(v){return a._pointAtResToContainerPoint(v,s,0,gh)},pg);h._combine(d)}h&&h._add(this._getFixedExtent());var g=this.options.smoothness;return g&&h._expand(h.getWidth()*.15),h},i._getFixedExtent=function(){this._fixedExtent||(this._fixedExtent=new ee);var e=this._sizeSymbol,o=(e&&e.lineWidth||1)/2;this._fixedExtent.set(-o,-o,o,o);var a=e&&e.lineDx||0;this._fixedExtent._add([a,0]);var s=e&&e.lineDy||0;return this._fixedExtent._add([0,s]),this._fixedExtent},i.get2DExtent=function(){var e=this.getMap();if(!e)return null;if(this._extent2d)return this._extent2d;var o=this._getPrjExtent();if(!o||!o.isValid())return null;var a=o.getMin(),s=o.getMax(),l=e.getGLRes();return e._prjToPointAtRes(a,l,a),e._prjToPointAtRes(s,l,s),this._extent2d=new ee(a,s),this._extent2d.z=e.getZoom(),this._extent2d},i.getSize=function(){var e=this.getContainerExtent();return e?e.getSize():null},i.containsPoint=function(e,o){if(!this.getMap())throw new Error('The geometry is required to be added on a map to perform "containsPoint".');return e instanceof z&&(e=this.getMap().coordToContainerPoint(e)),this._containsPoint(e,o)},i._containsPoint=function(e,o){var a=this._getPainter();return a?(o=o||0,this._hitTestTolerance&&(o+=this._hitTestTolerance()),a.hitTest(e,o)):!1},i.show=function(){if(this.options.visible=!0,this.getMap()){var e=this._getPainter();e&&e.show(),this._fireEvent("show")}return this},i.hide=function(){if(this.options.visible=!1,this.getMap()){this.onHide();var e=this._getPainter();e&&e.hide(),this._fireEvent("hide")}return this},i.isVisible=function(){if(!this.options.visible)return!1;var e=this._getInternalSymbol();if(!e)return!0;if(Array.isArray(e)){if(!e.length)return!0;for(var o=0,a=e.length;o<a;o++)if(M(e[o].opacity)||e[o].opacity>0)return!0;return!1}else return M(e.opacity)||Zt(e.opacity)||V(e.opacity)&&e.opacity>0},i.getZIndex=function(){return this.options.zIndex||0},i.setZIndex=function(e){var o=this.options.zIndex;return this.options.zIndex=e,this._fireEvent("zindexchange",{old:o,new:e}),this},i.setZIndexSilently=function(e){return this.options.zIndex=e,this},i.bringToFront=function(){var e=this.getLayer();if(!e||!e.getGeoMaxZIndex)return this;var o=e.getGeoMaxZIndex();return this.setZIndex(o+1),this},i.bringToBack=function(){var e=this.getLayer();if(!e||!e.getGeoMinZIndex)return this;var o=e.getGeoMinZIndex();return this.setZIndex(o-1),this},i.translate=function(e,o){if(M(e))return this;var a=new z(e,o);if(a.x===0&&a.y===0)return this;var s=this.getCoordinates();if(this._silence=!0,s)if(Array.isArray(s)){var l=_n(s,function(h){return h.add(a)});this.setCoordinates(l)}else this.setCoordinates(s.add(a));return this._silence=!1,this._fireEvent("positionchange"),this},i.flash=function(e,o,a,s){return Em.call(this,e,o,a,s)},i.copy=function(){var e=this.toJSON(),o=t.fromJSON(e);return o.options.visible=!0,o},i.remove=function(){var e=this.getLayer();return e?(this._fireEvent("removestart"),this._unbind(),this._fireEvent("removeend"),this._fireEvent("remove"),this):this},i.toGeoJSONGeometry=function(){var e=this._exportGeoJSONGeometry();return e},i.toGeoJSON=function(e){e||(e={});var o={type:"Feature",geometry:null};if(M(e.geometry)||e.geometry){var a=this._exportGeoJSONGeometry();o.geometry=a}var s=this.getId();M(s)||(o.id=s);var l;return(M(e.properties)||e.properties)&&(l=this._exportProperties()),o.properties=l,o},i.toJSON=function(e){e||(e={});var o=this._toJSON(e),a=this._exportGraphicOptions(e);return W(o,a),o},i.getLength=function(){return this._computeGeodesicLength(this._getMeasurer())},i.getArea=function(){return this._computeGeodesicArea(this._getMeasurer())},i.rotate=function(e,o){if(this.type==="GeometryCollection"){var a=this.getGeometries();return a.forEach(function(u){return u.rotate(e,o)}),this}o?o=new z(o):o=this.getCenter();var s=this._getMeasurer(),l=this.getCoordinates();if(!Array.isArray(l)){if(o.x!==l.x||o.y!==l.y){var h=s._rotate(l,o,e);this.setCoordinates(h)}return this}return _n(l,function(u){return s._rotate(u,o,e)}),this.setCoordinates(l),this},i._getConnectPoints=function(){return[this.getCenter()]},i._initOptions=function(e){var o=W({},e),a=o.symbol,s=o.properties,l=o.id;delete o.symbol,delete o.id,delete o.properties,this.setOptions(o),a&&this.setSymbol(a),s&&this.setProperties(s),M(l)||this.setId(l)},i._bindLayer=function(e){if(e!==this.getLayer()){if(this.getLayer())throw new Error("Geometry cannot be added to two or more layers at the same time.");this._layer=e,this._clearCache(),this._bindInfoWindow(),this._bindMenu()}},i._prepareSymbol=function(e){if(Array.isArray(e)){for(var o=[],a=0;a<e.length;a++)o.push(Ru(this._checkAndCopySymbol(e[a])));return o}else if(e)return e=this._checkAndCopySymbol(e),Ru(e);return null},i._checkAndCopySymbol=function(e){var o={};for(var a in e)Nx[a]&&ie(e[a])?o[a]=+e[a]:o[a]=e[a];return o},i._getSymbol=function(){return this._symbol},i._setExternSymbol=function(e){return this._eventSymbolProperties=e,this._symbol||delete this._textDesc,this._externSymbol=this._prepareSymbol(e),this.onSymbolChanged(),this},i._getInternalSymbol=function(){return this._symbol?this._symbol:this._externSymbol?this._externSymbol:this.options.symbol?this.options.symbol:null},i._getPrjExtent=function(){var e=this._getProjection();return this._verifyProjection(),!this._extent&&e&&(this._extent=this._computePrjExtent(e)),this._extent},i._unbind=function(){var e=this.getLayer();e&&(this._animPlayer&&this._animPlayer.finish(),this._unbindMenu(),this._unbindInfoWindow(),this.isEditing()&&this.endEdit(),this._removePainter(),this.onRemove&&this.onRemove(),e.onRemoveGeometry&&e.onRemoveGeometry(this),delete this._layer,delete this._internalId,delete this._extent)},i._getInternalId=function(){return this._internalId},i._setInternalId=function(e){this._internalId=e},i._getMeasurer=function(){return this._getProjection()?this._getProjection():er.getProjectionInstance(this.options.defaultProjection)},i._getProjection=function(){var e=this.getMap();return e?e.getProjection():null},i._verifyProjection=function(){var e=this._getProjection();this._projCode&&e&&this._projCode!==e.code&&this._clearProjection(),this._projCode=e?e.code:this._projCode},i._getExternalResources=function(){var e=this._getInternalSymbol();return el(e)},i._getPainter=function(){var e=this.getLayer();if(!this._painter&&e){if(_m.indexOf(this.type)!==-1){if(e.constructor.getCollectionPainterClass){var o=e.constructor.getCollectionPainterClass();o&&(this._painter=new o(this))}}else if(e.constructor.getPainterClass){var a=e.constructor.getPainterClass();a&&(this._painter=new a(this))}}return this._painter},i._getMaskPainter=function(){return this._maskPainter?this._maskPainter:(this._maskPainter=this.getGeometries&&this.getGeometries()?new F_(this,!0):new ic(this),this._maskPainter)},i._removePainter=function(){this._painter&&this._painter.remove(),delete this._painter},i._paint=function(e){if(this._painter){if(this._dirtyCoords){delete this._dirtyCoords;var o=this._getProjection();o&&(this._pcenter=o.project(this._coordinates),this._clearCache())}this._painter.paint(e)}},i._clearCache=function(){delete this._extent,delete this._extent2d},i._clearProjection=function(){delete this._extent,delete this._extent2d},i._repaint=function(){this._painter&&this._painter.repaint()},i.onHide=function(){this.closeMenu(),this.closeInfoWindow()},i.onShapeChanged=function(){this._clearCache(),this._repaint(),this._fireEvent("shapechange")},i.onPositionChanged=function(){this._clearCache(),this._repaint(),this._fireEvent("positionchange")},i.onSymbolChanged=function(){this._painter&&this._painter.refreshSymbol();var e={};this._eventSymbolProperties?(e.properties=JSON.parse(JSON.stringify(this._eventSymbolProperties)),delete this._eventSymbolProperties):delete this._textDesc,this._genSizeSymbol(),this._fireEvent("symbolchange",e)},i._genSizeSymbol=function(){var e=this._getInternalSymbol();if(!e){delete this._sizeSymbol;return}if(Array.isArray(e)){this._sizeSymbol=[];for(var o=!1,a=0;a<e.length;a++){var s=this._sizeSymbol[a]=this._getSizeSymbol(e[a]);!o&&s&&s._dynamic&&(o=!0)}this._sizeSymbol._dynamic=o}else this._sizeSymbol=this._getSizeSymbol(e)},i._getSizeSymbol=function(e){var o=Ms({lineWidth:e.lineWidth,lineDx:e.lineDx,lineDy:e.lineDy},this);return(de(e.lineWidth)||de(e.lineDx)||de(e.lineDy))&&(o._dynamic=!0),o},i._getCompiledSymbol=function(){return this._compiledSymbol?this._compiledSymbol:(this._compiledSymbol=Ms(this._getInternalSymbol(),this),this._compiledSymbol)},i.onConfig=function(e){var o;e.properties&&(o=e.properties,delete e.properties);var a=!1;for(var s in e)if(e.hasOwnProperty(s)){var l=s.slice(0,5);if(l==="arrow"||l==="smoot"){a=!0;break}}o?(this.setProperties(o),this._repaint()):a&&this._repaint()},i._setParent=function(e){e&&(this._parent=e)},i._getParent=function(){return this._parent},i._fireEvent=function(e,o){this._silence||(this.getLayer()&&this.getLayer()._onGeometryEvent&&(o||(o={}),o.type=e,o.target=this,this.getLayer()._onGeometryEvent(o)),this.fire(e,o))},i._toJSON=function(e){return{feature:this.toGeoJSON(e)}},i._exportGraphicOptions=function(e){var o={};return(M(e.options)||e.options)&&(o.options=this.config()),(M(e.symbol)||e.symbol)&&(o.symbol=this.getSymbol()),(M(e.infoWindow)||e.infoWindow)&&this._infoWinOptions&&(o.infoWindow=this._infoWinOptions),o},i._exportGeoJSONGeometry=function(){var e=this.getCoordinates(),o=z.toNumberArrays(e);return{type:this.getType(),coordinates:o}},i._exportProperties=function(){var e=null,o=this.getProperties();return M(o)||(Zt(o)?e=W({},o):e=o),e},i._hitTestTolerance=function(){return 0},i._getAltitude=function(){var e=this.getLayer();if(!e)return 0;var o=e.options,a=e.getAltitude?e.getAltitude():0,s=o.enableAltitude;if(!s)return a;var l=ph(e),h=this.properties||vh,u=h[l];if(M(u)){var f=mg(this,a,s);return M(f)?a:f}return Array.isArray(u)?u.map(function(c){return c+a}):u+a},i.getAltitude=function(){var e=this.getLayer(),o=ph(e),a=this.properties||vh,s=a[o];if(!M(s))return s;var l=mg(this,0,!1);return M(l)?0:l},i.setAltitude=function(e){if(!V(e))return this;var o=this.getLayer(),a=ph(o),s=this.properties||vh,l=s[a];if(!M(l))if(Array.isArray(l))for(var h=0,u=l.length;h<u;h++)l[h]=e;else s[a]=e;var f=this.getCoordinates?this.getCoordinates():null;if(!f)return this;if(H_(f,e),o){var c=o.getRenderer();c&&c.gl?this.setCoordinates(f):c&&this._repaint()}return this},i._genMinMaxAlt=function(){var e=this,o=this._getAltitude();Array.isArray(o)?(this._minAlt=Number.MAX_VALUE,this._maxAlt=Number.MIN_VALUE,o.forEach(function(a){var s=a;s<e._minAlt&&(e._minAlt=s),s>e._maxAlt&&(e._maxAlt=s)})):this._minAlt=this._maxAlt=o},i.getMinAltitude=function(){return this._minAlt===void 0&&this._genMinMaxAlt(),this._minAlt?this._minAlt:0},i.getMaxAltitude=function(){return this._maxAlt===void 0&&this._genMinMaxAlt(),this._maxAlt?this._maxAlt:0},t}(a_(Cr(Xf(zt))));ae.mergeOptions(VC);function ph(r){var t="altitude";if(r){var i=r.options;t=i.altitudeProperty}return t}function mg(r,t,i){var n=r.getCoordinates?r.getCoordinates():null;if(n){var e=[];if(B_(n,e),e.length){var o=G_(n,t,i);return r.getShell?o[0][0]:o}}return null}function H_(r,t){if(Array.isArray(r))for(var i=0,n=r.length;i<n;i++)H_(r[i],t);else r.z=t}function B_(r,t){if(!t.length)if(Array.isArray(r))for(var i=0,n=r.length;i<n;i++)B_(r[i],t);else V(r.z)&&t.push(r.z)}function G_(r,t,i){if(Array.isArray(r)){for(var n=[],e=0,o=r.length;e<o;e++)n.push(G_(r[e],t,i));return n}return V(r.z)?i?t+r.z:r.z:i?t:0}var ZC={attribution:null,minZoom:null,maxZoom:null,visible:!0,opacity:1,globalCompositeOperation:null,renderer:"canvas",debugOutline:"#0f0",cssFilter:null,forceRenderOnMoving:!1,forceRenderOnZooming:!1,forceRenderOnRotating:!1,collision:!1,collisionScope:"layer",hitDetect:function(){return!K.mobile}()},it=function(r){F(t,r);function t(n,e){var o,a;return e&&(a=e.canvas,delete e.canvas),o=r.call(this,e)||this,o._canvas=a,o.setId(n),e&&(o.setZIndex(e.zIndex),e.mask&&o.setMask(ae.fromJSON(e.mask))),o.proxyOptions(),o}var i=t.prototype;return i.load=function(){if(!this.getMap())return this;if(this.onLoad()){this._initRenderer();var e=this.getZIndex();M(e)||(this._renderer.setZIndex(e),this.isCanvasRender()||this._renderer.render()),this.onLoadEnd()}return this},i.getId=function(){return this._id},i.setId=function(e){var o=this._id;return M(e)||(e=e+""),this._id=e,this.fire("idchange",{old:o,new:e}),this},i.addTo=function(e){return e.addLayer(this),this},i.setZIndex=function(e){return this._zIndex=e,M(e)?delete this.options.zIndex:this.options.zIndex=e,this.map&&this.map._sortLayersByZIndex(),this._renderer&&this._renderer.setZIndex(e),this.fire("setzindex",{zIndex:e}),this},i.getZIndex=function(){return this._zIndex||0},i.getMinZoom=function(){var e=this.getMap(),o=this.options.minZoom;return e?Math.max(e.getMinZoom(),o||0):o},i.getMaxZoom=function(){var e=this.getMap(),o=this.options.maxZoom;return e?Math.min(e.getMaxZoom(),M(o)?1/0:o):o},i.getOpacity=function(){return this.options.opacity},i.setOpacity=function(e){return this.config("opacity",e),this.fire("setopacity",{opacity:e}),this},i.isCanvasRender=function(){var e=this._getRenderer();return e&&e instanceof Vo},i.getMap=function(){return this.map?this.map:null},i.getProjection=function(){var e=this.getMap();return e?e.getProjection():null},i.bringToFront=function(){var e=this._getLayerList();if(!e.length)return this;var o=e[e.length-1];if(e.length===1||o===this)return this;var a=o.getZIndex();return this.setZIndex(a+1),this},i.bringToBack=function(){var e=this._getLayerList();if(!e.length)return this;var o=e[0];if(e.length===1||o===this)return this;var a=o.getZIndex();return this.setZIndex(a-1),this},i.show=function(){var e=this;if(!this.options.visible){this.options.visible=!0;var o=this.getRenderer();o&&o.show();var a=this.getMap();o&&a?a.once("renderend",function(){e.fire("show")}):this.fire("show")}return this},i.hide=function(){var e=this;if(this.options.visible){this.options.visible=!1;var o=this.getRenderer();o&&o.hide();var a=this.getMap();o&&a?a.once("renderend",function(){e.fire("hide")}):this.fire("hide")}return this},i.isVisible=function(){if(V(this.options.opacity)&&this.options.opacity<=0)return!1;var e=this.getMap();if(e){var o=e.getZoom();if(!M(this.options.maxZoom)&&this.options.maxZoom<o||!M(this.options.minZoom)&&this.options.minZoom>o)return!1}return M(this.options.visible)&&(this.options.visible=!0),this.options.visible},i.remove=function(){return this.map&&this.map.removeLayer(this),this},i.getMask=function(){return this._mask},i.setMask=function(e){if(!(e.type==="Point"&&e._isVectorMarker()||e.type==="Polygon"||e.type==="MultiPolygon"))throw new Error("Mask for a layer must be a marker with vector marker symbol or a Polygon(MultiPolygon).");if(e._bindLayer(this),e.type==="Point"?e.updateSymbol({markerLineColor:"rgba(0, 0, 0, 0)",markerFillOpacity:0}):e.setSymbol({lineColor:"rgba(0, 0, 0, 0)",polygonOpacity:0}),this._mask=e,this.options.mask=e.toJSON(),!this.getMap()||this.getMap().isZooming())return this;var o=this._getRenderer();return o&&o.setToRedraw&&this._getRenderer().setToRedraw(),this},i.removeMask=function(){if(delete this._mask,delete this.options.mask,!this.getMap()||this.getMap().isZooming())return this;var e=this._getRenderer();return e&&e.setToRedraw&&this._getRenderer().setToRedraw(),this},i.onLoad=function(){return!0},i.onLoadEnd=function(){},i.isLoaded=function(){return!!this._loaded},i.getCollisionIndex=function(){if(this.options.collisionScope==="layer")return this._collisionIndex||(this._collisionIndex=new al),this._collisionIndex;var e=this.getMap();return e?e.getCollisionIndex():null},i.clearCollisionIndex=function(){return this.options.collisionScope==="layer"&&this._collisionIndex&&this._collisionIndex.clear(),this},i.getRenderer=function(){return this._getRenderer()},i.onConfig=function(e){var o=e&&Object.keys&&Object.keys(e).length>0;if(o&&M(e.animation)){if(this._optionsHook&&oe(this._optionsHook)&&this._optionsHook(e),this._silentConfig)return;var a=this.getRenderer();a&&a.setToRedraw&&a.setToRedraw()}},i.onAdd=function(){},i.onRendererCreate=function(){},i.onCanvasCreate=function(){},i.onRemove=function(){},i._bindMap=function(e,o){e&&(this.map=e,M(o)||this.setZIndex(o),this._switchEvents("on",this),this.onAdd(),this.fire("add"))},i._initRenderer=function(){var e=this.options.renderer;if(this.constructor.getRendererClass){var o=this.constructor.getRendererClass(e);if(!o)throw new Error("Invalid renderer for Layer("+this.getId()+"):"+e);this._renderer=new o(this),this._renderer.layer=this,this._renderer.setZIndex(this.getZIndex()),this._switchEvents("on",this._renderer),this._renderer.onAdd&&this._renderer.onAdd(),this.onRendererCreate(),this.fire("renderercreate",{renderer:this._renderer})}},i._doRemove=function(){this._loaded=!1,this._switchEvents("off",this),this.onRemove(),this._renderer&&(this._switchEvents("off",this._renderer),this._renderer.remove(),delete this._renderer),delete this.map,delete this._collisionIndex},i._switchEvents=function(e,o){o&&o.getEvents&&this.getMap()&&this.getMap()[e](o.getEvents(),o)},i._getRenderer=function(){return this._renderer},i._getLayerList=function(){return this.map?this.map._layers:[]},i._getMask2DExtent=function(){if(!this._mask||!this.getMap())return null;var e=this._mask._getMaskPainter();return e?e.get2DExtent():null},t}(a_(Cr(g_(zt))));it.mergeOptions(ZC);var UC=it.prototype.fire;it.prototype.fire=function(r,t){return r==="layerload"&&(this._loaded=!0),this.map&&(t||(t={}),t.type=r,t.target=this,this.map._onLayerEvent(t)),UC.apply(this,arguments),["show","hide"].indexOf(r)>-1&&this.fire("visiblechange",Object.assign({},t,{visible:this.options.visible})),this};var W_=new z(0,0),_g=new k(0,0),yg=["centerCross","fog","fogColor","debugSky"],$C={maxVisualPitch:70,maxPitch:80,centerCross:!1,zoomInCenter:!1,zoomOrigin:null,zoomAnimation:function(){return!Fe}(),zoomAnimationDuration:330,panAnimation:function(){return!Fe}(),panAnimationDuration:600,rotateAnimation:function(){return!Fe}(),zoomable:!0,enableInfoWindow:!0,hitDetect:function(){return!K.mobile}(),hitDetectLimit:5,fpsOnInteracting:25,layerCanvasLimitOnInteracting:-1,maxZoom:null,minZoom:null,maxExtent:null,fixCenterOnResize:!0,checkSize:!0,checkSizeInterval:1e3,renderer:"canvas",cascadePitches:[10,60],renderable:!0,clickTimeThreshold:280,stopRenderOnOffscreen:!0,preventWheelScroll:!0,preventTouch:!0,supportPluginEvent:!0,switchDragButton:!1},Q=function(r){F(t,r);function t(n,e){var o;if(!e)throw new Error("Invalid options when creating map.");if(!e.center)throw new Error("Invalid center when creating map.");var a=W({},e),s=a.zoom;delete a.zoom;var l=new z(a.center);delete a.center;var h=a.baseLayer;delete a.baseLayer;var u=a.layers;return delete a.layers,o=r.call(this,a)||this,o.VERSION=t.VERSION,Object.defineProperty(Ie(Ie(o)),"id",{value:Tn(),writable:!1}),o._loaded=!1,o._initContainer(n),o._panels={},o._baseLayer=null,o._layers=[],o._zoomLevel=s,o._center=l,o.setSpatialReference(a.spatialReference||a.view),o._mapViewPoint=new k(0,0),o._initRenderer(),o._updateMapSize(o._getContainerDomSize()),h&&o.setBaseLayer(h),u&&o.addLayer(u),o.setMaxExtent(a.maxExtent),o._Load(),o.proxyOptions(),o}t.addOnLoadHook=function(e){var o=Array.prototype.slice.call(arguments,1),a=typeof e=="function"?e:function(){this[e].apply(this,o)};return this.prototype._onLoadHooks=this.prototype._onLoadHooks||[],this.prototype._onLoadHooks.push(a),this};var i=t.prototype;return i.isLoaded=function(){return!!this._loaded},i.getContainer=function(){return this._containerDOM},i.getSpatialReference=function(){return this._spatialReference},i.setSpatialReference=function(e){var o=this.options.spatialReference;return this._loaded&&er.equals(o,e)?this:(this._updateSpatialReference(e,o),this)},i._updateSpatialReference=function(e,o){if(ie(e)&&(e=er.getPreset(e)),e=W({},e),this._center=this.getCenter(),this.options.spatialReference=e,this._spatialReference=new er(e),this.options.spatialReference&&oe(this.options.spatialReference.projection)){var a=this._spatialReference.getProjection();this.options.spatialReference.projection=a.code}return this._resetMapStatus(),this._fireEvent("spatialreferencechange",{old:o,new:W({},this.options.spatialReference)}),this},i.onConfig=function(e){var o=e.spatialReference||e.view;M(o)||this._updateSpatialReference(o,null);for(var a=!1,s=0,l=yg.length;s<l;s++){var h=yg[s];if(!M(e[h])){a=!0;break}}if(!a)return this;var u=this.getRenderer();return u&&u.setToRedraw(),this},i.getProjection=function(){return this._spatialReference?this._spatialReference.getProjection():null},i.getFullExtent=function(){return this._spatialReference?this._spatialReference.getFullExtent():null},i.setCursor=function(e){return delete this._cursor,this._trySetCursor(e),this._cursor=e,this},i.resetCursor=function(){return this.setCursor(null)},i.getCenter=function(){if(!this._loaded||!this._prjCenter)return this._center;var e=this.getProjection(),o=e.unproject(this._prjCenter);return o.x=Math.round(o.x*1e8)/1e8,o.y=Math.round(o.y*1e8)/1e8,this.centerAltitude&&(o.z=this.centerAltitude),o},i.setCenter=function(e,o){if(!e)return this;e=new z(e),o&&(e=this._getCenterByPadding(e,this.getZoom(),o));var a=this.getProjection(),s=a.project(e);return this._verifyExtent(s)?this._loaded?(this.onMoveStart(),this._setPrjCenter(s),this.onMoveEnd(this._parseEventFromCoord(this.getCenter())),this):(this._center=e,this):this},i.getSize=function(){return M(this.width)||M(this.height)?this._getContainerDomSize():new Ae(this.width,this.height)},i.getContainerExtent=function(){var e=this.height,o=this.getPitch(),a=this.options.maxVisualPitch;return a&&o>a&&(e=this._getVisualHeight(a)),new ee(0,this.height-e,this.width,this.height)},i._getVisualHeight=function(e){e=e||.01;var o=(90-this.getPitch())*Math.PI/180,a=this.getFov()*Math.PI/180;e*=Math.PI/180;var s=this.cameraCenterDistance/this.getGLScale(),l=Math.tan(a/2),h=Math.tan(e),u=s*l/(1/h-l)/Math.sin(e),f=s*(Math.sin(o)*u/(s+Math.cos(o)*u));return this.height/2+f},i.getExtent=function(){return this._pointToExtent(this._get2DExtent())},i.getProjExtent=function(){var e=this._get2DExtent();return new ge(this._pointToPrj(e.getMin()),this._pointToPrj(e.getMax()))},i.getPrjExtent=function(){return this.getProjExtent()},i.getMaxExtent=function(){return this.options.maxExtent?new ge(this.options.maxExtent,this.getProjection()):null},i.setMaxExtent=function(e){if(e){var o=new ge(e,this.getProjection());this.options.maxExtent=o;var a=this.getProjection();this._prjMaxExtent=o.convertTo(function(s){return a.project(s)}),this._verifyExtent(this._getPrjCenter())||(this._loaded?this._panTo(this._prjMaxExtent.getCenter()):this._center=a.unproject(this._prjMaxExtent.getCenter()))}else delete this.options.maxExtent,delete this._prjMaxExtent;return this},i.getZoom=function(){return this._zoomLevel},i.getZoomForScale=function(e,o,a){var s=this.getZoom();if(M(o)&&(o=s),e===1&&o===s)return s;var l=this._getResolution(o),h=l/e,u=this.getZoomFromRes(h);if(a)return u;var f=1e-6;return this.getSpatialReference().getZoomDirection()<0?Math.ceil(u-f):Math.floor(u+f)},i.getZoomFromRes=function(e){var o=this._getResolutions(),a=this._getResolution(this.getMinZoom()),s=this._getResolution(this.getMaxZoom());if(a<=s){if(e<=a)return this.getMinZoom();if(e>=s)return this.getMaxZoom()}else{if(e>=a)return this.getMinZoom();if(e<=s)return this.getMaxZoom()}for(var l=o.length,h=0;h<l-1;h++)if(o[h]){var u=o[h+1]-o[h],f=e-o[h];if(et(u)===et(f)&&Math.abs(u)>=Math.abs(f))return h+f/u}return l-1},i.setZoom=function(e,o){return o===void 0&&(o={animation:!0}),isNaN(e)||M(e)?this:(e=+e,this._loaded&&this.options.zoomAnimation&&o.animation?this._zoomAnimation(e):this._zoom(e),this)},i.getMaxZoom=function(){return M(this.options.maxZoom)?this.getMaxNativeZoom():this.options.maxZoom},i.setMaxZoom=function(e){var o=this.getMaxNativeZoom();return e>o&&(e=o),e!==null&&e<this._zoomLevel&&(this.setZoom(e),e=+e),this.options.maxZoom=e,this},i.getMinZoom=function(){return M(this.options.minZoom)?this._spatialReference.getMinZoom():this.options.minZoom},i.setMinZoom=function(e){if(e!==null){e=+e;var o=this._spatialReference.getMinZoom();e<o&&(e=o),e>this._zoomLevel&&this.setZoom(e)}return this.options.minZoom=e,this},i.getMaxNativeZoom=function(){var e=this.getSpatialReference();return e?e.getMaxZoom():null},i.getGLRes=function(){if(this._glRes)return this._glRes;var e=this.getSpatialReference().getFullExtent();return this._glRes=(e.right-e.left)/Math.pow(2,19),this._glRes},i.getGLScale=function(e){return M(e)&&(e=this.getZoom()),this._getResolution(e)/this.getGLRes()},i.zoomIn=function(){return this.setZoom(this.getZoom()+1)},i.zoomOut=function(){return this.setZoom(this.getZoom()-1)},i.isZooming=function(){return!!this._zooming},i.isInteracting=function(){return this.isZooming()||this.isMoving()||this.isRotating()},i.setCenterAndZoom=function(e,o){return!M(o)&&this._zoomLevel!==o?(this.setCenter(e),this.setZoom(o,{animation:!1})):this.setCenter(e),this},i._getPaddingSize=function(e){return e===void 0&&(e={}),e.paddingLeft||e.paddingTop||e.paddingRight||e.paddingBottom?{width:(e.paddingLeft||0)+(e.paddingRight||0),height:(e.paddingTop||0)+(e.paddingBottom||0)}:null},i.getFitZoom=function(e,o,a){var s=this;if(!e||!(e instanceof ge))return this._zoomLevel;if(e.xmin===e.xmax&&e.ymin===e.ymax)return this.getMaxZoom();var l=this.getSize(),h=this._getPaddingSize(a);h&&(l={width:l.width-(h.width||0),height:l.height-(h.height||0)});var u=e.convertTo(function(p){return s.coordToPoint(p)}),f=u.getWidth(),c=u.getHeight(),d=l.width/f,g=l.height/c,v=this.getSpatialReference().getZoomDirection()<0?Math.max(d,g):Math.min(d,g),y=this.getZoomForScale(v,null,o);return y},i.getView=function(){return{center:this.getCenter().toArray(),zoom:this.getZoom(),pitch:this.getPitch(),bearing:this.getBearing()}},i.setView=function(e){return e?(e.center&&this.setCenter(e.center),e.zoom!==null&&!isNaN(+e.zoom)&&this.setZoom(+e.zoom,{animation:!1}),e.pitch!==null&&!isNaN(+e.pitch)&&this.setPitch(+e.pitch),e.pitch!==null&&!isNaN(+e.bearing)&&this.setBearing(+e.bearing),this):this},i.getResolution=function(e){return this._getResolution(e)},i.getScale=function(e){var o=M(e)?this.getZoom():e,a=this._getResolution(this.getMaxNativeZoom()),s=this._getResolution(o);return s/a},i._getCenterByPadding=function(e,o,a){a===void 0&&(a={});var s=this.coordinateToPoint(e,o),l=a,h=l.paddingLeft,u=h===void 0?0:h,f=l.paddingRight,c=f===void 0?0:f,d=l.paddingTop,g=d===void 0?0:d,v=l.paddingBottom,y=v===void 0?0:v,p=0,m=0;(u||c)&&(p=(c-u)/2),(g||y)&&(m=(g-y)/2);var _=new k({x:s.x+p,y:s.y+m});return this.pointToCoordinate(_,o)},i.fitExtent=function(e,o,a,s){if(a===void 0&&(a={}),!e)return this;e=new ge(e,this.getProjection());var l=this.getFitZoom(e,a.isFraction||!1,a)+(o||0),h=e.getCenter();return this._getPaddingSize(a)&&(h=this._getCenterByPadding(h,l,a)),typeof a.animation>"u"||a.animation?this._animateTo({center:h,zoom:l},{duration:a.duration||this.options.zoomAnimationDuration,easing:a.easing||"out"},s):this.setCenterAndZoom(h,l)},i.getBaseLayer=function(){return this._baseLayer},i.setBaseLayer=function(e){var o=!1;if(this._baseLayer&&(o=!0,this._fireEvent("baselayerchangestart"),this._baseLayer.remove()),!e)return delete this._baseLayer,this._fireEvent("baselayerchangeend"),this._fireEvent("setbaselayer"),this;this._baseLayer=e,e._bindMap(this,-1);function a(){this._fireEvent("baselayerload"),o&&(o=!1,this._fireEvent("baselayerchangeend"))}return this._baseLayer.on("layerload",a,this),this._loaded&&this._baseLayer.load(),this._fireEvent("setbaselayer"),this},i.removeBaseLayer=function(){return this._baseLayer&&(this._baseLayer.remove(),delete this._baseLayer,this._fireEvent("baselayerremove")),this},i.getLayers=function(e){return this._getLayers(function(o){return o===this._baseLayer||o.getId().indexOf(Bo)>=0?!1:e?e(o):!0})},i.getLayer=function(e){if(!e)return null;var o=this._layerCache?this._layerCache[e]:null;if(o)return o;var a=this.getBaseLayer();return a&&a.getId()===e?a:null},i.addLayer=function(e){if(!e)return this;if(!Array.isArray(e))return e=Array.prototype.slice.call(arguments,0),this.addLayer(e);this._layerCache||(this._layerCache={});for(var o=this._layers,a=0,s=e.length;a<s;a++){var l=e[a],h=l.getId();if(M(h))throw new Error("Invalid id for the layer: "+h);if(l.getMap()!==this){if(this._layerCache[h])throw new Error("Duplicate layer id in the map: "+h);this._layerCache[h]=l,l._bindMap(this),o.push(l),this._loaded&&l.load()}}return this._sortLayersByZIndex(),this._fireEvent("addlayer",{layers:e}),this},i.removeLayer=function(e){if(!e)return this;if(!Array.isArray(e))return this.removeLayer([e]);for(var o=[],a=0,s=e.length;a<s;a++){var l=e[a];if(l instanceof it||(l=this.getLayer(l)),!!l){var h=l.getMap();if(!(!h||h!==this)){o.push(l),this._removeLayer(l,this._layers),this._loaded&&l._doRemove();var u=l.getId();this._layerCache&&delete this._layerCache[u]}}}if(o.length>0){var f=this.getRenderer();f&&f.setLayerCanvasUpdated(),o.forEach(function(c){c.fire("remove")})}return this._fireEvent("removelayer",{layers:e}),this},i.sortLayers=function(e){if(!e||!Array.isArray(e))return this;for(var o=[],a=Number.MAX_VALUE,s=0,l=e.length;s<l;s++){var h=e[s];if(ie(e[s])&&(h=this.getLayer(h)),!(h instanceof it)||!h.getMap()||h.getMap()!==this)throw new Error("It must be a layer added to this map to order.");h.getZIndex()<a&&(a=h.getZIndex()),o.push(h)}for(var u=0,f=o.length;u<f;u++)o[u].setZIndex(a+u);return this},i.toDataURL=function(e){e||(e={});var o=e.mimeType;o||(o="image/png");var a=e.save,s=this._getRenderer();if(s&&s.toDataURL){var l=e.fileName;l||(l="export");var h=s.toDataURL(o,e.quality||.92);if(a&&h){var u;if(typeof Blob<"u"&&typeof atob<"u"){var f=n1(h.replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,""),o);u=URL.createObjectURL(f)}else u=h;var c=document.createElement("a");c.download=l,c.href=u,document.body.appendChild(c),c.click(),document.body.removeChild(c)}return h}return null},i.coordToPoint=function(e,o,a){return this.coordinateToPoint(e,o,a)},i.coordToPointAtRes=function(e,o,a){return this.coordinateToPointAtRes(e,o,a)},i.pointToCoord=function(e,o,a){return this.pointToCoordinate(e,o,a)},i.pointAtResToCoord=function(e,o,a){return this.pointAtResToCoordinate(e,o,a)},i.coordToViewPoint=function(e,o,a){return this.coordinateToViewPoint(e,o,a)},i.viewPointToCoord=function(e,o){return this.viewPointToCoordinate(e,o)},i.coordToContainerPoint=function(e,o,a){return this.coordinateToContainerPoint(e,o,a)},i.containerPointToCoord=function(e,o){return this.containerPointToCoordinate(e,o)},i.containerPointToViewPoint=function(e,o){return o?o.set(e.x,e.y):o=e.copy(),o._sub(this.getViewPoint())},i.viewPointToContainerPoint=function(e,o){return o?o.set(e.x,e.y):o=e.copy(),o._add(this.getViewPoint())},i.checkSize=function(e){var o=ve()-this._initTime<1500&&this.width===0||this.height===0,a=this._getContainerDomSize(),s=this.height,l=this.width;if(!e&&a.width===l&&a.height===s)return this;rl(this._containerDOM);var h=this.getCenter();if(this.options.fixCenterOnResize)this._updateMapSize(a);else{var u=this._getVisualHeight(this.getPitch()),f=new k(0,this.height-u),c=this._containerPointToPrj(f);this._updateMapSize(a);var d=this._getVisualHeight(this.getPitch()),g=new k(0,this.height-d);this._setPrjCoordAtContainerPoint(c,g),this._mapViewCoord=this._getPrjCenter()}var v=a.width===0||a.height===0||l===0||s===0;return(o||v)&&(this._eventSilence=!0,this.setCenter(h),delete this._eventSilence),this._fireEvent("resize"),this},i.locate=function(e,o,a){return this.getProjection()._locate(new z(e),o,a)},i.getMainPanel=function(){return this._getRenderer().getMainPanel()},i.getPanels=function(){return this._panels},i.remove=function(){var e=this;if(this.isRemoved())return this;this._fireEvent("removestart"),this._removeDomEvents(),this._clearHandlers(),this.removeBaseLayer();for(var o=this.getLayers(),a=0;a<o.length;a++)o[a].remove();return this._getRenderer()&&this._getRenderer().remove(),this._containerDOM.childNodes&&this._containerDOM.childNodes.length>0&&Array.prototype.slice.call(this._containerDOM.childNodes,0).filter(function(s){return s.className==="maptalks-wrapper"}).forEach(function(s){return e._containerDOM.removeChild(s)}),delete this._panels,delete this._containerDOM,delete this.renderer,this._fireEvent("removeend"),this._clearAllListeners(),K.removeDPRListening&&K.removeDPRListening(this),this},i.isRemoved=function(){return!this._containerDOM},i.isMoving=function(){return!!this._moving},i.onMoveStart=function(e){this._mapAnimPlayer&&this._stopAnim(this._mapAnimPlayer);var o=this._getPrjCenter();(!this._originCenter||this._verifyExtent(o))&&(this._originCenter=o),this._moving=!0,this._trySetCursor("move"),this._fireEvent("movestart",this._parseEvent(e?e.domEvent:null,"movestart"))},i.onMoving=function(e){this._fireEvent("moving",this._parseEvent(e?e.domEvent:null,"moving"))},i.onMoveEnd=function(e){if(this._moving=!1,this._suppressRecenter||this._recenterOnTerrain(),this._trySetCursor("default"),this._fireEvent("moveend",e&&e.domEvent?this._parseEvent(e.domEvent,"moveend"):e),!this._verifyExtent(this._getPrjCenter())&&this._originCenter){var o=this._originCenter;this._panTo(o)}},i.onDragRotateStart=function(e){this._dragRotating=!0,this._fireEvent("dragrotatestart",this._parseEvent(e?e.domEvent:null,"dragrotatestart"))},i.onDragRotating=function(e){this._fireEvent("dragrotating",this._parseEvent(e?e.domEvent:null,"dragrotating"))},i.onDragRotateEnd=function(e){this._dragRotating=!1,this._fireEvent("dragrotateend",this._parseEvent(e?e.domEvent:null,"dragrotateend"))},i.isDragRotating=function(){return!!this._dragRotating},i.isOffscreen=function(e,o){o===void 0&&(o=0);var a=this.width,s=this.height,l=a+o,h=s+o,u=e.xmin,f=e.ymin,c=e.xmax,d=e.ymax;return Array.isArray(e)&&(u=e[0],f=e[1],c=e[2],d=e[3]),c<o||u>=l||d<o||f>h},i.getRenderer=function(){return this._getRenderer()},i.getDevicePixelRatio=function(){return this.options.devicePixelRatio||K.devicePixelRatio||1},i.setDevicePixelRatio=function(e){return V(e)&&e>0&&e!==this.options.devicePixelRatio&&(this.options.devicePixelRatio=e,this.checkSize(!0)),this},i._initContainer=function(e){if(ie(e)){if(this._containerDOM=document.getElementById(e),!this._containerDOM)throw new Error("Invalid container when creating map: '"+e+"'")}else this._containerDOM=e,Fe&&(this.CanvasClass=this._containerDOM.constructor);if(this._containerDOM.childNodes&&this._containerDOM.childNodes.length>0&&this._containerDOM.childNodes[0].className==="maptalks-wrapper")throw new Error("Container is already loaded with another map instance, use map.remove() to clear it.")},i._trySetCursor=function(e){return!this._cursor&&!this._priorityCursor&&(e||(e="default"),this._setCursorToPanel(e)),this},i._setPriorityCursor=function(e){if(e)this._priorityCursor=e,this._setCursorToPanel(e);else{var o=!1;this._priorityCursor&&(o=!0),delete this._priorityCursor,o&&this.setCursor(this._cursor)}return this},i._setCursorToPanel=function(e){var o=this.getMainPanel();o&&o.style&&o.style.cursor!==e&&(o.style.cursor=e)},i._removeLayer=function(e,o){if(!(!e||!o)){var a=o.indexOf(e);a>-1&&o.splice(a,1)}},i._sortLayersByZIndex=function(){if(this._layers){for(var e=0,o=this._layers.length;e<o;e++)this._layers[e]._order=e,this._layers[e].sortLayersByZIndex&&this._layers[e].sortLayersByZIndex();this._layers.sort(function(a,s){var l=a.getZIndex()-s.getZIndex();return l===0?a._order-s._order:l})}},i._fireEvent=function(e,o){if(!this._eventSilence){var a="_";e[0]!==a&&this.fire(a+e,o),this.fire(e,o)}},i._Load=function(){this._resetMapStatus(),this.options.pitch&&(this.setPitch(this.options.pitch),delete this.options.pitch),this.options.bearing&&(this.setBearing(this.options.bearing),delete this.options.bearing),delete this._glRes,this._loadAllLayers(),this._getRenderer().onLoad(),this._loaded=!0,this._callOnLoadHooks(),this._initTime=ve()},i._initRenderer=function(){var e=this.options.renderer,o=t.getRendererClass(e);this._renderer=new o(this),this._renderer.load()},i._getRenderer=function(){return this._renderer},i._loadAllLayers=function(){function e(o){o&&o.load()}this._baseLayer&&this._baseLayer.load(),this._eachLayer(e,this.getLayers())},i._getLayers=function(e){for(var o=this._baseLayer?[this._baseLayer].concat(this._layers):this._layers,a=[],s=0;s<o.length;s++)(!e||e.call(this,o[s]))&&a.push(o[s]);return a},i._eachLayer=function(e){if(!(arguments.length<2)){var o=Array.prototype.slice.call(arguments,1);o&&!Array.isArray(o)&&(o=[o]);for(var a=[],s=0,l=o.length;s<l;s++)a=a.concat(o[s]);for(var h=0,u=a.length;h<u;h++)e.call(e,a[h])}},i._onLayerEvent=function(e){e&&e.type==="idchange"&&(delete this._layerCache[e.old],this._layerCache[e.new]=e.target)},i._resetMapStatus=function(){var e=this.getMaxZoom(),o=this.getMinZoom(),a=this._spatialReference.getMaxZoom(),s=this._spatialReference.getMinZoom();(M(e)||e===-1||e>a)&&this.setMaxZoom(a),(M(o)||o===-1||o<s)&&this.setMinZoom(s),e=this.getMaxZoom(),o=this.getMinZoom(),e<o&&this.setMaxZoom(o),(M(this._zoomLevel)||this._zoomLevel>e)&&(this._zoomLevel=e),this._zoomLevel<o&&(this._zoomLevel=o),delete this._prjCenter;var l=this.getProjection();this._prjCenter=l.project(this._center),this._calcMatrices();var h=this._getRenderer();h&&h.resetContainer()},i._getContainerDomSize=function(){if(!this._containerDOM)return null;var e=this._containerDOM,o,a;if(this._containerDomContentRect)return o=this._containerDomContentRect.width,a=this._containerDomContentRect.height,new Ae(o,a);if(!M(e.width)&&!M(e.height)){o=e.width,a=e.height;var s=this.getDevicePixelRatio();s!==1&&e.layer&&(o/=s,a/=s)}else if(!M(e.clientWidth)&&!M(e.clientHeight))o=parseInt(e.clientWidth,0),a=parseInt(e.clientHeight,0);else throw new Error("can not get size of container");return new Ae(o,a)},i._updateMapSize=function(e){return this.width=e.width,this.height=e.height,this._getRenderer().updateMapSize(e),this._calcMatrices(),this},i._getPrjCenter=function(){return this._prjCenter},i._setPrjCenter=function(e){this._prjCenter=e,this.isInteracting()&&!this.isMoving()&&(this._mapViewCoord=e),this._calcMatrices()},i._setPrjCoordAtContainerPoint=function(e,o){if(!this.centerAltitude&&o.x===this.width/2&&o.y===this.height/2)return this;var a=this._containerPointToPoint(o)._sub(this._prjToPoint(this._getPrjCenter())),s=this._pointToPrj(this._prjToPoint(e).sub(a));return this._setPrjCenter(s),this},i._verifyExtent=function(e){if(!e)return!1;var o=this._prjMaxExtent;return o?o.contains(e):!0},i._offsetCenterByPixel=function(e){var o=_g.set(this.width/2-e.x,this.height/2-e.y),a=this._containerPointToPrj(o,W_),s=_g.set(this.width/2,this.height/2);this._setPrjCoordAtContainerPoint(a,s)},i.offsetPlatform=function(e){return e?(this._getRenderer().offsetPlatform(e),this._mapViewCoord=this._getPrjCenter(),this._mapViewPoint=this._mapViewPoint.add(e),this):this._mapViewPoint},i.getViewPoint=function(){var e=this._getViewPointFrameOffset(),o=this.offsetPlatform();return e&&(o=o.add(e)),o},i._resetMapViewPoint=function(){this._mapViewPoint=new k(0,0),this._mapViewCoord=this._getPrjCenter()},i._getResolution=function(e){return(e===void 0||e===this._zoomLevel)&&this._mapRes!==void 0?this._mapRes:(M(e)&&(e=this._zoomLevel),this._spatialReference.getResolution(e))},i._getResolutions=function(){return this._spatialReference.getResolutions()},i._prjToPoint=function(e,o,a){o=M(o)?this.getZoom():o;var s=this._getResolution(o);return this._prjToPointAtRes(e,s,a)},i._prjToPointAtRes=function(e,o,a){return this._spatialReference.getTransformation().transform(e,o,a)},i._prjsToPointsAtRes=function(e,o,a){a===void 0&&(a=[]);for(var s=this._spatialReference.getTransformation(),l=[],h=0,u=e.length;h<u;h++){var f=s.transform(e[h],o,a[h]);l.push(f)}return l},i._pointToPrj=function(e,o,a){o=M(o)?this.getZoom():o;var s=this._getResolution(o);return this._pointToPrjAtRes(e,s,a)},i._pointToPrjAtRes=function(e,o,a){return this._spatialReference.getTransformation().untransform(e,o,a)},i._pointToPoint=function(e,o,a){return M(o)?(a?(a.x=e.x,a.y=e.y):a=e.copy(),a):this._pointAtResToPoint(e,this._getResolution(o),a)},i._pointAtResToPoint=function(e,o,a){return a?(a.x=e.x,a.y=e.y):a=e.copy(),a._multi(o/this._getResolution())},i._pointToPointAtRes=function(e,o,a){return a?(a.x=e.x,a.y=e.y):a=e.copy(),a._multi(this._getResolution()/o)},i._containerPointToPrj=function(e,o){return this._pointToPrj(this._containerPointToPoint(e,void 0,o),void 0,o)},i._callOnLoadHooks=function(){var e=t.prototype;if(e._onLoadHooks)for(var o=0,a=e._onLoadHooks.length;o<a;o++)e._onLoadHooks[o].call(this)},i._fixPrjOnWorldWide=function(e){var o=this.getProjection();if(o&&o.fullExtent&&e){var a=o.fullExtent||{},s=a.left,l=a.bottom,h=a.top,u=a.right;V(s)&&(e.x=Math.max(s,e.x)),V(u)&&(e.x=Math.min(u,e.x)),V(l)&&(e.y=Math.max(l,e.y)),V(h)&&(e.y=Math.min(h,e.y))}return this},t}(Xf(Cr(g_(zt))));Q.include({coordinateToPoint:function(t,i,n){var e=this._getResolution(i);return this.coordinateToPointAtRes(t,e,n)},coordinateToPointAtRes:function(){var r=new z(0,0);return function(t,i,n){var e=this.getProjection().project(t,r);return this._prjToPointAtRes(e,i,n)}}(),pointToCoordinate:function(){var r=new z(0,0);return function(t,i,n){var e=this._pointToPrj(t,i,r);return this.getProjection().unproject(e,n)}}(),pointAtResToCoordinate:function(){var r=new z(0,0);return function(t,i,n){var e=this._pointToPrjAtRes(t,i,r);return this.getProjection().unproject(e,n)}}(),coordinateToViewPoint:function(){var r=new z(0,0);return function(t,i,n){return this._prjToViewPoint(this.getProjection().project(t,r),i,n)}}(),viewPointToCoordinate:function(){var r=new z(0,0);return function(t,i){return this.getProjection().unproject(this._viewPointToPrj(t,r),i)}}(),coordinateToContainerPoint:function(t,i,n){var e=this._getResolution(i);return this.coordinateToContainerPointAtRes(t,e,n)},coordinateToContainerPointAtRes:function(){var r=new z(0,0);return function(t,i,n){var e=this.getProjection().project(t,r);return this._prjToContainerPointAtRes(e,i,n)}}(),coordinatesToContainerPoints:function(t,i){var n=this._getResolution(i);return this.coordinatesToContainerPointsAtRes(t,n)},coordinatesToContainerPointsAtRes:function(){return function(r,t){for(var i=[],n=this._spatialReference.getTransformation(),e=t/this._getResolution(),o=this.getProjection(),a=new z(0,0),s=this.isTransforming(),l=this._prjToPoint(this._getPrjCenter(),void 0,W_),h=0,u=r.length;h<u;h++){var f=o.project(r[h],a),c=n.transform(f,t);c=c._multi(e),this._toContainerPoint(c,s,r[h].z,l),i.push(c)}return i}}(),containerPointToCoordinate:function(){var r=new z(0,0);return function(t,i){var n=this._containerPointToPrj(t,r);return this.getProjection().unproject(n,i)}}(),containerToExtent:function(){var r=new k(0,0),t=new k(0,0);return function(i){var n=new ee(this._containerPointToPoint(i.getMin(r),void 0,r),this._containerPointToPoint(i.getMax(t),void 0,t));return this._pointToExtent(n)}}(),distanceToPixel:function(){var r=new k(0,0),t=new k(0,0);return function(i,n,e){var o=this.getProjection();if(!o)return null;var a=this.getScale()/this.getScale(e),s=this.getCenter(),l=o.locate(s,i,n),h=this.coordToContainerPoint(s,void 0,r),u=this.coordToContainerPoint(l,void 0,t);return u._sub(h)._multi(a)._abs(),new Ae(u.x,u.y)}}(),distanceToPoint:function(t,i,n,e){var o=this._getResolution(n);return this.distanceToPointAtRes(t,i,o,e)},distanceToPointAtRes:function(){var r=new k(0,0),t=new z(0,0);return function(i,n,e,o,a){var s=this.getProjection();if(!s)return null;var l=o||this.getCenter(),h=s.locate(l,i,n,t),u=this.coordToPointAtRes(l,e,r),f=this.coordToPointAtRes(h,e,a);return f._sub(u)._abs(),f}}(),altitudeToPoint:function(){var r=new z(0,40),t=new k(0,0);return function(i,n,e){i===void 0&&(i=0);var o=this.distanceToPointAtRes(i,i,n,e||r,t);i<0&&o.x>0&&(o.x=-o.x);var a=this.options.heightFactor;return a&&a!==1&&(o.x*=a,o.y*=a),o.x}}(),pointAtResToAltitude:function(){var r=new z(0,40);return function(t,i,n){t===void 0&&(t=0);var e=this.pointAtResToDistance(t,0,i,n||r);return e}}(),pixelToDistance:function(){var r=new z(0,0),t=new z(0,0),i=new z(0,0),n=new z(0,0);return function(e,o){var a=this.getProjection();if(!a)return null;var s=this.getFullExtent(),l=s.top>s.bottom?-1:1,h=r.set(this.width/2,this.height/2),u=t.set(this.width/2+e,this.height/2+l*o),f=this.containerPointToCoord(h,i),c=this.containerPointToCoord(u,n);return a.measureLength(f,c)}}(),pointToDistance:function(t,i,n){var e=this.getResolution(n);return this.pointAtResToDistance(t,i,e)},pointAtResToDistance:function(){var r=new k(0,0),t=new z(0,0),i=new z(0,0),n=new z(0,0);return function(e,o,a,s){var l=this.getProjection();if(!l)return null;var h=s?l.project(s,t):this._getPrjCenter(),u=this._prjToPointAtRes(h,a,r);u._add(e,o);var f=this.pointAtResToCoord(u,a,i),c=s||l.unproject(h,n);return l.measureLength(c,f)}}(),locateByPoint:function(){var r=new k(0,0);return function(t,i,n){var e=this.coordToContainerPoint(t,void 0,r);return this.containerPointToCoord(e._add(i,n))}}(),_get2DExtent:function(t,i){var n;if((t===void 0||t===this._zoomLevel)&&this._mapExtent2D&&(n=this._mapExtent2D),n)return i?(i.set(n.xmin,n.ymin,n.xmax,n.ymax),i):n.copy();var e=this._getResolution(t);return this._get2DExtentAtRes(e,i)},_get2DExtentAtRes:function(){var r=new k(0,0);return function(t,i){var n=this;if(t===this._mapGlRes&&this._mapGlExtent2D)return this._mapGlExtent2D;var e=this.getContainerExtent();return e.convertTo(function(o){return n._containerPointToPointAtRes(o,t,r)},i)}}(),_pointToExtent:function(){var r=new z(0,0),t=new z(0,0);return function(i){var n=i.getMin(),e=i.getMax(),o=this.getFullExtent(),a=!o||o.left<=o.right?[n.x,e.x]:[e.x,n.x],s=a[0],l=a[1],h=!o||o.top>o.bottom?[e.y,n.y]:[n.y,e.y],u=h[0],f=h[1],c=n.set(s,f),d=e.set(l,u);return new ge(this.pointToCoord(c,void 0,r),this.pointToCoord(d,void 0,t),this.getProjection())}}(),_getViewPointFrameOffset:function(){var r=new k(0,0);return function(){if(this.isZooming())return null;var t=this._getPrjCenter();return this._mapViewCoord&&!this._mapViewCoord.equals(t)?this._prjToContainerPoint(this._mapViewCoord)._sub(this._prjToContainerPoint(t,void 0,r)):null}}(),_viewPointToPrj:function(){var r=new k(0,0);return function(t,i){return this._containerPointToPrj(this.viewPointToContainerPoint(t,r),i)}}(),_prjToContainerPoint:function(t,i,n,e){var o=this._getResolution(i);return this._prjToContainerPointAtRes(t,o,n,e)},_prjToContainerPointAtRes:function(){var r=new k(0,0);return function(t,i,n,e){return this._pointAtResToContainerPoint(this._prjToPointAtRes(t,i,r),i,e||0,n)}}(),_prjToViewPoint:function(){var r=new k(0,0);return function(t,i,n){var e=this._prjToContainerPoint(t,void 0,r,n);return this.containerPointToViewPoint(e,i)}}(),_viewPointToPoint:function(){var r=new k(0,0);return function(t,i,n){return this._containerPointToPoint(this.viewPointToContainerPoint(t,r),i,n)}}(),_pointToViewPoint:function(){var r=new z(0,0);return function(t,i,n){return this._prjToViewPoint(this._pointToPrj(t,i,r),n)}}()});Q.mergeOptions($C);var XC=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.addHooks=function(){this.target&&this.target.on("_dblclick",this._onDoubleClick,this)},i.removeHooks=function(){this.target&&this.target.off("_dblclick",this._onDoubleClick,this)},i._onDoubleClick=function(e){var o=this.target;if(o.options.doubleClickZoom){var a=o.getZoom(),s=e.domEvent.shiftKey?Math.ceil(a)-1:Math.floor(a)+1;o._zoomAnimation(s,e.containerPoint)}},t}(Xt);Q.mergeOptions({doubleClickZoom:!0});Q.addOnLoadHook("addHandler","doubleClickZoom",XC);var JC=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.addHooks=function(){var e=this.target;if(e){var o=e._panels.mapWrapper||e._containerDOM;this._dragHandler=new Wo(o,{cancelOn:this._cancelOn.bind(this),rightclick:!0}),this._dragHandler.on("mousedown",this._onMouseDown,this).on("dragstart",this._onDragStart,this).on("dragging",this._onDragging,this).on("dragend",this._onDragEnd,this).enable()}},i.removeHooks=function(){this._dragHandler.off("mousedown",this._onMouseDown,this).off("dragstart",this._onDragStart,this).off("dragging",this._onDragging,this).off("dragend",this._onDragEnd,this),this._dragHandler.remove(),delete this._dragHandler},i._cancelOn=function(e){return!!(this.target.isZooming()||this._ignore(e))},i._ignore=function(e){return e?(e.domEvent&&(e=e.domEvent),this.target._ignoreEvent(e)):!1},i._onMouseDown=function(e){delete this.startDragTime,delete this._mode;var o=this.target.options.switchDragButton,a=o?0:2,s=e.domEvent.type==="touchstart",l=o&&s||e.domEvent.button===a||e.domEvent.ctrlKey;l?(this.target.options.dragRotate||this.target.options.dragPitch)&&(this._mode="rotatePitch"):this.target.options.dragPan&&(this._mode="move"),this.target._stopAnim(this.target._mapAnimPlayer),yr(e.domEvent)},i._onDragStart=function(e){this.startDragTime=ve(),this._mode==="move"?this._moveStart(e):this._mode==="rotatePitch"&&this._rotateStart(e)},i._onDragging=function(e){var o=this.target;o._isEventOutMap(e.domEvent)||(this._mode==="move"?this._moving(e):this._mode==="rotatePitch"&&this._rotating(e))},i._onDragEnd=function(e){this._mode==="move"?this._moveEnd(e):this._mode==="rotatePitch"&&this._rotateEnd(e),delete this.startDragTime,delete this.startBearing},i._start=function(e){this.preX=e.mousePos.x,this.preY=e.mousePos.y,this.startX=this.preX,this.startY=this.preY,this._startPrjCenter=this.target._getPrjCenter().copy()},i._moveStart=function(e){this._start(e);var o=this.target;o.onMoveStart(e);var a=_t(o._getActualEvent(e.domEvent),o.getContainer());this.startPrjCoord=o._containerPointToPrj(a)},i._moving=function(e){if(this.startDragTime){var o=this.target,a=_t(o._getActualEvent(e.domEvent),o.getContainer());o._setPrjCoordAtContainerPoint(this.startPrjCoord,a),o.onMoving(e)}},i._moveEnd=function(e){if(this.startDragTime){var o=e.domEvent.type==="touchend",a=this.target,s=ve()-this.startDragTime,l=e.mousePos.x,h=e.mousePos.y,u=l-this.startX,f=h-this.startY,c=a._getPrjCenter(),d=c.sub(this._startPrjCenter);if(this._clear(),a.options.panAnimation&&!e.interupted&&a._verifyExtent(a._getPrjCenter())&&s<280&&Math.abs(f)+Math.abs(u)>5){s=5*s;var g=o?5:2.8,v=c.add(d._multi(g));a._panTo(v,{duration:o?s*3:s*2,easing:"outExpo"})}else a.onMoveEnd(e)}},i._rotateStart=function(e){this._start(e),delete this._rotateMode,this.startBearing=this.target.getBearing(),this.target.onDragRotateStart(e),this._db=0},i._rotating=function(e){var o=this.target,a=e.mousePos.x,s=e.mousePos.y,l=o.getPitch(),h=o.getBearing(),u=Math.abs(a-this.preX),f=Math.abs(s-this.preY);if(this._rotateMode||(o.options.dragRotatePitch?this._rotateMode="rotate_pitch":u>f?this._rotateMode="rotate":u<f?this._rotateMode="pitch":this._rotateMode="rotate"),!(this._rotateMode==="pitch"&&l===0&&f<10)){if(this._rotateMode.indexOf("rotate")>=0&&o.options.dragRotate){var c=.15,d=0;o.options.dragPitch||u>f?d=-c*(this.preX-a):a>o.width/2?d=c*(this.preY-s):d=-c*(this.preY-s);var g=o.getBearing()+d;this._db=this._db||0,this._db+=d,o._setBearing(g)}this._rotateMode.indexOf("pitch")>=0&&o.options.dragPitch&&o._setPitch(o.getPitch()+(this.preY-s)*.15),this.preX=a,this.preY=s,(o.getBearing()!==h||o.getPitch()!==l)&&o.onDragRotating(e)}},i._rotateEnd=function(e){var o=this.target,a=o.getBearing();this._clear();var s=ve()-this.startDragTime;if(o.onDragRotateEnd(e),o.options.rotateAnimation&&Math.abs(a-this.startBearing)>20&&(this._rotateMode==="rotate"||this._rotateMode==="rotate_pitch")&&!e.interupted&&s<400){var l=o.getBearing();o._animateTo({bearing:l+this._db/1.5},{easing:"outQuint",duration:1600})}},i._clear=function(){delete this.startPrjCoord,delete this.preX,delete this.preY,delete this.startX,delete this.startY},t}(Xt);Q.mergeOptions({draggable:!0,dragPan:!0,dragRotatePitch:!0,dragRotate:!0,dragPitch:!0});Q.addOnLoadHook("addHandler","draggable",JC);var wg="mousedown mouseup mousemove click dblclick contextmenu touchstart touchmove touchend mouseout",YC={mousemove:["mousemove","mouseover","mouseout","mouseenter"],touchend:["touchend","click"]},Ea=function(t){return t&&t.getLayer&&t.on&&t.fire},xg=function(t){return t._getInternalId?t._getInternalId():t.getId?t.getId():null},Ri=function(t,i,n){if(t._onEvent)return t._onEvent(i,n);var e=t.getLayer();return e&&e.fireGeoEvent?e.fireGeoEvent(t,i,n):null},QC=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.addHooks=function(){var e=this.target,o=e._panels.allLayers||e._containerDOM;Pe(o,wg,this._identifyGeometryEvents,this)},i.removeHooks=function(){var e=this.target,o=e._panels.allLayers||e._containerDOM;Re(o,wg,this._identifyGeometryEvents)},i._identifyGeometryEvents=function(e,o){var a=this.target;if(a.isInteracting()||a._ignoreEvent(e))return;var s=null,l=o||e.type,h=l==="mousedown"||l==="touchstart"&&e.touches&&e.touches.length===1;if(h)this._mouseDownTime=ve();else if((l==="click"||l==="touchend")&&this._mouseDownTime){var u=this._mouseDownTime;delete this._mouseDownTime;var f=ve();if(f-u>300){if(l==="click")return}else l==="touchend"&&(s="click")}var c=e.touches&&e.touches.length>0?e.touches[0]:e.changedTouches&&e.changedTouches.length>0?e.changedTouches[0]:e;if(!c)return;var d=_t(c,a._containerDOM);l==="touchstart"&&a.options.preventTouch&&yr(e);for(var g=null,v=this.target.getRenderer().getTopElements(),y=h&&e.button!==2,p=0;p<v.length;p++)if(v[p].hitTest(d)){var m=v[p].options.cursor;if(m&&(g=m),y||v[p].events&&v[p].events.indexOf(l)>=0){var _={target:a,type:l,domEvent:e,containerPoint:d};if(y){a._setPriorityCursor(g),v[p].mousedown(_);return}else v[p].onEvent(_)}}var w=a._getLayers(function(S){return!!(S.identify&&S.options.geometryEvents)});if(a._setPriorityCursor(g),!w.length)return;var C=YC[l]||[l],x={includeInternals:!0,filter:function(E){if(E instanceof ae){var D=E._getEventTypeToFire(e);if(l==="mousemove"){if(!g&&E.options.cursor&&(g=E.options.cursor),!E.listens("mousemove")&&!E.listens("mouseover")&&!E.listens("mouseenter"))return!1}else if(!E.listens(D)&&!E.listens(s))return!1;return!0}else if(Ea(E))return!0;return!1},count:1,onlyVisible:a.options.onlyVisibleGeometryEvents,containerPoint:d,layers:w,eventTypes:C,domEvent:e},T=P.bind(this);Ym(l)?this._queryIdentifyTimeout=a.getRenderer().callInNextFrame(function(){a.isInteracting()||a.identifyAtPoint(x,T)}):a.identifyAtPoint(x,T);function P(S){var E=this,D=!0,A=function(){var X=E._prevOverGeos&&E._prevOverGeos.geos;return X||[]},I=function(X,ne){if(X===void 0&&(X=[]),ne===void 0&&(ne={}),X&&X.length>0)for(var te=X.length-1;te>=0;te--){var J=X[te];if(Ea(J)){var q=xg(X[te]);ne[q]||(D=Ri(J,e,"mouseout"))}}};if(l==="mouseout"){var L=A();this._prevOverGeos={geos:[],geomap:{}},I(L,{})}else if(l==="mousemove"){var O={};if(S.length>0)for(var H=S.length-1;H>=0;H--){var B=S[H];if(Ea(B)){var R=xg(B);O[R]=B,Ri(B,e),(!this._prevOverGeos||!this._prevOverGeos.geomap[R])&&Ri(B,e,"mouseenter"),D=Ri(B,e,"mouseover")}}a._setPriorityCursor(g);var b=A();this._prevOverGeos={geos:S,geomap:O},I(b,O)}else{if(!S||!S.length)return;for(var N=S.length-1;N>=0;N--)if(Ea(S[N])){D=Ri(S[N],e),s&&Ri(S[N],e,s);break}}D===!1&&wt(e)}},t}(Xt);Q.mergeOptions({geometryEvents:!0,onlyVisibleGeometryEvents:!0});Q.addOnLoadHook("addHandler","geometryEvents",QC);var Cg=4.000244140625,qC=1/100,KC=1/450,eP=2,tP=function(r){F(t,r);function t(n){var e;return e=r.call(this,n)||this,e._thisScrollZoom=e._scrollZoom.bind(Ie(Ie(e))),e._wheelZoomRate=KC,e._defaultZoomRate=qC,e._delta=0,e}var i=t.prototype;return i.addHooks=function(){ir(this.target._containerDOM,"wheel",this._onWheelScroll,this)},i.removeHooks=function(){dr(this.target._containerDOM,"wheel",this._onWheelScroll)},i._onWheelScroll=function(e){var o=this.target;if(o.options.preventWheelScroll&&(yr(e),wt(e)),o._ignoreEvent(e)||!o.options.zoomable)return!1;var a=o._containerDOM,s=o._checkZoomOrigin(_t(e,a));return o.options.seamlessZoom?(this._zooming||(this._trackPadSuspect=0,this._ensureTrackpad=!1),this._seamless(e,s)):this._interval(e,s)},i._seamless=function(e,o){var a=e.deltaMode===window.WheelEvent.DOM_DELTA_LINE?e.deltaY*60:e.deltaY;if(a%Cg!==0&&(this._ensureTrackpad||(Math.abs(a)<60?this._trackPadSuspect++:this._trackPadSuspect=0,this._trackPadSuspect>=2&&(this._ensureTrackpad=!0)),this._ensureTrackpad&&(a*=14)),e.shiftKey&&a&&(a=a/4),this._lastWheelEvent=e,this._delta-=a,!this._zooming&&this._delta){var s=this.target;this._zoomOrigin=o,s.onZoomStart(null,o)}this._start()},i._start=function(){if(this._delta){this._zooming=!0;var e=this.target;this._active||(e.getRenderer().callInNextFrame(this._thisScrollZoom),this._active=!0)}},i._scrollZoom=function(){var e=this;if(this._active=!1,!!this._delta){var o=Math.abs(this._delta)>Cg?this._wheelZoomRate:this._defaultZoomRate,a=eP/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&a!==0&&(a=1/a);var s=this.target,l=s.getZoom(),h=s.getZoomForScale(a,l,!0);this._delta=0,s.onZooming(h,this._zoomOrigin),this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(function(){e._zooming=!1,delete e._timeout,s.onZoomEnd(s.getZoom(),e._zoomOrigin)},210)}},i._interval=function(e,o){var a=this,s=this.target;if(this._zooming)return this._requesting++,!1;this._requesting=0;var l=(e.deltaY?e.deltaY*-1:e.wheelDelta?e.wheelDelta:e.detail)>0?1:-1;e.detail&&(l*=-1);var h=s.getZoom(),u=h+l;if(u=s._checkZoom(l>0?Math.ceil(u):Math.floor(u)),u===h)return!1;this._zooming=!0,this._delta||(s.onZoomStart(null,o),this._origin=o,this._delta=l,this._startZoom=s.getZoom());var f=90;return s._animateTo({zoom:u-this._delta*1/2,around:this._origin},{continueOnViewChanged:!0,easing:"linear",duration:f,wheelZoom:!0},function(c){if(c.state.playState!=="finished"){c.state.playState!=="running"&&(delete a._zooming,delete a._requesting);return}a._requesting<1||Math.abs(u-a._startZoom)>2||u===s.getMaxZoom()||u===s.getMinZoom()?(s._animateTo({zoom:u,around:a._origin},{continueOnViewChanged:!0,duration:100},function(d){d.state.playState!=="running"&&(delete a._zooming,delete a._requesting)}),delete a._startZoom,delete a._origin,delete a._delta,a._requesting=0):M(a._requesting)||(delete a._zooming,a._onWheelScroll(e))}),!1},t}(Xt);Q.mergeOptions({scrollWheelZoom:!0,seamlessZoom:!0});Q.addOnLoadHook("addHandler","scrollWheelZoom",tP);var rP=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.addHooks=function(){ir(this.target.getContainer(),"touchstart",this._onTouchStart,this)},i.removeHooks=function(){dr(this.target.getContainer(),"touchstart",this._onTouchStart)},i._onTouchStart=function(e){var o=this.target;if(!(!e.touches||e.touches.length<2)){var a=o.getContainer(),s=_t(e.touches[0],a),l=_t(e.touches[1],a);this.preY=s.y,this._startP1=s,this._startP2=l,this._startDist=s.distanceTo(l),this._startVector=s.sub(l),this._startZoom=o.getZoom(),this._startBearing=o.getBearing(),Re(document,"touchmove",this._onTouchMove),Re(document,"touchend",this._onTouchEnd),ir(document,"touchmove",this._onTouchMove,this),ir(document,"touchend",this._onTouchEnd,this),o.options.preventTouch&&yr(e),o._fireEvent("touchactstart")}},i._onTouchMove=function(e){var o=this.target;if(!(!e.touches||e.touches.length<2)){var a=o.getContainer(),s=_t(e.touches[0],a),l=_t(e.touches[1],a),h=s.sub(this._startP1),u=l.sub(this._startP2),f=s.sub(l),c=s.distanceTo(l)/this._startDist,d=f.angleWith(this._startVector)*180/Math.PI,g=this.preY||s.y,v=(g-s.y)*.4;this.preY=s.y;var y={domEvent:e,mousePos:[s,l]};if(this.mode||(o.options.touchRotate&&Math.abs(d)>8?this.mode=o.options.touchZoomRotate?"rotate_zoom":"rotate":o.options.touchPitch&&h.y*u.y>0&&Math.abs(h.y)>10&&Math.abs(u.y)>10?this.mode="pitch":o.options.zoomable&&o.options.touchZoom&&Math.abs(1-c)>.15&&(this.mode=o.options.touchZoomRotate&&o.options.touchRotate?"rotate_zoom":"zoom"),this._startTouching(y)),this.mode==="zoom"||this.mode==="rotate_zoom"){this._scale=c;var p=o._getResolution(this._startZoom)/c,m=o.getZoomFromRes(p);o.onZooming(m,this._Origin)}this.mode==="rotate"||this.mode==="rotate_zoom"?(o._setBearing(this._startBearing+d),o.onDragRotating(y)):this.mode==="pitch"&&(o._setPitch(o.getPitch()+v),o.onDragRotating(y)),o._fireEvent("touchactinging")}},i._startTouching=function(e){var o=this.target;if(this.mode==="zoom"||this.mode==="rotate_zoom"){var a=o.getSize();this._Origin=new k(a.width/2,a.height/2),o.onZoomStart(null,this._Origin)}(this.mode==="rotate"||this.mode==="pitch"||this.mode==="rotate_zoom")&&o.onDragRotateStart(e)},i._onTouchEnd=function(e){delete this.preY;var o=this.target;if(Re(document,"touchmove",this._onTouchMove),Re(document,"touchend",this._onTouchEnd),this.mode==="zoom"||this.mode==="rotate_zoom"){var a=this._scale,s=o._getResolution(this._startZoom)/a,l=o.getZoomFromRes(s);o.onZoomEnd(l,this._Origin)}(this.mode==="pitch"||this.mode==="rotate"||this.mode==="rotate_zoom")&&o.onDragRotateEnd({domEvent:e}),delete this.mode,o._fireEvent("touchactend")},t}(Xt);Q.mergeOptions({touchGesture:!0,touchZoom:!0,touchPitch:!0,touchRotate:!0,touchZoomRotate:!1});Q.addOnLoadHook("addHandler","touchGesture",rP);var ka="__anim_player",ln={outExpo:function(t){return t===1?1:1-Math.pow(2,-10*t)},outQuint:function(t){return 1-Math.pow(1-t,5)},in:function(t){return Math.pow(t,2)},out:function(t){return 1-ln.in(1-t)},inAndOut:function(t){return 3*t*t-2*t*t*t},linear:function(t){return t},upAndDown:function(t){return t<.5?ln.inAndOut(2*t):1-ln.inAndOut(2*(t-.5))}},iP=function(){function r(t,i){this.state=t,this.styles=i}return Qx(r,[{key:"playState",get:function(){return this.state.playState}},{key:"symbol",get:function(){return this.styles.symbol}}]),r}(),V_=function(t,i,n,e){this._animation=t,this.options=i,this._onFrame=n,this.playState="idle",this.ready=!0,this.finished=!1,this.target=e},Ge={speed:{slow:2e3,normal:1e3,fast:500},_resolveStyles:function(t){if(!t)return null;function i(f){if(!Array.isArray(f))return Ge._resolveStyles(f);for(var c=[],d=[],g=[],v=0;v<f.length;v++){var y=Ge._resolveStyles(f[v]);y&&(c.push(y[0]),d.push(y[1]),g.push(y[2]))}return c.length?[c,d,g]:null}function n(f){var c=f,d;Array.isArray(f)||(V(f)?c=[0,f]:f instanceof k||f instanceof z?(d=f.constructor,c=[new d(0,0),f]):c=[f,f]);var g=c[0],v=c[1];return V(g)&&V(v)?g===v?null:[g,v-g,v]:Array.isArray(g)&&V(g[0])||g instanceof z||g instanceof k?(Array.isArray(g)?(g=new z(g),v=new z(v)):(d=g.constructor,g=new d(g),v=new d(v)),g.equals(v)?null:[g,v.sub(g),v]):[g,v,v]}function e(f){return!Array.isArray(f)&&f.constructor===Object?!0:!!(Array.isArray(f)&&f[0].constructor===Object)}var o={},a={},s={};for(var l in t)if(t.hasOwnProperty(l)){var h=t[l];if(h){if(Array.isArray(h)&&(M(h[0])||M(h[1])))continue}else continue;var u=void 0;e(h)?u=i(h):u=n(h),u&&(a[l]=u[0],o[l]=u[1],s[l]=u[2])}return[a,o,s]},framing:function(t,i){i||(i={});var n=i.easing?ln[i.easing]:ln.linear;n||(n=ln.linear);var e,o,a;t=Ge._resolveStyles(t),t&&(o=t[0],e=t[1],a=t[2]);var s=function l(h,u,f){if(!u||!f)return null;var c={};for(var d in f)if(f.hasOwnProperty(d)){if(u[d]===a[d]){c[d]=u[d];continue}var g=u[d],v=f[d];if(V(v))c[d]=g+h*v;else if(Array.isArray(v)){for(var y=[],p=0;p<v.length;p++)y.push(l(h,g[p],v[p]));c[d]=y}else{var m=v.constructor;m===Object?c[d]=l(h,g,v):g instanceof k||g instanceof z?c[d]=g.add(v.multi(h)):c[d]=v}}return c};return function(l,h){var u,f;if(l<0)u={playState:"idle",delta:0},f=o;else if(l<h){var c=n(l/h);u={playState:"running",delta:c},f=s(c,o,e)}else u={playState:"finished",delta:1},f=a;return u.startStyles=o,u.destStyles=a,u.progress=l,u.remainingMs=h-l,new iP(u,f)}},_requestAnimFrame:function(t){this._frameQueue||(this._frameQueue=[]),this._frameQueue.push(t),this._a()},_a:function(){this._animationFrameId||(this._animationFrameId=_r(Ge._frameFn))},_run:function(){if(this._frameQueue.length){var t=this._frameQueue;this._frameQueue=[];for(var i=0,n=t.length;i<n;i++)t[i]();this._frameQueue.length?this._animationFrameId=_r(Ge._frameFn):delete this._animationFrameId}},animate:function(t,i,n,e){i||(i={});var o=Ge.framing(t,i),a=new V_(o,i,n,e);return a}};Ge._frameFn=Ge._run.bind(Ge);W(V_.prototype,{_prepare:function(){var t=this.options,i=t.speed||t.duration;ie(i)&&(i=Ge.speed[i],i||(i=+i)),i||(i=Ge.speed.normal),this.duration=i,this._framer=t.framer||Ge._requestAnimFrame.bind(Ge)},play:function(){if(this.playState!=="idle"&&this.playState!=="paused"||this.target&&this.target[ka])return this;this.target&&(this.target[ka]=1),this.playState==="idle"&&(this.currentTime=0,this._prepare());var t=ve();if(!this.startTime){var i=this.options;this.startTime=i.startTime?i.startTime:t}return this._playStartTime=Math.max(t,this.startTime),this.playState==="paused"&&(this._playStartTime-=this.currentTime),this.playState="running",this._run(),this},pause:function(){return this.playState==="paused"?this:(this.playState="paused",this._run(),this)},cancel:function(){return this.playState==="idle"?this:(this.playState="idle",this.finished=!1,this._run(),this)},finish:function(){return this.playState==="finished"?this:(this.playState="finished",this.finished=!0,this._run(),this)},reverse:function(){},_run:function(){var t=this,i=this._onFrame,n=ve(),e=n-this._playStartTime;if(this.options.repeat&&e>=this.duration&&(this._playStartTime=n,e=0),this.playState!=="running"){if(this.target&&delete this.target[ka],i){this.playState==="finished"?e=this.duration:this.playState==="idle"&&(e=0);var o=this._animation(e,this.duration);o.state.playState=this.playState,i(o)}return}var a=this._animation(e,this.duration);this.playState=a.state.playState,this.playState!=="running"&&this.target&&delete this.target[ka],this.playState==="idle"?this.startTime>n&&setTimeout(this._run.bind(this),this.startTime-n):this.playState==="running"?this._framer(function(){t.playState==="running"&&(t.currentTime=e,i&&i(a),t._run())}):this.playState==="finished"&&(this.finished=!0,i&&i(a))}});Ge.animate;var nP={smoothness:0,enableClip:!0,enableSimplify:!0,simplifyTolerance:2,symbol:{lineColor:"#000",lineWidth:2,lineOpacity:1,polygonFill:"#fff",polygonOpacity:1,opacity:1}},hl=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.animateShow=function(e,o){var a=this;e===void 0&&(e={}),this._showPlayer&&this._showPlayer.finish(),oe(e)&&(e={},o=e);var s=this.getCoordinates();if(s.length===0)return this;this._animIdx=0,this._animLenSoFar=0,this.show();var l=!!this.getShell,h=l?this.getShell().concat(this.getShell()[0]):s,u=this._getProjection(),f=u.projectCoords(h,this.options.antiMeridian);this._prjAniShowCenter=this._getPrjExtent().getCenter(),this._aniShowCenter=u.unproject(this._prjAniShowCenter);var c=e.duration||1e3,d=e.easing||"out";this.setCoordinates([]);var g=0;f.length&&(f[0]._distance=0);for(var v=1;v<f.length;v++){var y=f[v].distanceTo(f[v-1]);f[v]._distance=y,g+=y}this._tempCoord=new z(0,0),this._tempPrjCoord=new k(0,0);var p=this._showPlayer=Ge.animate({t:c},{duration:c,easing:d},function(m){if(!a.getMap()){if(p.playState!=="finished"&&(p.finish(),o)){var _=a.getCoordinates();o(m,_[_.length-1])}return}var w=a._drawAnimShowFrame(m.styles.t,c,g,h,f);m.state.playState==="finished"&&(delete a._showPlayer,delete a._aniShowCenter,delete a._prjAniShowCenter,delete a._animIdx,delete a._animLenSoFar,delete a._animTailRatio,delete a._tempCoord,delete a._tempPrjCoord,a.setCoordinates(s)),o&&o(m,w)},this);return p.play(),p},i._drawAnimShowFrame=function(e,o,a,s,l){if(e===0)return s[0];var h=e/o*a,u=0,f,c;for(f=this._animIdx+1,c=l.length;f<c&&(u=l[f]._distance,!(this._animLenSoFar+u>h));f++)this._animLenSoFar+=u;if(this._animIdx=f-1,this._animIdx>=c-1)return this.setCoordinates(s),s[s.length-1];var d=this._animIdx,g=l[d],v=l[d+1],y=h-this._animLenSoFar,p=y/u;this._animTailRatio=p;var m=g.x+(v.x-g.x)*p,_=g.y+(v.y-g.y)*p;this._tempPrjCoord.x=m,this._tempPrjCoord.y=_;var w=this._tempPrjCoord,C=s[d],x=s[d+1],T=C.x+(x.x-C.x)*p,P=C.y+(x.y-C.y)*p;this._tempCoord.x=T,this._tempCoord.y=P;var S=this._tempCoord,E=!!this.getShell;if(!E&&this.options.smoothness>0){for(var D=[],A=[],I=0;I<=this._animIdx;I++)D.push(s[I]),A.push(l[I]);D.push(S,S),A.push(w,w),this.setCoordinates(D),this._setPrjCoordinates(A)}else{var L=s.slice(0,this._animIdx+1);L.push(S);var O=l.slice(0,this._animIdx+1);O.push(w),E?(this.setCoordinates([this._aniShowCenter].concat(L)),this._setPrjCoordinates([this._prjAniShowCenter].concat(O))):(this.setCoordinates(L),this._setPrjCoordinates(O))}return S},i._getCenterInExtent=function(e,o,a){var s=this.getExtent();if(!e.intersects(s))return null;var l=a(o,e);if(l.length===0)return null;var h=0,u=0,f=0;l.forEach(function(d){Array.isArray(d)?d.forEach(function(g){g.point&&(g=g.point),h+=g.x,u+=g.y,f++}):(d.point&&(d=d.point),h+=d.x,u+=d.y,f++)});var c=new z(h,u)._multi(1/f);return c.count=f,c},i._getPath2DPoints=function(e,o,a){if(!he(e))return[];var s=this.getMap(),l=!o&&this._shouldSimplify(),h=this.options.simplifyTolerance*s._getResolution(),u=Array.isArray(e[0]);if(delete this._simplified,l&&!u){var f=e.length;e=Lx(e,h,!1),this._simplified=e.length<f}if(a||(a=s._getResolution()),Array.isArray(e)){var c=[],d="_glPt";if(!Array.isArray(e[0]))return c=Ts(e,d),s._prjsToPointsAtRes(e,a,c);for(var g=[],v=0,y=e.length;v<y;v++){var p=e[v];c=Ts(p,d);var m=s._prjsToPointsAtRes(p,a,c);g.push(m)}return g}else return s._prjToPointAtRes(e,a)},i._shouldSimplify=function(){var e=this.getLayer(),o=e.options.enableAltitude;return e&&e.options.enableSimplify&&!o&&this.options.enableSimplify&&!this._showPlayer},i._setPrjCoordinates=function(e){this._prjCoords=e,this.onShapeChanged()},i._getPrjCoordinates=function(){return this._verifyProjection(),!this._prjCoords&&this._getProjection()&&(this._prjCoords=this._projectCoords(this._coordinates)),this._prjCoords},i._updateCache=function(){this._clearCache();var e=this._getProjection();e&&this._prjCoords&&(this._coordinates=this._unprojectCoords(this._getPrjCoordinates()))},i._clearProjection=function(){this._prjCoords=null,r.prototype._clearProjection.call(this)},i._projectCoords=function(e){var o=this._getProjection();return o?o.projectCoords(e,this.options.antiMeridian):[]},i._unprojectCoords=function(e){var o=this._getProjection();return o?o.unprojectCoords(e):[]},i._computeCenter=function(){var e=this._coordinates;if(!he(e))return null;for(var o=0,a=0,s=0,l=e.length,h=0;h<l;h++)e[h]&&V(e[h].x)&&V(e[h].y)&&(o+=e[h].x,a+=e[h].y,s++);return new z(o/s,a/s)},i._computeExtent=function(){var e=this._coordinates;if(!he(e))return null;var o=[e];return this.hasHoles&&this.hasHoles()&&o.push.apply(o,this.getHoles()),this._coords2Extent(o,this._getProjection())},i._computePrjExtent=function(){var e=[this._getPrjCoordinates()];return this.hasHoles&&this.hasHoles()&&e.push.apply(e,this._getPrjHoles()),this._coords2Extent(e)},i._get2DLength=function(){for(var e=this._getPath2DPoints(this._getPrjCoordinates(),!0),o=0,a=1,s=e.length;a<s;a++)o+=e[a].distanceTo(e[a-1]);return o},i._hitTestTolerance=function(){var e=this._getInternalSymbol(),o;if(Array.isArray(e)){o=0;for(var a=0;a<e.length;a++)V(e[a].lineWidth)&&e[a].lineWidth>o&&(o=e[a].lineWidth)}else o=e.lineWidth;return r.prototype._hitTestTolerance.call(this)+(V(o)?o/2:1.5)},i._coords2Extent=function(e,o){if(!e||e.length===0||Array.isArray(e[0])&&e[0].length===0)return null;for(var a=new ge(o),s=0,l=e.length;s<l;s++)for(var h=0,u=e[s].length;h<u;h++)a._combine(e[s][h]);return a},t}(ae);hl.mergeOptions(nP);var Z_="Polygon",Oe=function(r){F(t,r);function t(n,e){var o;return o=r.call(this,e)||this,o.type="Polygon",n&&o.setCoordinates(n),o}var i=t.prototype;return i.getOutline=function(){var e=this._getPainter();if(!e)return null;var o=this.getExtent();return new t(o.toArray(),{symbol:{lineWidth:1,lineColor:"6b707b"}})},i.setCoordinates=function(e){if(!e)return this._coordinates=null,this._holes=null,this._projectRings(),this;var o=z.toCoordinates(e),a=o.length;if(!Array.isArray(o[0]))this._coordinates=this._trimRing(o);else if(this._coordinates=this._trimRing(o[0]),a>1){for(var s=[],l=1;l<a;l++)o[l]&&s.push(this._trimRing(o[l]));this._holes=s}else this._holes=null;return this._projectRings(),this},i.getCoordinates=function(){if(!this._coordinates)return[];for(var e=this.getHoles(),o=[this._copyAndCloseRing(this._coordinates)],a=0,s=e.length;a<s;a++)o.push(this._copyAndCloseRing(e[a]));return o},i.getCenterInExtent=function(e){return this._getCenterInExtent(e,this.getShell(),Ja)},i.getShell=function(){return this._coordinates||[]},i.getHoles=function(){return this._holes||[]},i.hasHoles=function(){return this.getHoles().length>0},i._projectRings=function(){if(!this.getMap()){this.onShapeChanged();return}this._prjCoords=this._projectCoords(this._coordinates),this._prjHoles=this._projectCoords(this._holes),this.onShapeChanged()},i._setPrjCoordinates=function(e){this._prjCoords=e,this.onShapeChanged()},i._cleanRing=function(e){for(var o=e.length-1;o>=0;o--)e[o]||e.splice(o,1)},i._checkRing=function(e){if(this._cleanRing(e),!e||!he(e))return!1;var o=e[e.length-1],a=!0;return(e[0].x!==o.x||e[0].y!==o.y)&&(a=!1),a},i._trimRing=function(e){var o=this._checkRing(e);return he(e)&&o&&e.splice(e.length-1,1),e},i._copyAndCloseRing=function(e){e=e.slice(0);var o=this._checkRing(e);return he(e)&&!o&&e.push(e[0].copy()),e},i._getPrjShell=function(){return this.getJSONType()===Z_?this._getPrjCoordinates():(this._verifyProjection(),this._getProjection()&&!this._prjShell&&(this._prjShell=this._projectCoords(this.getShell())),this._prjShell)},i._getPrjHoles=function(){var e=this._getProjection();return this._verifyProjection(),e&&!this._prjHoles&&(this._prjHoles=this._projectCoords(this.getHoles())),this._prjHoles},i._computeGeodesicLength=function(e){var o=this.getCoordinates();if(!he(o))return 0;for(var a=0,s=0,l=o.length;s<l;s++)a+=e.measureLength(o[s]);return a},i._computeGeodesicArea=function(e){var o=this.getCoordinates();if(!he(o))return 0;for(var a=e.measureArea(o[0]),s=1,l=o.length;s<l;s++)a-=e.measureArea(o[s]);return a},i._updateCache=function(){r.prototype._updateCache.call(this),this._prjHoles&&(this._holes=this._unprojectCoords(this._getPrjHoles()))},i._clearCache=function(){return delete this._prjShell,r.prototype._clearCache.call(this)},i._clearProjection=function(){this._prjHoles&&(this._prjHoles=null),this._prjShell&&(this._prjShell=null),r.prototype._clearProjection.call(this)},t}(hl);Oe.registerJSONType(Z_);function nc(r){return function(t){F(i,t);function i(){return t.apply(this,arguments)||this}var n=i.prototype;return n.getCoordinates=function(){return this._coordinates},n.setCoordinates=function(o){var a=o instanceof z?o:new z(o);if(this._coordinates=a,!this.getMap())return this._dirtyCoords=!0,this.onPositionChanged(),this;var s=this._getProjection();return this._setPrjCoordinates(s.project(this._coordinates)),this},n._getCenter2DPoint=function(o){var a=this.getMap();if(!a)return null;var s=this._getPrjCoordinates();return s?(o||(o=a._getResolution()),a._prjToPointAtRes(s,o)):null},n._getPrjCoordinates=function(){var o=this._getProjection();return this._verifyProjection(),!this._pcenter&&o&&this._coordinates&&(this._pcenter=o.project(this._coordinates)),this._pcenter},n._setPrjCoordinates=function(o){this._pcenter=o,this.onPositionChanged()},n._updateCache=function(){this._clearCache();var o=this._getProjection();this._pcenter&&o&&(this._coordinates=o.unproject(this._pcenter))},n._clearProjection=function(){this._pcenter=null,t.prototype._clearProjection.call(this)},n._computeCenter=function(){return this._coordinates?this._coordinates.copy():null},i}(r)}var Pg=new ee,oP={symbol:{markerType:"path",markerPath:[{path:"M8 23l0 0 0 0 0 0 0 0 0 0c-4,-5 -8,-10 -8,-14 0,-5 4,-9 8,-9l0 0 0 0c4,0 8,4 8,9 0,4 -4,9 -8,14z M3,9 a5,5 0,1,0,0,-0.9Z",fill:"#DE3333"}],markerPathWidth:16,markerPathHeight:23,markerWidth:24,markerHeight:34},hitTestForEvent:!1,collision:!0},Se=function(r){F(t,r);function t(n,e){var o;return o=r.call(this,e)||this,o.type="Point",n&&o.setCoordinates(n),o}var i=t.prototype;return i.getOutline=function(){var e=this.getCoordinates(),o=this.getContainerExtent(),a=this.getMap().coordToContainerPoint(e);return new t(e,{symbol:{markerType:"square",markerWidth:o.getWidth(),markerHeight:o.getHeight(),markerLineWidth:1,markerLineColor:"6b707b",markerFill:"rgba(0, 0, 0, 0)",markerDx:o.xmin-(a.x-o.getWidth()/2),markerDy:o.ymin-(a.y-o.getHeight()/2)}})},i.setSymbol=function(){var e;delete this._fixedExtent;for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return(e=r.prototype.setSymbol).call.apply(e,[this].concat(a))},i._getSizeSymbol=function(e){for(var o={},a=!1,s=!1,l=0;l<fh.length;l++){var h=e[fh[l]];M(h)||(!a&&de(h)&&(a=!0,s=!0),o[fh[l]]=h)}for(var u=0;u<ch.length;u++){var f=e[ch[u]];M(f)||(!a&&de(f)&&(a=!0),o[ch[u]]=f)}var c;return a?(c=Ms(o,this),s&&(c._dynamic=!0)):c=o,c},i._setExternSymbol=function(e){return this._symbol||delete this._fixedExtent,r.prototype._setExternSymbol.call(this,e)},i._isDynamicSize=function(){return this._sizeSymbol&&this._sizeSymbol._dynamic},i._getFixedExtent=function(){if(this._fixedExtent&&!this._isDynamicSize())return this._fixedExtent;this._fixedExtent=this._fixedExtent||new ee,this._fixedExtent.set(null,null,null,null);var e=this._sizeSymbol;if(!e)return this._fixedExtent;var o=this.getLayer()&&this.getLayer().getRenderer(),a=o&&o.resources,s=this.getTextDesc();if(Array.isArray(e)){Pg.set(1/0,1/0,-1/0,-1/0);for(var l=0;l<e.length;l++)e[l]&&this._fixedExtent._combine(zu(Pg,e[l],a,s&&s[l]))}else this._fixedExtent=zu(this._fixedExtent,e,a,s);return this._fixedExtent},i._isVectorMarker=function(){var e=this._getInternalSymbol();return Array.isArray(e)?!1:As(e)},i._canEdit=function(){var e=this._getInternalSymbol();return Array.isArray(e)?!1:As(e)||tc(e)||ec(e)},i._containsPoint=function(e,o){var a=this.getContainerExtent();return o&&(a=a.expand(o)),a.contains(e)?this.options.hitTestForEvent?r.prototype._containsPoint.call(this,e,o):!0:!1},i._computeExtent=function(){return Tg.call(this,"getCenter")},i._computePrjExtent=function(){return Tg.call(this,"_getPrjCoordinates")},i._computeGeodesicLength=function(){return 0},i._computeGeodesicArea=function(){return 0},i._getSprite=function(e,o){return this._getPainter()?this._getPainter().getSprite(e,o):new ic(this).getSprite(e,o)},t}(nc(ae));Se.mergeOptions(oP);Se.registerJSONType("Marker");function Tg(r){var t=this[r]();return t?new ge(t,t,this._getProjection()):null}var aP={arrowStyle:null,arrowPlacement:"vertex-last"},xe=function(r){F(t,r);function t(n,e){var o;return o=r.call(this,e)||this,o.type="LineString",n&&o.setCoordinates(n),o}var i=t.prototype;return i.getOutline=function(){return Oe.prototype.getOutline.call(this)},i.setCoordinates=function(e){return e?(this._coordinates=z.toCoordinates(e),this.getMap()?this._setPrjCoordinates(this._projectCoords(this._coordinates)):this.onShapeChanged(),this):(this._coordinates=null,this._setPrjCoordinates(null),this)},i.getCoordinates=function(){return this._coordinates||[]},i.getCenterInExtent=function(e){return this._getCenterInExtent(e,this.getCoordinates(),Xa)},i._computeGeodesicLength=function(e){return e.measureLength(this.getCoordinates())},i._computeGeodesicArea=function(){return 0},t}(hl);xe.mergeOptions(aP);xe.registerJSONType("LineString");var sP=new ee,Os=function(r){F(t,r);function t(n,e){var o;return o=r.call(this,e)||this,o.type="GeometryCollection",o.setGeometries(n),o}var i=t.prototype;return i.getContainerExtent=function(e){var o=e||new ee;return this.forEach(function(a){o._combine(a.getContainerExtent(sP))}),o},i.setGeometries=function(e){for(var o=this._checkGeometries(e||[]),a=this._getSymbol(),s=this.config(),l=this.getProperties(),h=o.length-1;h>=0;h--)o[h]._initOptions(s),o[h]._setParent(this),o[h]._setEventParent(this),a&&o[h].setSymbol(a),l&&o[h].setProperties(l);return this._geometries=o,this.getLayer()&&(this._bindGeometriesToLayer(),this.onShapeChanged()),this},i.getGeometries=function(){return this._geometries||[]},i.forEach=function(e,o){for(var a=this.getGeometries(),s=0,l=a.length;s<l;s++)a[s]&&(o?e.call(o,a[s],s):e(a[s],s));return this},i.filter=function(e,o){if(!e)return new t;var a=[],s=oe(e),l=s?e:Vf(e);return this.forEach(function(h){var u=s?h:ku(h);(o?l.call(o,u):l(u))&&a.push(h)},this),new t(a)},i.translate=function(e){if(!e)return this;if(this.isEmpty())return this;var o=arguments;return this.forEach(function(a){a&&a.translate&&a.translate.apply(a,o)}),this},i.isEmpty=function(){return!he(this.getGeometries())},i.remove=function(){return this.forEach(function(e){e._unbind()}),ae.prototype.remove.apply(this,arguments)},i.show=function(){return this.options.visible=!0,this.forEach(function(e){e.show()}),this},i.hide=function(){return this.options.visible=!1,this.forEach(function(e){e.hide()}),this},i.onConfig=function(e){this.forEach(function(o){o.config(e)})},i.getSymbol=function(){var e=r.prototype.getSymbol.call(this);if(!e){var o=[],a=!1;this.forEach(function(s){var l=s.getSymbol();l&&!a&&(a=!0),o.push(s.getSymbol())}),a&&(e={children:o})}return e},i.setSymbol=function(e){var o=this;if(e&&e.children)this._symbol=null,this.forEach(function(s,l){s._eventSymbolProperties=o._eventSymbolProperties,s.setSymbol(e.children[l])});else{var a=this._prepareSymbol(e);this._symbol=a,this.forEach(function(s){s._eventSymbolProperties=o._eventSymbolProperties,s.setSymbol(a)})}return this.onSymbolChanged(),this},i._setExternSymbol=function(e){return e=this._prepareSymbol(e),this._externSymbol=e,this.forEach(function(o){o._setExternSymbol(e)}),this.onSymbolChanged(),this},i._bindLayer=function(){r.prototype._bindLayer.apply(this,arguments),this._bindGeometriesToLayer()},i._bindGeometriesToLayer=function(){var e=this.getLayer();this.forEach(function(o){o._bindLayer(e)})},i._checkGeometries=function(e){var o="The geometry added to collection is invalid.";if(e&&!Array.isArray(e)){if(e instanceof ae)return[e];throw new Error(o)}else{for(var a=0,s=e.length;a<s;a++)if(!this._checkGeo(e[a]))throw new Error(o+" Index: "+a);return e}},i._checkGeo=function(e){return e instanceof ae},i._updateCache=function(){this._clearCache(),!this.isEmpty()&&this.forEach(function(e){e&&e._updateCache&&e._updateCache()})},i._removePainter=function(){this._painter&&this._painter.remove(),delete this._painter,this.forEach(function(e){e._removePainter()})},i._computeCenter=function(e){if(!e||this.isEmpty())return null;for(var o=0,a=0,s=0,l=this.getGeometries(),h=0,u=l.length;h<u;h++)if(l[h]){var f=l[h]._computeCenter(e);f&&(o+=f.x,a+=f.y,s++)}return s===0?null:new z(o/s,a/s)},i._containsPoint=function(e,o){if(this.isEmpty())return!1;delete this._pickGeometryIndex;for(var a=this.getGeometries(),s=0,l=a.length;s<l;s++)if(a[s]._containsPoint(e,o))return this._pickGeometryIndex=s,!0;return!1},i._computeExtent=function(e){return Sg.call(this,e,"_computeExtent")},i._computePrjExtent=function(e){return Sg.call(this,e,"_computePrjExtent")},i._computeGeodesicLength=function(e){if(!e||this.isEmpty())return 0;for(var o=this.getGeometries(),a=0,s=0,l=o.length;s<l;s++)o[s]&&(a+=o[s]._computeGeodesicLength(e));return a},i._computeGeodesicArea=function(e){if(!e||this.isEmpty())return 0;for(var o=this.getGeometries(),a=0,s=0,l=o.length;s<l;s++)o[s]&&(a+=o[s]._computeGeodesicArea(e));return a},i._exportGeoJSONGeometry=function(){var e=[];if(!this.isEmpty())for(var o=this.getGeometries(),a=0,s=o.length;a<s;a++)o[a]&&e.push(o[a]._exportGeoJSONGeometry());return{type:"GeometryCollection",geometries:e}},i._toJSON=function(e){var o={type:"Feature",geometry:{type:"GeometryCollection",geometries:this.getGeometries().filter(function(l){return l&&l._toJSON}).map(function(l){var h=l._toJSON();return h.subType?h:l._exportGeoJSONGeometry()})}},a=this.getId();M(a)||(o.id=a);var s;return(M(e.properties)||e.properties)&&(s=this._exportProperties()),o.properties=s,e.feature=o,e},i._clearProjection=function(){if(!this.isEmpty())for(var e=this.getGeometries(),o=0,a=e.length;o<a;o++)e[o]&&e[o]._clearProjection()},i._getConnectPoints=function(){var e=this.getExtent(),o=[new z(e.xmin,e.ymax),new z(e.xmax,e.ymin),new z(e.xmin,e.ymin),new z(e.xmax,e.ymax)];return o},i._getExternalResources=function(){if(this.isEmpty())return[];for(var e=this.getGeometries(),o=[],a={},s,l,h,u=0,f=e.length;u<f;u++)if(e[u]){s=e[u]._getInternalSymbol(),l=el(s);for(var c=0,d=l.length;c<d;c++)h=l[c].join(),a[h]||(o.push(l[c]),a[h]=1)}return o},i.startEdit=function(e){var o=this;if(this.isEmpty())return this;e||(e={}),e.symbol&&(this._originalSymbol=this.getSymbol(),this.setSymbol(e.symbol)),this._draggbleBeforeEdit=this.options.draggable,this.config("draggable",!1);for(var a=this.getGeometries(),s=0,l=a.length;s<l;s++)a[s].startEdit(e);this._editing=!0;var h=this.getLayer(),u=h&&h.options.renderer==="canvas";return u&&this.hide(),setTimeout(function(){o.fire("editstart")},1),this},i.endEdit=function(){if(this.isEmpty())return this;for(var e=this.getGeometries(),o=0,a=e.length;o<a;o++)e[o].endEdit();return this._originalSymbol&&(this.setSymbol(this._originalSymbol),delete this._originalSymbol),this._editing=!1,this.show(),this.config("draggable",this._draggbleBeforeEdit),this.fire("editend"),this},i.isEditing=function(){return!!this._editing},t}(ae);Os.registerJSONType("GeometryCollection");function Sg(r,t){if(this.isEmpty())return null;for(var i=new ge,n=this.getGeometries(),e=0,o=n.length;e<o;e++)if(n[e]){var a=n[e][t](r);a&&i._combine(a)}return i}var U_=function(r){F(t,r);function t(n,e,o,a){var s;return s=r.call(this,null,a)||this,s.GeometryType=n,s.type=e,s._initData(o),s}var i=t.prototype;return i.getCoordinates=function(){for(var e=[],o=this.getGeometries(),a=0,s=o.length;a<s;a++){var l=o[a];e.push(l.getShell&&l.getJSONType()!=="Polygon"?[l.getShell()]:l.getCoordinates())}return e},i.setCoordinates=function(e){e=e||[];for(var o=[],a=0,s=e.length;a<s;a++){var l=new this.GeometryType(e[a],this.config());o.push(l)}return this.setGeometries(o),this},i._initData=function(e){e=e||[],e.length&&(e[0]instanceof this.GeometryType?this.setGeometries(e):this.setCoordinates(e))},i._checkGeo=function(e){return e instanceof this.GeometryType},i._exportGeoJSONGeometry=function(){var e=this.getCoordinates(),o=z.toNumberArrays(e);return{type:this.getType(),coordinates:o}},i._toJSON=function(e){return{feature:this.toGeoJSON(e)}},t}(Os),Ls=function(r){F(t,r);function t(n,e){return r.call(this,Se,"MultiPoint",n,e)||this}var i=t.prototype;return i.findClosest=function(e){if(!e)return null;var o=this.getCoordinates(),a=null,s=1/0;return o.forEach(function(l){var h=lP(l,e);h<s&&(a=l,s=h)}),a},t}(U_);Ls.registerJSONType("MultiPoint");function lP(r,t){var i=t.x-r.x,n=t.y-r.y;return Math.sqrt(i*i+n*n)}var $_=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.getCenterInExtent=function(e){var o=this.getGeometries(),a=0,s=0,l=0;return o.forEach(function(h){var u=h.getCenterInExtent(e);u&&(a+=u.x*u.count,s+=u.y*u.count,l+=u.count)}),l===0?null:new z(a,s)._multi(1/l)},t}(U_),Ds=function(r){F(t,r);function t(i,n){return r.call(this,xe,"MultiLineString",i,n)||this}return t}($_);Ds.registerJSONType("MultiLineString");var X_=function(r){F(t,r);function t(i,n){return r.call(this,Oe,"MultiPolygon",i,n)||this}return t}($_);X_.registerJSONType("MultiPolygon");var hP={Marker:Se,LineString:xe,Polygon:Oe,MultiPoint:Ls,MultiLineString:Ds,MultiPolygon:X_},br={toGeometry:function(t,i){if(ie(t)&&(t=Hf(t)),Array.isArray(t)){for(var n=[],e=0,o=t.length;e<o;e++){var a=br._convert(t[e],i);Array.isArray(a)?pi(n,a):n.push(a)}return n}else{var s=br._convert(t,i);return s}},_convert:function(t,i){if(!t||M(t.type))return null;var n=t.type;if(n==="Feature"){var e=t.geometry,o=br._convert(e);return o?(o.setId(t.id),o.setProperties(t.properties),i&&i(o),o):null}else if(n==="FeatureCollection"){var a=t.features;return a?br.toGeometry(a,i):null}else if(["Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon"].indexOf(n)>=0){var s=n==="Point"?"Marker":n,l=new hP[s](t.coordinates);return i&&i(l),l}else if(n==="GeometryCollection"){var h=t.geometries;if(!he(h)){var u=new Os;return i&&i(u),u}for(var f=[],c=h.length,d=0;d<c;d++)h[d].subType?f.push(ae.getJSONClass(h[d].subType).fromJSON(h[d])):f.push(br._convert(h[d]));var g=new Os(f);return i&&i(g),g}return null}},uP={numberOfShellPoints:60},nr=function(r){F(t,r),t.fromJSON=function(e){var o=e.feature,a=new t(e.coordinates,e.radius,e.options);return a.setProperties(o.properties),a};function t(n,e,o){var a;return a=r.call(this,null,o)||this,n&&a.setCoordinates(n),a._radius=e,a}var i=t.prototype;return i.getRadius=function(){return this._radius},i.setRadius=function(e){return this._radius=e,this.onShapeChanged(),this},i.getShell=function(){for(var e=this._getMeasurer(),o=this.getCoordinates(),a=this.options.numberOfShellPoints,s=this.getRadius(),l=[],h,u,f,c=0,d=a-1;c<d;c++){h=360*c/d*Math.PI/180,u=s*Math.cos(h),f=s*Math.sin(h);var g=e.locate(o,u,f);l.push(g)}return l.push(l[0]),l},i.getHoles=function(){return[]},i.animateShow=function(){return this.show()},i._containsPoint=function(e,o){var a=this.getMap();if(a.getPitch())return r.prototype._containsPoint.call(this,e,o);var s=a._pointToContainerPoint(this._getCenter2DPoint()),l=this.getSize(),h=this._hitTestTolerance()+(o||0),u=s.add(l.width/2,l.height/2);return A_(e,s,u,h)},i._computePrjExtent=function(e){var o=this._getMinMax(e);if(!o)return null;var a=this._getPrjCoordinates(),s=o.map(function(c){return e.project(c)}),l=s[0].x-a.x,h=s[1].x-a.x,u=s[2].y-a.y,f=s[3].y-a.y;return new ge(a.add(l,u),a.add(h,f))},i._computeExtent=function(e){var o=this._getMinMax(e);return o?new ge(o[0].x,o[2].y,o[1].x,o[3].y,this._getProjection()):null},i._getMinMax=function(e){if(!e||!this._coordinates||M(this._radius))return null;var o=this._radius,a=e.locate(this._coordinates,-o,0),s=e.locate(this._coordinates,o,0),l=e.locate(this._coordinates,0,o),h=e.locate(this._coordinates,0,-o);return[a,s,l,h]},i._computeGeodesicLength=function(){return M(this._radius)?0:Math.PI*2*this._radius},i._computeGeodesicArea=function(){return M(this._radius)?0:Math.PI*Math.pow(this._radius,2)},i._exportGeoJSONGeometry=function(){var e=z.toNumberArrays([this.getShell()]);return{type:"Polygon",coordinates:e}},i._toJSON=function(e){var o=this.getCenter(),a=W({},e);a.geometry=!1;var s=this.toGeoJSON(a);return s.geometry={type:"Polygon"},{feature:s,subType:"Circle",coordinates:[o.x,o.y],radius:this.getRadius()}},t}(nc(Oe));nr.mergeOptions(uP);nr.registerJSONType("Circle");var fP={numberOfShellPoints:80},wr=function(r){F(t,r),t.fromJSON=function(e){var o=e.feature,a=new t(e.coordinates,e.width,e.height,e.options);return a.setProperties(o.properties),a};function t(n,e,o,a){var s;return s=r.call(this,null,a)||this,n&&s.setCoordinates(n),s.width=e,s.height=o,s}var i=t.prototype;return i.getWidth=function(){return this.width},i.setWidth=function(e){return this.width=e,this.onShapeChanged(),this},i.getHeight=function(){return this.height},i.setHeight=function(e){return this.height=e,this.onShapeChanged(),this},i.getShell=function(){for(var e=this._getMeasurer(),o=this.getCoordinates(),a=this.options.numberOfShellPoints,s=this.getWidth(),l=this.getHeight(),h=[],u=Math.pow(s/2,2)*Math.pow(l/2,2),f=Math.pow(s/2,2),c=Math.pow(l/2,2),d,g,v,y,p=0;p<a;p++){d=360*p/a,g=d*Math.PI/180,v=Math.sqrt(u/(f*Math.pow(Math.tan(g),2)+c)),y=Math.sqrt(u/(c*Math.pow(1/Math.tan(g),2)+f)),d>90&&d<270&&(v*=-1),d>180&&d<360&&(y*=-1);var m=e.locate(o,v,y);h.push(m)}return h},i.getHoles=function(){return[]},i.animateShow=function(){return this.show()},i._containsPoint=function(e,o){var a=this.getMap();if(a.isTransforming())return r.prototype._containsPoint.call(this,e,o);var s=a.getProjection(),l=this._hitTestTolerance()+(o||0),h=s.projectCoords([this._coordinates,a.locate(this._coordinates,this.getWidth()/2,this.getHeight()/2)],this.options.antiMeridian),u=a._prjToContainerPoint(h[0]),f=a._prjToContainerPoint(h[1]);return A_(e,u,f,l)},i._computePrjExtent=function(){return nr.prototype._computePrjExtent.apply(this,arguments)},i._computeExtent=function(){return nr.prototype._computeExtent.apply(this,arguments)},i._getMinMax=function(e){if(!e||!this._coordinates||M(this.width)||M(this.height))return null;var o=this.getWidth(),a=this.getHeight(),s=e.locate(this._coordinates,-o/2,0),l=e.locate(this._coordinates,o/2,0),h=e.locate(this._coordinates,0,-a/2),u=e.locate(this._coordinates,0,a/2);return[s,l,h,u]},i._computeGeodesicLength=function(){if(M(this.width)||M(this.height))return 0;var e=this.width>this.height?this.width:this.height;return 2*Math.PI*e/2-4*Math.abs(this.width-this.height)},i._computeGeodesicArea=function(){return M(this.width)||M(this.height)?0:Math.PI*this.width*this.height/4},i._exportGeoJSONGeometry=function(){var e=z.toNumberArrays([this.getShell()]);return{type:"Polygon",coordinates:e}},i._toJSON=function(e){var o=W({},e),a=this.getCenter();o.geometry=!1;var s=this.toGeoJSON(o);return s.geometry={type:"Polygon"},{feature:s,subType:"Ellipse",coordinates:[a.x,a.y],width:this.getWidth(),height:this.getHeight()}},t}(nc(Oe));wr.mergeOptions(fP);wr.registerJSONType("Ellipse");var hn=function(r){F(t,r),t.fromJSON=function(e){var o=e.feature,a=new t(e.coordinates,e.width,e.height,e.options);return a.setProperties(o.properties),a};function t(n,e,o,a){var s;return s=r.call(this,null,a)||this,n&&s.setCoordinates(n),s._width=e,s._height=o,s}var i=t.prototype;return i.getCoordinates=function(){return this._coordinates},i.setCoordinates=function(e){if(this._coordinates=e instanceof z?e:new z(e),!this._coordinates||!this.getMap())return this.onPositionChanged(),this;var o=this._getProjection();return this._setPrjCoordinates(o.project(this._coordinates)),this},i.getWidth=function(){return this._width},i.setWidth=function(e){return this._width=e,this.onShapeChanged(),this},i.getHeight=function(){return this._height},i.setHeight=function(e){return this._height=e,this.onShapeChanged(),this},i.getShell=function(){var e=this._getMeasurer(),o=this._coordinates,a=this.getMap(),s=1,l=-1;if(a){var h=a.getFullExtent();h.left>h.right&&(s=-1),h.bottom>h.top&&(l=1)}var u=[];return u.push(o),u.push(e.locate(o,s*this._width,0)),u.push(e.locate(o,s*this._width,l*this._height)),u.push(e.locate(o,0,l*this._height)),u.push(o),u},i.getHoles=function(){return[]},i.animateShow=function(){return this.show()},i._getPrjCoordinates=function(){var e=this._getProjection();return this._verifyProjection(),!this._pnw&&e&&this._coordinates&&(this._pnw=e.project(this._coordinates)),this._pnw},i._setPrjCoordinates=function(e){this._pnw=e,this.onPositionChanged()},i._getPrjShell=function(){var e=r.prototype._getPrjShell.call(this),o=this._getProjection();if(!o.isSphere())return e;for(var a=o.getSphereExtent(),s=a.sx,l=a.sy,h=this._getProjection().getCircum(),u=e[0],f=1,c=e.length;f<c;f++){var d=e[f],g=0,v=0;s*(u.x-d.x)>0&&(g=h.x*s),l*(u.y-d.y)<0&&(v=h.y*l),e[f]._add(g,v)}return e},i._updateCache=function(){this._clearCache();var e=this._getProjection();this._pnw&&e&&(this._coordinates=e.unproject(this._pnw))},i._clearProjection=function(){this._pnw=null,r.prototype._clearProjection.call(this)},i._computeCenter=function(e){return e.locate(this._coordinates,this._width/2,-this._height/2)},i._containsPoint=function(e,o){var a=this.getMap();if(a.isTransforming())return r.prototype._containsPoint.call(this,e,o);var s=M(o)?this._hitTestTolerance():o,l=a._getResolution()*s,h=this._getPrjExtent().expand(l),u=a._containerPointToPrj(e);return h.contains(u)},i._computePrjExtent=function(e){var o=this._getSouthEast(e);if(!o)return null;var a=e.projectCoords([new z(this._coordinates.x,o.y),new z(o.x,this._coordinates.y)],this.options.antiMeridian);return new ge(a[0],a[1])},i._computeExtent=function(e){var o=this._getSouthEast(e);return o?new ge(this._coordinates,o,this._getProjection()):null},i._getSouthEast=function(e){if(!e||!this._coordinates||M(this._width)||M(this._height))return null;var o=this.getWidth(),a=this.getHeight(),s=o,l=-a;if(e.fullExtent){var h=e.fullExtent,u=h.right>h.left?1:-1,f=h.top>h.bottom?1:-1;s*=u,l*=f}var c=e.locate(this._coordinates,s,0),d=e.locate(this._coordinates,0,l);return c.y=d.y,c},i._computeGeodesicLength=function(){return M(this._width)||M(this._height)?0:2*(this._width+this._height)},i._computeGeodesicArea=function(){return M(this._width)||M(this._height)?0:this._width*this._height},i._exportGeoJSONGeometry=function(){var e=z.toNumberArrays([this.getShell()]);return{type:"Polygon",coordinates:e}},i._toJSON=function(e){var o=W({},e),a=this.getCoordinates();o.geometry=!1;var s=this.toGeoJSON(o);return s.geometry={type:"Polygon"},{feature:s,subType:"Rectangle",coordinates:[a.x,a.y],width:this.getWidth(),height:this.getHeight()}},t}(Oe);hn.registerJSONType("Rectangle");var cP={numberOfShellPoints:60},En=function(r){F(t,r),t.fromJSON=function(e){var o=e.feature,a=new t(e.coordinates,e.radius,e.startAngle,e.endAngle,e.options);return a.setProperties(o.properties),a};function t(n,e,o,a,s){var l;return l=r.call(this,n,e,s)||this,l.startAngle=o,l.endAngle=a,l}var i=t.prototype;return i.getStartAngle=function(){return this.startAngle},i.setStartAngle=function(e){return this.startAngle=e,this.onShapeChanged(),this},i.getEndAngle=function(){return this.endAngle},i.setEndAngle=function(e){return this.endAngle=e,this.onShapeChanged(),this},i.getShell=function(){for(var e=this._getMeasurer(),o=this.getCoordinates(),a=this.options.numberOfShellPoints-2,s=this.getRadius(),l=[o.copy()],h=this.getStartAngle(),u=this.getEndAngle()-h,f,c,d,g=0;g<a;g++){f=(u*g/(a-1)+h)*Math.PI/180,c=s*Math.cos(f),d=s*Math.sin(f);var v=e.locate(o,c,d);l.push(v)}return l.push(o.copy()),l},i._containsPoint=function(e,o){var a=this.getMap();if(a.isTransforming())return r.prototype._containsPoint.call(this,e,o);var s=a._pointToContainerPoint(this._getCenter2DPoint()),l=this._hitTestTolerance()+(o||0),h=this.getSize(),u=s,f=e,c=f.x-u.x,d=u.y-f.y,g=Math.atan2(d,c),v=g<0?(g+2*Math.PI)*360/(2*Math.PI):g*360/(2*Math.PI),y=this.startAngle%360,p=this.endAngle%360,m=!1;return y>p?m=!(v>p&&v<y):m=v>=y&&v<=p,f.distanceTo(u)<=h.width/2+l&&m},i._computeGeodesicLength=function(){return M(this._radius)?0:Math.PI*2*this._radius*Math.abs(this.startAngle-this.endAngle)/360+2*this._radius},i._computeGeodesicArea=function(){return M(this._radius)?0:Math.PI*Math.pow(this._radius,2)*Math.abs(this.startAngle-this.endAngle)/360},i._toJSON=function(e){var o=W({},e),a=this.getCenter();o.geometry=!1;var s=this.toGeoJSON(o);return s.geometry={type:"Polygon"},{feature:s,subType:"Sector",coordinates:[a.x,a.y],radius:this.getRadius(),startAngle:this.getStartAngle(),endAngle:this.getEndAngle()}},t}(nr);En.mergeOptions(cP);En.registerJSONType("Sector");var dP={enableSimplify:!1,enableClip:!1},Zo=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i._arc=function(e,o,a){for(var s=this.options.arcDegree*Math.PI/180,l=1,h=o.length;l<h;l++){var u=j._arcBetween(e,o[l-1],o[l],s),f=[o[l-1].x+o[l].x-u[0],o[l-1].y+o[l].y-u[1]];o[l-1].nextCtrlPoint=f,o[l].prevCtrlPoint=f,j._stroke(e,a)}},i._quadraticCurve=function(e,o){if(o.length<=2){j._path(e,o);return}var a,s;for(a=2,s=o.length;a<s;a+=2)e.quadraticCurveTo(o[a-1].x,o[a-1].y,o[a].x,o[a].y);if(a-=1,a<s)for(;a<s;a++)e.lineTo(o[a].x,o[a].y)},i._bezierCurve=function(e,o){if(o.length<=3){j._path(e,o);return}var a,s;for(a=1,s=o.length;a+2<s;a+=3)e.bezierCurveTo(o[a].x,o[a].y,o[a+1].x,o[a+1].y,o[a+2].x,o[a+2].y);if(a<s)for(;a<s;a++)e.lineTo(o[a].x,o[a].y)},i._getCurveArrowPoints=function(e,o,a,s,l,h){var u=o.length,f;for(f=h;f<u;f+=h){var c=this._getArrowShape(o[f-1],o[f],a,s,l);c&&e.push(c)}if(f-=h,f<u-1)for(f+=1;f<u;f++){var d=this._getArrowShape(o[f-1],o[f],a,s,l);d&&e.push(d)}},t}(xe);Zo.mergeOptions(dP);var gP={arcDegree:90},ul=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i._toJSON=function(e){return{feature:this.toGeoJSON(e),subType:"ArcCurve"}},i._paintOn=function(e,o,a){e.beginPath(),this._arc(e,o,a),j._stroke(e,a),this._paintArrow(e,o,a)},t.fromJSON=function(e){var o=e.feature,a=new t(o.geometry.coordinates,e.options);return a.setProperties(o.properties),a},t}(Zo);ul.registerJSONType("ArcCurve");ul.mergeOptions(gP);var J_=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}t.fromJSON=function(e){var o=e.feature,a=new t(o.geometry.coordinates,e.options);return a.setProperties(o.properties),a};var i=t.prototype;return i._toJSON=function(e){return{feature:this.toGeoJSON(e),subType:"CubicBezierCurve"}},i._paintOn=function(e,o,a){e.beginPath(),e.moveTo(o[0].x,o[0].y),this._bezierCurve(e,o),j._stroke(e,a),this._paintArrow(e,o,a)},i._getArrowPoints=function(e,o,a,s,l){return this._getCurveArrowPoints(e,o,a,s,l,3)},t}(Zo);J_.registerJSONType("CubicBezierCurve");var Y_=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}t.fromJSON=function(e){var o=e.feature,a=new t(o.geometry.coordinates,e.options);return a.setProperties(o.properties),a};var i=t.prototype;return i._toJSON=function(e){return{feature:this.toGeoJSON(e),subType:"QuadBezierCurve"}},i._paintOn=function(e,o,a){e.beginPath(),e.moveTo(o[0].x,o[0].y),this._quadraticCurve(e,o,a),j._stroke(e,a),this._paintArrow(e,o,a)},i._getArrowPoints=function(e,o,a,s,l){return this._getCurveArrowPoints(e,o,a,s,l,2)},t}(Zo);Y_.registerJSONType("QuadBezierCurve");var vP={textFaceName:"monospace",textSize:12,textLineSpacing:8,textWrapCharacter:`
`,textHorizontalAlignment:"middle",textVerticalAlignment:"middle"},pP={markerType:"square",markerLineColor:"#000",markerLineWidth:2,markerLineOpacity:1,markerFill:"#fff",markerOpacity:1},oc=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.getContent=function(){return this._content},i.setContent=function(e){var o=this._content;return this._content=Zf(e),this._refresh(),this._fireEvent("contentchange",{old:o,new:e}),this},i.onAdd=function(){this._refresh()},i.toJSON=function(){var e=r.prototype.toJSON.call(this);return delete e.symbol,e},i.setSymbol=function(e){if(this._refreshing||!e)return r.prototype.setSymbol.call(this,e);var o=this._parseSymbol(e);if(this.setTextStyle){var a=this.getTextStyle()||{};a.symbol=o[0],this.setTextStyle(a)}else this.setTextSymbol&&this.setTextSymbol(o[0]);if(this.setBoxStyle){var s=this.getBoxStyle()||{};s.symbol=o[1],this.setBoxStyle(s)}else this.setBoxSymbol&&this.setBoxSymbol(o[1]);return this},i._parseSymbol=function(e){var o={},a={};for(var s in e)Go(e,s)&&(s.indexOf("text")===0?o[s]=e[s]:a[s]=e[s]);return[o,a]},i._getTextSize=function(e){return Wm(this._content,e).size},i._getInternalSymbol=function(){return this._symbol},i._getDefaultTextSymbol=function(){return W({},vP)},i._getDefaultBoxSymbol=function(){return W({},pP)},i._getDefaultPadding=function(){return[12,8]},t}(Se),mP={textStyle:{wrap:!0,padding:[12,8],verticalAlignment:"middle",horizontalAlignment:"middle"},boxSymbol:null},bs=function(r){F(t,r);function t(n,e,o,a,s){var l;return s===void 0&&(s={}),l=r.call(this,e,s)||this,l._content=Zf(n),l._width=M(o)?100:o,l._height=M(a)?40:a,s.boxSymbol&&l.setBoxSymbol(s.boxSymbol),s.textStyle&&l.setTextStyle(s.textStyle),l._refresh(),l}var i=t.prototype;return i.getWidth=function(){return this._width},i.setWidth=function(e){return this._width=e,this._refresh(),this},i.getHeight=function(){return this._height},i.setHeight=function(e){return this._height=e,this._refresh(),this},i.getBoxSymbol=function(){return W({},this.options.boxSymbol)},i.setBoxSymbol=function(e){return this.options.boxSymbol=e&&W({},e),this.getSymbol()&&this._refresh(),this},i.getTextStyle=function(){return this.options.textStyle?W({},this.options.textStyle):null},i.setTextStyle=function(e){return this.options.textStyle=e&&W({},e),this.getSymbol()&&this._refresh(),this},t.fromJSON=function(e){var o=e.feature,a=new t(e.content,o.geometry.coordinates,e.width,e.height,e.options);return a.setProperties(o.properties),a.setId(o.id),e.symbol&&a.setSymbol(e.symbol),a},i._toJSON=function(e){return{feature:this.toGeoJSON(e),width:this.getWidth(),height:this.getHeight(),subType:"TextBox",content:this._content}},i._refresh=function(){var e=this.getTextStyle()||{},o=e.padding||[12,8],a,s;if(de(this._width)){a=JSON.parse(JSON.stringify(this._width));var l=a.stops;if(l)for(var h=0;h<l.length;h++)l[h][1]=l[h][1]-2*o[0]}else a=this._width-2*o[0];if(de(this._height)){s=JSON.parse(JSON.stringify(this._height));var u=s.stops;if(u)for(var f=0;f<u.length;f++)u[f][1]=u[f][1]-2*o[1]}else s=this._height-2*o[1];var c=W({},e.symbol||this._getDefaultTextSymbol(),this.options.boxSymbol||this._getDefaultBoxSymbol(),{textName:this._content,markerWidth:this._width,markerHeight:this._height,textHorizontalAlignment:"middle",textVerticalAlignment:"middle",textMaxWidth:a,textMaxHeight:s});e.wrap&&!c.textWrapWidth&&(c.textWrapWidth=a);var d=e.horizontalAlignment;c.textDx=c.markerDx||0;var g;if(de(this._width)){g=JSON.parse(JSON.stringify(this._width));var v=g.stops;if(v)for(var y=0;y<v.length;y++)v[y][1]=v[y][1]/2-o[0],d==="left"&&(v[y][1]*=-1)}else g=c.markerWidth/2-o[0],d==="left"&&(g*=-1);d==="left"?(c.textHorizontalAlignment="right",c.textDx=g):d==="right"&&(c.textHorizontalAlignment="left",c.textDx=g);var p=e.verticalAlignment;c.textDy=c.markerDy||0;var m;if(de(this._height)){m=JSON.parse(JSON.stringify(this._height));var _=m.stops;if(_)for(var w=0;w<_.length;w++)_[w][1]=_[w][1]/2-o[1],p==="top"&&(_[w][1]*=-1)}else m=c.markerHeight/2-o[1],p==="top"&&(m*=-1);p==="top"?(c.textVerticalAlignment="bottom",c.textDy=m):p==="bottom"&&(c.textVerticalAlignment="top",c.textDy=m),this._refreshing=!0,this.updateSymbol(c),delete this._refreshing},i.startEdit=function(e){var o=this._getCompiledSymbol();if(de(this._width)){var a=o.markerWidth;this._oldWidth=this._width,this.setWidth(a)}if(de(this._height)){var s=o.markerHeight;this._oldHeight=this._height,this.setHeight(s)}r.prototype.startEdit.call(this,e)},i.endEdit=function(){var e=this.getMap(),o=e&&e.getZoom();if(this._oldWidth){for(var a=this._width,s=Ss(this._oldWidth),l=s(o),h=a/l,u=this._oldWidth.stops,f=0;f<u.length;f++)u[f][1]*=h;this.setWidth(this._oldWidth),delete this._oldWidth}if(this._oldHeight){for(var c=this._height,d=Ss(this._oldHeight),g=d(o),v=c/g,y=this._oldHeight.stops,p=0;p<y.length;p++)y[p][1]*=v;this.setHeight(this._oldHeight),delete this._oldHeight}r.prototype.endEdit.call(this)},t}(oc);bs.mergeOptions(mP);bs.registerJSONType("TextBox");var _P={boxStyle:null,textSymbol:null},un=function(r){F(t,r);function t(n,e,o){var a;return o===void 0&&(o={}),a=r.call(this,e,o)||this,o.textSymbol&&a.setTextSymbol(o.textSymbol),o.boxStyle&&a.setBoxStyle(o.boxStyle),a._content=Zf(n),a._refresh(),a}var i=t.prototype;return i.getBoxStyle=function(){return this.options.boxStyle?W({},this.options.boxStyle):null},i.setBoxStyle=function(e){return this.options.boxStyle=e&&W({},e),this._refresh(),this},i.getTextSymbol=function(){return W({},this._getDefaultTextSymbol(),this.options.textSymbol)},i.setTextSymbol=function(e){return this.options.textSymbol=e&&W({},e),this._refresh(),this},t.fromJSON=function(e){var o=e.feature,a=new t(e.content,o.geometry.coordinates,e.options);return a.setProperties(o.properties),a.setId(o.id),e.symbol&&a.setSymbol(e.symbol),a},i._canEdit=function(){return!1},i._toJSON=function(e){return{feature:this.toGeoJSON(e),subType:"Label",content:this._content}},i._refresh=function(){var e=W({},this.getTextSymbol(),{textName:this._content}),o=this.getBoxStyle();if(o){W(e,o.symbol);var a=this._getBoxSize(e),s=a[1],l=o.padding||this._getDefaultPadding(),h=a[0];e.markerWidth=h.width,e.markerHeight=h.height;var u=e.textDx||0,f=e.textDy||0,c=mi(s,e.textHorizontalAlignment,e.textVerticalAlignment)._add(u,f),d=o.horizontalAlignment||"middle";e.markerDx=c.x,d==="left"?e.markerDx+=e.markerWidth/2-l[0]:d==="right"?e.markerDx-=e.markerWidth/2-s.width-l[0]:e.markerDx+=s.width/2;var g=o.verticalAlignment||"middle";e.markerDy=c.y,g==="top"?e.markerDy+=e.markerHeight/2-l[1]:g==="bottom"?e.markerDy-=e.markerHeight/2-s.height-l[1]:e.markerDy+=s.height/2}this._refreshing=!0,this.updateSymbol(e),delete this._refreshing},i._getBoxSize=function(e){e.markerType||(e.markerType="square");var o=this.getBoxStyle(),a=this._getTextSize(e),s,l,h=o.padding||this._getDefaultPadding();return s=a.width+h[0]*2,l=a.height+h[1]*2,o.minWidth&&(!s||s<o.minWidth)&&(s=o.minWidth),o.minHeight&&(!l||l<o.minHeight)&&(l=o.minHeight),[new Ae(s,l),a]},t}(oc);un.mergeOptions(_P);un.registerJSONType("Label");var Q_=function(t){return function(i){F(n,i);function n(){return i.apply(this,arguments)||this}n._hasConnectors=function(a){return!M(a.__connectors)&&a.__connectors.length>0},n._getConnectors=function(a){return a.__connectors};var e=n.prototype;return e.getConnectSource=function(){return this._connSource},e.setConnectSource=function(a){var s=this._connTarget;return this.onRemove(),this._connSource=a,this._connTarget=s,this.onAdd(),this},e.getConnectTarget=function(){return this._connTarget},e.setConnectTarget=function(a){var s=this._connSource;return this.onRemove(),this._connSource=s,this._connTarget=a,this._updateCoordinates(),this._registerEvents(),this},e._updateCoordinates=function(){var a=this.getMap();if(!a&&this._connSource&&(a=this._connSource.getMap()),!a&&this._connTarget&&(a=this._connTarget.getMap()),!!a&&!(!this._connSource||!this._connTarget)){for(var s=this._connSource._getConnectPoints(),l=this._connTarget._getConnectPoints(),h=0,u=this.getCoordinates(),f,c,d=0,g=s.length;d<g;d++)for(var v=s[d],y=0,p=l.length;y<p;y++){var m=l[y],_=a.computeLength(v,m);d===0&&y===0?(f=v,c=m,h=_):_<h&&(f=v,c=m)}(!he(u)||!u[0].equals(f)||!u[1].equals(c))&&this.setCoordinates([f,c])}},e.onAdd=function(){this._registerEvents(),this._updateCoordinates()},e.onRemove=function(){if(this._connSource&&(this._connSource.__connectors&&Cu(this,this._connSource.__connectors),this._connSource.off("dragging positionchange",this._updateCoordinates,this).off("remove",this.onRemove,this),this._connSource.off("dragstart mousedown mouseover",this._showConnect,this),this._connSource.off("dragend mouseup mouseout",this.hide,this),this._connSource.off("show",this._showConnect,this).off("hide",this.hide,this),delete this._connSource),this._connTarget&&(Cu(this,this._connTarget.__connectors),this._connTarget.off("dragging positionchange",this._updateCoordinates,this).off("remove",this.onRemove,this),this._connTarget.off("show",this._showConnect,this).off("hide",this.hide,this),delete this._connTarget),!(this._connSource instanceof ae)||!(this._connTarget instanceof ae)){var a=this.getMap();a&&a.off("movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange",this._updateCoordinates,this)}},e._showConnect=function(){!this._connSource||!this._connTarget||this._connSource.isVisible()&&this._connTarget.isVisible()&&(this._updateCoordinates(),this.show())},e._registerEvents=function(){if(!(!this._connSource||!this._connTarget)){this._connSource.__connectors||(this._connSource.__connectors=[]),this._connTarget.__connectors||(this._connTarget.__connectors=[]),this._connSource.__connectors.push(this),this._connTarget.__connectors.push(this),this._connSource.on("dragging positionchange",this._updateCoordinates,this).on("remove",this.remove,this),this._connTarget.on("dragging positionchange",this._updateCoordinates,this).on("remove",this.remove,this),this._connSource.on("show",this._showConnect,this).on("hide",this.hide,this),this._connTarget.on("show",this._showConnect,this).on("hide",this.hide,this);var a=this.options.showOn;if(this.hide(),a==="moving"?(this._connSource.on("dragstart",this._showConnect,this).on("dragend",this.hide,this),this._connTarget.on("dragstart",this._showConnect,this).on("dragend",this.hide,this)):a==="click"?(this._connSource.on("mousedown",this._showConnect,this).on("mouseup",this.hide,this),this._connTarget.on("mousedown",this._showConnect,this).on("mouseup",this.hide,this)):a==="mouseover"?(this._connSource.on("mouseover",this._showConnect,this).on("mouseout",this.hide,this),this._connTarget.on("mouseover",this._showConnect,this).on("mouseout",this.hide,this)):this._showConnect(),!(this._connSource instanceof ae)||!(this._connTarget instanceof ae)){var s=this.getMap();s&&s.on("movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange",this._updateCoordinates,this)}}},n}(t)},q_={showOn:"always"},Is=function(r){F(t,r);function t(i,n,e){var o;return o=r.call(this,null,e)||this,arguments.length===1&&(e=i,i=null,n=null),o._connSource=i,o._connTarget=n,o}return t}(Q_(xe));Is.mergeOptions(q_);Is.registerJSONType("ConnectorLine");var K_=function(r){F(t,r);function t(i,n,e){var o;return o=r.call(this,null,e)||this,arguments.length===1&&(e=i,i=null,n=null),o._connSource=i,o._connTarget=n,o}return t}(Q_(ul));K_.mergeOptions(q_);K_.registerJSONType("ArcConnectorLine");var yP={drawImmediate:!1,geometryEvents:!0,geometryEventTolerance:1},Mg=[],ey=function(r){F(t,r);function t(n,e,o){var a;e&&!(e instanceof ae)&&!Array.isArray(e)&&zx.indexOf(e.type)<0&&(o=e,e=null),a=r.call(this,n,o)||this,a._maxZIndex=0,a._minZIndex=0,a._initCache(),e&&a.addGeometry(e);var s=a.options.style;return s&&a.setStyle(s),a}var i=t.prototype;return i.getGeometryById=function(e){return M(e)||e===""||!this._geoMap[e]?null:this._geoMap[e]},i.getGeometries=function(e,o){if(!e)return this._geoList.slice(0);for(var a=[],s,l,h=0,u=this._geoList.length;h<u;h++)s=this._geoList[h],o?l=e.call(o,s):l=e(s),l&&a.push(s);return a},i.getFirstGeometry=function(){return this._geoList.length?this._geoList[0]:null},i.getLastGeometry=function(){var e=this._geoList.length;return e===0?null:this._geoList[e-1]},i.getCount=function(){return this._geoList.length},i.getExtent=function(){if(this.getCount()===0)return null;var e=new ge(this.getProjection());return this.forEach(function(o){e._combine(o.getExtent())}),e},i.forEach=function(e,o){for(var a=this._geoList.slice(0),s=0,l=a.length;s<l;s++)o?e.call(o,a[s],s):e(a[s],s);return this},i.filter=function(e,o){var a=[],s=oe(e),l=s?e:Vf(e);return this.forEach(function(h){var u=s?h:ku(h);(o?l.call(o,u):l(u))&&a.push(h)},this),a},i.isEmpty=function(){return!this._geoList.length},i.addGeometry=function(e,o){if(!e)return this;if(e.type==="FeatureCollection")return this.addGeometry(br.toGeometry(e),o);if(Array.isArray(e)){if(e.length===0)return this}else{var a=arguments.length,s=arguments[a-1];return e=Array.prototype.slice.call(arguments,0,a-1),o=s,s&&Zt(s)&&("type"in s||s instanceof ae)&&(e.push(s),o=!1),this.addGeometry(e,o)}this._initCache();var l;o&&(l=new ge),this._toSort=this._maxZIndex>0;for(var h=[],u=0,f=e.length;u<f;u++){var c=e[u];if(!c)throw new Error("Invalid geometry to add to layer("+this.getId()+") at index:"+u);if(!(c.getLayer&&c.getLayer()===this)){if(!(c instanceof ae)&&(c=ae.fromJSON(c),Array.isArray(c)))for(var d=0,g=c.length;d<g;d++)this._add(c[d],l,u),h.push(c[d]);Array.isArray(c)||(this._add(c,l,u),h.push(c))}}var v=this.getMap();if(v&&(this._getRenderer().onGeometryAdd(h),l&&!M(l.xmin))){var y=l.getCenter(),p=v.getFitZoom(l);if(Zt(o)){var m=oe(o.step)?o.step:function(){};v.animateTo({center:y,zoom:p},W({duration:v.options.zoomAnimationDuration,easing:"out"},o),m)}else o===!0&&v.setCenterAndZoom(y,p)}return this.fire("addgeo",{geometries:e}),this},i.getGeoMinZIndex=function(){return this._minZIndex},i.getGeoMaxZIndex=function(){return this._maxZIndex},i._add=function(e,o,a){this._toSort||(this._toSort=e.getZIndex()!==0),this._updateZIndex(e.getZIndex());var s=e.getId();if(!M(s)){if(!M(this._geoMap[s]))throw new Error("Duplicate geometry id in layer("+this.getId()+"):"+s+", at index:"+a);this._geoMap[s]=e}var l=Tn();e._setInternalId(l),this._geoList.push(e),this.onAddGeometry(e),e._bindLayer(this),e.onAdd&&e.onAdd(),o&&o._combine(e.getExtent()),e._fireEvent("add",{layer:this}),this._cookedStyles&&this._styleGeometry(e)},i.removeGeometry=function(e){if(!Array.isArray(e))return this.removeGeometry([e]);for(var o=e.length-1;o>=0;o--)e[o]instanceof ae||(e[o]=this.getGeometryById(e[o])),!(!e[o]||this!==e[o].getLayer())&&e[o].remove();return this.fire("removegeo",{geometries:e}),this},i.clear=function(){this._clearing=!0,this.forEach(function(a){a.remove()}),this._geoMap={};var e=this._geoList;this._geoList=[];var o=this._getRenderer();return o&&(o.onGeometryRemove(e),o.clearImageData&&(o.clearImageData(),delete o._lastGeosToDraw)),this._clearing=!1,this.fire("clear"),this},i.onRemoveGeometry=function(e){if(!(!e||this._clearing)&&this===e.getLayer()){var o=e._getInternalId();if(!M(o)){var a=e.getId();M(a)||delete this._geoMap[a];var s=this._findInList(e);s>=0&&this._geoList.splice(s,1),this._getRenderer()&&this._getRenderer().onGeometryRemove([e])}}},i.getStyle=function(){return this.options.style?this.options.style:null},i.setStyle=function(e){return this.options.style=e,e=E1(e),this._cookedStyles=Nm(e),this.forEach(function(o){this._styleGeometry(o)},this),this.fire("setstyle",{style:e}),this},i._styleGeometry=function(e){if(!this._cookedStyles)return!1;for(var o=ku(e),a=0,s=this._cookedStyles.length;a<s;a++)if(this._cookedStyles[a].filter(o)===!0)return e._setExternSymbol(this._cookedStyles[a].symbol),!0;return!1},i.removeStyle=function(){return this.options.style?(delete this.options.style,delete this._cookedStyles,this.forEach(function(e){e._setExternSymbol(null)},this),this.fire("removestyle"),this):this},i.onAddGeometry=function(e){var o=this.getStyle();o&&this._styleGeometry(e)},i.hide=function(){for(var e=0,o=this._geoList.length;e<o;e++)this._geoList[e].onHide();return it.prototype.hide.call(this)},i._initCache=function(){this._geoList||(this._geoList=[],this._geoMap={})},i._updateZIndex=function(){for(var e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];this._maxZIndex=Math.max(this._maxZIndex,Math.max.apply(Math,o)),this._minZIndex=Math.min(this._minZIndex,Math.min.apply(Math,o))},i._sortGeometries=function(){var e=this;this._toSort&&(this._maxZIndex=0,this._minZIndex=0,this._geoList.sort(function(o,a){return e._updateZIndex(o.getZIndex(),a.getZIndex()),e._compare(o,a)}),this._toSort=!1)},i._compare=function(e,o){return e.getZIndex()===o.getZIndex()?e._getInternalId()-o._getInternalId():e.getZIndex()-o.getZIndex()},i._findInList=function(e){var o=this._geoList.length;if(o===0)return-1;this._sortGeometries();for(var a=0,s=o-1,l;a<=s;){if(l=Math.floor((a+s)/2),this._geoList[l]===e)return l;this._compare(this._geoList[l],e)>0?s=l-1:a=l+1}return-1},i._onGeometryEvent=function(e){if(!(!e||!e.target)){var o=e.type;o==="idchange"?this._onGeometryIdChange(e):o==="zindexchange"?this._onGeometryZIndexChange(e):o==="positionchange"?this._onGeometryPositionChange(e):o==="shapechange"?this._onGeometryShapeChange(e):o==="symbolchange"?this._onGeometrySymbolChange(e):o==="show"?this._onGeometryShow(e):o==="hide"?this._onGeometryHide(e):o==="propertieschange"&&this._onGeometryPropertiesChange(e)}},i._onGeometryIdChange=function(e){if(!(e.new===e.old&&this._geoMap[e.old]&&this._geoMap[e.old]===e.target)){if(!M(e.new)){if(this._geoMap[e.new])throw new Error("Duplicate geometry id in layer("+this.getId()+"):"+e.new);this._geoMap[e.new]=e.target}!M(e.old)&&e.new!==e.old&&delete this._geoMap[e.old]}},i._onGeometryZIndexChange=function(e){e.old!==e.new&&(this._updateZIndex(e.new),this._toSort=!0,this._getRenderer()&&this._getRenderer().onGeometryZIndexChange(e))},i._onGeometryPositionChange=function(e){this._getRenderer()&&this._getRenderer().onGeometryPositionChange(e)},i._onGeometryShapeChange=function(e){this._getRenderer()&&this._getRenderer().onGeometryShapeChange(e)},i._onGeometrySymbolChange=function(e){this._getRenderer()&&this._getRenderer().onGeometrySymbolChange(e)},i._onGeometryShow=function(e){this._getRenderer()&&this._getRenderer().onGeometryShow(e)},i._onGeometryHide=function(e){this._getRenderer()&&this._getRenderer().onGeometryHide(e)},i._onGeometryPropertiesChange=function(e){this._getRenderer()&&this._getRenderer().onGeometryPropertiesChange(e)},i._hasGeoListeners=function(e){if(!e)return!1;Array.isArray(e)||(Mg[0]=e,e=Mg);for(var o=this.getGeometries()||[],a=0,s=o.length;a<s;a++)for(var l=0,h=e.length;l<h;l++){var u=e[l],f=o[a].listens(u);if(f>0)return!0}return!1},t}(it);ey.mergeOptions(yP);var wP=new ee,xP={debug:!1,enableSimplify:!0,defaultIconSize:[20,20],cacheVectorOnCanvas:!0,cacheSvgOnCanvas:K.gecko,enableAltitude:!1,altitudeProperty:"altitude",drawAltitude:!1,sortByDistanceToCamera:!1,roundPoint:!1,altitude:0,clipBBoxBufferSize:3,collision:!1,collisionBufferSize:2,collisionDelay:250,collisionScope:"layer"},or=function(r){F(t,r);function t(n,e,o){return r.call(this,n,e,o)||this}var i=t.prototype;return i.onConfig=function(e){if(r.prototype.onConfig.call(this,e),e.enableAltitude||e.drawAltitude||e.altitudeProperty){var o=this.getRenderer();o&&o.setToRedraw&&o.setToRedraw()}},i.identify=function(e,o){o===void 0&&(o={});var a=this.getRenderer();e instanceof z||(e=new z(e));var s=this.getMap().coordToContainerPoint(e);return o.onlyVisible&&a&&a.identifyAtPoint?a.identifyAtPoint(s,o):this._hitGeos(this._geoList,s,o)},i.identifyAtPoint=function(e,o){o===void 0&&(o={});var a=this.getRenderer();return e instanceof k||(e=new k(e)),o.onlyVisible&&a&&a.identifyAtPoint?a.identifyAtPoint(e,o):this._hitGeos(this._geoList,e,o)},i._hitGeos=function(e,o,a){a===void 0&&(a={});var s=a.filter,l=[],h=a.tolerance,u=this.getMap(),f=this.getRenderer(),c=f&&f.getImageData&&f.getImageData();if(c){for(var d=0,g=e.length-1;g>=0;g--){var v=e[g]._hitTestTolerance()+(h||0);v>d&&(d=v)}var y=u.getDevicePixelRatio();c.r=y;for(var p=!1,m=o.x-d,_=o.y-d,w=-d;w<=d;w++){for(var C=-d;C<=d;C++){var x=Math.round((m+w)*y),T=Math.round((_+C)*y),P=T*c.width*4+x*4;if(c.data[P+3]>0){p=!0;break}}if(p)break}if(!p)return l}for(var S=e.length-1;S>=0;S--){var E=e[S];if(!(!E||!E.isVisible()||!E._getPainter()||!E.options.interactive)){var D=E._getPainter(),A=D.getRenderBBOX&&D.getRenderBBOX();if(A){var I=o.x,L=o.y;if(I<A[0]||L<A[1]||I>A[2]||L>A[3])continue}if(!(E instanceof xe)||!E._getArrowStyle()&&!(E instanceof Zo)){var O=E.getContainerExtent(wP);if(h&&(O=O._expand(h)),!O||!O.contains(o))continue}if(E._containsPoint(o,h)&&(!s||s(E))&&(l.push(E),a.count&&l.length>=a.count))break}}return l},i.getAltitude=function(){return this.options.altitude||0},i.toJSON=function(e){e||(e={});var o={type:this.getJSONType(),id:this.getId(),options:this.config()};if(M(e.geometries)||e.geometries){var a;if(e.clipExtent){var s=this.getMap(),l=s?s.getProjection():null;a=new ge(e.clipExtent,l)}for(var h=[],u=this.getGeometries(),f=0,c=u.length;f<c;f++){var d=u[f],g=d.getExtent();if(!(!g||a&&!a.intersects(g))){var v=d.toJSON(e.geometries);h.push(v)}}o.geometries=h}return o},t.fromJSON=function(e){if(!e||e.type!=="VectorLayer")return null;for(var o=new t(e.id,e.options),a=e.geometries,s=[],l=0;l<a.length;l++){var h=ae.fromJSON(a[l]);h&&s.push(h)}return o.addGeometry(s),o},t.getPainterClass=function(){return ic},t.getCollectionPainterClass=function(){return F_},t}(ey);or.mergeOptions(xP);or.registerJSONType("VectorLayer");var Ra="_map_tool",Eg=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.addTo=function(e){return e?(this._map=e,e[Ra]&&e[Ra].disable(),this.onAdd&&this.onAdd(),this.enable(),e[Ra]=this,this._fireEvent("add"),this):this},i.getMap=function(){return this._map},i.enable=function(){var e=this._map;return!e||this._enabled?this:(this._enabled=!0,this._switchEvents("off"),this._registerEvents(),this.onEnable&&this.onEnable(),this._fireEvent("enable"),this)},i.disable=function(){return!this._enabled||!this._map?this:(this._enabled=!1,this._switchEvents("off"),this.onDisable&&this.onDisable(),this._fireEvent("disable"),this)},i.isEnabled=function(){return!!this._enabled},i.remove=function(){return this._map?(this.disable(),this._map&&(delete this._map[Ra],delete this._map),this._fireEvent("remove"),this):this},i._registerEvents=function(){this._switchEvents("on")},i._switchEvents=function(e){var o=this.getEvents();o&&this._map[e](o,this)},i._fireEvent=function(e,o){o||(o={}),this.fire(e,o)},t}(Cr(zt)),CP={symbol:{lineColor:"#000",lineWidth:2,lineOpacity:1,polygonFill:"#fff",polygonOpacity:.3},doubleClickZoom:!1,mode:null,once:!1,autoPanAtEdge:!1,ignoreMouseleave:!0,blockGeometryEvents:!1},kg={},Ze=function(r){F(t,r),t.registerMode=function(e,o){kg[e.toLowerCase()]=o},t.getRegisterMode=function(e){return kg[e.toLowerCase()]};function t(n){var e;return e=r.call(this,n)||this,e._checkMode(),e._events={click:e._clickHandler,"mousemove touchmove":e._mouseMoveHandler,dblclick:e._doubleClickHandler,"mousedown touchstart":e._mouseDownHandler,"mouseup touchend":e._mouseUpHandler,mousemove:e._mouseMoveHandler,mousedown:e._mouseDownHandler,mouseup:e._mouseUpHandler},e}var i=t.prototype;return i.getMode=function(){return this.options.mode?this.options.mode.toLowerCase():null},i.setMode=function(e){return this._geometry&&(this._geometry.remove(),delete this._geometry),this._clearStage(),this._switchEvents("off"),this.options.mode=e,this._checkMode(),this.isEnabled()&&(this._switchEvents("on"),this._restoreMapCfg(),this._saveMapCfg()),this},i.getSymbol=function(){var e=this.options.symbol;return Kt(e||this.options.symbol)},i.setSymbol=function(e){return e?(this.options.symbol=e,this._geometry&&this._geometry.setSymbol(e),this):this},i.getCurrentGeometry=function(){return this._geometry},i.onAdd=function(){this._checkMode()},i.onEnable=function(){this._saveMapCfg(),this._drawToolLayer=this._getDrawLayer(),this._clearStage(),this._loadResources();var e=this.getMap();return this.options.autoPanAtEdge&&(this._mapAutoPanAtEdge=e.options.autoPanAtEdge,this._mapAutoPanAtEdge||e.config({autoPanAtEdge:!0})),this._geometryEvents=e.options.geometryEvents,this.options.blockGeometryEvents&&e.config("geometryEvents",!1),this},i.onDisable=function(){var e=this.getMap();return this._restoreMapCfg(),this.endDraw({ignoreEndEvent:!0}),this._map&&(e.removeLayer(this._getDrawLayer()),this.options.autoPanAtEdge&&(this._mapAutoPanAtEdge||e.config({autoPanAtEdge:!1}))),this.options.blockGeometryEvents&&e.config("geometryEvents",this._geometryEvents),this},i.undo=function(){var e=this._getRegisterMode(),o=e.action;if(!this._shouldRecordHistory(o)||!this._historyPointer)return this;var a=this._clickCoords.slice(0,--this._historyPointer);return e.update(this.getMap().getProjection(),a,this._geometry),this},i.redo=function(){var e=this._getRegisterMode(),o=e.action;if(!this._shouldRecordHistory(o)||M(this._historyPointer)||this._historyPointer===this._clickCoords.length)return this;var a=this._clickCoords.slice(0,++this._historyPointer);return e.update(this.getMap().getProjection(),a,this._geometry),this},i._shouldRecordHistory=function(e){return Array.isArray(e)&&e[0]==="click"&&e[1]==="mousemove"&&e[2]==="dblclick"},i._checkMode=function(){this._getRegisterMode()},i._saveMapCfg=function(){var e=this.getMap();this._mapDoubleClickZoom=e.options.doubleClickZoom,e.config({doubleClickZoom:this.options.doubleClickZoom});for(var o=this._getRegisterMode().action,a=!1,s=0;s<o.length;s++)if(o[s].indexOf("mousedown")>=0||o[s].indexOf("touchstart")>=0){a=!0;break}if(a){var l=this.getMap();this._mapDraggable=l.options.draggable,l.config({draggable:!1})}},i._restoreMapCfg=function(){var e=this.getMap();e.config({doubleClickZoom:this._mapDoubleClickZoom}),M(this._mapDraggable)||e.config("draggable",this._mapDraggable),delete this._mapDraggable,delete this._mapDoubleClickZoom},i._loadResources=function(){var e=this.getSymbol(),o=el(e);o.length>0&&this._drawToolLayer._getRenderer().loadResources(o)},i._getProjection=function(){return this._map.getProjection()},i._getRegisterMode=function(){var e=this.getMode(),o=t.getRegisterMode(e);if(!o)throw new Error(e+" is not a valid mode of DrawTool.");return o},i.getEvents=function(){var e=this._getRegisterMode().action,o={};if(Array.isArray(e)){for(var a=0;a<e.length;a++)o[e[a]]=this._events[e[a]];return o}return null},i._mouseDownHandler=function(e){this._createGeometry(e)},i._mouseUpHandler=function(e){this.endDraw(e)},i._clickHandler=function(e){var o=this.getMap(),a=this._getRegisterMode();if(this._clickCoords&&this._clickCoords.length){var s=this._clickCoords.length,l=o._pointToPrj(e.point2d);if(this._clickCoords[s-1].equals(l))return}if(!this._geometry)this._createGeometry(e);else{var h=o._pointToPrj(e.point2d);M(this._historyPointer)||(this._clickCoords=this._clickCoords.slice(0,this._historyPointer));var u=this._geometry.snapTo;if(u&&oe(u)){var f=this._getSnapResult(u,e.containerPoint);if(h=f.prjCoord,this._clickCoords=this._clickCoords.concat(f.effectedVertex),this._clickCoords[this._clickCoords.length-1].equals(h))return}if(this._clickCoords.push(h),this._historyPointer=this._clickCoords.length,e.drawTool=this,a.update(o.getProjection(),this._clickCoords,this._geometry,e),this.getMode()==="point"){this.endDraw(e);return}this._clickCoords.length<=1?this._fireEvent("drawstart",e):this._fireEvent("drawvertex",e),a.clickLimit&&a.clickLimit===this._historyPointer&&this.endDraw(e)}},i._createGeometry=function(e){var o=this.getMode(),a=this._getRegisterMode(),s=this.getMap()._pointToPrj(e.point2d),l=this.getSymbol();if(!this._geometry){this._clickCoords=[s],e.drawTool=this,this._geometry=a.create(this.getMap().getProjection(),this._clickCoords,e),l&&o!=="point"?this._geometry.setSymbol(l):this.options.hasOwnProperty("symbol")&&this._geometry.setSymbol(this.options.symbol),this._addGeometryToStage(this._geometry),this._fireEvent("drawstart",e);var h=this._geometry.snapTo;if(h&&oe(h)){var u=this._getSnapResult(h,e.containerPoint),f=this.getMap();if(f&&u){var c=u.prjCoord;this._clickCoords=[c],a.update(f.getProjection(),this._clickCoords,this._geometry,e)}}}o==="point"&&e.type!=="mousemove"&&this.endDraw(e)},i._mouseMoveHandler=function(e){var o=this.getMap();if(!(!o||o.isInteracting())){if(this.getMode()==="point"&&!this._geometry){this._createGeometry(e);return}if(this._geometry){var a=this._getMouseContainerPoint(e);if(this._isValidContainerPoint(a)){var s=o._pointToPrj(e.point2d),l=[],h=this._geometry.snapTo;if(h&&oe(h)){var u=this._getSnapResult(h,a);s=u.prjCoord,l=u.effectedVertex}var f=o.getProjection();e.drawTool=this;var c=this._getRegisterMode();if(this._shouldRecordHistory(c.action)){var d=this._clickCoords.slice(0,this._historyPointer);if(d&&d.length>0&&s.equals(d[d.length-1]))return;c.update(f,d.concat(l,[s]),this._geometry,e)}else c.update(f,s,this._geometry,e);this._fireEvent("mousemove",e)}}}},i._doubleClickHandler=function(e){if(this._geometry){var o=this._getMouseContainerPoint(e);if(this._isValidContainerPoint(o)){var a=this._getRegisterMode(),s=this._clickCoords;if(!(s.length<2)){var l=this.getMode();if(!(l&&l.indexOf("polygon")>-1&&s.length<3)){for(var h=this.getMap().getProjection(),u=[s[0]],f=1,c=s.length;f<c;f++)(s[f].x!==s[f-1].x||s[f].y!==s[f-1].y)&&u.push(s[f]);u.length<2||this._geometry&&this._geometry instanceof Oe&&u.length<3||(e.drawTool=this,a.update(h,u,this._geometry,e),this.endDraw(e))}}}}},i._addGeometryToStage=function(e){var o=this._getDrawLayer();o.addGeometry(e)},i.endDraw=function(e){if(!this._geometry||this._ending)return this;this._ending=!0;var o=this._geometry;return this._clearStage(),e=e||{},this._geometry=o,e.ignoreEndEvent||this._fireEvent("drawend",e),delete this._geometry,this.options.once&&this.disable(),delete this._ending,delete this._historyPointer,this._vertexes&&(this._vertexes=[]),this},i._clearStage=function(){this._getDrawLayer().clear(),delete this._geometry,delete this._clickCoords},i._getMouseContainerPoint=function(e){var o=this._getRegisterMode().action;return(o[0].indexOf("mousedown")>=0||o[0].indexOf("touchstart")>=0)&&wt(e.domEvent),e.containerPoint},i._isValidContainerPoint=function(e){var o=this._map.getSize(),a=o.width,s=o.height;return e.x<0||e.y<0?!1:!(e.x>a||e.y>s)},i._getSnapResult=function(e,o){var a=this.getMap(),s=[];if(this.options.edgeAutoComplete){var l=this._clickCoords[(this._historyPointer||1)-1];s.push(a._prjToContainerPoint(l));var h=this._clickCoords[(this._historyPointer||1)-2];h&&s.push(a._prjToContainerPoint(h))}var u=e(o,s);o=(u.effectedVertex?u.point:u)||o;var f=a._containerPointToPrj(o);return u.effectedVertex&&(u.effectedVertex=u.effectedVertex.map(function(c){return a._containerPointToPrj(c)})),{prjCoord:f,effectedVertex:u.effectedVertex||[]}},i._getDrawLayer=function(){var e=Bo+"drawtool",o=this._map.getLayer(e);return o||(o=new or(e,{enableSimplify:!1,enableAltitude:this.options.enableAltitude}),this._map.addLayer(o)),o},i._fireEvent=function(e,o){o||(o={}),o=W({},o),this._geometry&&(o.geometry=this._getRegisterMode().generate(this._geometry,{drawTool:this}),o.tempGeometry=this._geometry),Eg.prototype._fireEvent.call(this,e,o)},t}(Eg);Ze.mergeOptions(CP);var PP=function(r){F(t,r);function t(n){var e;return e=r.call(this,n)||this,e.drawTool=new Ze({mode:"boxZoom",ignoreMouseleave:!1}),e}var i=t.prototype;return i.addHooks=function(){this.target.on("_mousedown",this._onMouseDown,this)},i.removeHooks=function(){this.target.off("_mousedown",this._onMouseDown,this),this.drawTool.isEnabled()&&this.drawTool.remove()},i._onMouseDown=function(e){this.target.options.boxZoom&&e.domEvent.shiftKey&&this.drawTool.setSymbol(this.target.options.boxZoomSymbol).on("drawend",this._boxZoom,this).addTo(this.target)},i._boxZoom=function(e){var o=this.target;this.drawTool.remove();var a=e.geometry,s=a.getCenter(),l=a.getSymbol(),h=l.markerWidth,u=l.markerHeight,f=new ge(s,o.locateByPoint(s,h,u),o.getProjection()),c=o.getFitZoom(f);o._animateTo({center:f.getCenter(),zoom:c})},t}(Xt);Q.mergeOptions({boxZoom:!0,boxZoomSymbol:{markerType:"rectangle",markerLineWidth:3,markerLineColor:"#1bbc9b",markerLineDasharray:[10,5],markerFillOpacity:.1,markerFill:"#1bbc9b",markerWidth:1,markerHeight:1}});Q.addOnLoadHook("addHandler","boxZoom",PP);var Mr=30,TP=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.addHooks=function(){this.target&&this.target.on("_mousemove",this._onMouseMove,this)},i.removeHooks=function(){this.target&&this.target.off("_mousemove",this._onMouseMove,this)},i._onMouseMove=function(e){var o=this.target;if(o.options.autoPanAtEdge){var a=e.containerPoint,s=o.getContainerExtent();if(s){var l=a.x,h=a.y,u=s.xmax,f=s.ymax,c;l<Mr&&(c=[Math.abs(l-Mr),0]),h<Mr&&(c=[0,Math.abs(h-Mr)]),l+Mr>u&&(c=[-Math.abs(l+Mr-u),0]),h+Mr>f&&(c=[0,-Math.abs(h+Mr-f)]),c&&o.panBy(c,{duration:1})}}},t}(Xt);Q.mergeOptions({autoPanAtEdge:!1});Q.addOnLoadHook("addHandler","autoPanAtEdge",TP);Q.include({animateTo:function(t,i,n){var e=this;i===void 0&&(i={}),t=W({},this.getView(),t),oe(i)&&(n=i,i={});var o=this.getProjection(),a=this.getView(),s={},l=!0;for(var h in t)if(Go(t,h)&&!M(t[h])&&(h==="prjCenter"||!M(a[h])))if(l=!1,h==="center"){var u=new z(a[h]),f=new z(t[h]);u.equals(f)||(s.center=[u,f])}else if(h==="prjCenter"){var c=new z(this._getPrjCenter()),d=new z(t[h]);c.equals(d)||(s.prjCenter=[c,d])}else a[h]!==t[h]&&h!=="around"&&(s[h]=[a[h],t[h]]);if(l)return null;this._animPlayer&&(this._isInternalAnimation?this._animPlayer.playState==="running"&&(this._animPlayer.pause(),this._prevAnimPlayer=this._animPlayer):(delete this._prevAnimPlayer,this._stopAnim(this._animPlayer)));var g=t.around||new k(this.width/2,this.height/2),v=this._getRenderer(),y=function(_){v.callInNextFrame(_)},p=this._animPlayer=Ge.animate(s,{easing:i.easing||"out",duration:i.duration||this.options.zoomAnimationDuration,framer:y,repeat:i.repeat},function(m){if(e.isRemoved()){p.finish();return}if(p.playState==="running"){if(m.styles.center){var _=m.styles.center;e._setPrjCenter(o.project(_)),e.onMoving(e._parseEventFromCoord(e.getCenter()))}else if(m.styles.prjCenter){var w=m.styles.prjCenter;e._setPrjCenter(w),e.onMoving(e._parseEventFromCoord(e.getCenter()))}M(m.styles.zoom)||e.onZooming(m.styles.zoom,g),M(m.styles.pitch)||e._setPitch(m.styles.pitch),M(m.styles.bearing)||e._setBearing(m.styles.bearing),e._fireEvent("animating")}else(p.playState!=="paused"||p===e._mapAnimPlayer)&&(p._interupted||(s.center?e._setPrjCenter(o.project(s.center[1])):s.prjCenter&&e._setPrjCenter(s.prjCenter[1]),M(s.pitch)||e._setPitch(s.pitch[1]),M(s.bearing)||e._setBearing(s.bearing[1])),e._endAnim(p,s,g,i));n&&n(m)},this);return this._startAnim(s,g),p},_animateTo:function(t,i,n){return i===void 0&&(i={}),this._mapAnimPlayer&&this._stopAnim(this._mapAnimPlayer),this._isInternalAnimation=!0,this._mapAnimPlayer=this.animateTo(t,i,n),delete this._isInternalAnimation,this._mapAnimPlayer},flyTo:function(t,i,n){var e=this;i===void 0&&(i={}),t=W({},this.getView(),t),this._animPlayer&&(this._isInternalAnimation?this._animPlayer.playState==="running"&&(this._animPlayer.pause(),this._prevAnimPlayer=this._animPlayer):(delete this._prevAnimPlayer,this._stopAnim(this._animPlayer))),oe(i)&&(n=i,i={}),i=W({curve:1.42},i);var o=this;function a(J,q){return o.getResolution(q)/o.getResolution(J)}var s=t.around||new k(this.width/2,this.height/2),l=this.getMinZoom(),h=this.getMaxZoom(),u=this.getProjection(),f=this.getView(),c=f.zoom,d=f.bearing,g=f.pitch,v="zoom"in t?Tu(+t.zoom,l,h):c,y="bearing"in t?+t.bearing:d,p="pitch"in t?+t.pitch:g,m=u.project(t.center&&new z(t.center)||this.getCenter()),_=a(v,c),w=u.project(this.getCenter()),C=m.sub(w),x=i.curve,T=Math.max(this.width,this.height),P=T/_,S=C.mag();if("minZoom"in i){var E=Tu(Math.min(i.minZoom,c,v),l,h),D=T/a(E,c);x=Math.sqrt(D/S*2)}var A=x*x;function I(J){var q=(P*P-T*T+(J?-1:1)*A*A*S*S)/(2*(J?P:T)*A*S);return Math.log(Math.sqrt(q*q+1)-q)}function L(J){return(Math.exp(J)-Math.exp(-J))/2}function O(J){return(Math.exp(J)+Math.exp(-J))/2}function H(J){return L(J)/O(J)}var B=I(0),R=function(q){return O(B)/O(B+x*q)},b=function(q){return T*((O(B)*H(B+x*q)-L(B))/A)/S},N=(I(1)-B)/x;if(Math.abs(S)<1e-6||!isFinite(N)){if(Math.abs(T-P)<1e-6)return this.animateTo(t,i,n);var Z=P<T?-1:1;N=Math.abs(Math.log(P/T))/x,b=function(){return 0},R=function(q){return Math.exp(Z*x*q)}}var X=this._getRenderer(),ne=function(q){X.callInNextFrame(q)},te=this._animPlayer=Ge.animate({k:[0,1]},{easing:i.easing||"out",duration:i.duration||8,framer:ne},function(J){if(e.isRemoved()){te.finish();return}var q=J.styles.k,ue=q*N,me=1/R(ue),re={};if(t.center){var He=q===1?m:w.add(C.multi(b(ue)));re.prjCenter=[m,He]}if(c!==v){var nt=q===1?v:e.getZoomForScale(me,c,!0);re.zoom=[c,nt]}if(g!==p){var _e=Rg(g,p,q);re.pitch=[p,_e]}if(d!==y){var Le=Rg(d,y,q);re.bearing=[y,Le]}if(te.playState==="running"){if(re.prjCenter){var Tt=re.prjCenter;e._setPrjCenter(Tt[1]),e.onMoving(e._parseEventFromCoord(e.getCenter()))}re.zoom&&e.onZooming(re.zoom[1],s),re.pitch&&e._setPitch(re.pitch[1]),re.bearing&&e._setBearing(re.bearing[1]),e._fireEvent("animating")}else(te.playState!=="paused"||te===e._mapAnimPlayer)&&(te._interupted||(re.prjCenter&&e._setPrjCenter(re.prjCenter[1]),re.pitch&&e._setPitch(re.pitch[1]),re.bearing&&e._setBearing(re.bearing[1])),e._endAnim(te,re,s,i));n&&n(J)});return this._startAnim({center:t.center,zoom:t.zoom!==c,pitch:p!==g,bearing:y!==d},s),this},isAnimating:function(){return!!this._animPlayer},isRotating:function(){return this.isDragRotating()||!!this._animRotating},_endAnim:function(t,i,n,e){delete this._animRotating;var o=t._interupted?"animateinterrupted":"animateend";if(t===this._animPlayer&&delete this._animPlayer,t===this._mapAnimPlayer&&delete this._mapAnimPlayer,i.center){var a;t._interupted?a=this.getCenter():a=i.center[1],this.onMoveEnd(this._parseEventFromCoord(a))}else if(i.prjCenter){var s;t._interupted?s=this._getPrjCenter():s=i.prjCenter[1];var l=this._parseEventFromCoord(this.getProjection().unproject(s));l.point2d=this._prjToPoint(s),this.onMoveEnd(l)}M(i.zoom)||(t._interupted?this.onZoomEnd(this.getZoom()):e.wheelZoom?this.onZooming(i.zoom[1],n):this.onZoomEnd(i.zoom[1])),o&&this._fireEvent(o),!M(i.pitch)&&!this.getPitch()&&this.getRenderer().setToRedraw(),e.wheelZoom||this._resumePrev(t)},_startAnim:function(t,i){this._animPlayer&&((t.center||t.prjCenter)&&this.onMoveStart(),t.zoom&&!this.isZooming()&&this.onZoomStart(t.zoom[1],i),(t.pitch||t.bearing)&&(this._animRotating=!0),this._fireEvent("animatestart"),this._animPlayer.play())},_stopAnim:function(t){t&&(delete this._animRotating,t.playState!=="finished"&&(t._interupted=!0,t.cancel()),t===this._animPlayer&&delete this._animPlayer,t===this._mapAnimPlayer&&delete this._mapAnimPlayer)},_resumePrev:function(t){if(this._prevAnimPlayer){var i=this._prevAnimPlayer;i.playState!=="paused"&&delete this._prevAnimPlayer,t!==i&&(this._animPlayer=i,i.play())}}});function Rg(r,t,i){return r*(1-i)+t*i}var Ag="mousedown mouseup mouseover mouseout mouseenter mouseleave mousemove click dblclick contextmenu keypress touchstart touchmove touchend ";Q.include({_registerDomEvents:function(){var t=this._panels.mapWrapper||this._containerDOM;ir(t,Ag,this._handleDOMEvent,this)},_removeDomEvents:function(){var t=this._panels.mapWrapper||this._containerDOM;dr(t,Ag,this._handleDOMEvent)},_handleDOMEvent:function(t){var i=this.options.clickTimeThreshold,n=t.type,e=n==="mousedown"||n==="touchstart"&&(!t.touches||t.touches.length===1);e&&(this._domMouseDownTime=ve(),this._domMouseDownView=this.getView());var o=n==="contextmenu"&&SP(this);if(n==="contextmenu"){yr(t);var a=this._domMouseDownTime,s=ve();s-a<=i&&!o&&this._fireDOMEvent(this,t,"dom:"+t.type)}else this._fireDOMEvent(this,t,"dom:"+t.type);if(!this._ignoreEvent(t)){var l=!1;if(e)this._mouseDownTime=ve();else if(n==="click"||n==="touchend"||n==="contextmenu")if(this._mouseDownTime){var h=this._mouseDownTime;delete this._mouseDownTime;var u=ve();if(u-h>i){if(n==="click"||n==="contextmenu")return}else if(n==="contextmenu"){if(o)return}else n==="touchend"&&(l=!0)}else return;var f;l&&(this._clickTime&&ve()-this._clickTime<=i?(delete this._clickTime,f="dblclick",this._fireDOMEvent(this,t,"dom:dblclick")):(this._clickTime=ve(),f="click",this._fireDOMEvent(this,t,"dom:click"))),!this._ignoreEvent(t)&&(this._fireDOMEvent(this,t,n),f&&this._fireDOMEvent(this,t,f))}},_ignoreEvent:function(t){if(!t||!this._panels.control)return!1;if(this._isEventOutMap(t))return!0;var i=t.srcElement||t.target,n;if(i)for(;i&&i!==this._containerDOM;){if(i.className&&i.className.indexOf&&(i.className.indexOf("maptalks-control")>=0||i.className.indexOf("maptalks-ui")>=0&&n&&!n.eventsPropagation))return!0;n=i,i=i.parentNode}return!1},_isEventOutMap:function(t){if(this.getPitch()>this.options.maxVisualPitch){var i=this._getActualEvent(t),n=_t(i,this._containerDOM);if(!this.getContainerExtent().contains(n))return!0}return!1},_parseEvent:function(t,i){if(!t)return null;var n={domEvent:t};if(i!=="keypress"){var e=this._getActualEvent(t);if(e&&e.clientX!==void 0){var o=_t(e,this._containerDOM);n=W(n,{containerPoint:o,viewPoint:this.containerPointToViewPoint(o)});var a=this.options.maxVisualPitch;(this.getPitch()<=a||o.y>=this.height-this._getVisualHeight(a))&&(n=W(n,{coordinate:this.containerPointToCoord(o),point2d:this._containerPointToPoint(o)}))}}return n},_parseEventFromCoord:function(t){var i=this.coordToContainerPoint(t),n=this.containerPointToViewPoint(i),e={coordinate:t,containerPoint:i,viewPoint:n,point2d:this.coordToPoint(t)};return e},_getActualEvent:function(t){return t.touches&&t.touches.length>0?t.touches[0]:t.changedTouches&&t.changedTouches.length>0?t.changedTouches[0]:t},_fireDOMEvent:function(t,i,n){var e=this;if(!this.isRemoved()){var o=this._parseEvent(i,n);Ym(n)?this.getRenderer().callInNextFrame(function(){if(o.domEvent&&o.domEvent._cancelBubble){e._fireEvent("_"+n,o);return}e._fireEvent(n,o)}):this._fireEvent(n,o)}},_getEventParams:function(t){var i=this,n={domEvent:t},e=t.touches&&t.touches.length>0?t.touches[0]:t.changedTouches&&t.changedTouches.length>0?t.changedTouches[0]:t;if(e){var o=_t(e,i._containerDOM);n.coordinate=i.containerPointToCoordinate(o),n.containerPoint=o,n.viewPoint=i.containerPointToViewPoint(o),n.pont2d=i._containerPointToPoint(o)}return n}});Q.addOnLoadHook("_registerDomEvents");function SP(r){if(!r._domMouseDownView)return!0;var t=r.getView(),i=r._domMouseDownView;return t.bearing!==i.bearing||t.pitch!==i.pitch}Q.include({isFullScreen:function(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)},requestFullScreen:function(t){return this._fireEvent("fullscreenstart"),this._requestFullScreen(t||this._containerDOM),this._fireEvent("fullscreenend"),this},cancelFullScreen:function(){return this._cancelFullScreen(),this._fireEvent("cancelfullscreen"),this},_requestFullScreen:function(t){if(t.requestFullscreen)t.requestFullscreen();else if(t.mozRequestFullScreen)t.mozRequestFullScreen();else if(t.webkitRequestFullScreen)t.webkitRequestFullScreen();else if(t.msRequestFullScreen)t.msRequestFullScreen();else{var i="fullscreen=1,status=no,resizable=yes,top=0,left=0,scrollbars=no,titlebar=no,menubar=no,location=no,toolbar=no,z-look=yes,width="+(screen.availWidth-8)+",height="+(screen.availHeight-45),n=window.open(location.href,"_blank",i);n!==null&&(window.opener=null,window.close())}},_cancelFullScreen:function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.webkitCancelFullScreen)document.webkitCancelFullScreen();else{var t="fullscreen=no,status=yes,resizable=yes,scrollbars=no,titlebar=no,menubar=yes,location=yes,toolbar=yes,z-look=yes",i=window.open(location.href,"_blank",t);i!==null&&(window.opener=null,window.close())}}});Q.include({panTo:function(t,i,n){if(i===void 0&&(i={}),!t)return this;if(oe(i)&&(n=i,i={}),t=new z(t),typeof i.animation>"u"||i.animation){var e=this.getProjection().project(t);return this._panAnimation(e,i.duration,n)}else this.setCenter(t);return this},_panTo:function(t,i){return i===void 0&&(i={}),typeof i.animation>"u"||i.animation?this._panAnimation(t,i.duration):(this.onMoveStart(),this._setPrjCenter(t),this.onMoveEnd(this._parseEventFromCoord(this.getCenter())),this)},panBy:function(t,i,n){if(i===void 0&&(i={}),!t)return this;oe(i)&&(n=i,i={}),t=new k(t);var e=this.getContainerExtent(),o=e.ymin;if(o>0&&t.y>30){var a=t.y;t.y=30,t.x=t.x*30/a,console.warn("offset is limited to panBy when pitch is above maxPitch")}if(typeof i.animation>"u"||i.animation){t=t.multi(-1);var s=this._containerPointToPrj(new k(this.width/2+t.x,this.height/2+t.y));this._panAnimation(s,i.duration,n)}else{this.onMoveStart(),this._offsetCenterByPixel(t);var l=this.containerPointToCoord(new k(this.width/2,this.height/2));this.onMoveEnd(this._parseEventFromCoord(l))}return this},_panAnimation:function(t,i,n){return this._animateTo({prjCenter:t},{duration:i||this.options.panAnimationDuration},n)}});ae.fromJSON=function(r){if(Array.isArray(r)){for(var t=[],i=0,n=r.length;i<n;i++){var e=ae.fromJSON(r[i]);Array.isArray(r)?t=t.concat(e):t.push(e)}return t}if(r&&!r.feature)return br.toGeometry(r);var o;return r.subType?(o=ae.getJSONClass(r.subType).fromJSON(r),M(r.feature.id)||o.setId(r.feature.id)):(o=br.toGeometry(r.feature),r.options&&o.config(r.options)),r.symbol&&o.setSymbol(r.symbol),r.infoWindow&&o.setInfoWindow(r.infoWindow),o};it.fromJSON=function(r){if(!r)return null;var t=r.type,i=it.getJSONClass(t);if(!i||!i.fromJSON)throw new Error("unsupported layer type:"+t);return i.fromJSON(r)};Q.include({JSON_VERSION:"1.0",toJSON:function(t){t||(t={});var i={jsonVersion:this.JSON_VERSION,version:this.VERSION,extent:this.getExtent().toJSON()};i.options=this.config(),i.options.center=this.getCenter(),i.options.zoom=this.getZoom(),i.options.bearing=this.getBearing(),i.options.pitch=this.getPitch();var n=this.getBaseLayer();(M(t.baseLayer)||t.baseLayer)&&n&&(i.baseLayer=n.toJSON(t.baseLayer));var e={};t.clipExtent&&(t.clipExtent===!0?e.clipExtent=this.getExtent():e.clipExtent=t.clipExtent);var o=[];if(M(t.layers)||t.layers&&!Array.isArray(t.layers)){for(var a=this.getLayers(),s=0,l=a.length;s<l;s++)if(a[s].toJSON){var h=W({},Zt(t.layers)?t.layers:{},e);o.push(a[s].toJSON(h))}i.layers=o}else if(he(t.layers)){for(var u=t.layers,f=0;f<u.length;f++){var c=u[f],d=this.getLayer(c.id);if(d.toJSON){var g=W({},c.options,e);o.push(d.toJSON(g))}}i.layers=o}else i.layers=[];return i}});Q.fromJSON=function(r,t,i){if(!r||!t)return null;i||(i={});var n=new Q(r,t.options);if(M(i.baseLayer)||i.baseLayer){var e=it.fromJSON(t.baseLayer);e&&n.setBaseLayer(e)}if(M(i.layers)||i.layers){for(var o=[],a=t.layers,s=0;s<a.length;s++){var l=it.fromJSON(a[s]);o.push(l)}n.addLayer(o)}return n};Q.include({computeLength:function(t,i){if(!this.getProjection())return null;var n=new z(t),e=new z(i);return n.equals(e)?0:this.getProjection().measureLength(n,e)},computeGeometryLength:function(t){return t._computeGeodesicLength(this.getProjection())},computeGeometryArea:function(t){return t._computeGeodesicArea(this.getProjection())},identify:function(t,i){t=t||{};var n=new z(t.coordinate);return this._identify(t,i,function(e){return e.identify(n,t)})},identifyAtPoint:function(t,i){var n=t.includeInternals,e=t.tolerance;t=t||{};var o=new k(t.containerPoint),a=this.containerPointToCoord(o);return this._identify(t,i,function(s){var l;return n&&!M(s.options.geometryEventTolerance)&&(t.tolerance=t.tolerance||0,t.tolerance+=s.options.geometryEventTolerance),s.identifyAtPoint?l=s.identifyAtPoint(o,t):a&&s.identify?l=s.identify(a,t):l=[],n&&(M(e)?delete t.tolerance:t.tolerance=e),(!l||!l.length)&&s.fire("identifyempty",t),l})},_identify:function(t,i,n){var e=t.layers;if(!he(e))return this;for(var o=t.eventTypes,a=[],s=0,l=e.length;s<l;s++)ie(e[s])?a.push(this.getLayer(e[s])):a.push(e[s]);o&&(a=a.filter(function(d){return d._hasGeoListeners?d._hasGeoListeners(o):!0}));for(var h=[],u=a.length-1;u>=0&&!(t.count&&h.length>=t.count);u--){var f=a[u];if(!(!f||!f.getMap()||!t.includeInvisible&&!f.isVisible()||!t.includeInternals&&f.getId().indexOf(Bo)>=0)){var c=n(f);c&&(Array.isArray(c)?pi(h,c):h.push(c))}}return i.call(this,h),this}});Q.include({_zoom:function(t,i){!this.options.zoomable||this.isZooming()||(i=this._checkZoomOrigin(i),t=this._checkZoom(t),this.onZoomStart(t,i),this._frameZoom=this.getZoom(),this.onZoomEnd(t,i))},_zoomAnimation:function(t,i,n){!this.options.zoomable||this.isZooming()||(t=this._checkZoom(t),this.getZoom()!==t&&(i=this._checkZoomOrigin(i),this._startZoomAnim(t,i,n)))},_checkZoomOrigin:function(t){return(!t||this.options.zoomInCenter)&&(t=new k(this.width/2,this.height/2)),this.options.zoomOrigin&&(t=new k(this.options.zoomOrigin)),t},_startZoomAnim:function(t,i,n){M(n)&&(n=1);var e=this._getResolution(this._startZoomVal)/this._getResolution(t),o=this.options.zoomAnimationDuration*Math.abs(e-n)/Math.abs(e-1);this._frameZoom=this._startZoomVal,this._animateTo({zoom:t,around:i},{continueOnViewChanged:!0,duration:o})},onZoomStart:function(t,i){!this.options.zoomable||this.isZooming()||(this._mapAnimPlayer&&this._stopAnim(this._mapAnimPlayer),delete this.cameraZenithDistance,this._zooming=!0,this._startZoomVal=this.getZoom(),this._startZoomCoord=this._containerPointToPrj(i),this._fireEvent("zoomstart",{from:this._startZoomVal,to:t}))},onZooming:function(t,i,n){if(this.options.zoomable){var e=this._frameZoom;if(e!==t){M(n)&&(n=1),this._zoomTo(t,i);var o=this.getResolution(t),a=this.getResolution(this._startZoomVal),s=a/o/n,l=this._prjToContainerPoint(this._startZoomCoord,this._startZoomVal),h=this.getViewPoint();if(!this.isRotating()&&!l.equals(i)&&s!==1){var u=this.getPitch(),f=l._sub(i)._multi(1/(1-s));u&&(f.y/=Math.cos(u*Math.PI/180)),i=i.add(f)}var c={view:[s,0,0,s,(i.x-h.x)*(1-s),(i.y-h.y)*(1-s)]},d=this.getDevicePixelRatio();d!==1&&(i=i.multi(d)),c.container=[s,0,0,s,i.x*(1-s),i.y*(1-s)],this._fireEvent("zooming",{from:this._startZoomVal,to:t,origin:i,matrix:c}),this._frameZoom=t}}},onZoomEnd:function(t,i){if(this.options.zoomable){var n=this._startZoomVal;this._zoomTo(t,i),this._zooming=!1,this._getRenderer().onZoomEnd(),this._suppressRecenter||this._recenterOnTerrain(),this._fireEvent("zoomend",{from:n,to:t}),this._verifyExtent(this._getPrjCenter())||this._panTo(this._prjMaxExtent.getCenter())}},_zoomTo:function(t,i){this._zoomLevel=t,this._calcMatrices(),i&&this._setPrjCoordAtContainerPoint(this._startZoomCoord,i)},_checkZoom:function(t){var i=this.getMaxZoom(),n=this.getMinZoom();return t<n&&(t=n),t>i&&(t=i),t}});function Og(r,t,i,n,e){var o=1/Math.tan(t/2),a=1/(n-e);return r[0]=o/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=(e+n)*a,r[11]=-1,r[12]=0,r[13]=0,r[14]=2*e*n*a,r[15]=0,r}function ty(r,t,i){var n=i[0],e=i[1],o=i[2],a,s,l,h,u,f,c,d,g,v,y,p;return t===r?(r[12]=t[0]*n+t[4]*e+t[8]*o+t[12],r[13]=t[1]*n+t[5]*e+t[9]*o+t[13],r[14]=t[2]*n+t[6]*e+t[10]*o+t[14],r[15]=t[3]*n+t[7]*e+t[11]*o+t[15]):(a=t[0],s=t[1],l=t[2],h=t[3],u=t[4],f=t[5],c=t[6],d=t[7],g=t[8],v=t[9],y=t[10],p=t[11],r[0]=a,r[1]=s,r[2]=l,r[3]=h,r[4]=u,r[5]=f,r[6]=c,r[7]=d,r[8]=g,r[9]=v,r[10]=y,r[11]=p,r[12]=a*n+u*e+g*o+t[12],r[13]=s*n+f*e+v*o+t[13],r[14]=l*n+c*e+y*o+t[14],r[15]=h*n+d*e+p*o+t[15]),r}function Nu(r,t,i){var n=i[0],e=i[1],o=i[2];return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r[3]=t[3]*n,r[4]=t[4]*e,r[5]=t[5]*e,r[6]=t[6]*e,r[7]=t[7]*e,r[8]=t[8]*o,r[9]=t[9]*o,r[10]=t[10]*o,r[11]=t[11]*o,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function MP(r,t,i){var n=Math.sin(i),e=Math.cos(i),o=t[4],a=t[5],s=t[6],l=t[7],h=t[8],u=t[9],f=t[10],c=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=o*e+h*n,r[5]=a*e+u*n,r[6]=s*e+f*n,r[7]=l*e+c*n,r[8]=h*e-o*n,r[9]=u*e-a*n,r[10]=f*e-s*n,r[11]=c*e-l*n,r}function EP(r,t,i){var n=Math.sin(i),e=Math.cos(i),o=t[0],a=t[1],s=t[2],l=t[3],h=t[4],u=t[5],f=t[6],c=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=o*e+h*n,r[1]=a*e+u*n,r[2]=s*e+f*n,r[3]=l*e+c*n,r[4]=h*e-o*n,r[5]=u*e-a*n,r[6]=f*e-s*n,r[7]=c*e-l*n,r}function oo(r,t,i){var n=t[0],e=t[1],o=t[2],a=t[3],s=t[4],l=t[5],h=t[6],u=t[7],f=t[8],c=t[9],d=t[10],g=t[11],v=t[12],y=t[13],p=t[14],m=t[15],_=i[0],w=i[1],C=i[2],x=i[3];return r[0]=_*n+w*s+C*f+x*v,r[1]=_*e+w*l+C*c+x*y,r[2]=_*o+w*h+C*d+x*p,r[3]=_*a+w*u+C*g+x*m,_=i[4],w=i[5],C=i[6],x=i[7],r[4]=_*n+w*s+C*f+x*v,r[5]=_*e+w*l+C*c+x*y,r[6]=_*o+w*h+C*d+x*p,r[7]=_*a+w*u+C*g+x*m,_=i[8],w=i[9],C=i[10],x=i[11],r[8]=_*n+w*s+C*f+x*v,r[9]=_*e+w*l+C*c+x*y,r[10]=_*o+w*h+C*d+x*p,r[11]=_*a+w*u+C*g+x*m,_=i[12],w=i[13],C=i[14],x=i[15],r[12]=_*n+w*s+C*f+x*v,r[13]=_*e+w*l+C*c+x*y,r[14]=_*o+w*h+C*d+x*p,r[15]=_*a+w*u+C*g+x*m,r}function Lg(r,t){var i=t[0],n=t[1],e=t[2],o=t[3],a=t[4],s=t[5],l=t[6],h=t[7],u=t[8],f=t[9],c=t[10],d=t[11],g=t[12],v=t[13],y=t[14],p=t[15],m=i*s-n*a,_=i*l-e*a,w=i*h-o*a,C=n*l-e*s,x=n*h-o*s,T=e*h-o*l,P=u*v-f*g,S=u*y-c*g,E=u*p-d*g,D=f*y-c*v,A=f*p-d*v,I=c*p-d*y,L=m*I-_*A+w*D+C*E-x*S+T*P;return L?(L=1/L,r[0]=(s*I-l*A+h*D)*L,r[1]=(e*A-n*I-o*D)*L,r[2]=(v*T-y*x+p*C)*L,r[3]=(c*x-f*T-d*C)*L,r[4]=(l*E-a*I-h*S)*L,r[5]=(i*I-e*E+o*S)*L,r[6]=(y*w-g*T-p*_)*L,r[7]=(u*T-c*w+d*_)*L,r[8]=(a*A-s*E+h*P)*L,r[9]=(n*E-i*A-o*P)*L,r[10]=(g*x-v*w+p*m)*L,r[11]=(f*w-u*x-d*m)*L,r[12]=(s*S-a*D-l*P)*L,r[13]=(i*D-n*S+e*P)*L,r[14]=(v*_-g*C-y*m)*L,r[15]=(u*C-f*_+c*m)*L,r):null}function ac(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Dg(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function kt(r,t,i,n){return r[0]=t,r[1]=i,r[2]=n,r}function kP(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r[2]=t[2]+i[2],r}function Ya(r,t,i){return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],r}function bg(r){var t=r[0],i=r[1],n=r[2];return Math.sqrt(t*t+i*i+n*n)}function Qa(r,t){var i=t[0],n=t[1],e=t[2],o=i*i+n*n+e*e;return o>0&&(o=1/Math.sqrt(o),r[0]=t[0]*o,r[1]=t[1]*o,r[2]=t[2]*o),r}function RP(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]}function AP(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r}function mh(r,t,i){var n=t[0],e=t[1],o=t[2],a=i[0],s=i[1],l=i[2];return r[0]=e*l-o*s,r[1]=o*a-n*l,r[2]=n*s-e*a,r}function Fu(r,t){var i=t[0]-r[0],n=t[1]-r[1],e=t[2]-r[2];return Math.hypot?Math.hypot(i,n,e):LP(i,n,e)}function OP(r,t,i){var n=t[0],e=t[1],o=t[2],a=i[3]*n+i[7]*e+i[11]*o+i[15];return a=a||1,r[0]=(i[0]*n+i[4]*e+i[8]*o+i[12])/a,r[1]=(i[1]*n+i[5]*e+i[9]*o+i[13])/a,r[2]=(i[2]*n+i[6]*e+i[10]*o+i[14])/a,r}function LP(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)}function _h(r,t,i){var n=t[0],e=t[1],o=t[2],a=1/(i[3]*n+i[7]*e+i[11]*o+i[15]);return r[0]=(i[0]*n+i[4]*e+i[8]*o+i[12])*a,r[1]=(i[1]*n+i[5]*e+i[9]*o+i[13])*a,r[2]=(i[2]*n+i[6]*e+i[10]*o+i[14])*a,r}function DP(r,t){var i=t[0],n=t[4],e=t[8],o=t[1],a=t[5],s=t[9],l=t[2],h=t[6],u=t[10],f=i+a+u,c;return f>0?(c=.5/Math.sqrt(f+1),r.w=.25/c,r.x=(h-s)*c,r.y=(e-l)*c,r.z=(o-n)*c):i>a&&i>u?(c=2*Math.sqrt(1+i-a-u),r.w=(h-s)/c,r.x=.25*c,r.y=(n+o)/c,r.z=(e+l)/c):a>u?(c=2*Math.sqrt(1+a-i-u),r.w=(e-l)/c,r.x=(n+o)/c,r.y=.25*c,r.z=(s+h)/c):(c=2*Math.sqrt(1+u-i-a),r.w=(o-n)/c,r.x=(e+l)/c,r.y=(s+h)/c,r.z=.25*c),this}function bP(r,t){var i=r,n=t.x,e=t.y,o=t.z,a=t.w,s=n+n,l=e+e,h=o+o,u=n*s,f=n*l,c=n*h,d=e*l,g=e*h,v=o*h,y=a*s,p=a*l,m=a*h;return i[0]=1-(d+v),i[4]=f-m,i[8]=c+p,i[1]=f+m,i[5]=1-(u+v),i[9]=g-y,i[2]=c-p,i[6]=g+y,i[10]=1-(u+d),i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function IP(r,t){var i=r;return i[12]=t[0],i[13]=t[1],i[14]=t[2],r}function zP(r,t,i,n){var e=[0,0,0],o=[0,0,0],a=[0,0,0];return Ya(a,t,i),bg(a)===0&&(a[2]=1),Qa(a,a),mh(e,n,a),bg(a)===0&&(Math.abs(n[2])===1?a[0]+=1e-4:a[2]+=1e-4,Qa(a,a),mh(e,n,a)),Qa(e,e),mh(o,a,e),r[0]=e[0],r[4]=o[0],r[8]=a[0],r[1]=e[1],r[5]=o[1],r[9]=a[1],r[2]=e[2],r[6]=o[2],r[10]=a[2],r}var Mt=Math.PI/180,jP=.6435011087932844,yh=new z(0,0),Ig=new k(0,0),NP=function(t){if(V(t))return t!==0;if(Array.isArray(t)&&t.length>0){for(var i=0,n=t.length;i<n;i++)if(V(t[i])&&t[i]!==0)return!0}return!1};Q.include({getFov:function(){return this._fov||(this._fov=jP),this._fov/Mt},setFov:function(t){if(this.isZooming())return this;if(t=Math.max(.01,Math.min(60,t)),this._fov===t)return this;var i=this.getFov();return this._fov=t*Mt,this._calcMatrices(),this._renderLayers(),this._fireEvent("fovchange",{from:i,to:this.getFov()}),this},getBearing:function(){return this._angle?-this._angle/Mt:0},setBearing:function(t){return this._mapAnimPlayer&&this._stopAnim(this._mapAnimPlayer),this._setBearing(t)},_setBearing:function(t){if(K.ie9)throw new Error("map can't rotate in IE9.");var i=-Jr(t,-180,180)*Mt;if(this._angle===i)return this;var n=this.getBearing();return this._fireEvent("rotatestart",{from:n,to:i}),this._angle=i,this._calcMatrices(),this._renderLayers(),this._fireEvent("rotate",{from:n,to:i}),this._fireEvent("rotateend",{from:n,to:i}),this},getPitch:function(){return this._pitch?this._pitch/Math.PI*180:0},setPitch:function(t){return this._mapAnimPlayer&&this._stopAnim(this._mapAnimPlayer),this._setPitch(t)},_setPitch:function(t){if(K.ie9)throw new Error("map can't tilt in IE9.");var i=Tu(t,0,this.options.maxPitch)*Mt;if(this._pitch===i)return this;var n=this.getPitch();return this._fireEvent("pitchstart",{from:n,to:i}),this._pitch=i,this._calcMatrices(),this._renderLayers(),this._fireEvent("pitch",{from:n,to:i}),this._fireEvent("pitchend",{from:n,to:i}),this},setCameraMovements:function(t,i){var n=this;if(!Array.isArray(t)||!t.length)return this;if(this.setView({center:t[0].center,zoom:t[0].zoom,pitch:t[0].pitch,bearing:t[0].bearing}),t.length===1)return this;var e=1,o=function(d){if(d.state.playState==="finished"){e++,e===t.length-1&&(o=null);var g=t[e];g.duration=g.timestamp-t[e-1].timestamp,i&&i.autoRotate&&(g.bearing=FP(t[e-1].center,g.center)),n._setCameraMovement(g,o)}};t.length===2&&(o=null);var a=this.getBearing();this._setCameraMovement(wu({bearing:a},t[e],{duration:t[e].timestamp-t[e-1].timestamp}),o);var s=function(){n._animPlayer.play()},l=function(){n._animPlayer.pause()},h=function(){n._animPlayer.cancel()},u=function(){n._animPlayer.finish()},f=function(){n._animPlayer.reverse()};return{play:s,pause:l,cancel:h,finish:u,reverse:f}},_setCameraMovement:function(t,i){this.animateTo({zoom:t.zoom,center:t.center,pitch:t.pitch,bearing:t.bearing},{duration:t.duration,easing:"out"},i)},setCameraPosition:function(t){var i=t.position,n=t.pitch,e=t.bearing,o=i[2]*this._meterToGLPoint,a=this.centerAltitude||0,s=a*this._meterToGLPoint,l=o-s,h=n*Mt,u=l/Math.cos(h),f=Math.sin(h)*u,c=u+s,d=this._getZoomFromCameraToCenterDistance(c),g=Jr(e,-180,180),v=g*Mt,y=this.getGLRes(),p=new z(i[0],i[1]),m=this.coordToPointAtRes(p,y),_=new k(0,0);_.x=m.x+f*Math.sin(v),_.y=m.y+f*Math.cos(v);var w=this._pointToPrjAtRes(_,this.getGLRes());return this._setPrjCenter(w),this.setView({bearing:e,pitch:n,zoom:d}),this},_getZoomFromCameraToCenterDistance:function(t){var i=this._getFovRatio(),n=t*i*2/(this.height||1)*this.getGLRes(),e=this._getResolutions(),o=0;for(o;o<e.length-1;o++){if(e[o]===n)return o;if(e[o+1]===n)return o+1;if(n<e[o]&&n>e[o+1])return o=(n-e[o])/(e[o+1]-e[o])+o,o-1}return o},isTransforming:function(){return!!(this._pitch||this._angle)},getFrustumAltitude:function(){return this._frustumAltitude},_calcFrustumAltitude:function(){var t=90-this.getPitch(),i=this.getFov()/2,n=this.cameraPosition?this.cameraPosition[2]:0;if(i<=t)return n;i=Math.PI*i/180;var e=new k(this.cameraPosition).distanceTo(new k(this.cameraLookAt)),o=n*Math.tan(i*2),a=Math.tan(i)*(e+o);return n+a},_pointToContainerPoint:function(t,i,n,e){n===void 0&&(n=0);var o=this._getResolution(i);return this._pointAtResToContainerPoint(t,o,n,e)},_pointAtResToContainerPoint:function(t,i,n,e){n===void 0&&(n=0),e||(e=new k(0,0)),t=this._pointAtResToPoint(t,i,e);var o=this.isTransforming(),a;return!o&&!n&&(a=this._prjToPoint(this._getPrjCenter(),void 0,yh)),this._toContainerPoint(e,o,n,a),e},_pointsAtResToContainerPoints:function(t,i,n,e){n===void 0&&(n=[]),e===void 0&&(e=[]);var o=this.getPitch(),a=this.getBearing(),s=i/this._getResolution();if(o===0&&a===0&&!NP(n)){var l=this._get2DExtent(),h=l.xmin,u=l.ymin,f=l.xmax,c=l.ymax;if(f>h&&c>u){for(var d=this.getSize(),g=d.width,v=d.height,y=(f-h)/g,p=(c-u)/v,m=0,_=t.length;m<_;m++){if(!t[m]){e[m]=null;continue}var w=e[m];w.x=t[m].x,w.y=t[m].y,w._multi(s),w.x=(w.x-h)*y,w.y=v-(w.y-u)*p}return e}}for(var C=Array.isArray(n),x=this.isTransforming(),T=this._prjToPoint(this._getPrjCenter(),void 0,yh),P=0,S=t.length;P<S;P++){if(!t[P]){e[P]=null;continue}var E=e[P];E.x=t[P].x,E.y=t[P].y,E._multi(s);var D=C?n[P]||0:n;this._toContainerPoint(E,x,D,T)}return e},_toContainerPoint:function(){var r=[0,0,0];return function(t,i,n,e){var o=this.width/2,a=this.height/2;if(i||n){this._altitudeScale||(this._altitudeScale=this.altitudeToPoint(100,this.getGLRes())/100);var s=this._glScale;kt(r,t.x*s,t.y*s,n*this._altitudeScale);var l=this._projIfBehindCamera(r,this.cameraPosition,this.cameraForward);_h(l,l,this.projViewMatrix),t.x=l[0]*o+o,t.y=-(l[1]*a)+a}else t._sub(e.x,e.y),t.set(t.x,-t.y),t._add(o,a)}}(),_projIfBehindCamera:function(){var r=new Array(3),t=new Array(3),i=new Array(3);return function(n,e,o){Ya(r,n,e);var a=RP(o,r);return a<=0&&(AP(t,o,a*1.01),kP(n,e,Ya(i,r,t))),n}}(),_containerPointToPoint:function(t,i,n){var e=this._getResolution(i);return this._containerPointToPointAtRes(t,e,n)},_containerPointToPointAtRes:function(){var r=[0,0,0],t=[0,0,0,1],i=[0,0,0,1];return function(n,e,o){if(this.isTransforming()){var a=this.width/2||1,s=this.height/2||1;kt(r,(n.x-a)/a,(s-n.y)/s,0),kt(t,r[0],r[1],0),kt(i,r[0],r[1],1),t[3]=i[3]=1,_h(t,t,this.projViewMatrixInverse),_h(i,i,this.projViewMatrixInverse);var l=t[0],h=i[0],u=t[1],f=i[1],c=t[2],d=i[2],g=c===d?0:(0-c)/(d-c),v=Pu(l,h,g),y=Pu(u,f,g);return o?(o.x=v,o.y=y):o=new k(v,y),o._multi(1/this._glScale),this._getResolution()===e?o:this._pointToPointAtRes(o,e,o)}var p=this._prjToPointAtRes(this._getPrjCenter(),e,o),m=this._getResolution()/e,_=m*(n.x-this.width/2),w=m*(n.y-this.height/2);return p._add(_,-w)}}(),_calcMatrices:function(){var r=Et();return function(){delete this._mapRes,delete this._mapGlRes,delete this._mapExtent2D,delete this._mapGlExtent2D;var t=this.getSize(),i=t.width||1,n=t.height||1;this._glScale=this.getGLScale();var e=this._getCameraWorldMatrix(),o=this.getFov()*Math.PI/180,a=this._getCameraFar(o,this.getPitch());this.cameraFar=a,this.cameraNear=this.cameraCenterDistance/20;var s=this.projMatrix||Et();Og(s,o,i/n,this.cameraNear,a),this.projMatrix=s,this.viewMatrix=Lg(this.viewMatrix||Et(),e),this.projViewMatrix=oo(this.projViewMatrix||Et(),s,this.viewMatrix),this._calcCascadeMatrixes(),this.projViewMatrixInverse=oo(this.projViewMatrixInverse||Et(),e,Lg(r,s)),this.domCssMatrix=this._calcDomMatrix(),this._frustumAltitude=this._calcFrustumAltitude(),this._mapRes=this._getResolution(),this._mapGlRes=this.getGLRes(),this._mapExtent2D=this._get2DExtent(),this._mapGlExtent2D=this._get2DExtentAtRes(this._mapGlRes)}}(),_getCameraFar:function(t,i){var n=this.cameraCenterDistance=Fu(this.cameraPosition,this.cameraLookAt),e=n,o=(this.options.cameraInfiniteFar?10:4)*n;if(i>0&&(i=i*Math.PI/180,2/Math.PI-i>t/2)){var a=Math.tan(t/2),s=Math.tan(i);o=Math.max(n*a/(1/s-a),o)}return e+=o,e+1},_calcCascadeMatrixes:function(){var r=Et();function t(i,n,e){var o=this.width,a=this.height,s=this.getFov()*Math.PI/180,l=this._getCameraFar(s,n),h=this.cameraCenterDistance;l=h+(l-h)/Math.cos((90-n)*Math.PI/180)*Math.cos((90-i)*Math.PI/180),Og(r,s,o/a,.1,l);var u=this.viewMatrix;return oo(e,r,u)}return function(){var i=this.getPitch(),n=this.options.cascadePitches[0],e=this.options.cascadePitches[1],o=this.cascadeFrustumMatrix0=this.cascadeFrustumMatrix0||Et(),a=this.cascadeFrustumMatrix1=this.cascadeFrustumMatrix1||Et();i>n?t.call(this,i,n,o):Dg(this.cascadeFrustumMatrix0,this.projViewMatrix),i>e?t.call(this,i,e,a):Dg(this.cascadeFrustumMatrix1,this.cascadeFrustumMatrix0)}}(),_calcDomMatrix:function(){var r=Et(),t=Et(),i=[1,-1,1],n=[0,0,0];return function(){var e=this.width||1,o=this.height||1,a=.5/Math.tan(this._fov/2)*o;return Nu(r,this.projMatrix,i),ty(r,r,kt(n,0,0,-a)),this._pitch&&MP(r,r,this._pitch),this._angle&&EP(r,r,this._angle),ac(t),Nu(t,t,kt(n,e/2,-o/2,1)),oo(this.domCssMatrix||Et(),t,r)}}(),_getFovZ:function(t){var i=this.getGLScale(t),n=this._getFovRatio();return i*(this.height||1)/2/n},_getCameraWorldMatrix:function(){var r={};return function(){var t=this.getGLRes();this._meterToGLPoint||(this._meterToGLPoint=this.distanceToPointAtRes(100,0,t).x/100);var i=this._prjToPointAtRes(this._prjCenter,t,Ig),n=this.centerAltitude||0,e=n*this._meterToGLPoint;this.cameraLookAt=kt(this.cameraLookAt||[0,0,0],i.x,i.y,e);var o=this.getPitch()*Mt,a=this.getBearing()*Mt,s=this._getFovZ(),l=this.cameraZenithDistance===void 0?s:this.cameraZenithDistance,h=l-e,u=h*Math.cos(o),f=Math.sin(o)*h,c=i.x-f*Math.sin(a),d=i.y-f*Math.cos(a);this.cameraPosition=kt(this.cameraPosition||[0,0,0],c,d,u+e),this.cameraToCenterDistance=s;var g=f||1,v=this.cameraUp=kt(this.cameraUp||[0,0,0],Math.sin(a)*g,Math.cos(a)*g,0),y=this.cameraWorldMatrix=this.cameraWorldMatrix||Et();zP(y,this.cameraPosition,this.cameraLookAt,v);var p=this.cameraForward||[0,0,0];return Ya(p,this.cameraLookAt,this.cameraPosition),this.cameraForward=Qa(p,p),DP(r,y),bP(y,r),IP(y,this.cameraPosition),y}}(),updateCenterAltitude:function(){this.getRenderer().setToRedraw(),!this.centerAltitude&&this._hasAltitudeLayer()&&(this.centerAltitude=0),this._recenterOnTerrain()},_recenterOnTerrain:function(){if(this.centerAltitude!==void 0){var t=this._queryTerrainByProjCoord(this._prjCenter);M(t)&&this._hasAltitudeLayer()&&(t=this.centerAltitude);var i=t||0,n=this.getPitch()*Mt,e=this.getBearing()*Mt,o=(i-this.centerAltitude)*this._meterToGLPoint,a=this._getFovZ(),s=this.cameraZenithDistance===void 0?a:this.cameraZenithDistance,l=s-this.centerAltitude*this._meterToGLPoint,h=l-o/Math.cos(n),u=this.cameraPosition,f=Math.sin(n)*h,c=Ig;c.x=u[0]+f*Math.sin(e),c.y=u[1]+f*Math.cos(e);var d=i*this._meterToGLPoint;this.cameraZenithDistance=(u[2]-d)/Math.cos(n)+d,this.centerAltitude=i;var g=this.pointAtResToCoordinate(c,this.getGLRes(),yh);this._eventSilence=!0,this._suppressRecenter=!0,this.setCenter(g),delete this._suppressRecenter,delete this._eventSilence,M(t)&&delete this.centerAltitude}},_queryTerrainByProjCoord:function(t){for(var i=this._getLayers(),n=0;n<i.length;n++)if(i[n].queryTerrainByProjCoord)return i[n].queryTerrainByProjCoord(t)[0];return 0},_hasAltitudeLayer:function(){for(var t=this._getLayers(),i=0;i<t.length;i++)if(t[i].getTerrainLayer&&t[i].getTerrainLayer())return!0;return!1},_getFovRatio:function(){var t=this.getFov();return Math.tan(t/2*Mt)},_renderLayers:function(){if(!this.isInteracting()){var t=this._getLayers();t.forEach(function(i){if(i){var n=i._getRenderer();n&&n.setToRedraw&&n.setToRedraw()}})}}});function Et(){return ac(new Array(16))}function FP(r,t){var i=De(r[0]),n=De(t[0]),e=De(r[1]),o=De(t[1]),a=Math.sin(n-i)*Math.cos(o),s=Math.cos(e)*Math.sin(o)-Math.sin(e)*Math.cos(o)*Math.cos(n-i);return Cm(Math.atan2(a,s))}Q.include({_onViewChange:function(t){this._viewHistory||(this._viewHistory=[],this._viewHistoryPointer=0);for(var i=this._getCurrentView(),n=this._viewHistory.length-1;n>=0;n--)if(Mu(t,this._viewHistory[n])){this._viewHistoryPointer=n,this._fireViewChange(i,t);return}this._viewHistoryPointer<this._viewHistory.length-1&&this._viewHistory.splice(this._viewHistoryPointer+1),this._viewHistory.push(t);var e=this.options.viewHistoryCount;e>0&&this._viewHistory.length>e&&this._viewHistory.splice(0,this._viewHistory.length-e),this._viewHistoryPointer=this._viewHistory.length-1,this._fireViewChange(i,t)},zoomToPreviousView:function(t){if(t===void 0&&(t={}),!this.hasPreviousView())return null;var i=this._viewHistory[--this._viewHistoryPointer];return this._zoomToView(i,t),i},hasPreviousView:function(){return!(!this._viewHistory||this._viewHistoryPointer===0)},zoomToNextView:function(t){if(t===void 0&&(t={}),!this.hasNextView())return null;var i=this._viewHistory[++this._viewHistoryPointer];return this._zoomToView(i,t),i},hasNextView:function(){return!(!this._viewHistory||this._viewHistoryPointer===this._viewHistory.length-1)},_zoomToView:function(t,i){var n=this,e=this.getView();i.animation?this._animateTo(t,{duration:i.duration},function(o){o.state.playState==="finished"&&n._fireViewChange(e,t)}):(this.setView(t),this._fireViewChange(e,t))},getViewHistory:function(){return this._viewHistory},_fireViewChange:function(t,i){this._fireEvent("viewchange",{old:t,new:i}),this._insertUICollidesQueue()},_getCurrentView:function(){return this._viewHistory?this._viewHistory[this._viewHistoryPointer]:null}});Q.mergeOptions({viewHistory:!0,viewHistoryCount:10});var HP=new al;Q.include({getCollisionIndex:function(){return this._collisionIndex||this.createCollisionIndex(),this._collisionIndex||this.createCollisionIndex()},createCollisionIndex:function(){return this.clearCollisionIndex(),this._collisionIndex=new al,this._collisionIndex},clearCollisionIndex:function(){return this.collisionFrameTime=0,this._collisionIndex&&this._collisionIndex.clear(),this},_insertUICollidesQueue:function(){return this._uiCollidesQueue||(this._uiCollidesQueue=[]),this._uiCollidesQueue.push(1),this},uiCollides:function(){if(!this.uiList||this.uiList.length===0||!this._uiCollidesQueue||this._uiCollidesQueue.length===0)return this;var t=HP;t.clear();for(var i=this.uiList,n=0,e=i.length;n<e;n++){var o=i[n],a=o.options,s=a.collisionBufferSize,l=a.collision;if(l){var h=o.getDOM();if(!(!o.isVisible()||!h)&&h.getBoundingClientRect){o.bbox||(o.bbox=[0,0,0,0]);var u=h.getBoundingClientRect(),f=u.x,c=u.y,d=u.width,g=u.height;if(d===0||g===0){var v=o.getSize();v&&(d=v.width,g=v.height)}var y=f-s,p=f+d+s,m=c-s,_=c+g+s;if(o.bbox[0]=y,o.bbox[1]=m,o.bbox[2]=p,o.bbox[3]=_,t.collides(o.bbox)){o._collidesEffect(!1);continue}t.insertBox(o.bbox),o._collidesEffect(!0)}}}return this._uiCollidesQueue=[],this},_addUI:function(t){this.uiList||(this.uiList=[]);var i=this.uiList.indexOf(t);return i>-1?this:(this.uiList.push(t),this.uiList=this.uiList.sort(function(n,e){return e.options.collisionWeight-n.options.collisionWeight}),this)},_removeUI:function(t){if(!this.uiList)return-1;var i=this.uiList.indexOf(t);return i<0||this.uiList.splice(i,1),i}});var BP={decimalPlaces:2,mode:"LineString",language:"zh-CN",metric:!0,imperial:!1,symbol:{lineColor:"#000",lineWidth:3,lineOpacity:1},vertexSymbol:{markerType:"ellipse",markerFill:"#fff",markerLineColor:"#000",markerLineWidth:3,markerWidth:11,markerHeight:11},labelOptions:{textSymbol:{textFaceName:"monospace",textLineSpacing:1,textHorizontalAlignment:"right",textDx:15},boxStyle:{padding:[6,2],symbol:{markerType:"square",markerFill:"#fff",markerFillOpacity:.9,markerLineColor:"#b4b3b3"}}},clearButtonSymbol:[{markerType:"square",markerFill:"#fff",markerLineColor:"#b4b3b3",markerLineWidth:2,markerWidth:15,markerHeight:15,markerDx:20},{markerType:"x",markerWidth:10,markerHeight:10,markerDx:20}]},ry=function(r){F(t,r);function t(n){var e;return e=r.call(this,n)||this,e.on("enable",e._afterEnable,Ie(Ie(e))).on("disable",e._afterDisable,Ie(Ie(e))),e._measureLayers=[],e}var i=t.prototype;return i.clear=function(){if(he(this._measureLayers))for(var e=0;e<this._measureLayers.length;e++)this._measureLayers[e].remove();return delete this._lastMeasure,delete this._lastVertex,this._measureLayers=[],this},i.getMeasureLayers=function(){return this._measureLayers},i.getLastMeasure=function(){return this._lastMeasure?this._lastMeasure:0},i.undo=function(){r.prototype.undo.call(this);var e=this._historyPointer;if(e!==this._vertexes.length)for(var o=e;o<this._vertexes.length;o++)this._vertexes[o].label&&this._vertexes[o].label.remove(),this._vertexes[o].marker.remove();return this},i.redo=function(){r.prototype.redo.call(this);var e=this._historyPointer-1;return this._vertexes[e]&&(this._vertexes[e].marker.getLayer()||(this._vertexes[e].label&&this._vertexes[e].label.addTo(this._measureMarkerLayer),this._vertexes[e].marker.addTo(this._measureMarkerLayer))),this},i._measure=function(e){var o=this.getMap(),a;e instanceof ae?a=o.computeGeometryLength(e):Array.isArray(e)&&(a=o.getProjection().measureLength(e)),this._lastMeasure=a;var s;this.options.language==="zh-CN"?s=[" "," "," "," "]:s=[" m"," km"," feet"," mile"];var l="",h=this.options.decimalPlaces;return this.options.metric&&(l+=a<1e3?a.toFixed(h)+s[0]:(a/1e3).toFixed(h)+s[1]),this.options.imperial&&(a*=3.2808399,l.length>0&&(l+=`
`),l+=a<5280?a.toFixed(h)+s[2]:(a/5280).toFixed(h)+s[3]),l},i._registerMeasureEvents=function(){this.on("drawstart",this._msOnDrawStart,this).on("drawvertex",this._msOnDrawVertex,this).on("mousemove",this._msOnMouseMove,this).on("drawend",this._msOnDrawEnd,this)},i._afterEnable=function(){this._registerMeasureEvents()},i._afterDisable=function(){this.off("drawstart",this._msOnDrawStart,this).off("drawvertex",this._msOnDrawVertex,this).off("mousemove",this._msOnMouseMove,this).off("drawend",this._msOnDrawEnd,this)},i._msOnDrawStart=function(e){var o=this.getMap(),a=o._pointToPrj(e.point2d),s=Tn(),l="distancetool_"+s,h="distancetool_markers_"+s;o.getLayer(l)?(this._measureLineLayer=o.getLayer(l),this._measureMarkerLayer=o.getLayer(h)):(this._measureLineLayer=new or(l).addTo(o),this._measureMarkerLayer=new or(h).addTo(o)),this._measureLayers.push(this._measureLineLayer),this._measureLayers.push(this._measureMarkerLayer);var u=new Se(e.coordinate,{symbol:this.options.vertexSymbol});u._setPrjCoordinates(a);var f=this.options.language==="zh-CN"?"":"start",c=new un(f,e.coordinate,this.options.labelOptions);c._setPrjCoordinates(a),this._lastVertex=c,this._addVertexMarker(u,c)},i._msOnMouseMove=function(e){var o=this._measure(this._msGetCoordsToMeasure(e));if(!this._tailMarker){var a=Kt(this.options.vertexSymbol);a.markerWidth/=2,a.markerHeight/=2,this._tailMarker=new Se(e.coordinate,{symbol:a}).addTo(this._measureMarkerLayer),this._tailLabel=new un(o,e.coordinate,this.options.labelOptions).addTo(this._measureMarkerLayer)}var s=this._geometry._getPrjCoordinates(),l=s[s.length-1];this._tailMarker.setCoordinates(e.coordinate),this._tailMarker._setPrjCoordinates(l),this._tailLabel.setContent(o),this._tailLabel.setCoordinates(e.coordinate),this._tailLabel._setPrjCoordinates(l)},i._msGetCoordsToMeasure=function(e){return e.geometry.getCoordinates().concat([e.coordinate])},i._msOnDrawVertex=function(e){var o=this._geometry._getPrjCoordinates(),a=o[o.length-1],s=e.geometry,l=new Se(e.coordinate,{symbol:this.options.vertexSymbol}),h=this._measure(s),u=new un(h,e.coordinate,this.options.labelOptions);this._addVertexMarker(l,u),u._setPrjCoordinates(a),l._setPrjCoordinates(a),this._lastVertex=u},i._addVertexMarker=function(e,o){this._vertexes||(this._vertexes=[]),this._historyPointer!==void 0&&this._vertexes.length>this._historyPointer-1&&(this._vertexes.length=this._historyPointer-1),this._vertexes.push({label:o,marker:e}),this._measureMarkerLayer.addGeometry(e),o&&this._measureMarkerLayer.addGeometry(o)},i._msOnDrawEnd=function(e){if(this._clearTailMarker(),e.geometry._getPrjCoordinates().length<2){this._lastMeasure=0,this._clearMeasureLayers();return}var o=this._lastVertex.getSize();o||(o=new Ae(10,10)),this._addClearMarker(this._lastVertex.getCoordinates(),this._lastVertex._getPrjCoordinates(),o.width);var a=e.geometry.copy();a._setPrjCoordinates(e.geometry._getPrjCoordinates()),a.addTo(this._measureLineLayer),this._lastMeasure=a.getLength()},i._addClearMarker=function(e,o,a){var s=this.options.clearButtonSymbol,l={markerDx:(s.markerDx||0)+a,textDx:(s.textDx||0)+a};Array.isArray(s)&&(l=s.map(function(c){return c?{markerDx:(c.markerDx||0)+a,textDx:(c.textDx||0)+a}:null})),s=Kt(s,l);var h=new Se(e,{symbol:s}),u=this._measureLineLayer,f=this._measureMarkerLayer;h.on("click",function(){return u.remove(),f.remove(),!1},this),h.addTo(this._measureMarkerLayer),h._setPrjCoordinates(o)},i._clearTailMarker=function(){this._tailMarker&&(this._tailMarker.remove(),delete this._tailMarker),this._tailLabel&&(this._tailLabel.remove(),delete this._tailLabel)},i._clearMeasureLayers=function(){this._measureLineLayer.remove(),this._measureMarkerLayer.remove()},t}(Ze);ry.mergeOptions(BP);var GP={mode:"Polygon",symbol:{lineColor:"#000000",lineWidth:2,lineOpacity:1,lineDasharray:"",polygonFill:"#ffffff",polygonOpacity:.5}},WP=function(r){F(t,r);function t(n){var e;return e=r.call(this,n)||this,e._measureLayers=[],e}var i=t.prototype;return i._measure=function(e){var o=this.getMap(),a;e instanceof ae?a=o.computeGeometryArea(e):Array.isArray(e)&&(a=o.getProjection().measureArea(e)),this._lastMeasure=a;var s;this.options.language==="zh-CN"?s=[" "," "," "," "]:s=[" sq.m"," sq.km"," sq.ft"," sq.mi"];var l="",h=this.options.decimalPlaces;if(this.options.metric&&(l+=a<1e6?a.toFixed(h)+s[0]:(a/1e6).toFixed(h)+s[1]),this.options.imperial){a*=3.2808399,l.length>0&&(l+=`
`);var u=5280*5280;l+=a<u?a.toFixed(h)+s[2]:(a/u).toFixed(h)+s[3]}return l},i._msGetCoordsToMeasure=function(e){return e.geometry.getShell().concat([e.coordinate])},i._msOnDrawVertex=function(e){var o=this.getMap()._pointToPrj(e.point2d),a=new Se(e.coordinate,{symbol:this.options.vertexSymbol});a._setPrjCoordinates(o),this._measure(e.geometry),this._lastVertex=a,this._addVertexMarker(a)},i._msOnDrawEnd=function(e){this._clearTailMarker();var o;if(e.point2d)o=this.getMap()._pointToPrj(e.point2d);else{var a=e.geometry._getPrjCoordinates();a=a.slice(0,a.length-1),e.geometry._setPrjCoordinates(a),o=a[a.length-1]}if(e.geometry._getPrjCoordinates().length<3){this._lastMeasure=0,this._clearMeasureLayers();return}var s=this._measure(e.geometry),l=this.getMap().getProjection(),h=l.unproject(o),u=new un(s,h,this.options.labelOptions).addTo(this._measureMarkerLayer);u._setPrjCoordinates(o);var f=u.getSize();f||(f=new Ae(10,10)),this._addClearMarker(h,o,f.width);var c=e.geometry.copy();c._setPrjCoordinates(e.geometry._getPrjCoordinates()),c.addTo(this._measureLineLayer),this._lastMeasure=c.getArea()},t}(ry);WP.mergeOptions(GP);var iy={create:function(t,i){var n=t.unproject(i[0]),e=new nr(n,0);return e._setPrjCoordinates(i[0]),e},update:function(t,i,n){var e=n.getMap(),o=Array.isArray(i)?i[i.length-1]:i,a=t.unproject(o),s=e.computeLength(n.getCenter(),a);n.setRadius(s)},generate:function(t){return t}};Ze.registerMode("circle",W({clickLimit:2,action:["click","mousemove","click"]},iy));Ze.registerMode("freeHandCircle",W({action:["mousedown touchstart","mousemove touchmove","mouseup touchend"]},iy));var ny={create:function(t,i){var n=t.unproject(i[0]),e=new wr(n,0,0);return e._setPrjCoordinates(i[0]),e},update:function(t,i,n){var e=n.getMap(),o=n.getCenter(),a=Array.isArray(i)?i[i.length-1]:i,s=t.unproject(a),l=e.computeLength(o,new z({x:s.x,y:o.y})),h=e.computeLength(o,new z({x:o.x,y:s.y}));n.setWidth(l*2),n.setHeight(h*2)},generate:function(t){return t}};Ze.registerMode("ellipse",W({clickLimit:2,action:["click","mousemove","click"]},ny));Ze.registerMode("freeHandEllipse",W({action:["mousedown touchstart","mousemove touchmove","mouseup touchend"]},ny));var oy={create:function(t,i){var n=new Oe([]);return n._firstClick=i[0],n},update:function(t,i,n,e){var o=n.getMap(),a=e.containerPoint,s=o._prjToContainerPoint(n._firstClick),l=[[s.x,s.y],[a.x,s.y],[a.x,a.y],[s.x,a.y]];n.setCoordinates(l.map(function(h){return o.containerPointToCoord(new k(h))})),n._setPrjCoordinates(l.map(function(h){return o._containerPointToPrj(new k(h))}))},generate:function(t){return t}};Ze.registerMode("rectangle",W({clickLimit:2,action:["click","mousemove","click"]},oy));Ze.registerMode("freeHandRectangle",W({action:["mousedown touchstart","mousemove touchmove","mouseup touchend"]},oy));Ze.registerMode("point",{clickLimit:1,action:["click","mousemove"],create:function(t,i){var n=t.unproject(i[0]),e=new Se(n);return e._setPrjCoordinates(i[0]),e},generate:function(t){return t},update:function(t,i,n){if(Array.isArray(i)&&(i=i[i.length-1]),!i)return n;var e=t.unproject(i);return n.setCoordinates(e),n}});var ay={create:function(t,i){var n=i.map(function(o){return t.unproject(o)}),e=new xe(n);return e._setPrjCoordinates(i),e},update:function(t,i,n){var e=n.getSymbol(),o;Array.isArray(i)?o=i:(o=n._getPrjCoordinates(),o.push(i));var a=o.map(function(u){return t.unproject(u)});n.setCoordinates(a),n._setPrjCoordinates(o);var s=n.getLayer();if(s){var l=s.getGeometryById("polygon");if(!l&&o.length>=3){if(l=new Oe([a],{id:"polygon"}),e){var h=Kt(e,{lineOpacity:0});l.setSymbol(h)}l.addTo(s)}l&&l._setPrjCoordinates(o)}},generate:function(t){var i=new Oe(t.getCoordinates(),{symbol:t.getSymbol()});return i._setPrjCoordinates(t._getPrjCoordinates()),i._projCode=t._projCode,i}};Ze.registerMode("polygon",W({action:["click","mousemove","dblclick"]},ay));Ze.registerMode("freeHandPolygon",W({action:["mousedown touchstart","mousemove touchmove","mouseup touchend"]},ay));var Uo={create:function(t,i){var n=i.map(function(o){return t.unproject(o)}),e=new xe(n);return e._setPrjCoordinates(i),e},update:function(t,i,n){var e;Array.isArray(i)?e=i:(e=n._getPrjCoordinates(),e.push(i));var o=e.map(function(a){return t.unproject(a)});n.setCoordinates(o),n._setPrjCoordinates(e)},generate:function(t){return t}};Ze.registerMode("linestring",W({action:["click","mousemove","dblclick"]},Uo));Ze.registerMode("freeHandLinestring",W({action:["mousedown touchstart","mousemove touchmove","mouseup touchend"]},Uo));Ze.registerMode("arccurve",{action:["click","mousemove","dblclick"],create:function(t,i){var n=i.map(function(o){return t.unproject(o)}),e=new ul(n);return e._setPrjCoordinates(i),e},update:Uo.update,generate:function(t){return t}});Ze.registerMode("quadbeziercurve",{action:["click","mousemove","dblclick"],create:function(t,i){var n=i.map(function(o){return t.unproject(o)}),e=new Y_(n);return e._setPrjCoordinates(i),e},update:Uo.update,generate:function(t){return t}});Ze.registerMode("cubicbeziercurve",{action:["click","mousemove","dblclick"],create:function(t,i){var n=i.map(function(o){return t.unproject(o)}),e=new J_(n);return e._setPrjCoordinates(i),e},update:Uo.update,generate:function(t){return t}});Ze.registerMode("boxZoom",{action:["mousedown","mousemove","mouseup"],create:function(t,i){i=i[0];var n=t.unproject(i),e=new Se(n);return e._firstClick=i,e},update:function(t,i,n,e){var o=n.getMap(),a=o._prjToContainerPoint(n._firstClick),s=e.containerPoint;i=o._containerPointToPrj(new z(Math.min(a.x,s.x),Math.min(a.y,s.y)));var l=t.unproject(i);n.setCoordinates(l)._setPrjCoordinates(i),n.updateSymbol({markerWidth:Math.abs(a.x-s.x),markerHeight:Math.abs(a.y-s.y)})},generate:function(t){return t}});function zg(r){for(var t=r.tileInfo,i=[t.cols,t.rows],n=[],e=t.lods,o=0,a=e.length;o<a;o++)n.push(e[o].resolution);var s=r.fullExtent,l=t.origin,h=[1,-1,l.x,l.y];return delete s.spatialReference,{spatialReference:{resolutions:n,fullExtent:s},tileSystem:h,tileSize:i}}er.loadArcgis=function(r,t,i){if(i===void 0&&(i={jsonp:!0}),ie(r)&&r.substring(0,1)!=="{")ut.getJSON(r,function(e,o){if(e){t(e);return}var a=zg(o);t(null,a)},i);else{ie(r)&&(r=Hf(r));var n=zg(r);t(null,n)}return this};function VP(r){for(var t="",i=r.split(""),n=i.length,e=n-1;e>=0&&!isNaN(i[e]);e--)t=i[e]+t;return t}function ZP(r){var t=r.indexOf("EPSG")>-1?r:"EPSG:"+r;return t=sy(t,[["4490","4326"],["102100","3857"],["900913","3857"]]),t}function sy(r,t){return t===void 0&&(t=[]),t.forEach(function(i){var n=i[0],e=i[1];r=r.replace(n,e)}),r}function UP(r){var t=r.projection,i=r.isArcgis,n=r.isGeoServer,e=r.isSuperMap,o=.0002645833333333333;return(i||n||e)&&(o=28e-5),t&&t.indexOf("4326")>-1&&(o=23767925226029154e-25,(i||e)&&(o=2518101729011901e-24),n&&(o=251528279553466e-23)),o}var $P="wmts";function Ir(r,t){var i=r.getElementsByTagName(t);if(i&&i.length)return i;var n=$P+":"+t;return r.getElementsByTagName(n)}function XP(r,t){for(var i=0;i<r.length;i++){var n=r[i];if(n=n.getElementsByTagName("ows:Identifier")[0],n&&n.textContent===t)return r[i]}return null}function JP(r,t,i){i.isArcgis==null&&(i.isArcgis=r.indexOf("arcgis")>-1),i.isSuperMap==null&&(i.isSuperMap=r.indexOf("supermap")>-1);var n=new DOMParser,e=n.parseFromString(r,"text/xml"),o=e.querySelectorAll("Contents")[0];if(!o)return[];var a=Ir(o,"Layer");if(!a.length)return[];for(var s=[],l=0,h=o.childNodes.length;l<h;l++)o.childNodes[l].localName==="TileMatrixSet"&&s.push(o.childNodes[l]);if(!s.length)return[];for(var u=[],f=0,c=a.length;f<c;f++){var d=a[f],g=d.querySelectorAll("Style")[0];g&&(g=g.getElementsByTagName("ows:Identifier")[0],g&&(g=g.textContent));var v=d.getElementsByTagName("ows:Identifier")[0];v&&(v=v.textContent);var y=Ir(d,"TileMatrixSetLink");if(y.length!==0)for(var p=0,m=y.length;p<m;p++){var _=y[p];_=Ir(_,"TileMatrixSet")[0],_&&(_=_.textContent);var w=XP(s,_);if(w){var C=d.querySelectorAll("ResourceURL")[0],x="";C&&(x=C.attributes.template.value);var T=YP(w,i),P=T.resolutions,S=T.tileSize,E=T.tileSystem,D=T.projection,A=T.TileMatrixSet,I=T.isGeoServer,L=T.levelStr;x.length||(x=t.substr(0,t.lastIndexOf("?")),x+="?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER={LAYER}&STYLE={Style}&TILEMATRIXSET={TileMatrixSet}&FORMAT={tiles}&TILEMATRIX={TileMatrix}&TILEROW={TileRow}&TILECOL={TileCol}");var O=sy(x,[["{LAYER}",v],["{Layer}",v],["{layer}",v],["{STYLE}",g],["{Style}",g],["{style}",g],["{TileMatrixSet}",A],["{TileMatrix}",I?L+":{z}":"{z}"],["{TileRow}","{y}"],["{TileCol}","{x}"],["{tiles}",I?"image/png":"tiles"]]);u.push({tileSize:S,tileSystem:E,spatialReference:{resolutions:P,projection:D},urlTemplate:O,info:{layerName:v,TileMatrixSet:A,style:g,tileSize:S,tileSystem:E,resolutions:P,projection:D,urlTemplate:O}})}}}return u}function YP(r,t){t===void 0&&(t={});var i=Ir(r,"TileMatrix"),n=[],e=[],o=[],a,s,l=!1,h;if(!a){var u=r.getElementsByTagName("ows:SupportedCRS")[0];u&&(a=u.textContent,a=a.split("EPSG")[1],a=VP(a),a=ZP(a))}s||(s=r.getElementsByTagName("ows:Identifier")[0],s&&(s=s.textContent)),t.projection=a;for(var f=1/0,c=0;c<i.length;c++){var d=i[c],g=d.getElementsByTagName("ows:Identifier")[0].textContent;isNaN(parseInt(g))?(h=g.substr(0,g.lastIndexOf(":")),g=g.split(":"),g=g[g.length-1],g=parseInt(g),l=!0,t.isGeoServer=!0):g=parseInt(g),f=Math.min(f,g);var v=Ir(d,"ScaleDenominator")[0].textContent,y=Ir(d,"TopLeftCorner")[0].textContent,p=Ir(d,"TileWidth")[0].textContent,m=Ir(d,"TileHeight")[0].textContent;if(o.length===0&&o.push(parseInt(p),parseInt(m)),e.length===0){var _=y.split(" ").filter(function(E){return E!==""}).map(function(E){return parseFloat(E)}),w=_[0],C=_[1];w>0?e.push(1,-1,C,w):e.push(1,-1,w,C)}var x=UP(t),T=parseFloat(v)*x;n.push(T)}if(f>0)for(var P=n[0],S=f-1;S>=0;S--)P=P*2,n.splice(0,0,P);return{resolutions:n,tileSize:o,tileSystem:e,projection:a,TileMatrixSet:s,isGeoServer:l,levelStr:h}}er.loadWMTS=function(r,t,i){return i===void 0&&(i={jsonp:!0}),ie(r)&&ut.get(r,function(n,e){if(n){t(n);return}var o=JP(e,r,i);t(null,o)},i),this};var QP={eventsPropagation:!1,eventsToStop:null,dx:0,dy:0,autoPan:!1,autoPanDuration:600,single:!0,animation:"scale",animationOnHide:!1,animationDuration:500,pitchWithMap:!1,rotateWithMap:!1,visible:!0,roundPoint:!1,collision:!1,collisionBufferSize:2,collisionWeight:0,collisionFadeIn:!1,zIndex:0},_i=function(r){F(t,r);function t(n){var e;return e=r.call(this,n)||this,e.proxyOptions(),e}var i=t.prototype;return i.addTo=function(e){return this._owner=e,this._switchEvents("on"),this.onAdd&&this.onAdd(),this.fire("add"),this},i.getMap=function(){return this._owner?this._owner.getBaseLayer?this._owner:this._owner.getMap():null},i._collides=function(){var e=this.getMap();return e?(e._addUI(this),e._insertUICollidesQueue(),this):this},i._collidesEffect=function(e){var o=this.getDOM();if(!o)return this;var a=e?"visible":"hidden";if(o.style.visibility=a,!o.classList||!o.classList.add)return this;if(!this.options.collisionFadeIn)return this;var s=o.classList,l="mtk-ui-fadein",h=s.contains(l);return e&&!h?o.classList.add(l):!e&&h&&o.classList.remove(l),this},i.show=function(e){var o=this,a=this.getMap();if(!a)return this;this.options.visible=!0,e=e||this._coordinate||this._owner.getCenter(),e instanceof z||(e=new z(e));var s=this.isVisible();this._showBySymbolChange||this.fire("showstart");var l=this._getUIContainer();this._coordinate=e,this._removePrevDOM(),this._mapEventsOn||this._switchMapEvents("on");var h=this.__uiDOM=this.buildOn(a);h.eventsPropagation=this.options.eventsPropagation,this._observerDomSize(h);var u=this.options.zIndex;if(!h)return this._showBySymbolChange||this.fire("showend"),this._collides(),this.setZIndex(u),this;this._measureSize(h),this._singleton()&&(h._uiComponent=this,a[this._uiDomKey()]=h),this._setPosition(),h.style[ya]=null,l.appendChild(h);var f=this._getAnimation();if(s&&(f.ok=!1),f.ok&&(f.fade&&(h.style.opacity=0),f.scale)){if(this.getTransformOrigin){var c=this.getTransformOrigin();h.style[O1]=c}h.style[Di]=this._toCSSTranslate(this._pos)+" scale(0)"}this.isSupportZoomFilter()||(h.style.display=""),this.options.eventsToStop&&Pe(h,this.options.eventsToStop,wt);var d=f.transition;return f.ok&&d&&(h.offsetHeight,d&&(h.style[ya]=d),f.fade&&(h.style.opacity=1),f.scale&&(h.style[Di]=this._toCSSTranslate(this._pos)+" scale(1)")),this._showBySymbolChange||this.fire("showend"),this._collides(),clearTimeout(this._autoPanId),this.options.autoPan&&(this._autoPanId=setTimeout(function(){o._autoPan()},32)),this.setZIndex(u),this},i.hide=function(){var e=this;if(!this.getDOM())return this;this._onDomMouseout&&this._onDomMouseout(),this.options.visible=!1;var o=this._getAnimation(),a=this.getDOM();return this.options.animationOnHide||(o.ok=!1),o.ok?(a.offsetHeight,a.style[ya]=o.transition,setTimeout(function(){a.style.display="none",e.fire("hide")},this.options.animationDuration)):(a.style.display="none",this.fire("hide")),o.fade&&(a.style.opacity=0),o.scale&&(a.style[Di]=this._toCSSTranslate(this._pos)+" scale(0)"),this._switchMapEvents("off"),this._collides(),this},i.isVisible=function(){if(!this.options.visible)return!1;var e=this.getDOM();return this.getMap()&&e&&e.parentNode&&e.style.display!=="none"},i.remove=function(){if(delete this._mapEventsOn,!this._owner)return this;var e=this.getMap();return e&&e._removeUI(this),this.hide(),this._switchEvents("off"),this.onRemove&&this.onRemove(),!this._singleton()&&this.__uiDOM&&this._removePrevDOM(),delete this._owner,this.fire("remove"),this._collides(),this},i.getSize=function(){return this._domContentRect&&this._size&&(this._size.width=this._domContentRect.width,this._size.height=this._domContentRect.height),this._size?this._size.copy():null},i.getOwner=function(){return this._owner},i.getDOM=function(){return this.__uiDOM},i.setZIndex=function(e){if(!V(e))return this;var o=this.getDOM();return o?(o.style.zIndex=e,e!==this.options.zIndex&&(this.options.zIndex=e),this):this},i._roundPoint=function(e){return this.options.roundPoint&&(e=e._round()),e},i.getPosition=function(){if(!this.getMap())return null;var e=this._roundPoint(this._getViewPoint());if(this.getOffset){var o=this._roundPoint(this.getOffset());o&&e._add(o)}return e},i._getAnimation=function(){for(var e={fade:!1,scale:!1},o=this.options.animation?this.options.animation.split(","):[],a=0;a<o.length;a++){var s=Hm(o[a]);s==="fade"?e.fade=!0:s==="scale"&&(e.scale=!0)}var l=null;return e.fade&&(l="opacity "+this.options.animationDuration+"ms"),e.scale&&(l=l?l+",":"",l+=Di+" "+this.options.animationDuration+"ms"),e.transition=l,e.ok=l!==null,e},i._getViewPoint=function(){var e=0,o=this._coordinate||{};V(o.z)?e=o.z:this._owner&&this._owner.getAltitude&&(e=this._owner.getAltitude()||0);var a=this._meterToPoint(this._coordinate,e);return this.getMap().coordToViewPoint(this._coordinate,void 0,a)._add(this.options.dx,this.options.dy)},i._meterToPoint=function(e,o){return o},i._autoPan=function(){var e=this.getMap(),o=this.getDOM();if(!(!o||!e||e.isMoving())){var a=this._getViewPoint()._round(),s=e.width,l=e.height;if(o&&o.getBoundingClientRect){var h=50,u=o.getBoundingClientRect(),f=0,c=0,d=u.left,g=u.right,v=u.top,y=u.bottom,p=u.width,m=u.height;if(p>0&&m>0){if(d<h&&(f=h-d),f===0&&g+h>s&&(f=-(g+h-s)),v<h&&(c=h-v),c===0&&y+h>l&&(c=-(y+h-l)),f!==0||c!==0){var _=e.getPitch();_>40&&c!==0&&this._coordinate?e.animateTo({center:this._coordinate},{duration:e.options.panAnimationDuration}):e.panBy([Math.ceil(f),Math.ceil(c)])}return}}var w=e.viewPointToContainerPoint(a),C=this.getOffset(),x=w.add(C),T=e._viewPointToPrj(a),P=parseInt(o.clientWidth),S=parseInt(o.clientHeight),E=50,D=0,A=0;if(x.x<0?D=-x.x+E:x.x+P>s&&(D=-(x.x+P-s)-E),x.y-S<0?A=Math.abs(x.y-S)+E:x.y+S>l&&(A=l-(x.y+S)-E),P>=s&&(D=s/2-w.x),A!==0||D!==0){var I=w.add(D,A),L=e._containerPointToPoint(I)._sub(e._prjToPoint(e._getPrjCenter())),O=e._pointToPrj(e._prjToPoint(T).sub(L));e._panAnimation(O)}}},i._measureSize=function(e){var o=this._getUIContainer();e.style.position="absolute";var a=e.style.bottom?"bottom":"top";if(e.style.display="",o.appendChild(e),e.getBoundingClientRect){var s=e.getBoundingClientRect();this._size=new Ae(s.width,s.height)}else this._size=new Ae(e.clientWidth,e.clientHeight);return e.style.display="none",e.style.left="0px",e.style[a]="0px",this._size},i._removePrevDOM=function(){this.onDomRemove&&this.onDomRemove();var e=this.options.eventsToStop;if(this._singleton()){var o=this.getMap(),a=this._uiDomKey();if(o[a]){e&&Re(o[a],e,wt);var s=o[a]._uiComponent;s&&s!==this&&s.isVisible()&&s.fire("hide"),yn(o[a]),s&&!this.hideDom&&s._switchMapEvents("off"),delete o[a]}delete this.__uiDOM}else this.__uiDOM&&(e&&Re(this.__uiDOM,e,wt),yn(this.__uiDOM),delete this.__uiDOM);this._resizeObserver&&(this._resizeObserver.disconnect(),delete this._resizeObserver,delete this._domContentRect)},i._uiDomKey=function(){return"__ui_"+this._getClassName()},i._singleton=function(){return this.options.single},i._getUIContainer=function(){return this.getMap()._panels.ui},i._getClassName=function(){return"UIComponent"},i._switchMapEvents=function(e){var o=this.getMap();if(o){this._mapEventsOn=e==="on";var a=this._getDefaultEvents();if(this.getEvents&&W(a,this.getEvents()),a)for(var s in a)a.hasOwnProperty(s)&&o[e](s,a[s],this)}},i._switchEvents=function(e){var o=this._getOwnerEvents();if(this._owner)for(var a in o)o.hasOwnProperty(a)&&this._owner[e](a,o[a],this)},i._getDefaultEvents=function(){return{"zooming rotate pitch":this.onEvent,zoomend:this.onZoomEnd,moving:this.onMoving,moveend:this.onMoving,resize:this.onResize}},i._getOwnerEvents=function(){var e={};return this._owner&&this._owner instanceof ae&&(e.positionchange=this.onGeometryPositionChange,e.symbolchange=this._updatePosition),this.getOwnerEvents&&W(e,this.getOwnerEvents()),e},i.onGeometryPositionChange=function(e){this._owner&&this.isVisible()&&(this._showBySymbolChange=!0,this.show(e.target.getCenter()),delete this._showBySymbolChange)},i.onMoving=function(){this.isVisible()&&this.getMap().isTransforming()&&this._updatePosition()},i.onEvent=function(){this.isVisible()&&this._updatePosition()},i.onZoomEnd=function(){this.isVisible()&&this._setPosition()},i.onResize=function(){this.isVisible()&&this._setPosition()},i.onDomSizeChange=function(){this.isVisible()&&(this._setPosition(),this._collides())},i._updatePosition=function(){if(!this.getMap())return this;var e=this.getMap()._getRenderer();return e.callInNextFrame(this._setPosition.bind(this)),this},i._setPosition=function(){var e=this.getDOM();if(e){e.style[ya]=null;var o=this.getPosition();this._pos=o,e.style[Di]=this._toCSSTranslate(o)+" scale(1)"}},i._toCSSTranslate=function(e){if(!e)return"";if(K.any3d){var o=this.getMap(),a=o?o.getBearing():0,s=o?o.getPitch():0,l="";return this.options.pitchWithMap&&s&&(l+=" rotateX("+Math.round(s)+"deg)"),this.options.rotateWithMap&&a&&(l+=" rotateZ("+Math.round(-a)+"deg)"),"translate3d("+e.x+"px,"+e.y+"px, 0px)"+l}else return"translate("+e.x+"px,"+e.y+"px)"},i._observerDomSize=function(e){var o=this;return!e||!K.resizeObserver||this._resizeObserver?this:(this._resizeObserver=new ResizeObserver(function(a){if(a.length){var s=a[0].borderBoxSize;s&&s.length?o._domContentRect={width:s[0].inlineSize,height:s[0].blockSize}:o._domContentRect=a[0].contentRect}else delete o._domContentRect;o.onDomSizeChange&&o.onDomSizeChange()}),this._resizeObserver.observe(e),this)},i.isSupportZoomFilter=function(){return!1},i.onConfig=function(){return this._updatePosition(),this},t.isSupport=function(e){return!!(e&&oe(e.on)&&oe(e.off)&&oe(e.getCenter))},t}(Cr(zt));_i.mergeOptions(QP);var qP={containerClass:null,eventsPropagation:!0,draggable:!1,single:!1,content:null,altitude:0,minZoom:0,maxZoom:null,horizontalAlignment:"middle",verticalAlignment:"middle"},jg="mousedown mouseup mouseenter mouseover mouseout mousemove click dblclick contextmenu keypress touchstart touchmove touchend",sc=function(r){F(t,r);function t(n,e){var o;return o=r.call(this,e)||this,o._markerCoord=new z(n),o}var i=t.prototype;return i._getClassName=function(){return"UIMarker"},i.setCoordinates=function(e){return this._markerCoord=e,this.fire("positionchange"),this.isVisible()&&(this._coordinate=this._markerCoord,this._setPosition(),this._collides()),this},i.getCoordinates=function(){return this._markerCoord},i.getCenter=function(){return this.getCoordinates()},i.getAltitude=function(){var e=this.getCoordinates()||{};return V(e.z)?e.z:this.options.altitude||0},i.setAltitude=function(e){return V(e)&&this._markerCoord&&(this._markerCoord.z=e,this._updatePosition&&(this._updatePosition(),this._collides())),this},i.setContent=function(e){var o=this.options.content;return this.options.content=e,this.fire("contentchange",{old:o,new:e}),this.isVisible()&&this.show(),this},i.getContent=function(){return this.options.content},i.onAdd=function(){this.show()},i.show=function(){return r.prototype.show.call(this,this._markerCoord)},i.flash=function(e,o,a,s){return Em.call(this,e,o,a,s)},i.buildOn=function(){var e,o=this.options.content,a=ie(o);return a||oe(o)?(e=Y("div"),a?e.innerHTML=this.options.content:o.bind(this)(e)):e=this.options.content,this.options.containerClass&&(e.className=this.options.containerClass),this._registerDOMEvents(e),e},i.getOffset=function(){var e=this.getSize(),o=-e.width/2,a=-e.height/2,s=this.options,l=s.horizontalAlignment,h=s.verticalAlignment;return l==="left"?o=-e.width:l==="right"&&(o=0),h==="top"?a=-e.height:h==="bottom"&&(a=0),new k(o,a)},i.getTransformOrigin=function(){return"center center"},i.onDomRemove=function(){var e=this.getDOM();this._removeDOMEvents(e)},i.isDragging=function(){return this.draggable?this.draggable.isDragging():!1},i._registerDOMEvents=function(e){Pe(e,jg,this._onDomEvents,this)},i._onDomEvents=function(e){var o=this.getMap()._parseEvent(e,e.type),a=e.type;if(a==="mousedown"&&(this._mousedownEvent=e),a==="mouseup"&&(this._mouseupEvent=e),!(a==="click"&&this._mouseClickPositionIsChange())&&(a==="touchstart"&&(this._touchstartTime=ve()),this.fire(e.type,o),a==="touchend"&&K.touch)){var s=this.getMap().options.clickTimeThreshold||280;ve()-this._touchstartTime<s&&this._onDomEvents(W({},e,{type:"click"}))}},i._removeDOMEvents=function(e){Re(e,jg,this._onDomEvents)},i._mouseClickPositionIsChange=function(){var e=this._mousedownEvent||{},o=e.x,a=e.y,s=this._mouseupEvent||{},l=s.x,h=s.y;return o!==l||a!==h},i._getConnectPoints=function(){var e=this.getMap(),o=e.coordToContainerPoint(this.getCoordinates()),a=this.getSize(),s=a.width,l=a.height,h=[e.containerPointToCoordinate(o.add(-s/2,0)),e.containerPointToCoordinate(o.add(s/2,0)),e.containerPointToCoordinate(o.add(0,l/2)),e.containerPointToCoordinate(o.add(0,-l/2))];return h},i._getViewPoint=function(){var e=0;if(this._owner){var o=this.getAltitude();o>0&&(e=this._meterToPoint(this._coordinate,o))}return this.getMap().coordToViewPoint(this._coordinate,void 0,e)._add(this.options.dx,this.options.dy)},i._getDefaultEvents=function(){return W({},r.prototype._getDefaultEvents.call(this),{"zooming zoomend":this.onZoomFilter})},i._setPosition=function(){this.onZoomFilter(),r.prototype._setPosition.call(this)},i.onZoomFilter=function(){var e=this.getDOM();e&&(!this.isVisible()&&e.style.display!=="none"?e.style.display="none":this.isVisible()&&e.style.display==="none"&&(e.style.display=""))},i.isVisible=function(){var e=this.getMap();if(!e||!this.options.visible)return!1;var o=e.getZoom(),a=this.options,s=a.minZoom,l=a.maxZoom;if(!M(s)&&o<s||!M(l)&&o>l)return!1;var h=this.getDOM();return h&&!0},i.isSupportZoomFilter=function(){return!0},t}(Xf(_i));sc.mergeOptions(qP);var Ng=K.touch?"touchstart mousedown":"mousedown",KP=function(r){F(t,r);function t(n){return r.call(this,n)||this}var i=t.prototype;return i.addHooks=function(){this.target.on(Ng,this._startDrag,this)},i.removeHooks=function(){this.target.off(Ng,this._startDrag,this)},i._startDrag=function(e){var o=e.domEvent;o.touches&&o.touches.length>1||o.button===2||this.isDragging()||(this.target.on("click",this._endDrag,this),this._lastCoord=e.coordinate,this._lastPoint=e.containerPoint,this._prepareDragHandler(),this._dragHandler.onMouseDown(e.domEvent),this.target.fire("dragstart",e))},i._prepareDragHandler=function(){this._dragHandler=new Wo(this.target.getDOM(),{cancelOn:this._cancelOn.bind(this),ignoreMouseleave:!0}),this._dragHandler.on("mousedown",this._onMouseDown,this),this._dragHandler.on("dragging",this._dragging,this),this._dragHandler.on("mouseup",this._endDrag,this),this._dragHandler.enable()},i._cancelOn=function(e){var o=e.srcElement||e.target,a=o.tagName.toLowerCase();return a==="button"||a==="input"||a==="select"||a==="option"||a==="textarea"},i._onMouseDown=function(e){wt(e.domEvent)},i._dragging=function(e){var o=this.target,a=o.getMap(),s=a._parseEvent(e.domEvent),l=s.domEvent;if(!(l.touches&&l.touches.length>1)){if(!this._isDragging){this._isDragging=!0;return}var h=s.coordinate,u=s.containerPoint;this._lastCoord||(this._lastCoord=h),this._lastPoint||(this._lastPoint=u);var f=h.sub(this._lastCoord),c=u.sub(this._lastPoint);this._lastCoord=h,this._lastPoint=u,this.target.setCoordinates(this.target.getCoordinates().add(f)),s.coordOffset=f,s.pointOffset=c,o.fire("dragging",s)}},i._endDrag=function(e){var o=this.target,a=o.getMap();if(this._dragHandler&&(o.off("click",this._endDrag,this),this._dragHandler.disable(),delete this._dragHandler),delete this._lastCoord,delete this._lastPoint,this._isDragging=!1,!!a){var s=a._parseEvent(e.domEvent);o&&o._mouseClickPositionIsChange&&o._mouseClickPositionIsChange()&&o.fire("dragend",s)}},i.isDragging=function(){return!!this._isDragging},t}(Xt);sc.addInitHook("addHandler","draggable",KP);var eT=/\{ *([\w_]+) *\}/g,ly={containerClass:"maptalks-msgBox",autoPan:!0,autoCloseOn:null,autoOpenOn:"click",width:"auto",minHeight:120,custom:!1,title:null,content:null,enableTemplate:!1},tT=new Ae(0,0),Hu=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i._getClassName=function(){return"InfoWindow"},i.addTo=function(e){return e instanceof ae&&(e.getInfoWindow()&&e.getInfoWindow()!==this&&e.removeInfoWindow(),e._infoWindow=this),r.prototype.addTo.call(this,e)},i.setContent=function(e){var o=this.options.content;return this.options.content=e,this.fire("contentchange",{old:o,new:e}),this.isVisible()&&this.show(this._coordinate),this},i.getContent=function(){return this.options.content},i.setTitle=function(e){var o=e;return this.options.title=e,this.fire("contentchange",{old:o,new:e}),this.isVisible()&&this.show(this._coordinate),this},i.getTitle=function(){return this.options.title},i.buildOn=function(){var e=oe(this.options.content),o=ie(this.options.content);if(this.options.custom)if(o||e){var a=Y("div");return o?(a.innerHTML=this.options.content,this._replaceTemplate(a)):this.options.content.bind(this)(a),a}else return this._replaceTemplate(this.options.content),this.options.content;this._bindDomEvents(this.getDOM(),"off");var s=Y("div");this.options.containerClass&&(s.className=this.options.containerClass);var l=this._getWindowWidth();s.style.width=V(l)?l+"px":"auto",s.style.bottom="0px";var h='<em class="maptalks-ico"></em>';this.options.title&&(h+="<h2>"+this.options.title+"</h2>"),h+='<a href="javascript:void(0);" class="maptalks-close"></a><div class="maptalks-msgContent"></div>',s.innerHTML=h,this._replaceTemplate(s);var u=s.querySelector(".maptalks-msgContent");o||e?o?u.innerHTML=this.options.content:this.options.content.bind(this)(u):u.appendChild(this.options.content),this._onCloseBtnClick=this.hide.bind(this);var f=s.querySelector(".maptalks-close");return ir(f,"click touchend",this._onCloseBtnClick),e||this._replaceTemplate(u),this._bindDomEvents(s,"on"),s},i._replaceTemplate=function(e){if(this.options.enableTemplate&&this._owner&&this._owner.getProperties&&e&&e.innerHTML){var o=this._owner.getProperties()||{};if(Zt(o)){var a=e.innerHTML;e.innerHTML=a.replace(eT,function(s,l){return o[l]})}}return this},i.getTransformOrigin=function(){var e=this.getSize();return e.width/2+"px bottom"},i.getOffset=function(){var e=this.getSize(),o=new k(-e.width/2,0);this.options.custom?o._sub(0,e.height):o._sub(4,12);var a=this.getOwner();if(a instanceof Se||a instanceof Ls){var s,l;if(a instanceof Se)s=a._getPainter(),l=a.getSize();else{var h=a.getGeometries();if(!h||!h.length)return o;s=h[0]._getPainter(),l=h[0].getSize()}if(l||(l=tT),s){var u=s.getFixedExtent();o._add(u.xmax-l.width/2,u.ymin)}else o._add(0,-l.height)}return o},i.show=function(e){return this.getMap()?this.getMap().options.enableInfoWindow?r.prototype.show.call(this,e):this:this},i.getEvents=function(){if(!this.options.autoCloseOn)return null;var e={};return e[this.options.autoCloseOn]=this.hide,e},i.getOwnerEvents=function(){var e=this.getOwner();if(!this.options.autoOpenOn||!e)return null;var o={};return o[this.options.autoOpenOn]=this._onAutoOpen,o},i.onRemove=function(){this._onDomMouseout(),this.onDomRemove()},i.onDomRemove=function(){if(this._onCloseBtnClick){var e=this.getDOM(),o=e.childNodes[2];dr(o,"click touchend",this._onCloseBtnClick),delete this._onCloseBtnClick}},i._onAutoOpen=function(e){var o=this,a=this.getOwner();setTimeout(function(){a instanceof Se||a instanceof _i?o.show(a.getCoordinates()):a instanceof Ls?o.show(a.findClosest(e.coordinate)):((a instanceof xe||a instanceof Ds)&&o.getMap().getScale()>=8&&(e.coordinate=o._rectifyMouseCoordinte(a,e.coordinate)),o.show(e.coordinate))},1)},i._rectifyMouseCoordinte=function(e,o){var a=this;return e instanceof xe?this._rectifyLineStringMouseCoordinate(e,o).coordinate:e instanceof Ds?e.getGeometries().map(function(s){return a._rectifyLineStringMouseCoordinate(s,o)}).sort(function(s,l){return s.dis-l.dis})[0].coordinate:o},i._rectifyLineStringMouseCoordinate=function(e,o){for(var a=this,s=e.getCoordinates().map(function(X){return a.getMap().coordToContainerPoint(X)}),l=this.getMap().coordToContainerPoint(o),h=1/0,u=-1,f=0,c=s.length;f<c;f++){var d=s[f],g=l.distanceTo(d);g<h&&(h=g,u=f)}var v=[];u===0?v.push(s[0],s[1]):u===s.length-1?v.push(s[u-1],s[u]):v.push(s[u-1],s[u],s[u+1]);for(var y=[],p=this.getMap().getSize(),m=p.width,_=p.height,w=0,C=v.length-1;w<C;w++){var x=v[w],T=v[w+1];if(x.x===T.x)for(var P=Math.max(0,Math.min(x.y,T.y)),S=Math.min(_,Math.max(x.y,T.y)),E=P;E<=S;E++)y.push(new k(x.x,E));else for(var D=(T.y-x.y)/(T.x-x.x),A=Math.max(0,Math.min(x.x,T.x)),I=Math.min(m,Math.max(x.x,T.x)),L=A;L<=I;L++){var O=D*(L-x.x)+x.y;y.push(new k(L,O))}}for(var H=1/0,B=-1,R=0,b=y.length;R<b;R++){var N=y[R],Z=l.distanceTo(N);Z<H&&(H=Z,B=R)}return{dis:H,coordinate:B<0?o:this.getMap().containerPointToCoord(y[B])}},i._getWindowWidth=function(){var e=ly.width,o=this.options.width;return o||(o=e),o},i._bindDomEvents=function(e,o){if(e){var a=this._getDomEvents(),s=o==="on"?Pe:Re;for(var l in a)s(e,l,a[l],this)}},i._getDomEvents=function(){return{mouseover:this._onDomMouseover,mouseout:this._onDomMouseout}},i._onDomMouseover=function(e){var o=this.getMap();o&&(o.options.preventWheelScroll=!1)},i._onDomMouseout=function(e){var o=this.getMap();o&&(o.options.preventWheelScroll=!0)},t}(_i);Hu.mergeOptions(ly);var Fg="remove hide shapechange positionchange dragend animatestart",rT={width:0,height:0,animation:"fade",containerClass:"maptalks-tooltip",showTimeout:400},iT=function(r){F(i,r);var t=i.prototype;t._getClassName=function(){return"ToolTip"};function i(n,e){var o;return e===void 0&&(e={}),o=r.call(this,e)||this,o._content=n,o}return t.addTo=function(e){if(i.isSupport(e))return e.on("mousemove",this.onMouseMove,this),e.on("mouseout",this.onMouseOut,this),e.on(Fg,this.hideDom,this),r.prototype.addTo.call(this,e);throw new Error("Invalid geometry or UIMarker the tooltip is added to.")},t.setStyle=function(e){return this.options.containerClass=e,this},t.getStyle=function(){return this.options.containerClass},t.getContent=function(){return this._content},t.buildOn=function(){var e=Y("div"),o=this.options||{};o.height&&(e.style.height=o.height+"px"),o.width&&(e.style.width=o.width+"px");var a=o.containerClass||o.cssName;return!a&&o.height&&(e.style.lineHeight=o.height+"px"),oe(this._content)?this._content.bind(this)(e):e.innerHTML='<div class="'+a+'">'+this._content+"</div>",e},t.onMouseOut=function(){clearTimeout(this._timeout),this.isVisible()&&this._removePrevDOM(),this._switchMapEvents("off")},t.onMouseMove=function(e){var o=this;clearTimeout(this._timeout);var a=this.getMap();if(a){var s=a.locateByPoint(e.coordinate,-5,25);this.options.showTimeout===0?this.show(s):this._timeout=setTimeout(function(){a&&o.show(s)},this.options.showTimeout)}},t.onRemove=function(){clearTimeout(this._timeout),this._owner&&(this._owner.off("mouseover",this.onMouseOver,this),this._owner.off("mouseout",this.onMouseOut,this),this._owner.off(Fg,this.hideDom,this))},t.hideDom=function(){return this.hide()},t.onEvent=function(){return r.prototype.onEvent.call(this),this.hideDom(),this},t._getViewPoint=function(){return this.getMap().coordToViewPoint(this._coordinate,void 0,0)._add(this.options.dx,this.options.dy)},i}(_i);iT.mergeOptions(rT);var nT={containerClass:"maptalks-menu",animation:null,animationDelay:10,animationOnHide:!1,autoPan:!1,width:160,maxHeight:0,custom:!1,items:[]},hy=function(r){F(t,r);function t(n){return r.call(this,n)||this}var i=t.prototype;return i._getClassName=function(){return"Menu"},i.addTo=function(e){return e._menu&&e._menu!==this&&e.removeMenu(),e._menu=this,this._owner=e,_i.prototype.addTo.apply(this,arguments)},i.setItems=function(e){return this.options.items=e,this},i.getItems=function(){return this.options.items||[]},i.buildOn=function(){if(this.options.custom)if(ie(this.options.items)){var e=Y("div");return e.innerHTML=this.options.items,e}else return this.options.items;else{var o=Y("div");this.options.containerClass&&rn(o,this.options.containerClass),o.style.width=this._getMenuWidth()+"px";var a=this._createMenuItemDom();return o.appendChild(a),Pe(o,"contextmenu",yr),o}},i.getOffset=function(){if(!this.getMap())return null;var e=this.getMap().getSize(),o=this.getMap().viewPointToContainerPoint(this._getViewPoint()),a=this.getSize(),s=0,l=0;return o.x+a.width>e.width&&(s=-a.width),o.y+a.height>e.height&&(l=-a.height),new k(s,l)},i.getTransformOrigin=function(){var e=this.getOffset()._multi(-1);return e.x+"px "+e.y+"px"},i.getEvents=function(){return{"_zoomstart _zoomend _movestart _dblclick _click":this._removePrevDOM}},i._createMenuItemDom=function(){var e=this,o=this.getMap(),a=Y("ul");rn(a,"maptalks-menu-items");var s=this.getItems();function l(v){return function(y){var p=o._parseEvent(y,"click");p.target=e,p.owner=e._owner,p.index=v;var m=this._callback(p);m!==!1&&(e.hide(),e._owner&&e._owner.fire("closemenu"))}}for(var h,u,f=0,c=s.length;f<c;f++){if(h=s[f],h==="-"||h==="_")u=Y("li"),rn(u,"maptalks-menu-splitter");else{u=Y("li");var d=h.item;oe(d)&&(d=d({owner:this._owner,index:f})),u.innerHTML=d,u._callback=h.click,Pe(u,"click",l(f))}a.appendChild(u)}var g=this.options.maxHeight||0;return g>0&&il(a,"max-height: "+g+"px; overflow-y: auto;"),a},i._getMenuWidth=function(){var e=160,o=this.options.width||e;return o},t}(_i);hy.mergeOptions(nT);var uy={setMenu:function(t){return this._menuOptions=t,this._menu?this._menu.setOptions(t):this.on("contextmenu",this._defaultOpenMenu,this),this},getMenu:function(){return this._menu},openMenu:function(t){var i=this instanceof Q?this:this.getMap();return t||(t=this.getCenter()),this._menu?this._menu.show(t):this._menuOptions&&i&&(this._bindMenu(),this._menu.show(t)),this.fire("openmenu",{coordinate:t}),this},setMenuItems:function(t){return this._menuOptions||(this._menuOptions={}),Array.isArray(t)&&(this._menuOptions.custom=!1),this._menuOptions.items=t,this.setMenu(this._menuOptions),this},getMenuItems:function(){return this._menu?this._menu.getItems():this._menuOptions?this._menuOptions.items||[]:[]},closeMenu:function(){return this._menu&&this._menu.hide(),this.fire("closemenu",{}),this},removeMenu:function(){return this.off("contextmenu",this._defaultOpenMenu,this),this._unbindMenu(),delete this._menuOptions,this.fire("removemenu",{}),this},_bindMenu:function(){return this._menuOptions?(this._menu=new hy(this._menuOptions),this._menu.addTo(this),this):this},_unbindMenu:function(){return this._menu&&(this.closeMenu(),this._menu.remove(),delete this._menu),this},_defaultOpenMenu:function(t){return this.openMenu(t.coordinate),!1}};Q.include(uy);ae.include(uy);var $t=function(r){F(t,r);function t(n){return n&&n.position&&!ie(n.position)&&(n.position=W({},n.position)),r.call(this,n)||this}var i=t.prototype;return i.addTo=function(e){if(this.remove(),!e.options.control)return this;this._map=e;var o=e._panels.control;return this.__ctrlContainer=Y("div"),il(this.__ctrlContainer,"position:absolute;overflow:visible;"),this.update(),o.appendChild(this.__ctrlContainer),this.onAdd&&this.onAdd(),this.fire("add",{dom:o}),this},i.update=function(){return this.__ctrlContainer.innerHTML="",this._controlDom=this.buildOn(this.getMap()),this._controlDom&&(this._updatePosition(),this.__ctrlContainer.appendChild(this._controlDom)),this},i.getMap=function(){return this._map},i.getPosition=function(){return W({},this._parse(this.options.position))},i.setPosition=function(e){return ie(e)?this.options.position=e:this.options.position=W({},e),this._updatePosition(),this},i.getContainerPoint=function(){var e=this.getPosition(),o=this.getMap().getSize(),a,s;return M(e.left)?M(e.right)||(a=o.width-parseInt(e.right)):a=parseInt(e.left),M(e.top)?M(e.bottom)||(s=o.height-parseInt(e.bottom)):s=parseInt(e.top),new k(a,s)},i.getContainer=function(){return this.__ctrlContainer},i.getDOM=function(){return this._controlDom},i.show=function(){return this.__ctrlContainer.style.display="",this},i.hide=function(){return this.__ctrlContainer.style.display="none",this},i.isVisible=function(){return this.__ctrlContainer&&this.__ctrlContainer.style.display===""},i.remove=function(){return this._map?(yn(this.__ctrlContainer),this.onRemove&&this.onRemove(),delete this._map,delete this.__ctrlContainer,delete this._controlDom,this.fire("remove"),this):this},i._parse=function(e){var o=e;return ie(e)&&(o=t.positions[o]),o},i._updatePosition=function(){var e=this.getPosition();e||(e={top:20,left:20});for(var o in e)e.hasOwnProperty(o)&&(e[o]=parseInt(e[o]),this.__ctrlContainer.style[o]=e[o]+"px");this.fire("positionchange",{position:W({},e)})},t}(Cr(zt));$t.positions={"top-left":{top:20,left:20},"top-right":{top:20,right:20},"bottom-left":{bottom:20,left:20},"bottom-right":{bottom:20,right:20}};Q.mergeOptions({control:!0});Q.include({addControl:function(t){return this._containerDOM.getContext?this:(t.addTo(this),this)},removeControl:function(t){return!t||t.getMap()!==this?this:(t.remove(),this)}});var oT={position:{bottom:0,left:0},content:'<a href="http://maptalks.org" target="_blank">maptalks</a>'},Hg="addlayer removelayer setbaselayer baselayerremove",fy=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.buildOn=function(){return this._attributionContainer=Y("div"),this._attributionContainer.className="maptalks-attribution",this._update(),this._attributionContainer},i.onAdd=function(){this.getMap().on(Hg,this._update,this)},i.onRemove=function(){this.getMap().off(Hg,this._update,this)},i._update=function(){var e=this.getMap();if(e){var o=e._getLayers(function(s){return s.options.attribution}).reverse().map(function(s){return s.options.attribution}),a=this.options.content+(o.length>0?" - "+o.join(", "):"");this._attributionContainer.innerHTML='<span style="padding:0px 4px">'+a+"</span>"}},t}($t);fy.mergeOptions(oT);Q.mergeOptions({attribution:!0});Q.addOnLoadHook(function(){var r=this.options.attribution||this.options.attributionControl;r&&(this.attributionControl=new fy(r),this.addControl(this.attributionControl))});var aT={position:{top:120,left:20}},cy=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.buildOn=function(e){var o=this._getCompass();return this._compass=o,this._registerDomEvents(),e.on("resize moving moveend zooming zoomend rotate rotateend dragrotating dragrotateend viewchange",this._rotateCompass,this),o},i.onAdd=function(){this._rotateCompass()},i._getCompass=function(){var e=Y("div","maptalks-compass");return e},i._registerDomEvents=function(){Pe(this._compass,"click",this._resetView,this)},i._rotateCompass=function(){var e=this.getMap().getBearing().toFixed(1);e<=180&&(e*=-1),e!==this._bearing&&(this._bearing=e,il(this._compass,"transform: rotate("+this._bearing+"deg);"))},i.onRemove=function(){this.getMap().off("resize moving moveend zooming zoomend rotate rotateend dragrotating dragrotateend viewchange",this._rotateCompass,this),delete this._compass,delete this._bearing},i._resetView=function(){var e={bearing:0};this.getMap().animateTo(e)},t}($t);cy.mergeOptions(aT);Q.mergeOptions({compassControl:!1});Q.addOnLoadHook(function(){this.options.compassControl&&(this.compassControl=new cy(this.options.compassControl),this.addControl(this.compassControl))});var sT={position:"top-right",baseTitle:"Base Layers",overlayTitle:"Layers",excludeLayers:[],containerClass:"maptalks-layer-switcher"},dy=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.buildOn=function(){var e=this.container=Y("div",this.options.containerClass),o=this.panel=Y("div","panel"),a=this.button=Y("button");return e.appendChild(a),e.appendChild(o),e},i.onAdd=function(){Pe(this.button,"mouseover",this._show,this),Pe(this.panel,"mouseleave",this._hide,this),Pe(this.getMap(),"click",this._hide,this)},i.onRemove=function(){this.panel&&(Re(this.button,"mouseover",this._show),Re(this.panel,"mouseleave",this._hide),Re(this.getMap(),"click",this._hide),yn(this.panel),yn(this.button),delete this.panel,delete this.button,delete this.container)},i._show=function(){Xm(this.container,"shown")||(rn(this.container,"shown"),this._createPanel())},i._hide=function(e){this.panel.contains(e.toElement||e.relatedTarget)||$f(this.container,this.options.containerClass)},i._createPanel=function(){this.panel.innerHTML="";var e=Y("ul");this.panel.appendChild(e),this._renderLayers(this.getMap(),e)},i._renderLayers=function(e,o){var a=this,s=e.getBaseLayer(),l=e.getLayers(),h=l.length;if(s){var u=s.layers||[s],f=Y("li","group"),c=Y("ul"),d=Y("label");d.innerHTML=this.options.baseTitle,f.appendChild(d);for(var g=0,v=u.length;g<v;g++){var y=u[g];this._isExcluded(y)&&(c.appendChild(this._renderLayer(u[g],!0)),f.appendChild(c),o.appendChild(f))}}if(h){var p=Y("li","group"),m=Y("ul"),_=Y("label"),w=Y("input");w.type="checkbox",w.checked=!0,_.innerHTML=this.options.overlayTitle,p.appendChild(w),p.appendChild(_);for(var C=function(S){var E=S.target.checked,D=S.target.parentNode;if(D){var A=D.getElementsByTagName("ul")[0];if(A){var I=function(H){var B=H._layer;B&&B[E?"show":"hide"]()},L=function(H){var B=H._layer,R=H.childNodes[0];R&&(R.checked=E),B&&B[E?"show":"hide"]()};I(D),A.childNodes.forEach(function(O){L(O);var H=O.getElementsByTagName("ul")[0];H&&(I(O),H.childNodes.forEach(function(B){L(B)}))})}}},x=0;x<h;x++){var T=l[x];this._isExcluded(T)&&(T.getLayers?function(){var P=Y("li","group"),S=Y("ul"),E=Y("label"),D=Y("input");E.innerHTML=T.getId(),D.type="checkbox",D.checked=T.isVisible(),D.onchange=C,P.appendChild(D),P.appendChild(E),P.appendChild(S),P._layer=T,m.appendChild(P);var A=T.getLayers()||[];A.forEach(function(I){S.appendChild(a._renderLayer(I,!1,D.checked))})}():m.appendChild(this._renderLayer(T)),T&&!T.isVisible()&&(w.checked=!1))}p.appendChild(m),o.appendChild(p),w.onchange=C}},i._isExcluded=function(e){var o=e.getId(),a=this.options.excludeLayers;return!(a.length&&a.indexOf(o)>=0)},i._renderLayer=function(e,o,a){var s=this;a===void 0&&(a=!0);var l=Y("li","layer"),h=Y("label"),u=Y("input"),f=this.getMap(),c=e.options.visible;e.options.visible=!0;var d=e.isVisible();return e.options.visible=c,l.className="layer",o?(u.type="radio",u.name="base"):u.type="checkbox",u.checked=c&&d,a||(u.checked=!1),d||u.setAttribute("disabled","disabled"),u.onchange=function(g){if(g.target.type==="radio"){var v=f.getBaseLayer(),y=v.layers;if(y)for(var p=0,m=y.length;p<m;p++){var _=y[p];_[_===e?"show":"hide"]()}else v.isVisible()||v.show();f._fireEvent("setbaselayer")}else e[g.target.checked?"show":"hide"]();s.fire("layerchange",{target:e})},l.appendChild(u),h.innerHTML=e.getId(),l.appendChild(h),l._layer=e,l},t}($t);dy.mergeOptions(sT);Q.mergeOptions({layerSwitcherControl:!1});Q.addOnLoadHook(function(){this.options.layerSwitcherControl&&(this.layerSwitcherControl=new dy(this.options.layerSwitcherControl),this.addControl(this.layerSwitcherControl))});var lT={level:4,position:{right:1,bottom:1},size:[300,200],maximize:!0,symbol:{lineWidth:3,lineColor:"#1bbc9b",polygonFill:"#1bbc9b",polygonOpacity:.4},containerClass:"maptalks-overview",buttonClass:"maptalks-overview-button"},gy=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.buildOn=function(){var e=this.options.size;this.options.maximize||(e=[0,0]);var o=Y("div"),a=this.mapContainer=Y("div");a.style.width=e[0]+"px",a.style.height=e[1]+"px",a.className=this.options.containerClass;var s=this.button=Y("div");return s.className=this.options.buttonClass,o.appendChild(a),o.appendChild(s),o},i.onAdd=function(){this.options.maximize&&this._createOverview(),this.getMap().on("resize moving zooming rotate dragrotating viewchange",this._update,this).on("setbaselayer",this._updateBaseLayer,this).on("spatialreferencechange",this._updateSpatialReference,this),Pe(this.button,"click",this._onButtonClick,this),this._updateButtonText()},i.onRemove=function(){this.getMap().off("resize moving zooming rotate dragrotating viewchange",this._update,this).off("setbaselayer",this._updateBaseLayer,this).off("spatialreferencechange",this._updateSpatialReference,this),this._overview&&(this._overview.remove(),delete this._overview,delete this._perspective),Re(this.button,"click",this._onButtonClick)},i.maxmize=function(){var e=this.options.size,o=this.mapContainer;return o.style.width=e[0]+"px",o.style.height=e[1]+"px",this._createOverview(),this},i.minimize=function(){this._overview&&this._overview.remove(),delete this._overview,delete this._perspective;var e=this.mapContainer;return e.style.width="0px",e.style.height="0px",this},i.getOverviewMap=function(){return this._overview},i._onButtonClick=function(){this._overview?this.minimize():this.maxmize(),this._updateButtonText()},i._updateButtonText=function(){this._overview?this.button.innerHTML="-":this.button.innerHTML="+"},i._createOverview=function(){var e=this.getMap(),o=this.mapContainer,a=e.config();W(a,{center:e.getCenter(),zoom:this._getOverviewZoom(),zoomAnimationDuration:150,pitch:0,bearing:0,scrollWheelZoom:!1,checkSize:!1,doubleClickZoom:!1,touchZoom:!1,control:!1,draggable:!1,maxExtent:null}),this._overview=new Q(o,a),this._updateBaseLayer(),this._perspective=new Oe(this._getPerspectiveCoords(),{draggable:!0,cursor:"move",symbol:this.options.symbol}).on("dragend",this._onDragEnd,this),new or("perspective_layer",this._perspective).addTo(this._overview),this.fire("load")},i._getOverviewZoom=function(){var e=this.getMap(),o=e.getZoom(),a=e.getMinZoom(),s=this.options.level;if(s>0){for(var l=s;l>0;l--)if(o-l>=a)return o-l}else for(var h=s;h<0;h++)if(o-h>=a)return o-h;return o},i._onDragEnd=function(){var e=this._perspective.getCenter();this._overview.setCenter(e),this.getMap().panTo(e)},i._getPerspectiveCoords=function(){var e=this.getMap(),o=e.getProjection();return e.getContainerExtent().toArray().map(function(a){if(o){var s=e._containerPointToPrj(a);return e._fixPrjOnWorldWide(s),o.unproject(s)}return e.containerPointToCoordinate(a)})},i._update=function(){if(this._overview){rl(this._overview._containerDOM);var e=this._getPerspectiveCoords();this._perspective.setCoordinates(e),this._overview.setCenterAndZoom(this.getMap().getCenter(),this._getOverviewZoom())}},i._updateSpatialReference=function(){if(this._overview){var e=this.getMap(),o=e.options.spatialReference;this._overview.setSpatialReference(o)}},i._updateBaseLayer=function(){if(this._overview){var e=this.getMap(),o=e.getBaseLayer();if(!o){this._overview.setBaseLayer(null);return}var a=o.layers,s=0;if(a)for(var l=0,h=a.length;l<h;l++){var u=a[l];if(u.isVisible()){s=l;break}}var f=o.toJSON(),c=null;a?(c=f.layers[s].options,c.visible=!0):c=f.options,this._overview.setMinZoom(c.minZoom||null).setMaxZoom(c.maxZoom||null),delete c.minZoom,delete c.maxZoom,delete f.options.canvas,f.options.visible=!0,f.options.renderer="canvas";var d=it.fromJSON(f);for(var g in o)oe(o[g])&&o.hasOwnProperty(g)&&o[g]!==o.constructor.prototype[g]&&(d[g]=o[g]);this._overview.setBaseLayer(d)}},t}($t);gy.mergeOptions(lT);Q.mergeOptions({overviewControl:!1});Q.addOnLoadHook(function(){this.options.overviewControl&&(this.overviewControl=new gy(this.options.overviewControl),this.addControl(this.overviewControl))});var hT={position:"top-right",draggable:!0,custom:!1,content:"",closeButton:!0},uT=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.buildOn=function(){var e;if(this.options.custom)ie(this.options.content)?(e=Y("div"),e.innerHTML=this.options.content):e=this.options.content;else{if(e=Y("div","maptalks-panel"),this.options.closeButton){var o=Y("a","maptalks-close");o.innerText="",o.href="javascript:;",o.onclick=function(){e.style.display="none"},e.appendChild(o)}var a=Y("div","maptalks-panel-content");a.innerHTML=this.options.content,e.appendChild(a)}return this.draggable=new Wo(e,{cancelOn:this._cancelOn.bind(this),ignoreMouseleave:!0}),this.draggable.on("dragstart",this._onDragStart,this).on("dragging",this._onDragging,this).on("dragend",this._onDragEnd,this),this.options.draggable&&this.draggable.enable(),e},i.update=function(){return this.draggable&&(this.draggable.disable(),delete this.draggable),$t.prototype.update.call(this)},i.setContent=function(e){var o=this.options.content;return this.options.content=e,this.fire("contentchange",{old:o,new:e}),this.isVisible()&&this.update(),this},i.getContent=function(){return this.options.content},i._cancelOn=function(e){var o=e.srcElement||e.target,a=o.tagName.toLowerCase();return a==="button"||a==="input"||a==="select"||a==="option"||a==="textarea"},i._onDragStart=function(e){this._startPos=e.mousePos,this._startPosition=W({},this.getPosition()),this.fire("dragstart",e)},i._onDragging=function(e){var o=e.mousePos,a=o.sub(this._startPos),s=this._startPosition,l=this.getPosition();M(l.top)||(l.top=parseInt(s.top)+a.y),M(l.bottom)||(l.bottom=parseInt(s.bottom)-a.y),M(l.left)||(l.left=parseInt(s.left)+a.x),M(l.right)||(l.right=parseInt(s.right)-a.x),this.setPosition(l),this.fire("dragging",e)},i._onDragEnd=function(e){delete this._startPos,delete this._startPosition,this.fire("dragend",e)},i._getConnectPoints=function(){var e=this.getMap(),o=this.getContainerPoint(),a=this.getDOM(),s=parseInt(a.clientWidth),l=parseInt(a.clientHeight),h=[e.containerPointToCoordinate(o.add(s/2,0)),e.containerPointToCoordinate(o.add(s,l/2)),e.containerPointToCoordinate(o.add(s/2,l)),e.containerPointToCoordinate(o.add(0,l/2))];return h},t}($t);uT.mergeOptions(hT);var fT={position:{top:156,left:20},view:null},vy=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.buildOn=function(){var e=this._getReset();return this._reset=e,this._registerDomEvents(),e},i.onAdd=function(){this._view=this.options.view?this.options.view:this.getMap().getView()},i.setView=function(e){this._view=e},i._getReset=function(){var e=Y("div","maptalks-reset");return e},i._registerDomEvents=function(){Pe(this._reset,"click",this._resetView,this)},i.onRemove=function(){delete this._reset,delete this._view},i._resetView=function(){this.getMap().setView(this._view)},t}($t);vy.mergeOptions(fT);Q.mergeOptions({resetControl:!1});Q.addOnLoadHook(function(){this.options.resetControl&&(this.resetControl=new vy(this.options.resetControl),this.addControl(this.resetControl))});var cT={position:"bottom-left",maxWidth:100,metric:!0,imperial:!1,containerClass:null},Bg="zoomend moving moveend",py=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.buildOn=function(e){return this._map=e,this._scaleContainer=Y("div",this.options.containerClass),this._addScales(),e.on(Bg,this._update,this),this._map._loaded&&this._update(),this._scaleContainer},i.onRemove=function(){this.getMap().off(Bg,this._update,this)},i._addScales=function(){var e="border: 2px solid #000000;border-top: none;line-height: 1.1;padding: 0px;color: #000000;font-size: 11px;text-align:center;white-space: nowrap;overflow: hidden;-moz-box-sizing: content-box;box-sizing: content-box;background: #fff; background: rgba(255, 255, 255, 0);";this.options.metric&&(this._mScale=Kd("div",this.options.containerClass?null:e,this._scaleContainer)),this.options.imperial&&(this._iScale=Kd("div",this.options.containerClass?null:e,this._scaleContainer))},i._update=function(){var e=this._map,o=e.pixelToDistance(this.options.maxWidth,0);this._updateScales(o)},i._updateScales=function(e){this.options.metric&&e&&this._updateMetric(e),this.options.imperial&&e&&this._updateImperial(e)},i._updateMetric=function(e){var o=this._getRoundNum(e),a=o<1e3?o+" m":o/1e3+" km";this._updateScale(this._mScale,a,o/e)},i._updateImperial=function(e){var o=e*3.2808399,a,s,l;o>5280?(a=o/5280,s=this._getRoundNum(a),this._updateScale(this._iScale,s+" mile",s/a)):(l=this._getRoundNum(o),this._updateScale(this._iScale,l+" feet",l/o))},i._updateScale=function(e,o,a){e.style.width=Math.round(this.options.maxWidth*a)+"px",e.innerHTML=o},i._getRoundNum=function(e){var o=Math.pow(10,(Math.floor(e)+"").length-1),a=e/o;return a=a>=10?10:a>=5?5:a>=3?3:a>=2?2:1,o*a},t}($t);py.mergeOptions(cT);Q.mergeOptions({scaleControl:!1});Q.addOnLoadHook(function(){this.options.scaleControl&&(this.scaleControl=new py(this.options.scaleControl),this.addControl(this.scaleControl))});var dT={height:28,vertical:!1,position:"top-right",reverseMenu:!1,items:{}},gT=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.buildOn=function(e){this._map=e;var o=Y("div"),a=Y("ul","maptalks-toolbar-hx");o.appendChild(a),this.options.vertical?rn(o,"maptalks-toolbar-vertical"):rn(o,"maptalks-toolbar-horizonal");var s=this;function l(y,p,m,_){var w=s._getItems()[p];return function(C){return wt(C),y({target:w,index:p,childIndex:m,dom:_})}}var h=this.options.items;if(he(h))for(var u=0,f=h.length;u<f;u++){var c=h[u],d=Y("li");if(this.options.height!==28&&(d.style.lineHeight=this.options.height+"px"),d.style.height=this.options.height+"px",d.style.cursor="pointer",I1(c.item)){d.style.textAlign="center";var g=z1("div",c.item);d.innerHTML='<div style="margin-top:'+(this.options.height-g.height)/2+'px;">'+c.item+"</div>"}else d.innerHTML=c.item;if(c.click&&Pe(d,"click",l(c.click,u,null,d)),he(c.children)){var v=this._createDropMenu(u);d.appendChild(v),d._menu=v,Pe(d,"mouseover",function(){this._menu.style.display=""}),Pe(d,"mouseout",function(){this._menu.style.display="none"})}a.appendChild(d)}return o},i._createDropMenu=function(e){var o=this;function a(C,x,T){var P=o._getItems()[x].children[T];return function(S){return wt(S),C({target:P,index:x,childIndex:T})}}var s=Y("div","maptalks-dropMenu"),l=this._getItems(),h=l.length,u=Y("ul"),f=l[e].children;e===h-1&&f&&(s.style.cssText="right: 0px;",u.style.cssText="right: 0px;position: absolute;",this.options.reverseMenu&&(u.style.bottom=0)),s.appendChild(Y("em","maptalks-ico"));for(var c=0,d=0,g=f.length;d<g;d++){var v=Bm(f[d].item,"12px");v.width>c&&(c=v.width)}for(var y=0,p=f.length;y<p;y++){var m=f[y],_=Y("li");_.innerHTML='<a href="javascript:;">'+m.item+"</a>",_.style.cursor="pointer",_.style.width=c+24+"px",Pe(_.childNodes[0],"click",a(m.click,e,y)),u.appendChild(_)}if(this.options.vertical){var w=c<95?95:c;this.options.reverseMenu?s.style.right=-(w+10*2+2)+"px":s.style.left=-(w+10*2+2)+"px"}else this.options.reverseMenu?s.style.bottom="28px":s.style.top="29px";return s.appendChild(u),s.style.display="none",s},i._getItems=function(){return this.options.items||[]},t}($t);gT.mergeOptions(dT);var vT={position:"top-left",zoomLevel:!0,seamless:!1},my=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.buildOn=function(e){var o=this.options,a=Y("div","maptalks-zoom");if(o.zoomLevel){var s=Y("span","maptalks-zoom-zoomlevel"),l=Y("span","maptalks-zoom-zoomlevel-text");s.appendChild(l),a.appendChild(s),this._levelDOM=l}var h=Y("div","maptalks-zoom-slider"),u=Y("a","maptalks-zoom-zoomin");u.href="javascript:;",h.appendChild(u),this._zoomInButton=u;var f=Y("a","maptalks-zoom-zoomout");return f.href="javascript:;",h.appendChild(f),this._zoomOutButton=f,a.appendChild(h),e.on("_zoomend _zooming _zoomstart _spatialreferencechange",this._update,this),this._update(),this._registerDomEvents(),a},i.onRemove=function(){this.getMap().off("_zoomend _zooming _zoomstart _spatialreferencechange",this._update,this)},i._update=function(){this._updateText()},i._updateText=function(){if(this._levelDOM){var e=this.getMap(),o=e.getZoom();$i(o)||(o=Math.floor(o*10)/10),this._levelDOM.innerHTML=o}},i._registerDomEvents=function(){this._zoomInButton&&Pe(this._zoomInButton,"click",this._onZoomInClick,this),this._zoomOutButton&&Pe(this._zoomOutButton,"click",this._onZoomOutClick,this)},i._onZoomInClick=function(e){yr(e),this.getMap().zoomIn()},i._onZoomOutClick=function(e){yr(e),this.getMap().zoomOut()},t}($t);my.mergeOptions(vT);Q.mergeOptions({zoomControl:!1});Q.addOnLoadHook(function(){this.options.zoomControl&&(this.zoomControl=new my(this.options.zoomControl),this.addControl(this.zoomControl))});var zr=function(){function r(t,i,n,e){Array.isArray(t)?(this.scale={x:t[0],y:t[1]},this.origin={x:t[2],y:t[3]}):(this.scale={x:t,y:i},this.origin={x:n,y:e})}return r.getDefault=function(i){var n=i.code.toLowerCase();return n==="baidu"?"baidu":n==="EPSG:4326".toLowerCase()||n==="EPSG:4490".toLowerCase()?"tms-global-geodetic":n==="identity"?[1,-1,0,0]:"web-mercator"},r}(),Aa=6378137*Math.PI;W(zr,{"web-mercator":new zr([1,-1,-Aa,Aa]),"tms-global-mercator":new zr([1,1,-Aa,-Aa]),"tms-global-geodetic":new zr([1,1,-180,-90]),baidu:new zr([1,1,0,0])});var Gg=function(){function r(i,n,e,o){this.map=i,this.tileSize=o,this.fullExtent=e,this.prepareTileInfo(n,e),this._xScale=e.right>=e.left?1:-1,this._yScale=e.top>=e.bottom?1:-1;var a=i.getGLRes();this._pointOrigin=i._prjToPointAtRes(new k(this.tileSystem.origin),a),this._glRes=a}var t=r.prototype;return t.prepareTileInfo=function(n,e){if(ie(n)?n=zr[n.toLowerCase()]:Array.isArray(n)&&(n=new zr(n)),!n)throw new Error("Invalid TileSystem");this.tileSystem=n;var o=e.right>e.left?1:-1,a=e.top>e.bottom?-1:1,s=n.origin.x,l=n.origin.y;this.transformation=new s_([o,a,s,l])},t._getTileNum=function(n,e){var o=this.tileSystem,a=this.tileSize,s=1e-7,l=Math.floor(s*o.scale.x+n.x/(a.width*e)),h=Math.ceil(s*o.scale.y+n.y/(a.height*e));return{x:o.scale.x*l,y:o.scale.y*h}},t.getTileIndex=function(n,e,o){var a=this.tileSystem,s=this.transformation.transform(n,1),l=this._getTileNum(s,e);return a.scale.x<0&&(l.x-=1),a.scale.y>0&&(l.y-=1),this.getNeighorTileIndex(l.x,l.y,0,0,e,o)},t.getNeighorTileIndex=function(n,e,o,a,s,l){var h=this.tileSystem,u=n+h.scale.x*o,f=e-h.scale.y*a,c=!1,d=u,g=f,v=this._getTileFullIndex(s);return l&&((l===!0||l==="x")&&(v.xmax===v.xmin?u=v.xmin:u<v.xmin?(u=v.xmax-(v.xmin-u)%(v.xmax-v.xmin),u===v.xmax&&(u=v.xmin)):u>=v.xmax&&(u=v.xmin+(u-v.xmin)%(v.xmax-v.xmin))),(l===!0||l==="y")&&(v.ymax===v.ymin?f=v.ymin:f>=v.ymax?f=v.ymin+(f-v.ymin)%(v.ymax-v.ymin):f<v.ymin&&(f=v.ymax-(v.ymin-f)%(v.ymax-v.ymin),f===v.ymax&&(f=v.ymin)))),(u<v.xmin||u>v.xmax||f>v.ymax||f<v.ymin)&&(c=!0),{x:u,y:f,idx:d,idy:g,out:c}},t._getTileFullIndex=function(n){if(this._tileFullIndex||(this._tileFullIndex={}),this._tileFullIndex[n])return this._tileFullIndex[n];var e=this.fullExtent,o=this.transformation,a=this._getTileNum(o.transform(new z(e.left,e.top),1),n),s=this._getTileNum(o.transform(new z(e.right,e.bottom),1),n),l=this.tileSystem;return l.scale.x<0&&(a.x-=1,s.x-=1),l.scale.y>0&&(a.y-=1,s.y-=1),this._tileFullIndex[n]=new ge(a,s),this._tileFullIndex[n]},t.getTilePrjNW=function(n,e,o,a){var s=this.tileSystem,l=this.tileSize,h=s.origin.y+this._yScale*s.scale.y*(e+(s.scale.y===1?1:0))*o*l.height,u=s.origin.x+this._xScale*s.scale.x*(n+(s.scale.x===1?0:1))*o*l.width;return a?(a.set(u,h),a):new z(u,h)},t.getTilePointNW=function(n,e,o,a){var s=this._glRes/o,l=this.tileSystem,h=this.tileSize,u=this._pointOrigin.y*s+this._yScale*l.scale.y*(e+(l.scale.y===1?1:0))*h.height,f=this._pointOrigin.x*s+this._xScale*l.scale.x*(n+(l.scale.x===1?0:1))*h.width;return a?(a.set(f,u),a):new k(f,u)},t.getTilePrjSE=function(n,e,o,a){var s=this.tileSystem,l=this.tileSize,h=s.origin.y+this._yScale*s.scale.y*(e+(s.scale.y===1?0:1))*o*l.height,u=s.origin.x+this._xScale*s.scale.x*(n+(s.scale.x===1?1:0))*o*l.width;return a?(a.set(u,h),a):new z(u,h)},t.getTilePointSE=function(n,e,o,a){var s=this._glRes/o,l=this.tileSystem,h=this.tileSize,u=this._pointOrigin.y*s+this._yScale*l.scale.y*(e+(l.scale.y===1?0:1))*h.height,f=this._pointOrigin.x*s+this._xScale*l.scale.x*(n+(l.scale.x===1?1:0))*h.width;return a?(a.set(f,u),a):new k(f,u)},t.getTilePrjExtent=function(n,e,o){var a=this.getTilePrjNW(n,e,o),s=this.getTilePrjSE(n,e,o);return new ge(a,s)},r}(),pT=1,Zn=new k(0,0),mT=32,Oa=typeof Set<"u",Wg=function(){function r(){this._table=Oa?new Set:{}}var t=r.prototype;return t.add=function(n){Oa?this._table.add(n):this._table[n]=!0},t.has=function(n){return Oa?this._table.has(n):this._table[n]},t.reset=function(){Oa?this._table.clear():this._table={}},r}(),_T={urlTemplate:null,subdomains:null,errorUrl:null,repeatWorld:!0,background:!0,loadingLimitOnInteracting:3,loadingLimit:0,tileRetryCount:0,placeholder:!1,crossOrigin:null,tileSize:[256,256],offset:[0,0],tileSystem:null,fadeAnimation:!Fe,fadeDuration:1e3/60*10,debug:!1,spatialReference:null,maxCacheSize:256,renderer:function(){return K.webgl?"gl":"canvas"}(),clipByPitch:!0,maxAvailableZoom:null,cascadeTiles:!0,zoomOffset:0,pyramidMode:1,decodeImageInWorker:!1,tileLimitPerFrame:0,tileStackStartDepth:7,tileStackDepth:3,awareOfTerrain:!0},yT=/\{ *([\w_]+) *\}/g,wT=new k(0,0),La=new k(0,0),Un=new k(0,0),Er=new k(0,0),xT=new k(0,0),CT=new k(0,0),Ue=[[0,0,0],[0,0,0]],wh=[0,0,0],xh=[0,0,0],Ch=[],Lt=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}t.fromJSON=function(e){return!e||e.type!=="TileLayer"?null:new t(e.id,e.options)};var i=t.prototype;return i.forceReload=function(){return this.fire("forcereloadstart"),this.clear(),this.load(),this.fire("forcereloadend"),this},i.getTileSize=function(){if(this._tileSize)return this._tileSize;var e=this.options.tileSize;return V(e)&&(e=[e,e]),this._tileSize=new Ae(e),this._tileSize},i.getTiles=function(e,o){return this._coordCache={},this._isPyramidMode()?this._getPyramidTiles(e,o):this._getCascadeTiles(e,o)},i._isPyramidMode=function(){var e=this.getSpatialReference();return!this._disablePyramid&&!this._hasOwnSR&&this.options.pyramidMode&&e&&e.isPyramid()},i._getTileFullExtent=function(){if(this._tileFullExtent)return this._tileFullExtent;var e=this.getSpatialReference(),o=e.getFullExtent(),a=e.getResolution(0),s=this.getMap();return this._tileFullExtent=o.convertTo(function(l){return s._prjToPointAtRes(l,a,Zn)}),this._tileFullExtent},i._getRootNodes=function(e){var o=this.getMap();if(this._rootNodes){var a=this._rootNodes,s=a.tiles,l=a.mapWidth,h=a.mapHeight;if(o.width!==l||o.height!==h){for(var u=this._getRootError(),f=0;f<s.length;f++)s[f].error=u;this._rootNodes.mapWidth=o.width,this._rootNodes.mapHeight=o.height}for(var c=0;c<s.length;c++)s[c].offset[0]=e[0],s[c].offset[1]=e[1];return this._rootNodes}var d=this.getSpatialReference(),g=d.getResolution(0),v=this._getTileConfig(),y=d.getFullExtent(),p=v.tileSystem,m=p.origin,_=p.scale,w=v.getTilePrjExtent(0,0,g),C=w.getWidth(),x=w.getHeight(),T=1e-5,P=Math.abs((m.x-y.left)/C);P=Math.ceil(P-T);var S=Math.abs((y.right-m.x)/C);S=Math.ceil(S-T);var E=Math.ceil(Math.abs(y.top-m.y)/x);E=Math.ceil(E-T);var D=Math.ceil(Math.abs(y.bottom-m.y)/x);if(D=Math.ceil(D-T),(S+P)*(D+E)>mT)return{status:0,error:"Too many root nodes"};for(var A=this._getRootError(),I=[],L=0,O=this.options.zoomOffset,H=-P;H<S;H++)for(var B=-E;B<D;B++){var R=_.y<0?B:-(B+1);I.push({x:H,y:R,z:L,idx:H,idy:R,res:g,extent2d:v.getTilePrjExtent(H,R,g).convertTo(function(b){return o._prjToPointAtRes(b,g,Zn)}),id:this._getTileId(H,R,L),url:this.getTileUrl(H,R,L+O),offset:[0,0],error:A,children:[]})}return this._rootNodes={status:1,tiles:I,mapWidth:o.width,mapHeight:o.height},this._getRootNodes(e)},i._getRootError=function(){var e=this.getMap(),o=De(e.getFov()),a=e.width/e.height,s=e.cameraPosition[2],l=s*Math.tan(.5*o),h=l*a,u=Math.sqrt(s*s+l*l+h*h),f=e._getFovZ(0),c=f*(u/s),d=this.getSpatialReference(),g=d.getResolution(0);return c*g/e.getResolution(0)},i._getPyramidTiles=function(e,o){var a=this.getMap();isNaN(+e)&&(e=this._getTileZoom(a.getZoom()));var s=this.getSpatialReference(),l=Math.min(e,this.getMaxZoom(),this.options.maxAvailableZoom||1/0),h=a.projViewMatrix,u=this._getTileFullExtent(),f=this._getTileOffset(0),c;if(this.options.repeatWorld){var d=a.getContainerExtent(),g=this._convertToExtent2d(d),v=s.getResolution(0)/a.getResolution();if(g.within(u.copy()._scale(v))){var x=this._getRootNodes(f);if(x.status!==1)return console.warn(x.error),this._disablePyramid=!0,this.getTiles(e,o);c=x.tiles.concat()}else{var y=a.getPitch(),p=a.options.cascadePitches[1],m=Math.floor(a._getVisualHeight(p)),_=y<=p?d:new ee(0,a.height-m,a.width,a.height);this._visitedTiles=new Wg;var w=this._getTiles(0,_,2,o&&o.getRenderer(),!0),C=this._getRootError();w.tiles.forEach(function(L){L.error=C}),c=w.tiles}}else{var T=this._getRootNodes(f);if(T.status!==1)return console.warn(T.error),this._disablePyramid=!0,this.getTiles(e,o);c=T.tiles.concat()}for(var P=a.getGLRes(),S={0:f},E=new ee,D=[],A=[];c.length>0;){var I=c.pop();if(I.z===l){E._combine(I.extent2d),D.push(I);continue}S[I.z+1]||(S[I.z+1]=this._getTileOffset(I.z+1)),this._splitNode(I,h,c,D,E,l,S[I.z+1],o&&o.getRenderer(),P),this.isParentTile(e,l,I)&&A.push(I)}return A.sort(TT),{tileGrids:[{extent:E,count:D.length,tiles:D,parents:A,offset:[0,0],zoom:e}],count:D.length}},i.isParentTile=function(e,o,a){var s=Math.max(this.getMinZoom(),e-this.options.tileStackStartDepth),l=Math.min(o,s+this.options.tileStackDepth);return a.z>=s&&a.z<l},i._splitNode=function(e,o,a,s,l,h,u,f,c){for(var d=this.options.zoomOffset,g=this._getTileConfig().tileSystem,v=g.scale.y,y=e.z+1,p=this.getSpatialReference(),m=e.x,_=e.y,w=e.extent2d,C=e.idx,x=e.idy,T=2,P=w.getWidth()/2*T,S=w.getHeight()/2*T,E=w.xmin*T,D=w.ymax*T,A=w.ymin*T,I=f||this.getRenderer(),L=!1,O=[],H=p.getResolution(y),B=H/c,R=0;R<4;R++){var b=R%2,N=R>>1,Z=(m<<1)+b,X=(_<<1)+N,ne=(C<<1)+b,te=(x<<1)+N;e.children||(e.children=[]);var J=e.children[R];J||(J=this._getTileId(ne,te,y),e.children[R]=J);var q=I.isTileCachedOrLoading(J),ue=void 0,me=q&&q.info;if(!me){if(this.tileInfoCache||(this.tileInfoCache=new e_(this.options.maxCacheSize*4)),me=this.tileInfoCache.get(J),!me){if(v<0){var re=E+b*P,He=D-N*S;ue=new ee(re,He-S,re+P,He)}else{var nt=E+b*P,_e=A+N*S;ue=new ee(nt,_e,nt+P,_e+S)}me={x:Z,y:X,idx:ne,idy:te,z:y,extent2d:ue,error:e.error/2,res:H,id:J,children:[],url:this.getTileUrl(Z,X,y+d),offset:u},this.tileInfoCache.add(J,me)}f&&(me.layer=this.getId())}me.error=e.error/2,me.offset[0]=u[0],me.offset[1]=u[1];var Le=this._isTileVisible(me,o,B,h,u);if(Le===1)L=!0;else{if(Le===-1)continue;if(Le===0&&y!==h){s.push(e),l._combine(e.extent2d);return}}O.push(me)}y===h?L?a.push.apply(a,O):(s.push(e),l._combine(e.extent2d)):a.push.apply(a,O)},i._isTileVisible=function(e,o,a,s,l){if(e.z===0)return 1;if(!this._isTileInFrustum(e,o,a,l))return-1;var h=this.options.maxError;M(h)&&(h=pT);var u=this._getScreenSpaceError(e,a,s,l);return u>=h?1:0},i._isTileInFrustum=function(e,o,a,s){if(!this._zScale){var l=this.getMap(),h=l.getGLRes();this._zScale=l.altitudeToPoint(100,h)/100}var u=this.getRenderer(),f=e.extent2d,c=f.xmin,d=f.ymin,g=f.xmax,v=f.ymax;Ue[0][0]=(c-s[0])*a,Ue[0][1]=(d-s[1])*a;var y=e.minAltitude||u&&u.avgMinAltitude||0;Ue[0][2]=y*this._zScale,Ue[1][0]=(g-s[0])*a,Ue[1][1]=(v-s[1])*a;var p=e.maxAltitude||u&&u.avgMaxAltitude||0;return Ue[1][2]=p*this._zScale,Wl(o,Ue)},i._getScreenSpaceError=function(e,o,a,s){var l=e.error,h=this.getMap(),u=e.extent2d,f=u.xmin,c=u.ymin,d=u.xmax,g=u.ymax;wh[0]=(f-s[0])*o,wh[1]=(c-s[1])*o,xh[0]=(d-s[0])*o,xh[1]=(g-s[1])*o;var v=PT(wh,xh,h.cameraPosition),y=Math.max(Math.abs(v),1e-7),p=Math.abs(e.z-a),m;h.height<1e3?m=1:m=p<=1?1:p<=2?.7:.605;var _=l*m/y;return _},i._getCascadeTiles=function(e,o){var a=this.getMap(),s=a.getPitch(),l=o&&o.getRenderer(),h=a.getContainerExtent(),u=[],f=0,c=this.getMinZoom(),d=a.options.cascadePitches[0],g=a.options.cascadePitches[1],v=Math.floor(a._getVisualHeight(g)),y=M(e)?this._getTileZoom(a.getZoom()):e;if(this._visitedTiles=new Wg,!M(e)||!this.options.cascadeTiles||s<=d||!M(c)&&y<=c){var p=s<=g?h:new ee(0,a.height-v,a.width,a.height),m=this._getTiles(y,p,2,l);return m&&(f+=m.tiles.length,u.push(m)),{tileGrids:u,count:f}}var _=Math.floor(a._getVisualHeight(d)),w=new ee(0,a.height-_,a.width,a.height),C=this._getTiles(y,w,0,l);f+=C?C.tiles.length:0,u.push(C);var x=w.ymin,T=a.getSpatialReference().getZoomDirection(),P=T,S;if(s>g){y-P<=c&&(P=0);var E=new ee(0,a.height-v,a.width,x);S=this._getTiles(y-P,E,1,l),f+=S?S.tiles.length:0,x=E.ymin,P+=4*T,u.push(S)}var D;if(y-P>=c){var A=new ee(0,h.ymin,a.width,x);D=this._getTiles(y-P,A,2,l),f+=D?D.tiles.length:0,u.push(D)}return S&&D&&(u[1]=D,u[2]=S),{tileGrids:u,count:f}},i.getTileUrl=function(e,o,a){var s=this.options.urlTemplate,l="";if(this.options.subdomains){var h=this.options.subdomains;if(he(h)){var u=h.length,f=(e+o)%u;f<0&&(f=0),l=h[f]}}if(oe(s))return s(e,o,a,l);var c={x:e,y:o,z:a,s:l};return this.options.token&&(c.token=this.options.token),this.options.customTags&&W(c,this.options.customTags),s.replace(yT,function(d,g){var v=c[g];if(v===void 0)throw new Error("No value provided for variable "+d);return typeof v=="function"&&(v=v(c)),v})},i.clear=function(){return this._renderer&&this._renderer.clear(),this.tileInfoCache&&this.tileInfoCache.reset(),this.fire("clear"),this},i.toJSON=function(){var e={type:this.getJSONType(),id:this.getId(),options:this.config()};return e},i.getSpatialReference=function(){var e=this.getMap();if(e&&(!this.options.spatialReference||er.equals(this.options.spatialReference,e.options.spatialReference)))return e.getSpatialReference();if(this._sr)return this._sr;var o=this.options.spatialReference;if(ie(o)&&(o=er.getPreset(o),!o))throw new Error("Unsupported spatial reference: "+this.options.spatialReference+", possible values: "+er.getAllPresets().join());return this._sr=new er(o),this._srMinZoom=this._sr.getMinZoom(),this._srMaxZoom=this._sr.getMaxZoom(),this._hasOwnSR=this._sr.toJSON().projection!==e.getSpatialReference().toJSON().projection,this._sr},i.getMinZoom=function(){var e=this.getSpatialReference();return e!==this.getMap().getSpatialReference()?Math.max(r.prototype.getMinZoom.call(this),this._srMinZoom):r.prototype.getMinZoom.call(this)},i.getMaxZoom=function(){var e=this.getSpatialReference();return e!==this.getMap().getSpatialReference()?Math.min(r.prototype.getMaxZoom.call(this),this._srMaxZoom):r.prototype.getMaxZoom.call(this)},i._getTileZoom=function(e){if(!this._hasOwnSR){var o=this.getMap().getResolution(e),a=this.getSpatialReference().getResolution(e),s=Math.log(a/o)*Math.LOG2E;e+=s}var l=this.options.maxAvailableZoom;return!M(l)&&e>l&&(e=l),$i(e)||(e=Math.round(e)),e=Math.max(0,e),e},i._getTiles=function(e,o,a,s,l){var h=this.getMap(),u=e,f=h.projViewMatrix,c=h.getResolution(e)/h.getResolution(e-1)===.5;a<2&&(a===0&&c&&(u-=1),f=a===0?h.cascadeFrustumMatrix0:a===1?h.cascadeFrustumMatrix1:h.projViewMatrix);var d=u+this.options.zoomOffset,g=this._getTileOffset(u),v=g[0]||g[1],y={zoom:u,extent:null,offset:g,tiles:[]};if(d<0||!h||!this.isVisible()||!h.width||!h.height)return y;if(!l){var p=this.getMinZoom(),m=this.getMaxZoom();if(!M(p)&&u<p||!M(m)&&u>m)return y}var _=this._getTileConfig();if(!_)return y;var w={zoom:g},C=this.getSpatialReference(),x=C.getResolution(u),T;this._hasOwnSR?T=h.getGLScale(u):T=x/h.getGLRes();var P=!this._hasOwnSR&&this.options.repeatWorld,S=this._convertToExtent2d(o),E=this._getMask2DExtent();if(E){var D=E.intersection(S);if(!D)return y;o=D.convertTo(function(xi){return h._pointToContainerPoint(xi,void 0,0,Zn)})}var A=h._containerPointToPrj(o.getCenter(),wT),I=h._prjToPoint(A,u,La),L;v?L=this._project(h._pointToPrj(I._add(g),u,La),La):L=this._project(A,La);var O=h.getGLScale()/h.getGLScale(u);Un.x=S.xmin*O,Un.y=S.ymax*O,Er.x=S.xmax*O,Er.y=S.ymin*O;for(var H=this._project(h._pointToPrj(Un._add(g),u,Un),Un),B=this._project(h._pointToPrj(Er._add(g),u,Er),Er),R=_.getTileIndex(L,x,P),b=_.getTileIndex(H,x,P),N=_.getTileIndex(B,x,P),Z=Math.ceil(Math.abs(R.idy-b.idy)),X=Math.ceil(Math.abs(R.idx-b.idx)),ne=Math.ceil(Math.abs(R.idy-N.idy)),te=Math.ceil(Math.abs(R.idx-N.idx)),J=(Z+ne+1)*(X+te+1),q=this.getTileSize(),ue=this.getRenderer()||s,me=this._getTileConfig().tileSystem.scale,re=[],He=new ee,nt=new k(0,0),_e=-Z;_e<=ne;_e++)for(var Le=-X,Tt=-1/0,ar=!1;Le>=Tt&&Le<=te;){var fe=_.getNeighorTileIndex(R.idx,R.idy,Le,_e,x,P);Tt===-1/0?Le++:Le--;var Pr=this._getTileId(fe.idx,fe.idy,u);if(!(fe.out||this._visitedTiles&&this._visitedTiles.has(Pr))){var ht=ue&&ue.isTileCachedOrLoading(Pr);ht&&(ht=ht.info);var Jt=void 0;if(ht){var Oy=ht,gc=Oy.extent2d;nt.set(gc.xmin,gc.ymax),Jt=nt}else if(!this._hasOwnSR)Jt=_.getTilePointNW(fe.x,fe.y,x);else{var Ly=_.getTilePrjNW(fe.x,fe.y,x);Jt=h._prjToPoint(this._unproject(Ly,Er),u)}var $o=void 0,Xo=void 0;if(!this._hasOwnSR)$o=q.width,Xo=q.height;else{var Jo=void 0;if(!this._hasOwnSR)Jo=_.getTilePointSE(fe.x,fe.y,x);else{var Dy=_.getTilePrjSE(fe.x,fe.y,x);Jo=h._prjToPoint(this._unproject(Dy,Er),u,Er)}$o=Math.ceil(Math.abs(Jo.x-Jt.x)),Xo=Math.ceil(Math.abs(Jo.y-Jt.y))}var cl=me.x*(fe.idx-fe.x)*$o,dl=me.y*(fe.idy-fe.y)*Xo;!ht&&(cl||dl)&&Jt._add(cl,dl);var kn=ht&&ht.extent2d||new ee(Jt.x,Jt.y-Xo,Jt.x+$o,Jt.y);if(J<=4||ar||this._isTileInExtent(f,kn,g,T)){var vc=this._hasOwnSR?h._getResolution(u):x;this._visitedTiles&&a===0&&this._visitedTiles.add(Pr),c&&a===0?(this._splitTiles(f,re,ue,fe,u+1,vc,kn,cl,dl,w,s),He._combine(kn)):(ht?(ht.offset[0]=g[0],ht.offset[1]=g[1]):(ht={z:u,x:fe.x,y:fe.y,idx:fe.idx,idy:fe.idy,extent2d:kn,offset:g,id:Pr,res:vc,url:this.getTileUrl(fe.x,fe.y,d)},s&&(ht.layer=this.getId())),re.push(ht),He._combine(kn)),Tt===-1/0?(Tt=Le,Le=te):ar||(ar=!0)}}}if(re.length){var pc=h._containerPointToPoint(o.getCenter(),u,Zn)._add(g),mc=new k(0,0),_c=new k(0,0);re.sort(function(xi,Yo){return mc.set((xi.extent2d.xmin+xi.extent2d.xmax)/2,(xi.extent2d.ymin+xi.extent2d.ymax)/2),_c.set((Yo.extent2d.xmin+Yo.extent2d.xmax)/2,(Yo.extent2d.ymin+Yo.extent2d.ymax)/2),mc.distanceTo(pc)-_c.distanceTo(pc)})}return{offset:g,zoom:e,extent:He,tiles:re}},i._convertToExtent2d=function(e){var o=this,a=this.getMap();return e.convertTo(function(s){var l;if(s.y>0&&s.y<a.height){var h=(s.x===0?0:1)+s.y;o._coordCache[h]||(o._coordCache[h]=a._containerPointToPoint(s)),l=o._coordCache[h]}return l=a._containerPointToPoint(s,void 0,Zn),l})},i._splitTiles=function(e,o,a,s,l,h,u,f,c,d,g){var v=this._getTileConfig().tileSystem.scale.y,y=this.getMap().getGLScale(l),p=xT.set(u.xmin*2,v<0?u.ymax*2:u.ymin*2),m=u.getWidth(),_=u.getHeight(),w=s.idx*2,C=s.idy*2,x=s.x*2,T=s.y*2,P=this._checkAndAddTile(e,a,w,C,x,T,l,h,0,0,m,_,p,y,d,g);P&&o.push(P),P=this._checkAndAddTile(e,a,w,C,x,T,l,h,0,1,m,_,p,y,d,g),P&&o.push(P),P=this._checkAndAddTile(e,a,w,C,x,T,l,h,1,0,m,_,p,y,d,g),P&&o.push(P),P=this._checkAndAddTile(e,a,w,C,x,T,l,h,1,1,m,_,p,y,d,g),P&&o.push(P)},i._checkAndAddTile=function(e,o,a,s,l,h,u,f,c,d,g,v,y,p,m,_){var w=this._getTileId(a+c,s+d,u);if(this._visitedTiles&&this._visitedTiles.has(w))return null;var C=m[u];C||(C=m[u]=this._getTileOffset(u));var x=this._getTileConfig().tileSystem.scale.y,T=new ee(y.x+c*g,y.y+x*d*v,y.x+(c+1)*g,y.y+x*(d+1)*v);if(!this._isSplittedTileInExtent(e,T,C,p))return null;var P=f/2,S=o&&o.isTileCachedOrLoading(w);return S?S=S.info:(S={z:u,x:l+c,y:h+d,extent2d:T,id:w,offset:C,res:P,url:this.getTileUrl(l+c,h+d,u+this.options.zoomOffset)},_&&(S.layer=this.getId())),S},i._getTileOffset=function(e){var o=this.options.offset;return oe(o)&&(o=o.call(this,e)),V(o)&&(o=[o,o]),o||[0,0]},i._getTileId=function(e,o,a,s){return(s||this.getId())+"_"+e+"_"+o+"_"+a},i._project=function(e,o){if(this._hasOwnSR){var a=this.getMap(),s=a.getProjection(),l=this.getSpatialReference().getProjection();return l.project(s.unproject(e,o),o)}else return e},i._unproject=function(e,o){if(this._hasOwnSR){var a=this.getMap(),s=this.getSpatialReference(),l=a.getProjection(),h=s.getProjection();return l.project(h.unproject(e,o),o)}else return e},i._initTileConfig=function(){var e=this.getMap(),o=this.getTileSize(),a=this.getSpatialReference(),s=a.getProjection(),l=a.getFullExtent();this._defaultTileConfig=new Gg(e,zr.getDefault(s),l,o),this.options.hasOwnProperty("tileSystem")&&(this._tileConfig=new Gg(e,this.options.tileSystem,l,o)),delete this._rootNodes,delete this._tileFullExtent,delete this._disablePyramid},i._getTileConfig=function(){return this._defaultTileConfig||this._initTileConfig(),this._tileConfig||this._defaultTileConfig},i._bindMap=function(e){var o=e.getBaseLayer();return o===this&&(o.options.hasOwnProperty("forceRenderOnMoving")||this.config({forceRenderOnMoving:!0})),this._onSpatialReferenceChange(),r.prototype._bindMap.apply(this,arguments)},i._isTileInExtent=function(e,o,a,s){var l=this.getMap(),h;if(e!==l.projViewMatrix){var u=o.getCenter(CT)._sub(a[0],a[1])._multi(s);kt(Ch,u.x,u.y,0);var f=OP(Ch,Ch,l.projViewMatrix);h=f[1]<0?l.projViewMatrix:e}else h=l.projViewMatrix;return Ue[0][0]=(o.xmin-a[0])*s,Ue[0][1]=(o.ymin-a[1])*s,Ue[1][0]=(o.xmax-a[0])*s,Ue[1][1]=(o.ymax-a[1])*s,Wl(h,Ue)},i._isSplittedTileInExtent=function(e,o,a,s){var l=this.getMap();return Ue[0][0]=(o.xmin-a[0])*s,Ue[0][1]=(o.ymin-a[1])*s,Ue[1][0]=(o.xmax-a[0])*s,Ue[1][1]=(o.ymax-a[1])*s,Wl(l.projViewMatrix,Ue)},i.getEvents=function(){return{spatialreferencechange:this._onSpatialReferenceChange}},i._onSpatialReferenceChange=function(){delete this._tileConfig,delete this._defaultTileConfig,delete this._sr,delete this._srMinZoom,delete this._hasOwnSR,delete this._rootNodes,this.tileInfoCache&&this.tileInfoCache.reset();var e=this.getRenderer();e&&e.clear()},i.getPolygonOffsetCount=function(){return 2},i.getPolygonOffset=function(){return this._polygonOffset||0},i.setPolygonOffset=function(e){return this._polygonOffset=e,this},t}(it);Lt.registerJSONType("TileLayer");Lt.mergeOptions(_T);function PT(r,t,i){var n=Math.max(r[0]-i[0],0,i[0]-t[0]),e=Math.max(r[1]-i[1],0,i[1]-t[1]),o=Math.max(r[2]-i[2],0,i[2]-t[2]);return Math.sqrt(n*n+e*e+o*o)}function TT(r,t){return r.z-t.z}var ST={maxCacheSize:1024},MT=new Ae(256,256),Ai="show hide remove setzindex forcereloadstart";function Vg(r){return Array.isArray(r)||(r=[r]),r}var _y=function(r){F(t,r),t.fromJSON=function(e){if(!e||e.type!=="GroupTileLayer")return null;var o=e.layers.map(function(a){return it.fromJSON(a)});return new t(e.id,o,e.options)};function t(n,e,o){var a;return a=r.call(this,n,o)||this,a.layers=e||[],a._checkChildren(),a.layerMap={},a._groupChildren=[],a}var i=t.prototype;return i.getLayers=function(){return this.layers},i.addLayer=function(e){var o=this;e===void 0&&(e=[]),e=Vg(e);var a=this.layers.length;return e.forEach(function(s){s instanceof Lt&&o.layers.indexOf(s)===-1&&!o.layerMap[s.getId()]&&o.layers.push(s)}),a!==this.layers.length&&(this._sortLayers(),this._refresh(),this._renderLayers()),this},i.removeLayer=function(e){var o=this;e===void 0&&(e=[]),e=Vg(e);var a=this.layers.length;return e.forEach(function(s){if(s instanceof Lt||(s=o.layerMap[s]),s instanceof Lt){var l=o.layers.indexOf(s);l>=0&&(o.layers.splice(l,1),s._doRemove(),s.off(Ai,o._onLayerShowHide,o))}}),a!==this.layers.length&&(this._refresh(),this._renderLayers()),this},i.clearLayers=function(){var e=this;return this.layers.forEach(function(o){o._doRemove(),o.off(Ai,e._onLayerShowHide,e)}),this.layers=[],this._refresh(),this._renderLayers(),this},i.toJSON=function(){var e={type:this.getJSONType(),id:this.getId(),layers:this.layers.map(function(o){return o.toJSON()}),options:this.config()};return e},i.getTileSize=function(e){var o=this.getLayer(e);return o?o.getTileSize():MT},i.getTiles=function(e,o){for(var a=this.layers,s=[],l=0,h=0,u=a.length;h<u;h++){var f=a[h];if(!(!f||!f.options.visible||!f.isVisible()||!f.getMap())){var c=f.getTiles(e,o||this);!c||c.count===0||(l+=c.count,pi(s,c.tileGrids))}}return{count:l,tileGrids:s}},i.onAdd=function(){this._sortLayers(),this._refresh(),r.prototype.onAdd.call(this)},i.onRemove=function(){var e=this;this.layers.forEach(function(o){o._doRemove(),o.off(Ai,e._onLayerShowHide,e)}),this.layerMap={},this._groupChildren=[],r.prototype.onRemove.call(this)},i.getLayer=function(e){return this.getChildLayer(e)},i.getChildLayer=function(e){var o=this.layerMap[e];if(o)return o;for(var a=0;a<this._groupChildren.length;a++){var s=this._groupChildren[a].getChildLayer(e);if(s)return s}return null},i._removeChildTileCache=function(e){if(!e)return this;var o=this.getRenderer();if(!o)return this;var a,s=e.getId(),l=function(){return a&&a.info&&a.info.layer===s};if(o.tileCache){var h=o.tileCache.keys();h.forEach(function(g){a=o.tileCache.get(g),l()&&o.tileCache.remove(g)})}var u=o.tilesInView||{};for(var f in u)a=u[f],l()&&delete u[f];var c=o.tilesLoading||{};for(var d in c)a=c[d],l()&&o.abortTileLoading(a.image,a.info);return this},i._onLayerShowHide=function(e){var o=e||{},a=o.type,s=o.target;return a==="remove"&&s?(this.layers.splice(this.layers.indexOf(s),1),s._doRemove(),s.off(Ai,this._onLayerShowHide,this),this._refresh()):a==="setzindex"?this._sortLayers():a==="forcereloadstart"&&this._removeChildTileCache(s),this._renderLayers(),this},i._renderLayers=function(){var e=this.getRenderer();return e&&e.setToRedraw(),this},i._refresh=function(){var e=this,o=this.getMap();return this._groupChildren=[],this.layerMap={},this.layers.forEach(function(a){e.layerMap[a.getId()]=a,a.getChildLayer&&e._groupChildren.push(a),a.getMap()||a._bindMap(o),a.off(Ai,e._onLayerShowHide,e),a.on(Ai,e._onLayerShowHide,e)}),this},i.isVisible=function(){if(!r.prototype.isVisible.call(this))return!1;for(var e=this.layers,o=0,a=e.length;o<a;o++)if(e[o].isVisible())return!0;return!1},i._checkChildren=function(){var e=this,o={};this.layers.forEach(function(a){var s=a.getId();if(o[s])throw new Error("Duplicate child layer id ("+s+") in the GroupTileLayer ("+e.getId()+")");o[s]=1})},i._sortLayers=function(){this.layers.sort(function(e,o){return e.options.zIndex-o.options.zIndex})},t}(Lt);_y.registerJSONType("GroupTileLayer");_y.mergeOptions(ST);var yy={crs:null,uppercase:!1,detectRetina:!1},ET={service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},Ph,lc=function(r){F(t,r);function t(n,e){var o;return o=r.call(this,n)||this,Ph||(Ph=W({},o.options)),o.wmsParams=W({},ET),o.setOptions(e),o.setZIndex(e.zIndex),K.proxy||o._optionsHook(e),o}var i=t.prototype;return i._optionsHook=function(e){e===void 0&&(e={});for(var o in e)o==="tileSize"&&(this._tileSize=null),o in Ph||(this.wmsParams[o]=e[o]);var a=this.getTileSize();return this.wmsParams.width=a.width,this.wmsParams.height=a.height,this._wmsVersion=parseFloat(this.wmsParams.version),this},i.onAdd=function(){var e=this.getMap().getDevicePixelRatio(),o=yy.detectRetina?e:1;this.wmsParams.width*=o,this.wmsParams.height*=o;var a=this.options.crs||this.getMap().getProjection().code,s=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[s]=a,r.prototype.onAdd.call(this)},i.getTileUrl=function(e,o,a){var s=this.getSpatialReference().getResolution(a),l=this._getTileConfig(),h=l.getTilePrjExtent(e,o,s),u=h.getMax(),f=h.getMin(),c=(this._wmsVersion>=1.3&&(this.wmsParams.crs==="EPSG:4326"||this.wmsParams.crs==="EPSG:4490")?[f.y,f.x,u.y,u.x]:[f.x,f.y,u.x,u.y]).join(","),d=r.prototype.getTileUrl.call(this,e,o,a);return d+kT(this.wmsParams,d,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+c},i.toJSON=function(){return{type:"WMSTileLayer",id:this.getId(),options:this.config()}},t.fromJSON=function(e){return!e||e.type!=="WMSTileLayer"?null:new t(e.id,e.options)},t}(Lt);lc.registerJSONType("WMSTileLayer");lc.mergeOptions(yy);function kT(r,t,i){var n=[];for(var e in r)n.push(encodeURIComponent(i?e.toUpperCase():e)+"="+encodeURIComponent(r[e]));return(!t||t.indexOf("?")===-1?"?":"&")+n.join("&")}var hc=function(r){F(t,r);function t(n,e){var o;return o=r.call(this,n,e)||this,o.options.hasOwnProperty("forceRenderOnMoving")||(o.options.forceRenderOnMoving=!1),o}var i=t.prototype;return i.drawTile=function(){},i.toJSON=function(){return{type:"CanvasTileLayer",id:this.getId(),options:this.config()}},t.fromJSON=function(e){return!e||e.type!=="CanvasTileLayer"?null:new t(e.id,e.options)},t}(Lt);hc.registerJSONType("CanvasTileLayer");function RT(r,t){for(var i={alpha:!0,stencil:!0,preserveDrawingBuffer:!0,antialias:!1},n=["webgl","experimental-webgl"],e=null,o=0;o<n.length;++o){try{e=r.getContext(n[o],t||i)}catch{}if(e)break}return e}function Zg(r,t,i){var n=r.createShader(t);r.shaderSource(n,i),r.compileShader(n);var e=r.getShaderParameter(n,r.COMPILE_STATUS);if(!e){var o=r.getShaderInfoLog(n);throw r.deleteShader(n),new Error("Failed to compile shader: "+o)}return n}function wy(r,t,i){var n=Zg(r,r.VERTEX_SHADER,t),e=Zg(r,r.FRAGMENT_SHADER,i);if(!n||!e)return null;var o=r.createProgram();return o?(r.attachShader(o,n),r.attachShader(o,e),r.linkProgram(o),{program:o,vertexShader:n,fragmentShader:e}):null}function xy(r,t,i){if(Array.isArray(i[0])){for(var n=Float32Array.BYTES_PER_ELEMENT,e=0,o=0;o<i.length;o++)e+=i[o][1]||0;for(var a=0,s=0;s<i.length;s++){var l=r.getAttribLocation(t,i[s][0]);if(l<0)throw new Error("Failed to get the storage location of "+i[s][0]);r.vertexAttribPointer(l,i[s][1],r[i[s][2]||"FLOAT"],!1,n*e,n*a),a+=i[s][1]||0,r.enableVertexAttribArray(l)}}else{var h=r.getAttribLocation(t,i[0]);r.vertexAttribPointer(h,i[1],r[i[2]||"FLOAT"],!1,0,0),r.enableVertexAttribArray(h)}}var AT={never:512,"<":513,"=":514,"<=":515,">":516,"!=":517,">=":518,always:519};function OT(r){return AT[r]}var Ug=[1,1,1,1],$g={vertexShader:`
        attribute vec2 a_position;

        attribute vec2 a_texCoord;

        uniform mat4 u_matrix;

        varying vec2 v_texCoord;

        void main() {
            gl_Position = u_matrix * vec4(a_position, 0., 1.);

            v_texCoord = a_texCoord;
        }
    `,fragmentShader:`
        precision mediump float;

        uniform sampler2D u_image;

        uniform float u_opacity;
        uniform float u_debug_line;
        uniform vec4 u_base_color;
        uniform float u_alpha_test;
        varying vec2 v_texCoord;

        void main() {
            if (u_debug_line == 1.) {
                gl_FragColor = vec4(0., 1., 0., 1.);
            } else {
                gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
            }
            gl_FragColor *= u_base_color;
            if (gl_FragColor.a < u_alpha_test) {
                discard;
            }
        }
    `},Da=[0,0],$n=[0,0,0],LT=new Array(16),DT=new k(20,20),Cy=function(t){var i=function(n){F(e,n);function e(){return n.apply(this,arguments)||this}var o=e.prototype;return o.drawGLImage=function(s,l,h,u,f,c,d,g,v){this.gl.program!==this.program&&this.useProgram(this.program);var y=this.gl;this.loadTexture(s);var p=this.canvas.gl&&this.canvas.gl.wrap;if(p){var m=this.layer&&this.layer.options.opacity;M(m)&&(m=1),d*=m}$n[0]=l||0,$n[1]=h||0,$n[2]=0;var _=this.layer;if(_){var w=_.options.altitude,C=V(w);if(C||(this._layerAlt=0),this._layerAltitude!==w&&C){var x=_.getMap();if(x){var T=x.altitudeToPoint(w,x.getGLRes());this._layerAltitude=w,this._layerAlt=T}}}$n[2]=this._layerAlt||0;var P=ac(LT);ty(P,P,$n),Nu(P,P,[c,c,1]),oo(P,this.getMap().projViewMatrix,P),y.uniformMatrix4fv(this.program.u_matrix,!1,P),y.uniform1f(this.program.u_opacity,d),y.uniform1f(this.program.u_debug_line,0),y.uniform4fv(this.program.u_base_color,v||Ug),y.uniform1f(this.program.u_alpha_test,this.layer.options.alphaTest||0);var S=s.glBuffer;S&&(S.width!==u||S.height!==f)&&(this.saveImageBuffer(S),delete s.glBuffer),s.glBuffer?y.bindBuffer(y.ARRAY_BUFFER,S):s.glBuffer=this.bufferTileData(0,0,u,f),Da[0]="a_position",Da[1]=2,Da[2]=s.glBuffer.type,this.enableVertexAttrib(Da),y.drawArrays(y.TRIANGLE_STRIP,0,4),g&&this.drawDebug(P,0,0,u,f,g)},o.drawDebug=function(s,l,h,u,f,c){var d=this.gl;d.disable(d.DEPTH_TEST),d.bindBuffer(d.ARRAY_BUFFER,this._debugBuffer),this.enableVertexAttrib(["a_position",2,"FLOAT"]),d.bufferData(d.ARRAY_BUFFER,new Float32Array([l,h,l+u,h,l+u,h-f,l,h-f,l,h]),d.DYNAMIC_DRAW),d.uniformMatrix4fv(this.program.u_matrix,!1,s),d.uniform1f(this.program.u_opacity,1),d.uniform1f(this.program.u_debug_line,1),d.uniform4fv(this.program.u_base_color,Ug),d.uniform1f(this.program.u_alpha_test,this.layer.options.alphaTest||0),d.drawArrays(d.LINE_STRIP,0,5);var g=this._debugInfoCanvas;if(!g){var v=this.getMap().getDevicePixelRatio()>1?2:1;g=this._debugInfoCanvas=document.createElement("canvas"),g.width=256*v,g.height=32*v;var y=g.getContext("2d");y.font="20px monospace",y.scale(v,v)}var p=g.getContext("2d");p.clearRect(0,0,g.width,g.height);var m=this.layer.options.debugOutline;j.fillText(p,c,DT,m),this.loadTexture(g),d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,g),u=256;var _=l,w=l+u,C=h-f+32,x=h-f;d.bufferData(d.ARRAY_BUFFER,this.set8(_,C,_,x,w,C,w,x),d.DYNAMIC_DRAW),d.uniform1f(this.program.u_debug_line,0),d.drawArrays(d.TRIANGLE_STRIP,0,4),d.enable(d.DEPTH_TEST)},o.bufferTileData=function(s,l,h,u,f){var c=s,d=s+h,g=l,v=l-u,y;$i(c)&&$i(d)&&$i(g)&&$i(v)?y=this.set8Int(c,g,c,v,d,g,d,v):y=this.set8(c,g,c,v,d,g,d,v);var p=this.loadImageBuffer(y,f);return p.width=h,p.height=u,p.type=y instanceof Int16Array?"SHORT":"FLOAT",p},o.drawTinImage=function(s,l,h,u,f){var c=this.gl;this.loadTexture(s),c.uniformMatrix4fv(this.program.u_matrix,!1,this.getMap().projViewMatrix),c.uniform1f(this.program.u_opacity,f),c.bindBuffer(c.ARRAY_BUFFER,this.posBuffer),this.enableVertexAttrib(["a_position",3]),c.bufferData(c.ARRAY_BUFFER,new Float32Array(l),c.DYNAMIC_DRAW),c.bindBuffer(c.ARRAY_BUFFER,this.texBuffer),this.enableVertexAttrib(["a_texCoord",2]),c.bufferData(c.ARRAY_BUFFER,new Float32Array(h),c.DYNAMIC_DRAW),c.bufferData(c.ELEMENT_ARRAY_BUFFER,new Uint16Array(u),c.DYNAMIC_DRAW),c.drawElements(c.TRIANGLES,u.length,c.UNSIGNED_SHORT,0)},o.createCanvas2=function(){this.canvas2=j.createCanvas(this.canvas.width,this.canvas.height)},o.createGLContext=function(){this.canvas.gl&&this.canvas.gl.wrap?this.gl=this.canvas.gl.wrap():this.gl=RT(this.canvas2||this.canvas,this.layer.options.glOptions);var s=this.gl;s.clearColor(0,0,0,0),s.enable(s.DEPTH_TEST),s.enable(s.STENCIL_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),this.program=this.createProgram($g.vertexShader,this.layer.options.fragmentShader||$g.fragmentShader),this._debugBuffer=this.createBuffer(),this.useProgram(this.program),this.texBuffer=this.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,this.texBuffer),this.enableVertexAttrib(["a_texCoord",2,"UNSIGNED_BYTE"]),s.bufferData(s.ARRAY_BUFFER,new Uint8Array([0,0,0,1,1,0,1,1]),s.STATIC_DRAW),this.enableSampler("u_image"),s.activeTexture(s.TEXTURE0),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0)},o.resizeGLCanvas=function(){this.gl&&this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.canvas2&&(this.canvas2.width!==this.canvas.width||this.canvas2.height!==this.canvas.height)&&(this.canvas2.width=this.canvas.width,this.canvas2.height=this.canvas.height)},o.clearGLCanvas=function(){this.gl&&(this.gl.clearStencil(255),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT)),this.gl.wrap||this.gl.clear(this.gl.DEPTH_BUFFER_BIT)},o.disposeImage=function(s){s&&(s.texture&&this.saveTexture(s.texture),s.glBuffer&&this.saveImageBuffer(s.glBuffer),delete s.texture,delete s.glBuffer)},o._createTexture=function(s){var l=this.gl,h=this.getTexture()||l.createTexture();return l.bindTexture(l.TEXTURE_2D,h),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),(!Xi(s.width)||!Xi(s.height))&&(s=bT(s)),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,s),l.generateMipmap(l.TEXTURE_2D),h},o.getTexture=function(){this._textures||(this._textures=[]);var s=this._textures;return s&&s.length>0?s.pop():null},o.saveTexture=function(s){this._textures.push(s)},o.loadTexture=function(s){var l=this.getMap(),h=this.gl,u=s.texture;return u||(u=this._createTexture(s),s.texture=u),h.bindTexture(h.TEXTURE_2D,u),l.getRenderer().isViewChanged()?h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR_MIPMAP_LINEAR):h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),u},o.getImageBuffer=function(){this._imageBuffers||(this._imageBuffers=[]);var s=this._imageBuffers;return s&&s.length>0?s.pop():null},o.saveImageBuffer=function(s){this._imageBuffers||(this._imageBuffers=[]),this._imageBuffers.push(s)},o.loadImageBuffer=function(s,l){var h=this.gl,u=l||this.createImageBuffer();return h.bindBuffer(h.ARRAY_BUFFER,u),h.bufferData(h.ARRAY_BUFFER,s,h.STATIC_DRAW),u},o.createImageBuffer=function(){return this.getImageBuffer()||this.createBuffer()},o.removeGLCanvas=function(){var s=this.gl;if(s){if(this._debugBuffer&&(s.deleteBuffer(this._debugBuffer),delete this._debugBuffer),this._buffers&&(this._buffers.forEach(function(u){s.deleteBuffer(u)}),delete this._buffers),this._textures&&(this._textures.forEach(function(u){return s.deleteTexture(u)}),delete this._textures),this._debugInfoCanvas){var l=this._debugInfoCanvas.texture;l&&s.deleteTexture(l),delete this._debugInfoCanvas.texture,delete this._debugInfoCanvas}var h=s.program;s.deleteShader(h.fragmentShader),s.deleteShader(h.vertexShader),s.deleteProgram(h),delete this.gl,delete this.canvas2}},o.createBuffer=function(){var s=this.gl,l=s.createBuffer();if(!l)throw new Error("Failed to create the buffer object");return this._buffers||(this._buffers=[]),this._buffers.push(l),l},o.enableVertexAttrib=function(s){xy(this.gl,this.gl.program,s)},o.createProgram=function(s,l){for(var h=this.gl,u=wy(h,s,l),f=u.program,c=u.vertexShader,d=u.fragmentShader,g=h.getProgramParameter(f,35718),v=[],y=0;y<g;++y){var p=h.getActiveUniform(f,y);v.push(p.name)}return f.vertexShader=c,f.fragmentShader=d,this._initUniforms(f,v),f},o.useProgram=function(s){var l=this.gl;return l.useProgram(s),l.program=s,this},o.enableSampler=function(s,l){var h=this.gl,u=this._getUniform(h.program,s);return l||(l=0),h.uniform1i(u,l),u},o._initUniforms=function(s,l){for(var h=0;h<l.length;h++){var u=l[h],f=l[h],c=u.indexOf("[");c>=0&&(u=u.substring(0,c),Fe||(f=f.substring(0,c))),s[u]=this._getUniform(s,f)}},o._getUniform=function(s,l){var h=this.gl,u=h.getUniformLocation(s,l);if(!u)throw new Error("Failed to get the storage location of "+l);return u},e}(t);return W(i.prototype,{set8:function(){var n=K.ie9?null:new Float32Array(8);return function(e,o,a,s,l,h,u,f){return n[0]=e,n[1]=o,n[2]=a,n[3]=s,n[4]=l,n[5]=h,n[6]=u,n[7]=f,n}}(),set8Int:function(){var n=K.ie9?null:new Int16Array(8);return function(e,o,a,s,l,h,u,f){return n[0]=e,n[1]=o,n[2]=a,n[3]=s,n[4]=l,n[5]=h,n[6]=u,n[7]=f,n}}()}),i};function bT(r){if(Xi(r.width)&&Xi(r.height))return r;var t=r.width,i=r.height;Xi(t)||(t=Xg(t)),Xi(i)||(i=Xg(i));var n=document.createElement("canvas");return n.width=t,n.height=i,n.getContext("2d").drawImage(r,0,0,t,i),n}function Xi(r){return(r&r-1)===0&&r!==0}function Xg(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}var IT={renderer:K.webgl?"gl":"canvas",crossOrigin:null,alphaTest:0,depthMask:!0,depthFunc:"<="},zT=new k(0,0),uc=function(r){F(t,r);function t(n,e,o){var a;return e&&!Array.isArray(e)&&!e.url&&(o=e,e=null),a=r.call(this,n,o)||this,a._images=e,a}var i=t.prototype;return i.onAdd=function(){this._prepareImages(this._images)},i.setImages=function(e){return this._images=e,this._prepareImages(e),this},i.getImages=function(){return this._images},i._prepareImages=function(e){e=e||[],Array.isArray(e)||(e=[e]);var o=this.getMap(),a=o.getGLRes();this._imageData=e.map(function(l){var h=new ge(l.extent);return W({},l,{extent:h,extent2d:h.convertTo(function(u){return o.coordToPointAtRes(u,a)})})}),this._images=e;var s=this.getRenderer();s&&s.refreshImages()},t}(it);uc.mergeOptions(IT);var jT=[],Py=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.isDrawable=function(){return this.getMap().getPitch()?(console&&console.warn("ImageLayer with canvas renderer can't be pitched, use gl renderer ('renderer' : 'gl') instead."),!1):!0},i.checkResources=function(){var e=this;if(this._imageLoaded)return jT;var o=this.layer,a=o._imageData.map(function(h){return[h.url,null,null]});if(this.resources){var s=[],l=new wn;a.forEach(function(h){if(e.resources.isResourceLoaded(h)){var u=e.resources.getImage(h);l.addResource(h,u)}else s.push(h)}),this.resources.forEach(function(h,u){l.isResourceLoaded(h)||e.retireImage(u.image)}),this.resources=l,a=s}return this._imageLoaded=!0,a},i.retireImage=function(e){e.close&&e.close()},i.refreshImages=function(){this._imageLoaded=!1,this.setToRedraw()},i.draw=function(e,o){this.isDrawable()&&(this.prepareCanvas(),this._painted=!1,this._drawImages(e,o),this.completeRender())},i._drawImages=function(){var e=this.layer._imageData,o=this.getMap(),a=o._get2DExtentAtRes(o.getGLRes());if(e&&e.length)for(var s=0;s<e.length;s++){var l=e[s].extent2d,h=this.resources&&this.resources.getImage(e[s].url);h&&a.intersects(l)&&(this._painted=!0,this._drawImage(h,l,e[s].opacity||1))}},i._drawImage=function(e,o,a){var s=0,l=this.context;a<1&&(s=l.globalAlpha,l.globalAlpha=a);var h=this.getMap(),u=zT.set(o.xmin,o.ymax),f=h._pointAtResToContainerPoint(u,h.getGLRes()),c=f.x,d=f.y,g=h.getBearing();g&&(l.save(),l.translate(c,d),g&&l.rotate(-g*Math.PI/180),c=d=0);var v=h.getGLScale();l.drawImage(e,c,d,o.getWidth()/v,o.getHeight()/v),g&&l.restore(),s&&(l.globalAlpha=s)},i.drawOnInteracting=function(){this.draw()},t}(Vo),NT=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.drawOnInteracting=function(e,o,a){this.draw(o,a)},i._prepareGLContext=function(){var e=this.gl;if(e){e.disable(e.STENCIL_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.enable(e.DEPTH_TEST),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.depthFunc(OT(this.layer.options.depthFunc));var o=M(this.layer.options.depthMask)||!!this.layer.options.depthMask;e.depthMask(o)}},i._drawImages=function(e,o){var a=this.gl;if(o&&o.renderTarget){var s=o.renderTarget.fbo;if(s){var l=o.renderTarget.getFramebuffer(s);a.bindFramebuffer(a.FRAMEBUFFER,l)}}if(this._prepareGLContext(),r.prototype._drawImages.call(this),o&&o.renderTarget){var h=o.renderTarget.fbo;h&&a.bindFramebuffer(a.FRAMEBUFFER,null)}},i.isDrawable=function(){return!0},i._drawImage=function(e,o,a){this.drawGLImage(e,o.xmin,o.ymax,o.getWidth(),o.getHeight(),1,a)},i.createContext=function(){this.createGLContext()},i.resizeCanvas=function(e){this.canvas&&(r.prototype.resizeCanvas.call(this,e),this.resizeGLCanvas())},i.clearCanvas=function(){this.canvas&&(r.prototype.clearCanvas.call(this),this.clearGLCanvas())},i.retireImage=function(e){e.close&&e.close(),this.disposeImage(e)},i.onRemove=function(){this.removeGLCanvas(),r.prototype.onRemove.call(this)},t}(Cy(Py));uc.registerRenderer("canvas",Py);uc.registerRenderer("gl",NT);var Ty=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.getPrepareParams=function(){return[]},i.getDrawParams=function(){return[]},i.onCanvasCreate=function(){this.canvas&&this.layer.options.doubleBuffer&&(this.buffer=j.createCanvas(this.canvas.width,this.canvas.height,this.getMap().CanvasClass))},i.needToRedraw=function(){if(this.layer.options.animation)return!0;var e=this.getMap();return e.isInteracting()&&!this.layer.drawOnInteracting?!1:r.prototype.needToRedraw.call(this)},i.draw=function(){this.prepareCanvas(),this.prepareDrawContext(),this._drawLayer.apply(this,arguments)},i.drawOnInteracting=function(){this._drawLayerOnInteracting.apply(this,arguments)},i.getCanvasImage=function(){var e=r.prototype.getCanvasImage.call(this);if(e&&e.image&&this.layer.options.doubleBuffer){var o=e.image;(this.buffer.width!==o.width||this.buffer.height!==o.height)&&(this.buffer.width=o.width,this.buffer.height=o.height);var a=this.buffer.getContext("2d"),s=this.layer.doubleBuffer(a,this.context);(s===void 0||s)&&(j.image(a,o,0,0),e.image=this.buffer)}return e},i.remove=function(){return delete this._drawContext,r.prototype.remove.call(this)},i.onZoomStart=function(e){this.layer.onZoomStart(e),r.prototype.onZoomStart.call(this,e)},i.onZooming=function(e){this.layer.onZooming(e),r.prototype.onZooming.call(this,e)},i.onZoomEnd=function(e){this.layer.onZoomEnd(e),r.prototype.onZoomEnd.call(this,e)},i.onMoveStart=function(e){this.layer.onMoveStart(e),r.prototype.onMoveStart.call(this,e)},i.onMoving=function(e){this.layer.onMoving(e),r.prototype.onMoving.call(this,e)},i.onMoveEnd=function(e){this.layer.onMoveEnd(e),r.prototype.onMoveEnd.call(this,e)},i.onResize=function(e){this.layer.onResize(e),r.prototype.onResize.call(this,e)},i.prepareDrawContext=function(){if(!this._predrawed){var e=Jg(this.getPrepareParams());this._drawContext=this.layer.prepareToDraw.apply(this.layer,[this.context].concat(e)),this._drawContext||(this._drawContext=[]),Array.isArray(this._drawContext)||(this._drawContext=[this._drawContext]),this._predrawed=!0}},i._prepareDrawParams=function(){if(!this.getMap())return null;var e=this.getViewExtent();if(e.maskExtent&&!e.extent.intersects(e.maskExtent))return this.completeRender(),null;var o=[this.context,e],a=Jg(this.getDrawParams());return o.push.apply(o,a),o.push.apply(o,this._drawContext),o},i._drawLayer=function(){var e=this._prepareDrawParams();if(e){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];this.layer.draw.apply(this.layer,e.concat(a)),this.completeRender()}},i._drawLayerOnInteracting=function(){if(this.layer.drawOnInteracting){var e=this._prepareDrawParams();if(e){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];this.layer.drawOnInteracting.apply(this.layer,e.concat(a)),this.completeRender()}}},t}(Vo);function Jg(r){return r||(r=[]),Array.isArray(r)||(r=[r]),r}var FT={doubleBuffer:!1,animation:!1},fc=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.isCanvasRender=function(){return!0},i.prepareToDraw=function(){},i.draw=function(){},i.redraw=function(){return this._getRenderer()&&this._getRenderer().setToRedraw(),this},i.play=function(){return this.config("animation",!0),this},i.pause=function(){return this.config("animation",!1),this},i.isPlaying=function(){return this.options.animation},i.clearCanvas=function(){return this._getRenderer()&&this._getRenderer().clearCanvas(),this},i.requestMapToRender=function(){return this._getRenderer()&&this._getRenderer().requestMapToRender(),this},i.completeRender=function(){return this._getRenderer()&&this._getRenderer().completeRender(),this},i.onCanvasCreate=function(){return this},i.onZoomStart=function(){},i.onZooming=function(){},i.onZoomEnd=function(){},i.onMoveStart=function(){},i.onMoving=function(){},i.onMoveEnd=function(){},i.onResize=function(){},i.doubleBuffer=function(e){return e.clearRect(0,0,e.canvas.width,e.canvas.height),this},t}(it);fc.mergeOptions(FT);fc.registerRenderer("canvas",Ty);var HT=new k(0,0),BT={animation:!0},Sy=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.getParticles=function(){},i.draw=function(e,o){var a=this.getParticles(ve());if(!a||a.length===0){var s=this._getRenderer();s&&(this._getRenderer()._shouldClear=!0);return}var l=this.getMap(),h=o.extent;o.maskExtent&&(h=o.extent.intersection(o.maskExtent)),h=h.convertTo(function(y){return l._pointToContainerPoint(y,void 0,0,HT)});for(var u=2*Math.PI,f=0,c=a.length;f<c;f++){var d=a[f].point;if(h.contains(d)){var g=a[f].color||this.options.lineColor||"#fff",v=a[f].r;e.fillStyle!==g&&(e.fillStyle=g),v<=2?e.fillRect(d.x-v/2,d.y-v/2,v,v):(e.beginPath(),e.arc(d.x,d.y,v/2,0,u),e.fill())}}this._fillCanvas(e)},i._fillCanvas=function(e){var o=e.globalCompositeOperation;e.globalCompositeOperation="destination-out";var a=this.options.trail||30;e.fillStyle="rgba(0, 0, 0, "+1/a+")",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.globalCompositeOperation=o},t}(fc);Sy.mergeOptions(BT);Sy.registerRenderer("canvas",function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.draw=function(){(!this.canvas||!this.layer.options.animation||this._shouldClear)&&(this.prepareCanvas(),this._shouldClear=!1),this.prepareDrawContext(),this._drawLayer()},i.drawOnInteracting=function(){this.draw(),this._shouldClear=!1},i.onSkipDrawOnInteracting=function(){this._shouldClear=!0},t}(Ty));var Xn=new wn,Jn,Yn,GT=function(r){F(t,r);function t(n,e,o){var a;a=r.call(this,o)||this,a.target=n,n.once("remove",a.delete,Ie(Ie(a)));var s=a.options.symbol,l=s.markerLineWidth||1;return a.w=s.markerWidth+l,a.h=s.markerHeight+l,a.opacity=M(s.opacity)?1:s.opacity,a.map=e,a.events=o.events,a._fetchImage(),a.addTo(e),a}var i=t.prototype;return i.getCursor=function(){return this.options.cursor||"default"},i._fetchImage=function(){var e=this.map,o=this.options.symbol,a=o.markerFile;this.url=a||Uf(o);var s=Xn.getImage(this.url);if(!s){var l=this.w,h=this.h;if(a)s=new Image,s.onload=function(){var c=e.getRenderer();c&&c.setToRedraw()},s.src=this.url;else{var u=document.createElement("canvas");u.width=l,u.height=h;var f=u.getContext("2d");s=L_(f,{x:l/2,y:h/2},o,Xn)}Xn.addResource([this.url,l,h],s)}Xn.login(this.url),this._img=s},i.setContainerPoint=function(e){this._point=e,this._point._sub(this.w/2,this.h/2)},i.getContainerPoint=function(){return this._point.add(this.w/2,this.h/2)},i.offset=function(e){this._point._add(e)},i.render=function(e){if(!this._img)return!1;var o=this.options.symbol,a=o.markerDx||0,s=o.markerDy||0,l=this.map,h=this._point,u=h.x,f=h.y,c=this.w,d=this.h;if(u+c>0&&u<l.width&&f+d>0&&f<l.height){var g=l.getDevicePixelRatio();return e.globalAlpha=this.opacity,e.drawImage(this._img,Math.round((u+a)*g),Math.round((f+s)*g),Math.round(c*g),Math.round(d*g)),!0}return!1},i.delete=function(){if(this.map){var e=this.map.getRenderer();e&&e.removeTopElement(this)}Xn.logout(this.url),this._dragger&&(this._dragger.disable(),delete this._dragger),delete this.map},i.hitTest=function(e){var o=this.options.symbol,a=o.markerDx||0,s=o.markerDy||0,l=this.w,h=this.h,u=this._point.x+a,f=this._point.y+s;return e.x>=u&&e.x<=u+l&&e.y>=f&&e.y<=f+h},i.addTo=function(e){this.map=e;var o=e.getRenderer();o.addTopElement(this)},i.onEvent=function(e){this.fire(e.type,e)},i.mousedown=function(e){var o=e.target,a=this.options.cursor;a&&o.setCursor(a),this.onDragstart(e)},i.onDragstart=function(e){var o=e.containerPoint,a=e.target,s=a._panels.mapWrapper||a._containerDOM,l=this._dragger=new Wo(s);l.on("dragging",this.onDragging,this).on("mouseup",this.onDragend,this).enable(),l.type="handle",l.onMouseDown(e.domEvent),Jn=o.x,Yn=o.y,this.fire("dragstart",{containerPoint:o})},i.onDragging=function(e){if(this._dragger){var o=this.map,a=_t(e.domEvent,o._containerDOM),s={x:a.x-Jn,y:a.y-Yn},l=o.containerPointToCoord(new k(Jn,Yn)),h=o.containerPointToCoord(a);Jn=a.x,Yn=a.y,this.offset(s),this.fire("dragging",{containerPoint:a,coordOffset:h._sub(l)})}},i.onDragend=function(e){if(this._dragger){var o=this.map;o.resetCursor();var a=_t(e.domEvent,o._containerDOM),s={x:a.x-Jn,y:a.y-Yn};this.offset(s),this._dragger.disable(),delete this._dragger,this.fire("dragend",{containerPoint:a})}},t}(Cr(zt)),WT=function(){function r(i,n){this.target=i,i.once("remove",this.delete,this),this.map=n,this.addTo(n)}var t=r.prototype;return t.setPoints=function(n){this.points=n;var e=n.map(function(a){return a.x}),o=n.map(function(a){return a.y});this.xmin=Math.min.apply(Math,e),this.xmax=Math.max.apply(Math,e),this.ymin=Math.min.apply(Math,o),this.ymax=Math.max.apply(Math,o)},t.hitTest=function(){return!1},t.render=function(n){var e=this.map;if(this.xmax<=0||this.xmin>=e.width||this.ymax<=0||this.ymin>=e.height)return;var o=e.getDevicePixelRatio(),a=.5;function s(u){return Math.round(u)*o+a}n.lineWidth=1,n.strokeStyle="#000",n.globalAlpha=1,n.beginPath();var l=this.points;n.moveTo(s(l[0].x),s(l[0].y));for(var h=1;h<this.points.length;h++)n.lineTo(s(l[h].x),s(l[h].y));n.closePath(),n.stroke()},t.addTo=function(n){this.map=n;var e=n.getRenderer();e.addTopElement(this)},t.delete=function(){if(this.map){var n=this.map.getRenderer();n&&n.removeTopElement(this)}},r}(),VT=Bo+"_edit_stage_";function Th(r,t){return{markerType:r,markerFill:"#fff",markerLineColor:"#000",markerLineWidth:2,markerWidth:10,markerHeight:10,opacity:t}}var ZT={fixAspectRatio:!1,symbol:null,removeVertexOn:"contextmenu",centerHandleSymbol:Th("ellipse",1),vertexHandleSymbol:Th("square",1),newVertexHandleSymbol:Th("square",.4)},My=function(r){F(t,r);function t(n,e){var o;return o=r.call(this,e)||this,o._geometry=n,o._geometry?o:Ie(o)}var i=t.prototype;return i.getMap=function(){return this._geometry.getMap()},i.prepare=function(){var e=this.getMap();e&&(e.on("drawtopstart",this._refresh,this),this.options.symbol&&(this._originalSymbol=this._geometry.getSymbol(),this._geometry.setSymbol(this.options.symbol)),this._prepareEditStageLayer())},i._prepareEditStageLayer=function(){var e=this._geometry.getLayer();if(e.options.renderer==="canvas"){var o=this.getMap(),a=Tn(),s=VT+a+"_shadow";if(this._shadowLayer=o.getLayer(s),!this._shadowLayer){var l=e.constructor;this._shadowLayer=new l(s),o.addLayer(this._shadowLayer)}}},i.start=function(){if(!(!this._geometry||!this._geometry.getMap()||this._geometry.editing)){this.editing=!0,this.prepare();var e=this._geometry,o,a=this._geometry.getLayer(),s=a.options.renderer==="canvas";this._geometryDraggble=e.options.draggable,s?(e.config("draggable",!1),o=e.copy(),o.setSymbol(e._getInternalSymbol()),o.copyEventListeners(e),e._getParent()&&o.copyEventListeners(e._getParent()),o._setEventTarget(e),o.setId(null).config({draggable:!1}),this._shadow=o,e.hide()):e instanceof Se&&e.config("draggable",!0),this._switchGeometryEvents("on"),(e instanceof Se||e instanceof nr||e instanceof hn||e instanceof wr)&&this._createOrRefreshOutline(),this._shadowLayer&&this._shadowLayer.bringToFront().addGeometry(o),e instanceof Se?o&&(o.config("draggable",!0),o.on("dragend",this._onMarkerDragEnd,this)):this._createCenterHandle(),e instanceof Se&&this.options.resize!==!1?this.createMarkerEditor():e instanceof nr?this.createCircleEditor():e instanceof hn?this.createEllipseOrRectEditor():e instanceof wr?this.createEllipseOrRectEditor():e instanceof En||(e instanceof Oe||e instanceof xe)&&this.createPolygonEditor()}},i.stop=function(){delete this._history,delete this._historyPointer,delete this._editOutline,this._switchGeometryEvents("off");var e=this.getMap();if(!e){this.fire("remove");return}this._geometry.config("draggable",this._geometryDraggble),this._shadow&&(delete this._shadow,delete this._geometryDraggble,this._geometry.show()),this._shadowLayer&&(this._shadowLayer.remove(),delete this._shadowLayer),this._refreshHooks=[],this.options.symbol&&(this._geometry.setSymbol(this._originalSymbol),delete this._originalSymbol),this.editing=!1,this.fire("remove")},i.isEditing=function(){return M(this.editing)?!1:this.editing},i._getGeometryEvents=function(){return{symbolchange:this._onGeoSymbolChange,dragstart:this._onDragStart,dragend:this._onDragEnd,"positionchange shapechange":this._exeAndReset}},i._switchGeometryEvents=function(e){if(this._geometry){var o=this._getGeometryEvents();for(var a in o)this._geometry[e](a,o[a],this)}},i._onGeoSymbolChange=function(e){this._shadow&&this._shadow.setSymbol(e.target._getInternalSymbol())},i._onMarkerDragEnd=function(){this._update("setCoordinates",this._shadow.getCoordinates().toArray())},i._createOrRefreshOutline=function(){var e=this._geometry,o=this._editOutline;o||(this._editOutline=new WT(this,this.getMap()),this._addRefreshHook(this._createOrRefreshOutline));var a=this._editOutline.points;if(e instanceof Se)this._editOutline.setPoints(e.getContainerExtent().toArray(a));else{var s=this.getMap(),l=e._getPrjExtent();a=l.toArray(a),a.forEach(function(h){return s._prjToContainerPoint(h,null,h)}),this._editOutline.setPoints(a)}return o},i._createCenterHandle=function(){var e=this,o=this.getMap(),a=this.options.centerHandleSymbol,s,l=o.coordToContainerPoint(this._geometry.getCenter()),h=this.createHandle(l,{symbol:a,cursor:"move",onDown:function(){if(e._shadow){s=e._shadow.copy();var f=Lu(s._getInternalSymbol(),.5);s.setSymbol(f).addTo(e._geometry.getLayer())}},onMove:function(f){var c=f.coordOffset;s?s.translate(c):e._geometry.translate(c)},onUp:function(){if(s){var f=s.getFirstCoordinate(),c=e._geometry.getFirstCoordinate(),d=f.sub(c);e._update("translate",d),s.remove()}}});this._addRefreshHook(function(){var u=e._geometry.getCenter();h.setContainerPoint(o.coordToContainerPoint(u))})},i._createHandleInstance=function(e,o){var a=this.getMap(),s=Gf(o.symbol,function(){return[a.getZoom(),{"{bearing}":a.getBearing(),"{pitch}":a.getPitch(),"{zoom}":a.getZoom()}]}),l=this.options.removeVertexOn,h=new GT(this,a,{symbol:s,cursor:o.cursor,events:l});return h.setContainerPoint(e),h},i.createHandle=function(e,o){o||(o={});var a=this._createHandleInstance(e,o),s=this;function l(f){return this._updating=!0,o.onDown&&(this._geometry.fire("handledragstart"),o.onDown.call(s,f.containerPoint,f)),!1}function h(f){return s._hideContext(),o.onMove&&(this._geometry.fire("handledragging"),o.onMove.call(s,f)),!1}function u(f){return o.onUp&&(this._geometry.fire("handledragend"),o.onUp.call(s,f)),this._updating=!1,!1}return a.on("dragstart",l,this),a.on("dragging",h,this),a.on("dragend",u,this),o.onRefresh&&(a.refresh=o.onRefresh),a},i._createResizeHandles=function(e,o,a){var s=this,l=["nw-resize","n-resize","ne-resize","w-resize","e-resize","sw-resize","s-resize","se-resize"],h=[null,"y",null,"x","x",null,"y",null],u=this._geometry,f=u instanceof Se;function c(){if(f){var _=u.getContainerExtent();return[new k(_.xmin,_.ymin),new k((_.xmax+_.xmin)/2,_.ymin),new k(_.xmax,_.ymin),new k(_.xmin,(_.ymin+_.ymax)/2),new k(_.xmax,(_.ymin+_.ymax)/2),new k(_.xmin,_.ymax),new k((_.xmax+_.xmin)/2,_.ymax),new k(_.xmax,_.ymax)]}var w=u._getPrjExtent();return[new k(w.xmin,w.ymax),new k((w.xmax+w.xmin)/2,w.ymax),new k(w.xmax,w.ymax),new k(w.xmin,(w.ymax+w.ymin)/2),new k(w.xmax,(w.ymax+w.ymin)/2),new k(w.xmin,w.ymin),new k((w.xmax+w.xmin)/2,w.ymin),new k(w.xmax,w.ymin)]}e||(e=[]);var d=this,g=[],v={},y=this.getMap(),p=this.options.vertexHandleSymbol,m=function(){for(var w=c(),C=function(S){if(Array.isArray(e)){var E=e.some(function(L){return L===S});if(E)return"continue"}var D=w[S],A=f?D:y._prjToContainerPoint(D);if(g.length<w.length-e.length){var I=s.createHandle(A,{symbol:p,cursor:l[S],axis:h[S],onMove:function(L){return function(O){d._updating=!0,o(O.containerPoint,L),u.fire("resizing")}}(S),onUp:function(){d._updating=!1,a()}});v[S]=g.length,g.push(I)}else g[v[S]].setContainerPoint(A)},x=0;x<w.length;x++)var T=C(x)};return m(),this._addRefreshHook(m),g},i.createMarkerEditor=function(){var e=this,o=this._shadow||this._geometry,a=this.getMap();if(!o._canEdit()){console&&console.warn("A marker can't be resized with symbol:",o.getSymbol());return}this._history||this._recordHistory(p());var s=o._getInternalSymbol(),l=new k(0,0);V(s.markerDx)&&(l.x=s.markerDx),V(s.markerDy)&&(l.y=s.markerDy);var h=null,u="middle",f="middle";if(z_.test(s)){var c=s.markerType;c==="pin"||c==="pie"||c==="bar"?(h=[5,6,7],u="bottom"):c==="rectangle"&&(h=[0,1,2,3,5],u="top",f="left")}else(rc.test(s)||j_.test(s))&&(u="bottom",h=[5,6,7]);var d=[2,1,2,0,0,2,1,2],g;if(this.options.fixAspectRatio){var v=o.getSize();g=v.width/v.height}var y=this._createResizeHandles(h,function(m,_){if(h&&h.indexOf(_)>=0){var w=a.containerPointToCoordinate(m.sub(l)),C=o.getCoordinates();w.x=C.x,o.setCoordinates(w),e._updateCoordFromShadow(!0);var x=y[y.length-1-_],T=x.getContainerPoint();m=T}var P=a.coordToContainerPoint(o.getCoordinates()).add(l),S=o._getInternalSymbol(),E=m.sub(P);u==="bottom"&&m.y>P.y&&(E.y=0);var D=u==="middle"?2:1,A=f==="left"?1:2,I=Math.abs(E.x)*A,L=Math.abs(E.y)*D;g&&(I=Math.max(I,L*g),L=I/g);var O=d[_];o instanceof bs?((g||O===0||O===2)&&(o.setWidth(I),o!==e._geometry&&e._geometry.setWidth(I)),(g||O===1||O===2)&&(o.setHeight(L),o!==e._geometry&&e._geometry.setHeight(L))):((g||O===0||O===2)&&(S.markerWidth=Math.min(I,e._geometry.options.maxMarkerWidth||1/0)),(g||O===1||O===2)&&(S.markerHeight=Math.min(L,e._geometry.options.maxMarkerHeight||1/0)),o.setSymbol(S),o!==e._geometry&&e._geometry.setSymbol(S))},function(){e._update(p())});function p(){var m=[["setCoordinates",o.getCoordinates().toArray()]];return o instanceof bs?(m.push(["setWidth",o.getWidth()]),m.push(["setHeight",o.getHeight()])):m.push(["setSymbol",o.getSymbol()]),m}},i.createCircleEditor=function(){var e=this,o=this._shadow||this._geometry,a=this.getMap();this._history||this._recordHistory([["setCoordinates",o.getCoordinates().toArray()],["setRadius",o.getRadius()]]),this._createResizeHandles(null,function(s){var l=o.getCenter(),h=a.containerPointToCoord(s),u=new xe([[l.x,l.y],[h.x,l.y]]),f=new xe([[l.x,l.y],[l.x,h.y]]),c=Math.max(a.computeGeometryLength(u),a.computeGeometryLength(f));o.setRadius(c),o!==e._geometry&&e._geometry.setRadius(c)},function(){e._update("setRadius",o.getRadius())})},i.createEllipseOrRectEditor=function(){var e=this,o=[2,1,2,0,0,2,1,2],a=this._shadow||this._geometry;this._history||this._recordHistory(f());var s=this.getMap(),l=this._geometry instanceof hn,h;this.options.fixAspectRatio&&(h=a.getWidth()/a.getHeight());var u=this._createResizeHandles(null,function(c,d){var g=l?1:2,v,y,p,m=u[d],_=m.getContainerPoint(),w=o[d];if(l){var C=u[7-d],x=C.getContainerPoint();v=_.sub(x);var T=v.abs();y=s.pixelToDistance(T.x,0),p=s.pixelToDistance(0,T.y);var P=a.getSize(),S=a.getCoordinates(),E=a.getWidth(),D=a.getHeight(),A=s.containerPointToCoord(c),I=s.containerPointToCoord(x),L=new xe([[I.x,I.y],[A.x,I.y]]),O=new xe([[I.x,I.y],[I.x,A.y]]);if(y=s.computeGeometryLength(L),p=s.computeGeometryLength(O),w===0)if(h&&(T.y=T.x/h,P.height=Math.abs(T.y),p=y/h),_.y=x.y-P.height/2,A.y=S.y,d===4)A.x=Math.min(A.x,S.x);else{var H=s.locate(S,E,0);A.x=s.locate(new z(H.x,A.y),-y,0).x}else if(w===1)h&&(T.x=T.y*h,P.width=Math.abs(T.x),y=p*h),_.x=x.x-P.width/2,A.x=S.x,A.y=Math.max(A.y,I.y);else{if(h&&(y>p*h?(p=y/h,_.y=x.y+T.x*et(v.y)/h):(y=p*h,_.x=x.x+T.y*et(v.x)*h)),d===0||d===5){var B=d===0?s.locate(S,E,0):s.locate(S,E,-D);A.x=s.locate(new z(B.x,A.y),-y,0).x}else A.x=Math.min(A.x,I.x);A.y=Math.max(A.y,I.y)}a.setCoordinates(A),e._updateCoordFromShadow(!0)}else{var R=a.getCenter(),b=s.containerPointToCoord(_),N=new xe([[R.x,R.y],[b.x,R.y]]),Z=new xe([[R.x,R.y],[R.x,b.y]]);y=s.computeGeometryLength(N),p=s.computeGeometryLength(Z),h&&(y=Math.max(y,p*h),p=y/h)}(h||w===0||w===2)&&(a.setWidth(y*g),a!==e._geometry&&e._geometry.setWidth(y*g)),(h||w===1||w===2)&&(a.setHeight(p*g),a!==e._geometry&&e._geometry.setHeight(p*g))},function(){e._update(f())});function f(){return[["setCoordinates",a.getCoordinates().toArray()],["setWidth",a.getWidth()],["setHeight",a.getHeight()]]}},i.createPolygonEditor=function(){var e=this.getMap(),o=this._shadow||this._geometry,a=this;this._history||this._recordHistory("setCoordinates",z.toNumberArrays(o.getCoordinates()));var s=o instanceof Oe?3:2,l="maptalks--editor-vertex-index",h={0:[]},u={0:[]};function f(L){if(L===void 0&&(L=0),o instanceof Oe){var O=o.getCoordinates()[L]||[];return O.slice(0,O.length-1)}else return o.getCoordinates()}function c(L){return L===void 0&&(L=0),L===0?o._getPrjCoordinates():o._getPrjHoles()[L-1]}function d(){for(var L in h){for(var O=h[L].length-1;O>=0;O--)h[L][O][l]=O;for(var H=u[L].length-1;H>=0;H--)u[L][H][l]=H}a._updateCoordFromShadow()}function g(L){a._updating=!0;var O=L.target,H=O[l],B=V(O._ringIndex)?O._ringIndex:0,R=c(B);if(!(R.length<=s)){var b=o instanceof xe&&(H===0||H===R.length-1);R.splice(H,1),B>0?o._prjHoles[B-1]=R:o._setPrjCoordinates(R),o._updateCache(),h[B].splice(H,1)[0].delete(),H<u[B].length&&u[B].splice(H,1)[0].delete();var N;if(H===0?N=u[B].length-1:N=H-1,u[B].splice(N,1)[0].delete(),b||u[B].splice(N,0,w.call(a,N,B)),B>0){var Z=o.getCoordinates(),X=Z[B];X&&Array.isArray(X)&&X.length>1&&(X.splice(H,1),o!==this._geometry&&o.setCoordinates(Z))}d(),a._updating=!1}}function v(L,O,H){H===void 0&&(H=0);var B=a._geometry.snapTo;B&&oe(B)&&(L=a._geometry.snapTo(L)||L);var R=c(H),b=e._containerPointToPrj(L.sub(p())),N=R[O];N.x=b.x,N.y=b.y,o._updateCache(),o.onShapeChanged(),a._updateCoordFromShadow(!0);var Z;O===0?Z=u[H].length-1:Z=O-1,u[H][O]&&u[H][O].refresh(),u[H][Z]&&u[H][Z].refresh()}var y=new k(0,0);function p(){var L=o._getCompiledSymbol();return y.x=L.lineDx||0,y.y=L.lineDy||0,y}function m(L,O,H){O===void 0&&(O=0);var B=(H||f(O))[L],R=a.createHandle(e.coordToContainerPoint(B)._add(p()),{symbol:a.options.vertexHandleSymbol,cursor:"pointer",axis:null,onMove:function(){v(R.getContainerPoint(),R[l],O)},onRefresh:function(N,Z){B=(Z||f(O))[R[l]];var X=e.coordToContainerPoint(B);R.setContainerPoint(X._add(p()))},onUp:function(){a._updateCoordFromShadow()},onDown:function(N,Z){Z&&Z.domEvent&&Z.domEvent.button}});return R[l]=L,R._ringIndex=O,R.on(a.options.removeVertexOn,g),R}var _=!1;function w(L,O,H){O===void 0&&(O=0);var B=H||f(O),R;L+1>=B.length?R=B[0]:R=B[L+1];var b=B[L].add(R).multi(1/2),N=a.createHandle(b,{symbol:a.options.newVertexHandleSymbol,cursor:"pointer",axis:null,onDown:function(X,ne){if(!(ne&&ne.domEvent&&ne.domEvent.button===2)){var te=c(O),J=N[l],q=N.getContainerPoint(),ue=e._containerPointToPrj(q);te.splice(J+1,0,ue),O>0?o._prjHoles[O-1]=te:o._setPrjCoordinates(te),o._updateCache(),N.opacity=1,u[O].splice(J,0,w.call(a,J,O),w.call(a,J+1,O)),_=!0}},onMove:function(){v(N.getContainerPoint(),N[l]+1,O)},onUp:function(X){if(X&&X.domEvent&&X.domEvent.button===2){_=!1;return}var ne=N[l];Cu(N,u[O]),N.delete(),h[O].splice(ne+1,0,m.call(a,ne+1,O)),d(),a._updateCoordFromShadow(),_=!1},onRefresh:function(X,ne){B=ne||f(X);var te=N[l],J;te===B.length-1?J=0:J=te+1;var q=B[te].add(B[J]).multi(1/2),ue=e.coordToContainerPoint(q);N.setContainerPoint(ue._add(p()))}});return N[l]=L,N}if(o instanceof Oe)for(var C=o.getHoles().length+1,x=0;x<C;x++){h[x]=[],u[x]=[];for(var T=f(x),P=0,S=T.length;P<S;P++)h[x].push(m.call(this,P,x,T)),P<S-1&&u[x].push(w.call(this,P,x,T));u[x].push(w.call(this,T.length-1,x,T))}else{for(var E=0,D=f(E),A=0,I=D.length;A<I;A++)h[E].push(m.call(this,A,E,D)),A<I-1&&u[E].push(w.call(this,A,E,D));u[E].length&&o.getCoordinates().length===2&&(u[E][0].options.symbol.markerDx=12)}this._addRefreshHook(function(){if(!_){for(var L in u)for(var O=f(L),H=u[L].length-1;H>=0;H--)u[L][H].refresh(L,O);u[0].length&&o instanceof xe&&(o.getCoordinates().length===2?u[0][0].options.symbol.markerDx=12:o.getCoordinates().length>2&&(u[0][0].options.symbol.markerDx=0));for(var B in h)for(var R=f(B),b=h[B].length-1;b>=0;b--)h[B][b].refresh(B,R)}})},i._refresh=function(){if(this._refreshHooks)for(var e=this._refreshHooks.length-1;e>=0;e--)this._refreshHooks[e].call(this)},i._hideContext=function(){this._geometry&&(this._geometry.closeMenu(),this._geometry.closeInfoWindow())},i._addRefreshHook=function(e){e&&(this._refreshHooks||(this._refreshHooks=[]),this._refreshHooks.push(e))},i._update=function(e){for(var o=arguments.length,a=new Array(o>1?o-1:0),s=1;s<o;s++)a[s-1]=arguments[s];this._exeHistory([e,a]),this._recordHistory.apply(this,[e].concat(a))},i._updateCoordFromShadow=function(e){var o=this._shadow||this._geometry,a=o.getCoordinates(),s=this._geometry,l=this._updating;this._updating=!0,s.setCoordinates(a),e||this._recordHistory("setCoordinates",z.toNumberArrays(s.getCoordinates())),this._updating=l},i._recordHistory=function(e){this._history||(this._history=[],this._historyPointer=0);for(var o=arguments.length,a=new Array(o>1?o-1:0),s=1;s<o;s++)a[s-1]=arguments[s];if(this._history.length){var l=this._history[this._history.length-1];if(l[0]===e&&JSON.stringify(l[1])===JSON.stringify(a))return}this._historyPointer<this._history.length-1&&this._history.splice(this._historyPointer+1),this._history.push([e,a]),this._historyPointer=this._history.length-1,this._geometry.fire("editrecord")},i.cancel=function(){if(!this._history||this._historyPointer===0)return this;this._historyPointer=0;var e=this._history[0];return this._exeAndReset(e),this},i.undo=function(){if(!this._history||this._historyPointer===0)return this;var e=this._history[--this._historyPointer];return this._exeAndReset(e),this},i.redo=function(){if(!this._history||this._historyPointer===this._history.length-1)return this;var e=this._history[++this._historyPointer];return this._exeAndReset(e),this},i._exeAndReset=function(e){if(!this._updating){this._exeHistory(e);var o=this._history,a=this._historyPointer;this.stop(),this._history=o,this._historyPointer=a,this.start()}},i._onDragStart=function(){this._updating=!0},i._onDragEnd=function(){this._updating=!1},i._exeHistory=function(e){if(Array.isArray(e)){var o=this._updating;this._updating=!0;var a=this._shadow||this._geometry,s=this._geometry;Array.isArray(e[0])?e[0].forEach(function(l){var h=l[0],u=l.slice(1);a[h].apply(a,u),a!==s&&s[h].apply(s,u)}):(a[e[0]].apply(a,e[1]),a!==s&&s[e[0]].apply(s,e[1])),this._updating=o}},t}(Cr(zt));My.mergeOptions(ZT);var UT={startEditText:function(){return this.getMap()?(this.hide(),this.endEditText(),this._prepareEditor(),this._fireEvent("edittextstart"),this):this},endEditText:function(){if(this._textEditor){var t=this._textEditor.innerHTML;t=t.replace(/<p>/ig,"").replace(/<\/p>/ig,"<br/>"),this._textEditor.innerHTML=t;var i=this._textEditor.innerText.replace(/[\r\n]+$/gi,"");this.setContent(i),Re(this._textEditor,"mousedown dblclick",wt),this.getMap().off("mousedown",this.endEditText,this),this._editUIMarker.remove(),delete this._editUIMarker,this._textEditor.onkeyup=null,delete this._textEditor,this.show(),this._fireEvent("edittextend")}return this},isEditingText:function(){return!!this._textEditor},getTextEditor:function(){return this._editUIMarker},_prepareEditor:function(){var t=this.getMap(),i=this._createEditor();this._textEditor=i,t.on("mousedown",this.endEditText,this);var n=this._getEditorOffset();this._editUIMarker=new sc(this.getCoordinates(),{animation:null,content:i,dx:n.dx,dy:n.dy}).addTo(t),this._setCursorToLast(this._textEditor)},_getEditorOffset:function(){var t=this._getInternalSymbol()||{},i=0,n=0,e=t.textHorizontalAlignment;return e==="middle"||M(e)?(i=(t.textDx||0)-2,n=(t.textDy||0)-2):(i=(t.markerDx||0)-2,n=(t.markerDy||0)-2),{dx:i,dy:n}},_createEditor:function(){var t=this.getContent(),i=this.getSize(),n=this._getInternalSymbol()||{},e=i.width,o=n.textFill||"#000000",a=n.textSize||12,s=i.height,l=n.markerLineColor||"#000",h=n.markerFill||"#3398CC",u=n.textLineSpacing||0,f=Y("div");return f.contentEditable=!0,f.style.cssText="background:"+h+"; border:1px solid "+l+`;
            color:`+o+";font-size:"+a+"px;width:"+(e-2)+"px;height:"+(s-2)+`px;margin: auto;
            line-height:`+(a+u)+`px;outline: 0; padding:0; margin:0;word-wrap: break-word;
            overflow: hidden;-webkit-user-modify: read-write-plaintext-only;`,f.innerText=t,Pe(f,"mousedown dblclick",wt),f.onkeyup=function(c){var d=f.style.height||0;c.keyCode===13&&(f.style.height=parseInt(d)+a/2+"px")},f},_setCursorToLast:function(t){var i;window.getSelection?(t.focus(),i=window.getSelection(),i.selectAllChildren(t),i.collapseToEnd()):document.selection&&(i=document.selection.createRange(),i.moveToElementText(t),i.collapse(!1),i.select())}};oc.include(UT);ae.include({animate:function(t,i,n){var e=this;this._animPlayer&&this._animPlayer.finish(),oe(i)&&(n=i),i||(i={});var o=this.getMap(),a=this._getProjection(),s=this._prepareAnimationStyles(t),l,h=i.focus;if(delete this._animationStarted,o){var u=o._getRenderer(),f=function(g){u.callInNextFrame(g)};i.framer=f}var c=Ge.animate(s,i,function(d){if(o&&o.isRemoved()){c.finish();return}o&&!e._animationStarted&&h&&o.onMoveStart();var g=d.styles;for(var v in g)if(v!=="symbol"&&v!=="translate"&&g.hasOwnProperty(v)){var y="set"+v[0].toUpperCase()+v.slice(1);e[y](g[v])}var p=g.translate;if(p){var m=p;l&&(m=p.sub(l)),l=p,e.translate(m)}var _=g.symbol;if(_){var w=e.getSymbol()||{};e.setSymbol(Kt(w,_))}if(o&&h){var C=a.project(e.getCenter());o._setPrjCenter(C);var x=o._parseEventFromCoord(a.unproject(C));c.playState!=="running"?o.onMoveEnd(x):o.onMoving(x)}e._fireAnimateEvent(c.playState),n&&n(d)},this);return this._animPlayer=c,this._animPlayer.play()},_prepareAnimationStyles:function(t){var i=this._getInternalSymbol(),n={};for(var e in t)if(t.hasOwnProperty(e)){var o=t[e];if(e!=="translate"&&e!=="symbol"){var a="get"+e[0].toUpperCase()+e.substring(1),s=this[a]();n[e]=[s,o]}else if(e==="symbol"){var l=void 0;if(Array.isArray(t.symbol)){if(!Array.isArray(i))throw new Error("geometry'symbol isn't a composite symbol, while the symbol in styles is.");l=[];for(var h=t.symbol,u=0;u<h.length;u++){if(!h[u]){l.push(null);continue}var f={};for(var c in h[u])h[u].hasOwnProperty(c)&&(f[c]=[i[u][c],h[u][c]]);l.push(f)}}else{if(Array.isArray(i))throw new Error("geometry'symbol is a composite symbol, while the symbol in styles isn't.");l={};for(var d in o)o.hasOwnProperty(d)&&(l[d]=[i[d],o[d]])}n.symbol=l}else e==="translate"&&(n.translate=new z(o))}return n},_fireAnimateEvent:function(t){t==="finished"?(delete this._animationStarted,this._fireEvent("animateend")):t==="running"&&(this._animationStarted?this._fireEvent("animating"):(this._fireEvent("animatestart"),this._animationStarted=!0))}});var Sh=Bo+"_drag_stage",Yg=K.touch?"touchstart mousedown":"mousedown",$T=function(r){F(t,r);function t(n){return r.call(this,n)||this}var i=t.prototype;return i.addHooks=function(){this.target.on(Yg,this._startDrag,this)},i.removeHooks=function(){this._endDrag(),this.target.off(Yg,this._startDrag,this),delete this.container},i._prepareDragHandler=function(){this._dragHandler=new Wo(this.container),this._dragHandler.on("dragging",this._dragging,this).on("mouseup",this._endDrag,this).enable()},i._prepareShadow=function(){var e=this,o=this.target,a=o.getLayer().options.renderer==="canvas";if(a){this._prepareDragStageLayer(),this._shadow&&this._shadow.remove();var s=this._shadow=o.copy();if(s.getGeometries){var l=s.getGeometries(),h=o.getGeometries();l.forEach(function(u,f){e._updateShadowSymbol(u,h[f])})}else this._updateShadowSymbol(s,o);s.setId(null),this._prepareShadowConnectors()}},i._updateShadowSymbol=function(e,o){if(e.setSymbol(o._getInternalSymbol()),o.options.dragShadow){var a=Lu(e._getInternalSymbol(),.5);e.setSymbol(a)}},i._prepareShadowConnectors=function(){var e=this.target,o=this._shadow,a=this._dragStageLayer._getRenderer().resources,s=[];if(Is._hasConnectors(e))for(var l=Is._getConnectors(e),h=0,u=l.length;h<u;h++){var f=l[h],c=f.config(),d=f._getInternalSymbol();c.symbol=Lu(d,.5);var g=void 0;f.getConnectSource()===e?g=new f.constructor(o,f.getConnectTarget(),c):g=new f.constructor(f.getConnectSource(),o,c),s.push(g),f.getLayer()&&f.getLayer()._getRenderer()&&a.merge(f.getLayer()._getRenderer().resources)}this._shadowConnectors=s,s.push(o),this._dragStageLayer.bringToFront().addGeometry(s)},i._onTargetUpdated=function(){this._shadow&&this._shadow.setSymbol(this.target._getSymbol())},i._prepareDragStageLayer=function(){var e=this.target.getMap(),o=this.target.getLayer();this._dragStageLayer=e.getLayer(Sh),this._dragStageLayer||(this._dragStageLayer=new or(Sh,{enableAltitude:o.options.enableAltitude,altitudeProperty:o.options.altitudeProperty}),e.addLayer(this._dragStageLayer));var a=new wn;a.merge(o._getRenderer().resources),this._dragStageLayer._getRenderer().resources=a},i._startDrag=function(e){var o=this.target.getMap();if(o){var a=this.target._getParent();if(!a&&!this.isDragging()){var s=e.domEvent;s.touches&&s.touches.length>1||s.button===2||(this.container=o._panels.mapWrapper||o._containerDOM,this.target.on("click",this._endDrag,this),this._lastCoord=this._correctCoord(e.coordinate),this._lastPoint=e.containerPoint,this._prepareDragHandler(),this._dragHandler.onMouseDown(e.domEvent),Pe(this.container,"mouseleave",this._endDrag,this),this._startParam=e,this._moved=!1)}}},i._dragging=function(e){var o=this.target,a=o.getMap(),s=a._parseEvent(e.domEvent),l=s.domEvent;if(!(l.touches&&l.touches.length>1)){var h=a._getVisualHeight(a.options.maxVisualPitch);if(!(s.containerPoint.y<a.height-h)){if(!this._moved){this._moved=!0,o.on("symbolchange",this._onTargetUpdated,this),this._isDragging=!0,this._prepareShadow(),this._shadow&&(o.options.dragShadow||o.hide(),this._shadow._fireEvent("dragstart",s)),this.target._fireEvent("dragstart",this._startParam||s),delete this._startParam;return}var u=this._shadow||o,f=u.options.dragOnAxis,c=u.options.dragOnScreenAxis,d=s.containerPoint,g=s.coordinate;this._lastPoint=this._lastPoint||d,this._lastCoord=this._lastCoord||g,c?(f==="x"?d.y=this._lastPoint.y:f==="y"&&(d.x=this._lastPoint.x),g=a.containerPointToCoord(d)):g=this._correctCoord(g);var v=d.sub(this._lastPoint),y=g.sub(this._lastCoord);c||(f==="x"?v.y=y.y=0:f==="y"&&(v.x=y.x=0)),this._lastPoint=d,this._lastCoord=g,u.translate(y),u!==o&&!o.options.dragShadow&&o.translate(y),s.coordOffset=y,s.pointOffset=v,u._fireEvent("dragging",s),u!==o&&o._fireEvent("dragging",s)}}},i._endDrag=function(e){if(this._dragHandler&&(this._dragHandler.disable(),delete this._dragHandler),this.container&&Re(this.container,"mouseleave",this._endDrag),!!this.target){var o=this.target;o.off("click",this._endDrag,this),o.off("symbolchange",this._onTargetUpdated,this),delete this._lastCoord,delete this._lastPoint,this._isDragging=!1;var a=o.getMap();if(this.enabled()&&a){var s=a._parseEvent(e?e.domEvent:null);this._updateTargetAndRemoveShadow(s),this._moved&&o._fireEvent("dragend",s)}}},i.isDragging=function(){return!!this._isDragging},i._updateTargetAndRemoveShadow=function(e){if(this._shadow){var o=this.target,a=o.getMap();o.options.dragShadow||o.show();var s=this._shadow;if(s){if(o.options.dragShadow){var l=s.getFirstCoordinate(),h=o.getFirstCoordinate(),u=l.sub(h);o.translate(u)}s._fireEvent("dragend",e),s.remove(),delete this._shadow}this._shadowConnectors&&(a.getLayer(Sh).removeGeometry(this._shadowConnectors),delete this._shadowConnectors),this._dragStageLayer&&(this._dragStageLayer._getRenderer().resources=new wn,this._dragStageLayer.remove())}},i._correctCoord=function(e){var o=this.target.getMap();if(!o.getPitch())return e;var a=this.target;if(!a.getMinAltitude())return e;var s=(a.getMinAltitude()+a.getMaxAltitude())/2;return o.locateByPoint(e,0,-s)},t}(Xt);ae.mergeOptions({draggable:!1,dragShadow:!0,dragOnAxis:null,dragOnScreenAxis:!1});ae.addInitHook("addHandler","draggable",$T);ae.include({isDragging:function(){return this._getParent()?this._getParent().isDragging():this.draggable?this.draggable.isDragging():!1}});ae.include({startEdit:function(t){var i=this.getMap();return!i||!this.options.editable?this:(this._editor&&this.endEdit(),this._editor=new My(this,t),this._editor.start(),this._getParent()||this.fire("editstart"),i.getRenderer().setToRedraw(),this)},endEdit:function(){if(this._editor){this._editor.stop(),delete this._editor,this._getParent()||this.fire("editend");var t=this.getMap();t&&t.getRenderer().setToRedraw()}return this},redoEdit:function(){return this.isEditing()?(this._editor.redo(),this._getParent()||this.fire("redoedit"),this):this},undoEdit:function(){return this.isEditing()?(this._editor.undo(),this._getParent()||this.fire("undoedit"),this):this},cancelEdit:function(){return this.isEditing()?(this._editor.cancel(),this._getParent()||this.fire("canceledit"),this):this},isEditing:function(){return this._editor?this._editor.isEditing():!1}});ae.include({_onEvent:function(t,i){var n=this.getMap();if(n){var e=i||this._getEventTypeToFire(t);e==="contextmenu"&&this.listens("contextmenu")&&(wt(t),yr(t));var o=n._getEventParams(t);V(this._pickGeometryIndex)&&(o.pickGeometryIndex=this._pickGeometryIndex),this._fireEvent(e,o)}},_getEventTypeToFire:function(t){return t.type}});ae.include({setInfoWindow:function(t){return this.removeInfoWindow(),t instanceof Hu?(this._infoWindow=t,this._infoWinOptions=W({},this._infoWindow.options),this._infoWindow.addTo(this),this):(this._infoWinOptions=W({},t),this._infoWindow?this._infoWindow.setOptions(t):this.getMap()&&this._bindInfoWindow(),this)},getInfoWindow:function(){return this._infoWindow?this._infoWindow:null},openInfoWindow:function(t){return this.getMap()?(t||(t=this.getCenter()),this._infoWindow?this._infoWindow.show(t):this._infoWinOptions&&this.getMap()&&(this._bindInfoWindow(),this._infoWindow.show(t)),this):this},closeInfoWindow:function(){return this._infoWindow&&this._infoWindow.hide(),this},removeInfoWindow:function(){return this._unbindInfoWindow(),delete this._infoWinOptions,delete this._infoWindow,this},_bindInfoWindow:function(){var t=this._infoWinOptions;return t?(this._infoWindow=new Hu(t),this._infoWindow.addTo(this),this):this},_unbindInfoWindow:function(){return this._infoWindow&&(this.closeInfoWindow(),this._infoWindow.remove(),delete this._infoWindow),this}});var XT=new k(0,0),JT=new k(0,0),Qg=new k(0,0),qg=new k(0,0),Bu=[],YT=function(r){F(t,r);function t(){return r.call(this,Qf)||this}var i=t.prototype;return i.checkUrl=function(e){return!e||!ie(e)?e:Rm(e)},i.fetchImage=function(e,o,a,s){e=this.checkUrl(e);var l={url:e,fetchOptions:s};this.send(l,Bu,a,o)},t}(C_),QT=new Image,cc=function(r){F(t,r);function t(n){var e;return e=r.call(this,n)||this,e.tilesInView={},e.tilesLoading={},e._parentTiles=[],e._childTiles=[],e._tileQueue=[],e.tileCache=new e_(n.options.maxCacheSize,function(o){e.deleteTile(o)}),K.decodeImageInWorker&&e.layer.options.decodeImageInWorker&&(n.options.renderer==="gl"||!K.safari&&!K.iosWeixin)&&(e._tileImageWorkerConn=new YT),e._compareTiles=KT.bind(Ie(Ie(e))),e}var i=t.prototype;return i.getCurrentTileZoom=function(){return this._tileZoom},i.draw=function(e,o){var a=this.getMap();if(this.isDrawable()){var s=this.prepareCanvas();if(s&&!s.intersects(this.canvasExtent2D)){this.completeRender();return}this._renderTimestamp!==e&&(this._consumeTileQueue(),this._computeAvgTileAltitude(),this._renderTimestamp=e);var l,h=!1,u=this._frameTiles;if(u&&e===u.timestamp){if(u.empty)return;l=u}else{if(l=this._getTilesInCurrentFrame(),!l){this._frameTiles={empty:!0,timestamp:e},this.completeRender();return}h=!0,this._frameTiles=l,this._frameTiles.timestamp=e,l.loadingCount&&this.loadTileQueue(l.tileQueue)}var f=l,c=f.tiles,d=f.childTiles,g=f.parentTiles,v=f.placeholders,y=f.loading,p=f.loadingCount;this._drawTiles(c,g,d,v,o),p||y||(!a.isAnimating()&&(this._parentTiles.length||this._childTiles.length)&&(this._parentTiles=[],this._childTiles=[],this.setToRedraw()),this.completeRender()),h&&this._retireTiles()}},i.getTileGridsInCurrentFrame=function(){return this._frameTileGrids},i._getTilesInCurrentFrame=function(){var e=this.getMap(),o=this.layer,a=o.getTiles();if(this._frameTileGrids=a,a=a.tileGrids,!a||!a.length)return null;var s=a.reduce(function(J,q){return J+(q&&q.tiles&&q.tiles.length||0)},0);s>=this.tileCache.max/2&&this.tileCache.setMaxSize(s*2+1);var l=0,h=!1,u={},f=[],c=[],d={},g=[],v={},y=[],p={},m={},_=this._markTiles(),w=this._getLoadLimit(),C=a.length;this._tileZoom=a[0].zoom;for(var x=0;x<C;x++){var T=a[x],P=T.tiles,S=T.parents||Bu,E=S.length,D=S.concat(P),A=void 0;D.length&&(A=this._generatePlaceHolder(D[0].res));for(var I=0,L=D.length;I<L;I++){var O=D[I],H=O.id,B=I<E,R=!1;if(this._isLoadingTile(H))R=h=!0,this.tilesLoading[H].current=!0;else{var b=this._getCachedTile(H,B);if(b)B||(b.image&&this.isTileFadingIn(b.image)&&(R=h=!0,this.setToRedraw()),f.push(b),this.isTileComplete(b)||(R=!0));else{R=h=!0;var N=w&&l+_[0]>w;if(!N&&(!e.isInteracting()||e.isMoving()||e.isRotating())){l++;var Z=H;m[Z]=O}}}if(!B&&R&&!u[H]){u[H]=1,A&&!p[H]&&(O.cache=!1,y.push({image:A,info:O}),p[H]=1);var X=this._findChildTiles(O);if(X.length&&X.forEach(function(J){v[J.info.id]||(g.push(J),v[J.info.id]=1)}),!X.length||X.length!==4){var ne=this._findParentTile(O);if(ne){var te=ne.info.id;d[te]===void 0&&(d[te]=c.length,c.push(ne))}}}}}return this.tileCache.shrink(),{childTiles:g,parentTiles:c,tiles:f,placeholders:y,loading:h,loadingCount:l,tileQueue:m}},i.removeTileCache=function(e){delete this.tilesInView[e],this.tileCache.remove(e)},i.isTileCachedOrLoading=function(e){return this.tileCache.get(e)||this.tilesInView[e]||this.tilesLoading[e]},i.isTileCached=function(e){return!!(this.tileCache.get(e)||this.tilesInView[e])},i.isTileFadingIn=function(e){return this._getTileFadingOpacity(e)<1},i._drawTiles=function(e,o,a,s,l){var h=this;o.length&&(o.sort(this._compareTiles),this._parentTiles=o),a.length&&(this._childTiles=a,this._childTiles.sort(this._compareTiles));var u=!0,f=this.canvas._parentTileTimestamp;(this.layer.constructor===Lt||this.layer.constructor===lc)&&(this._renderTimestamp===f?u=!1:this.canvas._parentTileTimestamp=this._renderTimestamp);var c={tiles:e,parentTiles:this._parentTiles,childTiles:this._childTiles,parentContext:l};if(this.onDrawTileStart(c,l),u&&this.layer.options.opacity===1){this.layer._silentConfig=!0;var d=this.layer.options.fadeAnimation;this.layer.options.fadeAnimation=!1,this.drawingChildTiles=!0,this._childTiles.forEach(function(p){return h._drawTile(p.info,p.image,l)}),delete this.drawingChildTiles,this.drawingParentTiles=!0,this._parentTiles.forEach(function(p){return h._drawTile(p.info,p.image,l)}),delete this.drawingParentTiles,this.layer.options.fadeAnimation=d,this.layer._silentConfig=!1}this.drawingCurrentTiles=!0,e.sort(this._compareTiles);for(var g=0,v=e.length;g<v;g++)this._drawTileAndCache(e[g],l);if(delete this.drawingCurrentTiles,u&&this.layer.options.opacity<1){this.layer._silentConfig=!0;var y=this.layer.options.fadeAnimation;this.layer.options.fadeAnimation=!1,this.drawingChildTiles=!0,this._childTiles.forEach(function(p){return h._drawTile(p.info,p.image,l)}),delete this.drawingChildTiles,this.drawingParentTiles=!0,this._parentTiles.forEach(function(p){return h._drawTile(p.info,p.image,l)}),delete this.drawingParentTiles,this.layer.options.fadeAnimation=y,this.layer._silentConfig=!1}s.forEach(function(p){return h._drawTile(p.info,p.image,l)}),this.onDrawTileEnd(c,l)},i.onDrawTileStart=function(){},i.onDrawTileEnd=function(){},i._drawTile=function(e,o,a){o&&this.drawTile(e,o,a)},i._drawTileAndCache=function(e,o){this.tilesInView[e.info.id]=e,this._drawTile(e.info,e.image,o)},i.drawOnInteracting=function(e,o,a){this.draw(o,a)},i.needToRedraw=function(){var e=this.getMap();return this._tileQueue.length?!0:e.getPitch()?r.prototype.needToRedraw.call(this):e.isRotating()||e.isZooming()?!0:e.isMoving()?!!this.layer.options.forceRenderOnMoving:r.prototype.needToRedraw.call(this)},i.hitDetect=function(){return!1},i._getLoadLimit=function(){return this.getMap().isInteracting()?this.layer.options.loadingLimitOnInteracting:this.layer.options.loadingLimit||0},i.isDrawable=function(){return this.getMap().getPitch()?(console&&console.warn("TileLayer with canvas renderer can't be pitched, use gl renderer ('renderer' : 'gl') instead."),this.clear(),!1):!0},i.clear=function(){this._retireTiles(!0),this.tileCache.reset(),this.tilesInView={},this.tilesLoading={},this._parentTiles=[],this._childTiles=[],r.prototype.clear.call(this)},i._isLoadingTile=function(e){return!!this.tilesLoading[e]},i.clipCanvas=function(e){return r.prototype.clipCanvas.call(this,e)},i._clipByPitch=function(e){var o=this.getMap();if(o.getPitch()<=o.options.maxVisualPitch||!this.layer.options.clipByPitch)return!1;var a=o.getContainerExtent(),s=o.getDevicePixelRatio();return e.save(),e.strokeStyle="rgba(0, 0, 0, 0)",e.beginPath(),e.rect(0,Math.ceil(a.ymin)*s,Math.ceil(a.getWidth())*s,Math.ceil(a.getHeight())*s),e.stroke(),e.clip(),!0},i.loadTileQueue=function(e){for(var o in e)if(e.hasOwnProperty(o)){var a=e[o],s=this.loadTile(a);s.loadTime===void 0&&(this.tilesLoading[a.id]={image:s,current:!0,info:a})}},i.loadTile=function(e){var o=this,a={};if(this.loadTileBitmap){var s=function(u){o.onTileLoad(u,e)};this.loadTileBitmap(e.url,e,s)}else if(this._tileImageWorkerConn&&this.loadTileImage===this.constructor.prototype.loadTileImage)this._fetchImage(a,e);else{var l=this.layer.getTileSize(e.layer);a=new Image,a.width=l.width,a.height=l.height,a.onload=this.onTileLoad.bind(this,a,e),a.onerror=this.onTileError.bind(this,a,e),this.loadTileImage(a,e.url)}return a},i._fetchImage=function(e,o){var a=this;if(e instanceof Image)e.src=o.url;else{var s=o.x,l=o.y,h=Math.abs(s+l)%this._tileImageWorkerConn.workers.length;this._tileImageWorkerConn.fetchImage(o.url,h,function(u,f){u?a.onTileError(e,o,u):km(f,function(c){a.onTileLoad(c,o)})},this.layer.options.fetchOptions||{referrer:document.location.href,headers:{accept:"image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8"}})}},i.loadTileImage=function(e,o){var a=this.layer.options.crossOrigin;return M(a)||(e.crossOrigin=a),Ps(e,[o])},i.abortTileLoading=function(e,o){o&&o.id!==void 0&&this.removeTileLoading(o),e&&(e.onload=Kg,e.onerror=Kg,e.src=Mm)},i.onTileLoad=function(e,o){this.removeTileLoading(o),this._tileQueue.push({tileInfo:o,tileData:e}),this.setToRedraw()},i.removeTileLoading=function(e){delete this.tilesLoading[e.id],this.setToRedraw()},i._consumeTileQueue=function(){for(var e=0,o=this.layer.options.tileLimitPerFrame,a=this._tileQueue;a.length&&(o<=0||e<o);){var s=a.shift(),l=s.tileData,h=s.tileInfo;this.checkTileInQueue(l,h)&&(this.consumeTile(l,h),e++)}},i._computeAvgTileAltitude=function(){var e=0,o=0,a=0;for(var s in this.tilesInView){var l=this.tilesInView[s]&&this.tilesInView[s].info;l&&(e+=l.minAltitude||0,o+=l.maxAltitude||0,a++)}this.avgMinAltitude=e/a,this.avgMaxAltitude=o/a},i.checkTileInQueue=function(){return!0},i.consumeTile=function(e,o){if(this.layer&&this.tilesInView){var a={tile:o,tileImage:e};this.layer.fire("tileload",a),e=a.tileImage,this.resetTileLoadTime(e),this.removeTileLoading(o),this._addTileToCache(o,e),this.setToRedraw()}},i.resetTileLoadTime=function(e){e.loadTime=ve()},i.onTileError=function(e,o){if(this.layer){e.onerrorTick=e.onerrorTick||0;var a=this.layer.options.tileRetryCount;if(a>e.onerrorTick){e.onerrorTick++,this._fetchImage(e,o),this.removeTileLoading(o);return}var s=this.layer.options.errorUrl;if(s)if(e instanceof Image&&e.src!==s){e.src=s,this.removeTileLoading(o);return}else e=new Image,e.src=s;e=e instanceof Image?e:QT,this.abortTileLoading(e,o),e.loadTime=0,this.removeTileLoading(o),this._addTileToCache(o,e),this.setToRedraw(),this.layer.fire("tileerror",{tile:o})}},i.drawTile=function(e,o){if(!(!o||!this.getMap())){var a=e.extent2d,s=e.offset,l=XT.set(a.xmin-s[0],a.ymax-s[1]),h=e.z,u=e.id,f=this.getMap(),c=f.getZoom(),d=this.context,g=f._pointAtResToContainerPoint(l,e.res,0,JT),v=f.getBearing(),y=v||c!==h,p=this.getTileOpacity(o,e),m=d.globalAlpha;p<1&&(d.globalAlpha=p),y||g._round();var _=g.x,w=g.y,C=e.extent2d.xmax-e.extent2d.xmin,x=e.extent2d.ymax-e.extent2d.ymin;if(y){d.save(),d.translate(_,w),v&&d.rotate(-v*Math.PI/180),C+=.5,x+=.5;var T=f._getResolution();if(T!==e.res){var P=e.res/T;d.scale(P,P)}_=w=0}if(j.image(d,o,_,w,C,x),this.layer.options.debug){var S=this.layer.options.debugOutline;d.save(),d.strokeStyle=S,d.fillStyle=S,d.strokeWidth=10,d.font="20px monospace";var E=new k(_,w);j.rectangle(d,E,{width:C,height:x},1,0),j.fillText(d,this.getDebugInfo(u),E._add(32,x-14),S),j.drawCross(d,_+C/2,w+x/2,2,S),d.restore()}y&&d.restore(),d.globalAlpha!==m&&(d.globalAlpha=m),this.setCanvasUpdated()}},i.getDebugInfo=function(e){var o=e.split("_"),a=o.length;return o[a-3]+"/"+o[a-2]+"/"+o[a-1]},i._findChildTiles=function(e){var o=this._getLayerOfTile(e.layer);if(!o||!o.options.background||e.z>this.layer.getMaxZoom())return Bu;var a=this.getMap(),s=[];if(o._isPyramidMode()){for(var l=2,h=e.x*2,u=e.y*2,f=e.z+1,c=[],d=0;d<2;d++)for(var g=0;g<2;g++)c.push(h+d,u+g,f);for(;c.length;){var v=c.pop(),y=c.pop(),p=c.pop(),m=o._getTileId(p,y,v,e.layer),_=v+1<=e.z+l,w=this.tileCache.getAndRemove(m);if(w){if(this.isValidCachedTile(w))s.push(w),this.tileCache.add(m,w);else if(_)for(var C=0;C<2;C++)for(var x=0;x<2;x++)c.push(p*2+C,y*2+x,v+1)}else if(_)for(var T=0;T<2;T++)for(var P=0;P<2;P++)c.push(p*2+T,y*2+P,v+1)}return s}for(var S=1,E=e.res,D=e.extent2d.getMin(),A=e.extent2d.getMax(),I=o._project(a._pointToPrjAtRes(D,E,Qg),Qg),L=o._project(a._pointToPrjAtRes(A,E,qg),qg),O=1;O<S;O++)this._findChildTilesAt(s,I,L,o,e.z+O);return s},i._findChildTilesAt=function(e,o,a,s,l){var h=s.getId(),u=s.getSpatialReference().getResolution(l);if(u)for(var f=s._getTileConfig().getTileIndex(o,u),c=s._getTileConfig().getTileIndex(a,u),d=Math.min(f.idx,c.idx),g=Math.max(f.idx,c.idx),v=Math.min(f.idy,c.idy),y=Math.max(f.idy,c.idy),p,m,_=d;_<g;_++)for(var w=v;w<y;w++)p=s._getTileId(_,w,l,h),m=this.tileCache.getAndRemove(p),m&&this.isValidCachedTile(m)&&(e.push(m),this.tileCache.add(p,m))},i._findParentTile=function(e){var o=this.getMap(),a=this._getLayerOfTile(e.layer);if(!a||!a.options.background)return null;var s=a.getMinZoom(),l=e.z-s;if(a._isPyramidMode()){for(var h=e.z-1;h>=s;h--){var u=e.z-h,f=Math.pow(2,u),c=Math.floor(e.x/f),d=Math.floor(e.y/f),g=a._getTileId(c,d,h,e.layer),v=this.tileCache.getAndRemove(g);if(v&&this.isValidCachedTile(v))return this.tileCache.add(g,v),v}return null}for(var y=a.getSpatialReference(),p=y.getZoomDirection(),m=e.res,_=e.extent2d.getCenter(),w=a._project(o._pointToPrjAtRes(_,m)),C=1;C<=l;C++){var x=e.z-p*C,T=y.getResolution(x);if(T){var P=a._getTileConfig().getTileIndex(w,T),S=a._getTileId(P.x,P.y,x,e.layer),E=this.tileCache.getAndRemove(S);if(E)return this.tileCache.add(S,E),E}}return null},i.isValidCachedTile=function(e){return!!e.image},i.isTileComplete=function(){return!0},i._getLayerOfTile=function(e){return this.layer.getChildLayer?this.layer.getChildLayer(e):this.layer},i._getCachedTile=function(e,o){var a=this.tilesInView,s=this.tileCache.getAndRemove(e);if(s){o||(a[e]=s);var l=this.tilesLoading;if(l&&l[e]){l[e].current=!1;var h=l[e],u=h.image,f=h.info;this.abortTileLoading(u,f),delete l[e]}}else s=a[e];return s&&(s.current=!0,this.tileCache.add(e,s)),s},i._addTileToCache=function(e,o){this.tilesInView[e.id]={image:o,current:!0,info:e}},i.getTileOpacity=function(e,o){var a=this._getTileFadingOpacity(e);if(this.layer.getChildLayer){var s=this.layer.getLayer(o.layer);s&&(a*=s.options.opacity)}return a},i._getTileFadingOpacity=function(e){return!this.layer.options.fadeAnimation||!e.loadTime?1:Math.min(1,(ve()-e.loadTime)/this.layer.options.fadeDuration)},i.onRemove=function(){this.clear(),delete this.tileCache,delete this._tilePlaceHolder,r.prototype.onRemove.call(this)},i._markTiles=function(){var e=0,o=0;if(this.tilesLoading)for(var a in this.tilesLoading)this.tilesLoading[a].current=!1,e++;if(this.tilesInView)for(var s in this.tilesInView)this.tilesInView[s].current=!1,o++;return[e,o]},i._retireTiles=function(e){for(var o in this.tilesLoading){var a=this.tilesLoading[o];(e||!a.current)&&(a.image&&this.abortTileLoading(a.image,a.info),this.deleteTile(a),this.removeTileLoading(a.info))}for(var s in this.tilesInView){var l=this.tilesInView[s];l.current||(delete this.tilesInView[s],this.tileCache.has(s)||this.deleteTile(l))}},i.deleteTile=function(e){!e||!e.image||(e.image.close&&e.image.close(),e.image.onload=null,e.image.onerror=null)},i._generatePlaceHolder=function(e){var o=this.getMap(),a=this.layer.options.placeholder;if(!a||o.getPitch())return null;var s=this.layer.getTileSize(),l=e/o._getResolution(),h=this._tilePlaceHolder=this._tilePlaceHolder||j.createCanvas(1,1,o.CanvasClass);return h.width=s.width*l,h.height=s.height*l,oe(a)?a(h):qT(h),h},t}(Vo);Lt.registerRenderer("canvas",cc);function Kg(){return!1}function qT(r){var t=r.getContext("2d"),i=r.width,n=r.height,e=i/16,o=n/16;t.beginPath();for(var a=0;a<16;a++)t.moveTo(0,a*o),t.lineTo(i,a*o),t.moveTo(a*e,0),t.lineTo(a*e,n);t.strokeStyle="rgba(180, 180, 180, 0.1)",t.lineWidth=1,t.stroke(),t.beginPath();for(var s=[[0,0],[i,0],[0,n],[i,n],[0,0],[0,n],[i,0],[i,n],[0,n/2],[i,n/2],[i/2,0],[i/2,n]],l=1;l<s.length;l+=2)t.moveTo(s[l-1][0],s[l-1][1]),t.lineTo(s[l][0],s[l][1]);t.lineWidth=1*4,t.stroke()}function KT(r,t){return Math.abs(this._tileZoom-r.info.z)-Math.abs(this._tileZoom-t.info.z)}var eS=new k(0,0),tS={properties:{}},Ey=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.isDrawable=function(){return!0},i.needToRedraw=function(){var e=this.getMap();return this._gl()&&!e.getPitch()&&e.isZooming()&&!e.isMoving()&&!e.isRotating()?!0:r.prototype.needToRedraw.call(this)},i.onDrawTileStart=function(e,o){var a=this.gl;a.enable(a.DEPTH_TEST),a.depthFunc(a.LEQUAL),a.enable(a.POLYGON_OFFSET_FILL),a.enable(a.STENCIL_TEST),a.stencilOp(a.KEEP,a.KEEP,a.REPLACE);var s=M(this.layer.options.depthMask)||!!this.layer.options.depthMask;if(a.depthMask(s),o&&o.renderTarget){var l=o.renderTarget.fbo;if(l){var h=o.renderTarget.getFramebuffer(l);a.bindFramebuffer(a.FRAMEBUFFER,h)}}},i.onDrawTileEnd=function(e,o){var a=this.gl;if(o&&o.renderTarget){var s=o.renderTarget.fbo;s&&a.bindFramebuffer(a.FRAMEBUFFER,null)}},i.drawTile=function(e,o,a){if(!(a&&a.sceneFilter&&!a.sceneFilter(tS))){var s=this.getMap();if(!(!e||!s||!o)){var l=e._glScale=e._glScale||e.res/s.getGLRes(),h=e.extent2d.xmax-e.extent2d.xmin,u=e.extent2d.ymax-e.extent2d.ymin;if(e.cache!==!1&&this._bindGLBuffer(o,h,u),!this._gl()){r.prototype.drawTile.call(this,e,o);return}var f=e.extent2d,c=e.offset,d=eS.set(f.xmin-c[0],e.extent2d.ymax-c[1]),g=d.x*l,v=d.y*l,y=this.getTileOpacity(o,e),p=null;this.layer.options.debug&&(p=this.getDebugInfo(e.id));var m=this.gl;m.stencilFunc(m.LEQUAL,Math.abs(this.getCurrentTileZoom()-e.z),255);var _=this.layer.getPolygonOffset(),w=this.drawingCurrentTiles?_:_+1;m.polygonOffset(w,w),this.drawGLImage(o,g,v,h,u,l,y,p),this._getTileFadingOpacity(o)<1?this.setToRedraw():this.setCanvasUpdated()}}},i._bindGLBuffer=function(e,o,a){e.glBuffer||(e.glBuffer=this.bufferTileData(0,0,o,a))},i.loadTileImage=function(e,o){var a=this.layer.options.crossOrigin;e.crossOrigin=a!==null?a:"",e.src=o},i.onCanvasCreate=function(){(!this.canvas.gl||!this.canvas.gl.wrap)&&this.createCanvas2()},i.createContext=function(){r.prototype.createContext.call(this),this.createGLContext()},i.resizeCanvas=function(e){this.canvas&&(r.prototype.resizeCanvas.call(this,e),this.resizeGLCanvas())},i.clearCanvas=function(){this.canvas&&(r.prototype.clearCanvas.call(this),this.clearGLCanvas())},i.getCanvasImage=function(){if(!this._gl()||!this.canvas2)return r.prototype.getCanvasImage.call(this);var e=r.prototype.getCanvasImage.call(this);return e&&(e.image=this.canvas2),e},i._gl=function(){if(this.canvas.gl&&this.canvas.gl.wrap)return!0;var e=this.getMap();return e&&(e.getPitch()||e.getBearing())||this.layer&&!!this.layer.options.fragmentShader},i.deleteTile=function(e){r.prototype.deleteTile.call(this,e),e&&e.image&&this.disposeImage(e.image),delete e.image},i.onRemove=function(){r.prototype.onRemove.call(this),this.removeGLCanvas()},t}(Cy(cc));Lt.registerRenderer("gl",Ey);function ky(r){var t=this.layer.getTileSize(),i=this.canvas.constructor,n=this.getMap(),e=n.getDevicePixelRatio(),o=j.createCanvas(t.width*e,t.height*e,i);o.layer=this.layer;var a=this,s=new k(r.extent2d.xmin,r.extent2d.ymax),l=new ge(n.pointToCoordinate(s),n.pointToCoordinate(s.add(t.width,t.height)),n.getProjection());return this.layer.drawTile(o,{url:r.url,point:s,center:n.pointToCoordinate(s.add(t.width/2,t.height/2)),extent:l,z:r.z,x:r.x,y:r.y},function(h){if(h){a.onTileError(o,r);return}a.onTileLoad(o,r)}),o}var rS=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.loadTile=function(){return ky.apply(this,arguments)},t}(cc),iS=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.loadTile=function(){return ky.apply(this,arguments)},t}(Ey);hc.registerRenderer("canvas",rS);hc.registerRenderer("gl",iS);var nS=typeof Int8Array<"u"?new Int8Array([-1,1,0,-1,-1,0,1,1,0,1,-1,0]):[],oS=`
    attribute vec3 a_position;
    uniform mat4 transform;

    void main()
    {
        gl_Position = transform * vec4(a_position, 1.0);
    }
`,aS=`
    precision mediump float;
    uniform vec3 color;
    void main()
    {
        gl_FragColor = vec4(color, 1.0);
    }
`;(function(){function r(i,n,e){this.gl=i,this.quadVertices=n||nS,this.attributes=["a_position",3,sS(n)],this.debug=e}var t=r.prototype;return t.start=function(){var n=this.gl;n.enable(n.STENCIL_TEST),n.stencilMask(255),n.stencilOp(n.KEEP,n.REPLACE,n.REPLACE),n.depthMask(!1),this._save(),this.buffer||(this._createBuffer(),this._createProgram()),n.useProgram(this.program),n.bindBuffer(n.ARRAY_BUFFER,this.buffer),xy(n,this.program,this.attributes),this.transformLoc||(this.transformLoc=n.getUniformLocation(this.program,"transform")),this.colorLoc||(this.colorLoc=n.getUniformLocation(this.program,"color")),!this.debug&&n.colorMask(!1,!1,!1,!1)},t.end=function(){var n=this.gl;n.depthMask(!0),this._restore(),!this.debug&&n.colorMask(!0,!0,!0,!0)},t.draw=function(n){var e=this.gl;e.uniformMatrix4fv(this.transformLoc,!1,n),e.uniform3fv(this.colorLoc,[Math.random(),Math.random(),Math.random()]),e.drawArrays(e.TRIANGLE_STRIP,0,4)},t.remove=function(){var n=this.gl;return this.buffer&&n.deleteBuffer(this.buffer),this.program&&(n.deleteShader(this.program.fragmentShader),n.deleteShader(this.program.vertexShader),n.deleteProgram(this.program)),delete this.transformLoc,delete this.gl,this},t.stencilMask=function(n){return this.gl.stencilMask(n),this},t.stencilFunc=function(n,e,o){return this.ref=e,this.gl.stencilFunc(n,e,o),this},t.stencilOp=function(n,e,o){return this.gl.stencilOp(n,e,o),this},t.resetFunc=function(){return this.ref=1,this.gl.stencilFunc(this.gl.ALWAYS,1,255),this},t._save=function(){var n=this.gl;this._savedProgram=n.program},t._restore=function(){var n=this.gl;n.program=this._savedProgram,n.program&&n.useProgram(n.program)},t._createBuffer=function(){var n=this.gl;if(this.buffer=n.createBuffer(),!this.buffer)throw new Error("Failed to create the buffer object");n.bindBuffer(n.ARRAY_BUFFER,this.buffer),n.bufferData(n.ARRAY_BUFFER,this.quadVertices,n.STATIC_DRAW)},t._createProgram=function(){var n=wy(this.gl,oS,aS),e=n.program,o=n.vertexShader,a=n.fragmentShader;e.vertexShader=o,e.fragmentShader=a,this.program=e},r})();function sS(r){return r instanceof Float32Array?"FLOAT":r instanceof Int16Array?"SHORT":r instanceof Uint16Array?"UNSIGNED_SHORT":r instanceof Int8Array?"BYTE":r instanceof Uint8Array||r instanceof Uint8ClampedArray?"UNSIGNED_BYTE":"FLOAT"}var lS=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i.checkResources=function(){var e=this._geosToCheck||[];if(!this._resourceChecked&&this.layer._geoList&&pi(e,this.layer._geoList),!he(e))return[];for(var o=[],a={},s=e.length-1;s>=0;s--){var l=e[s],h=l._getExternalResources();if(h.length)if(!this.resources)o.push.apply(o,h);else for(var u=0;u<h.length;u++){var f=h[u][0];!this.resources.isResourceLoaded(h[u])&&!a[f]&&(o.push(h[u]),a[f]=1)}}return this._resourceChecked=!0,delete this._geosToCheck,o},i.render=function(){return this.layer._sortGeometries(),r.prototype.render.apply(this,arguments)},i._addGeoToCheckRes=function(e){e&&(Array.isArray(e)||(e=[e]),this._geosToCheck||(this._geosToCheck=[]),pi(this._geosToCheck,e))},i.onGeometryAdd=function(e){this._addGeoToCheckRes(e),sr(this)},i.onGeometryRemove=function(){sr(this)},i.onGeometrySymbolChange=function(e){this._addGeoToCheckRes(e.target),sr(this)},i.onGeometryShapeChange=function(){sr(this)},i.onGeometryPositionChange=function(){sr(this)},i.onGeometryZIndexChange=function(){sr(this)},i.onGeometryShow=function(){sr(this)},i.onGeometryHide=function(){sr(this)},i.onGeometryPropertiesChange=function(){sr(this)},t}(Vo);function sr(r){r.layer.options.drawImmediate&&r.render(),r.setToRedraw()}var hS=new ee,ba=[],Mh=new ee,uS="center",ev=new al,fS=function(r){F(t,r);function t(){return r.apply(this,arguments)||this}var i=t.prototype;return i._geoIsCollision=function(e,o){if(!e)return!1;var a=e.options.collision;if(!a)return!1;var s=e.getType();if(s==="Point"&&e.getContainerExtent){e.bbox||(e.bbox=[0,0,0,0]);var l=this.layer.options.collisionBufferSize,h=e.getContainerExtent();if(!h)return!1;if(e.bbox[0]=h.xmin-l,e.bbox[1]=h.ymin-l,e.bbox[2]=h.xmax+l,e.bbox[3]=h.ymax+l,o.collides(e.bbox))return!0;o.insertBox(e.bbox)}return!1},i.getImageData=function(){if(!this.layer.options.geometryEvents||!this._lastRenderTime||ve()-this._lastRenderTime<32||!this.context||!this.context.canvas)return null;if(!this._imageData){var e=this.context.canvas,o=e.width,a=e.height;try{this._imageData=this.context.getImageData(0,0,o,a)}catch(s){console.warn(`hit detect failed with tainted canvas, some geometries have external resources in another domain:
`,s)}}return this._imageData},i.clearImageData=function(){this._imageData=null,delete this._imageData,this._lastRenderTime=ve()},i.checkResources=function(){var e=this,o=r.prototype.checkResources.apply(this,arguments),a=this.layer.getStyle();return a&&(Array.isArray(a)||(a=[a]),a.forEach(function(s){for(var l=el(s.symbol,!0),h=0,u=l.length;h<u;h++)e.resources.isResourceLoaded(l[h])||o.push(l[h])})),o},i.needToRedraw=function(){var e=this.getMap();return e.isInteracting()&&this.layer.options.enableAltitude?!0:e.isZooming()&&!e.isRotating()&&!e.getPitch()&&!this._hasPoint&&this.layer.constructor===or?!1:r.prototype.needToRedraw.call(this)},i.draw=function(){if(this.getMap()){if(!this.layer.isVisible()||this.layer.isEmpty()){this.clearCanvas(),this.completeRender();return}this.prepareCanvas(),this.drawGeos(),this.completeRender()}},i.isBlank=function(){return this.context?!this.context.canvas._drawn:!1},i.drawOnInteracting=function(){if(this._geosToDraw){this._updateMapStateCache(),this._updateDisplayExtent();var e=this.getMap(),o=this.layer.getCount(),a=this.mapStateCache.resolution;(e.isZooming()&&e.options.seamlessZoom&&this._drawnRes!==void 0&&a>this._drawnRes*1.5&&this._geosToDraw.length<o||e.isMoving()||e.isInteracting())&&(this.prepareToDraw(),this._batchConversionMarkers(this.mapStateCache.glRes),this._onlyHasPoint||this.forEachGeo(this.checkGeo,this),this._drawnRes=a),this._sortByDistanceToCamera(e.cameraPosition);var s=this.layer.options,l=s.collision,h=s.collisionDelay;if(l){var u=ve();this._lastCollisionTime||(this._lastCollisionTime=u),u-this._lastCollisionTime<=h?this._geosToDraw=this._lastGeosToDraw||this._geosToDraw:(this._collidesGeos(),this._lastCollisionTime=u)}for(var f=0,c=this._geosToDraw.length;f<c;f++){var d=this._geosToDraw[f];if(!d._isCheck&&!d.isVisible()){delete d._cPoint,delete d._inCurrentView;continue}d._paint(this._displayExtent),this._geosToDraw[f]._cPoint=void 0,this._geosToDraw[f]._inCurrentView=void 0}this.clearImageData(),this._lastGeosToDraw=this._geosToDraw}},i.show=function(){this.layer.forEach(function(e){e._repaint()}),r.prototype.show.apply(this,arguments)},i.forEachGeo=function(e,o){this.layer.forEach(e,o)},i.drawGeos=function(){this._updateMapStateCache(),this._drawnRes=this.mapStateCache.resolution,this._updateDisplayExtent(),this.prepareToDraw(),this._batchConversionMarkers(this.mapStateCache.glRes),this._onlyHasPoint||this.forEachGeo(this.checkGeo,this),this._sortByDistanceToCamera(this.getMap().cameraPosition),this._collidesGeos();for(var e=0,o=this._geosToDraw.length;e<o;e++)this._geosToDraw[e]._paint(),this._geosToDraw[e]._cPoint=void 0,this._geosToDraw[e]._inCurrentView=void 0;this.clearImageData(),this._lastGeosToDraw=this._geosToDraw,this._setDrawGeosDrawTime()},i.prepareToDraw=function(){return this.layer._drawTime=ve(),this._hasPoint=!1,this._geosToDraw=[],this},i._setDrawGeosDrawTime=function(){for(var e=this.layer._drawTime,o=0,a=this._geosToDraw.length;o<a;o++){var s=this._geosToDraw[o],l=s._painter;l&&l._setDrawTime&&l._setDrawTime(e)}return this},i.checkGeo=function(e){if(e.type==="Point"&&this._onlyHasPoint!==void 0){e._inCurrentView&&(this._hasPoint=!0,e._isCheck=!0,this._geosToDraw.push(e));return}if(e._isCheck=!1,!(!e||!e.isVisible()||!e.getMap()||!e.getLayer()||!e.getLayer().isCanvasRender())){var o=e._getPainter(),a=!0;if(e._inCurrentView)a=!0;else if(e._inCurrentView===!1)a=!1;else{var s=o.get2DExtent(this.resources,hS);(!s||!s.intersects(this._displayExtent))&&(a=!1)}a&&(o.hasPoint()&&(this._hasPoint=!0),e._isCheck=!0,this._geosToDraw.push(e))}},i._collidesGeos=function(){var e=this.layer.options.collision;if(!e)return this;var o=this.layer.options.collisionScope,a=this.layer.getMap(),s=o==="map"?a.getCollisionIndex():ev;s===ev&&s.clear();var l=this._geosToDraw;this._geosToDraw=[];for(var h=0,u=l.length;h<u;h++)this._geoIsCollision(l[h],s)||this._geosToDraw.push(l[h]);return this},i.onZoomEnd=function(){delete this.canvasExtent2D,r.prototype.onZoomEnd.apply(this,arguments)},i.onRemove=function(){this.forEachGeo(function(e){e.onHide()}),delete this._geosToDraw},i.onGeometryPropertiesChange=function(e){e&&this.layer._styleGeometry(e.target),r.prototype.onGeometryPropertiesChange.call(this,e)},i._updateDisplayExtent=function(){var e=this.canvasExtent2D;if(this._maskExtent){if(!this._maskExtent.intersects(e)){this.completeRender();return}e=e.intersection(this._maskExtent)}this._displayExtent=e},i.identifyAtPoint=function(e,o){o===void 0&&(o={});var a=this._geosToDraw;return a?this.layer._hitGeos(a,e,o):[]},i._updateMapStateCache=function(){var e=this.getMap(),o=e._pointToContainerPoint(this.southWest)._add(0,-e.height),a=e.getResolution(),s=e.getPitch(),l=e.getBearing(),h=e.getGLScale(),u=e.getGLRes(),f=e.getContainerExtent(),c=e._get2DExtent(),d=e._get2DExtentAtRes(u);return this.mapStateCache={resolution:a,pitch:s,bearing:l,glScale:h,glRes:u,_2DExtent:c,glExtent:d,containerExtent:f,offset:o},this},i._batchConversionMarkers=function(e){if(this._onlyHasPoint=void 0,!this._constructorIsThis())return[];var o=[],a=[],s=[],l={},h=this.layer,u=h.options,f=h.getAltitude?h.getAltitude():0,c=h.isCanvasRender();this._onlyHasPoint=!0;for(var d=0,g=0,v=this.layer._geoList.length;g<v;g++){var y=this.layer._geoList[g],p=y.getType();if(p==="Point"){var m=y._painter;m||(m=y._getPainter());var _=m.getRenderPoints(uS)[0][0],w=u.enableAltitude?y._getAltitude():f;l[w]===void 0&&(l[w]=m.getAltitude()),o[d]=_,s[d]=l[w],a[d]=y,d++}else this._onlyHasPoint=!1}if(d===0)return[];var C=this.getMap(),x=Ts(o,"_pt");x=C._pointsAtResToContainerPoints(o,e,s,x);for(var T=C.getContainerExtent(),P=T.xmax,S=T.ymax,E=T.xmin,D=T.ymin,A={},I=0,L=a.length;I<L;I++){var O=a[I];if(O._cPoint=x[I],!O._cPoint){O._inCurrentView=!1;continue}var H=x[I],B=H.x,R=H.y;if(O._inCurrentView=B>=E&&R>=D&&B<=P&&R<=S,!O._inCurrentView){var b=O.getSymbolHash(),N=void 0;b?N=A[b]=A[b]||O._painter.getFixedExtent():N=O._painter.getFixedExtent(),Mh.set(N.xmin,N.ymin,N.xmax,N.ymax),Mh._add(x[I]),O._inCurrentView=Mh.intersects(T)}O._inCurrentView&&((!O.isVisible()||!c)&&(O._inCurrentView=!1),this._onlyHasPoint&&O._inCurrentView&&(this._hasPoint=!0,O._isCheck=!0,this._geosToDraw.push(O)))}return x},i._sortByDistanceToCamera=function(e){if(this.layer.options.sortByDistanceToCamera&&this._geosToDraw.length){var o=this.getMap(),a=o.distanceToPoint(1e3,0,o.getGLScale()).x,s=a/1e3,l="center";this._geosToDraw.sort(function(h,u){var f=h.getType(),c=u.getType();if(f!=="Point"||c!=="Point")return 0;var d=h._painter,g=u._painter;if(!d||!g)return 0;var v=d.getRenderPoints(l)[0][0],y=g.getRenderPoints(l)[0][0],p=d.getAltitude()*s,m=g.getAltitude()*s;kt(ba,v.x,v.y,p);var _=Fu(ba,e);kt(ba,y.x,y.y,m);var w=Fu(ba,e);return w-_})}},i._constructorIsThis=function(){return this.constructor===t},t}(lS);or.registerRenderer("canvas",fS);var cS=function(r){F(t,r);function t(n){var e;return e=r.call(this)||this,e.map=n,e._handlerQueue=[],e._thisDocVisibilitychange=e._onDocVisibilitychange.bind(Ie(Ie(e))),e._thisDocDragStart=e._onDocDragStart.bind(Ie(Ie(e))),e._thisDocDragEnd=e._onDocDragEnd.bind(Ie(Ie(e))),e}var i=t.prototype;return i.callInNextFrame=function(e){this._handlerQueue.push(e)},i.executeFrameCallbacks=function(){var e=this._handlerQueue;this._handlerQueue=[];for(var o=0,a=e.length;o<a;o++)e[o]()},i.offsetPlatform=function(e,o){if(!this.map._panels.front)return this;if(!o&&e.x===0&&e.y===0)return this;var a=this.map._panels,s=this._frontCount=a.back.layerDOM.childElementCount,l=this._backCount=a.front.layerDOM.childElementCount,h=this._uiCount=a.front.uiDOM.childElementCount;if(s||l||h){var u=this.map.offsetPlatform();e?u=u.add(e)._round():u=u.round(),l&&wa(a.back,u),(s||h)&&wa(a.front,u)}return this},i.domChanged=function(){var e=this.map._panels;if(!e.front)return!1;var o=e.back.layerDOM.childElementCount;if(this._frontCount===void 0||this._frontCount!==o)return!0;var a=e.front.layerDOM.childElementCount;if(this._backCount===void 0||this._backCount!==a)return!0;var s=e.front.uiDOM.childElementCount;return this._uiCount===void 0||this._uiCount!==s},i.resetContainer=function(){if(this.map&&(this.map._resetMapViewPoint(),this.map._panels.front)){var e=new k(0,0);wa(this.map._panels.back,e),wa(this.map._panels.front,e)}},i.onZoomEnd=function(){this.resetContainer()},i.onLoad=function(){this._frameLoop()},i._onDocVisibilitychange=function(){document.visibilityState==="visible"&&this.setToRedraw()},i._getWrapPanel=function(){if(!this.map)return null;var e=this.map.getPanels();return e&&e.mapWrapper},i._onDocDragStart=function(){var e=this._getWrapPanel();e&&(e.style.overflow="visible")},i._onDocDragEnd=function(){var e=this._getWrapPanel();e&&(e.style.overflow="hidden")},i._containerIsOffscreen=function(){var e=this.map.getContainer();if(!e||!e.style||e.style.display==="none")return!0;var o=Math.min(e.clientWidth,e.clientHeight);return o<=0},t}(zt),dS=function(r){F(t,r);function t(n){var e;return e=r.call(this,n)||this,e._containerIsCanvas=!!n._containerDOM.getContext,e._registerEvents(),e._loopTime=0,e._resizeEventList=[],e._resizeTime=-1/0,e}var i=t.prototype;return i.load=function(){this.initContainer()},i.renderFrame=function(e){var o=this.map;if(!o||!o.options.renderable)return!1;if(this._handleResizeEventList(e),o.options.stopRenderOnOffscreen&&this._containerIsOffscreen())return!0;this._updateDomPosition(e),delete this._isViewChanged,o._fireEvent("framestart"),this.updateMapDOM(),o.clearCollisionIndex();var a=this._getAllLayerToRender();this.drawLayers(a,e);var s=this.drawLayerCanvas(a);return s&&(this.drawTops(),this._drawCenterCross(),o.options.debugSky&&this._debugSky()),this._needClear=!1,o._fireEvent("frameend"),this._recordView(),this._mapview=this._getMapView(),delete this._spatialRefChanged,this._fireLayerLoadEvents(),this.executeFrameCallbacks(),this._canvasUpdated=!1,o.uiCollides(),!0},i.updateMapDOM=function(){var e=this.map;if(!e.isZooming()){var o=e._getViewPointFrameOffset();o?e.offsetPlatform(o):this.domChanged()&&this.offsetPlatform(null,!0)}},i.drawLayers=function(e,o){for(var a=this.map,s=a.isInteracting(),l=[],h=[],u=a.options.fpsOnInteracting||0,f=u===0?0:1e3/u,c=this.map.options.layerCanvasLimitOnInteracting,d=e.length,g=a.getBaseLayer(),v=0,y=0;y<d;y++){var p=e[y];if(p.isVisible()){var m=p.isCanvasRender();m&&l.push(p.getId());var _=p._getRenderer();if(_){var w=this._checkLayerRedraw(p);m&&_.isCanvasUpdated()&&(w||h.push(p.getId()),this.setLayerCanvasUpdated());var C=_.__zoomTransformMatrix;if(delete _.__zoomTransformMatrix,!w){m&&s&&(a.isZooming()&&!a.getPitch()?(_.prepareRender(),_.__zoomTransformMatrix=this._zoomMatrix):(a.getPitch()||a.isRotating())&&_.clearCanvas());continue}if(s&&m){if(c>0&&d-1-y>c&&p!==g){p._getRenderer().clearCanvas();continue}v+=this._drawCanvasLayerOnInteracting(p,v,f,o)}else s&&_.drawOnInteracting?(_.prepareRender&&_.prepareRender(),_.checkAndDraw?_.checkAndDraw(_.drawOnInteracting,this._eventParam,o):_.drawOnInteracting(this._eventParam,o)):(_.render(o),m&&C&&_.isLoadingResource()&&(_.__zoomTransformMatrix=C));m&&(h.push(p.getId()),this.setLayerCanvasUpdated())}}}var x=this._canvasIds||[],T=this._updatedIds||[];if(this._canvasIds=l,this._updatedIds=h,!this.isLayerCanvasUpdated()){var P="---";(x.join(P)!==l.join(P)||T.join(P)!==h.join(P))&&this.setLayerCanvasUpdated()}},i._checkLayerRedraw=function(e){if(this.isSpatialReferenceChanged())return!0;var o=this.map,a=e._getRenderer();return e.isCanvasRender()?a.testIfNeedRedraw():a.needToRedraw&&a.needToRedraw()?!0:o.isInteracting()||this.isViewChanged()},i._drawCanvasLayerOnInteracting=function(e,o,a,s){var l=this.map,h=e._getRenderer(),u=h.getDrawTime(),f=a===0||a>0&&o+u<=a;if(h.mustRenderOnInteracting&&h.mustRenderOnInteracting())h.render(s);else{if(h.drawOnInteracting&&(e===l.getBaseLayer()||f||l.isZooming()&&e.options.forceRenderOnZooming||l.isMoving()&&e.options.forceRenderOnMoving||l.isRotating()&&e.options.forceRenderOnRotating))return h.prepareRender(),h.prepareCanvas(),h.checkAndDraw?h.checkAndDraw(h.drawOnInteracting,this._eventParam,s):h.drawOnInteracting(this._eventParam,s),u;l.isZooming()&&!l.getPitch()&&!l.isRotating()?(h.prepareRender(),h.__zoomTransformMatrix=this._zoomMatrix):(l.getPitch()||l.isRotating())&&h.clearCanvas()}return h.drawOnInteracting&&!f&&h.onSkipDrawOnInteracting(this._eventParam,s),0},i._fireLayerLoadEvents=function(){if(this._updatedIds&&this._updatedIds.length>0){var e=this.map;this._updatedIds.reverse().forEach(function(o){var a=e.getLayer(o);if(a){var s=a._getRenderer();!s||!s.isRenderComplete()||a.fire("layerload")}})}},i.isLayerCanvasUpdated=function(){return this._canvasUpdated},i.setLayerCanvasUpdated=function(){this._canvasUpdated=!0},i.drawLayerCanvas=function(e){var o=this.map;if(!o||!this.isLayerCanvasUpdated()&&!this.isViewChanged()&&this._needClear===!1)return!1;this.canvas||this.createCanvas(),o._fireEvent("renderstart",{context:this.context}),this._updateCanvasSize()||this.clearCanvas();for(var a=o.isInteracting(),s=o.options.layerCanvasLimitOnInteracting,l=e.length,h,u=[],f=0;f<l;f++)if(!(!e[f].isVisible()||!e[f].isCanvasRender())){var c=e[f]._getRenderer();if(c){var d=this._getLayerImage(e[f]);d&&d.image&&(e[f]===o.getBaseLayer()?h=[e[f],d]:u.push([e[f],d]))}}var g=this.canvas.width,v=this.canvas.height;h&&(this._drawLayerCanvasImage(h[0],h[1],g,v),this._drawFog()),l=u.length;for(var y=a&&s>=0&&l>s?l-s:0,p=y;p<l;p++)this._drawLayerCanvasImage(u[p][0],u[p][1],g,v);return o._fireEvent("renderend",{context:this.context}),!0},i.setToRedraw=function(){var e=this._getAllLayerToRender();this._needClear=!0;for(var o=0,a=e.length;o<a;o++){var s=e[o].getRenderer();s&&s.canvas&&s.setToRedraw&&s.setToRedraw()}},i.updateMapSize=function(e){if(!(!e||this._containerIsCanvas)){var o=e.width+"px",a=e.height+"px",s=this.map._panels;s.mapWrapper.style.width=o,s.mapWrapper.style.height=a,this._updateCanvasSize()}},i.getMainPanel=function(){return this.map?this._containerIsCanvas?this.map._containerDOM:this.map._panels?this.map._panels.mapWrapper:null:null},i.toDataURL=function(e,o){return this.canvas?this.canvas.toDataURL(e,o):null},i.remove=function(){K.webgl&&typeof document<"u"&&(dr(document,"visibilitychange",this._thisDocVisibilitychange),dr(document,"dragstart",this._thisDocDragStart),dr(document,"dragend",this._thisDocDragEnd)),this._resizeInterval&&clearInterval(this._resizeInterval),this._resizeObserver&&this._resizeObserver.disconnect(),delete this.context,delete this.canvas,delete this.map,delete this._spatialRefChanged,this._cancelFrameLoop()},i.hitDetect=function(e){var o=this.map;if(!(!o||!o.options.hitDetect||o.isInteracting())){var a=o._getLayers(),s="default",l=o.options.hitDetectLimit||0,h=0;e&&e._round&&e._round();for(var u=a.length-1;u>=0;u--){var f=a[u];if(!(!f.options.hitDetect||f.isEmpty&&f.isEmpty())){var c=f._getRenderer();if(!(!c||!c.hitDetect)&&!(c.isBlank&&c.isBlank())){if(f.options.cursor!=="default"&&c.hitDetect(e)){s=f.options.cursor||"pointer";break}if(h++,l>0&&h>l)break}}}o._trySetCursor(s)}},i._getLayerImage=function(e){var o=e._getRenderer();return o.getCanvasImage?o.getCanvasImage():null},i.initContainer=function(){var e=this.map._panels;function o(w,C,x,T){var P=Y("div",C);return x&&(P.style.cssText=x),e[w]=P,T||L1(P),P}var a=this.map._containerDOM;if(!this._containerIsCanvas){a.innerHTML="";var s="position:absolute;top:0px;left:0px;",l=o("mapWrapper","maptalks-wrapper","position:absolute;overflow:hidden;",!0),h=o("allLayers","maptalks-all-layers",s+"padding:0px;margin:0px;z-index:0;overflow:visible;",!0),u=o("backStatic","maptalks-back-static",s+"z-index:0;",!0),f=o("back","maptalks-back",s+"z-index:1;"),c=o("backLayer","maptalks-back-layer",s),d=o("canvasContainer","maptalks-canvas-layer",s+"border:none;z-index:2;"),g=o("frontStatic","maptalks-front-static",s+"z-index:3;",!0),v=o("front","maptalks-front",s+"z-index:4;",!0),y=o("frontLayer","maptalks-front-layer",s+"z-index:0;"),p=o("ui","maptalks-ui",s+"border:none;z-index:1;",!0),m=o("control","maptalks-control","z-index:1",!0);a.appendChild(l),h.appendChild(u),f.appendChild(c),f.layerDOM=c,h.appendChild(f),h.appendChild(d),v.appendChild(y),v.layerDOM=y,v.uiDOM=p,h.appendChild(g),h.appendChild(v),v.appendChild(p),l.appendChild(h),l.appendChild(m),this.createCanvas(),this.resetContainer();var _=this.map._getContainerDomSize();this.updateMapSize(_)}},i.isViewChanged=function(){if(this._isViewChanged!==void 0)return this._isViewChanged;var e=this._mapview,o=this._getMapView();return this._isViewChanged=!e||!Mu(e,o),this._isViewChanged},i._recordView=function(){var e=this.map;!e._onViewChange||e.isInteracting()||e.isAnimating()||Mu(e.getView(),e._getCurrentView())||e._onViewChange(e.getView())},i.isSpatialReferenceChanged=function(){return this._spatialRefChanged},i._getMapView=function(){var e=this.map,o=e._getPrjCenter();return{x:o.x,y:o.y,zoom:e.getZoom(),pitch:e.getPitch(),bearing:e.getBearing(),width:e.width,height:e.height}},i._frameLoop=function(e){var o=this;if(!this.map){this._cancelFrameLoop();return}e=e||0,this._frameTimestamp=e,this._resizeCount=0,this.renderFrame(e),this._animationFrame=_r(function(a){o._frameLoop(a)})},i._cancelFrameLoop=function(){this._animationFrame&&Cs(this._animationFrame)},i._drawLayerCanvasImage=function(e,o,a,s){var l=this.context,h=o.point.round(),u=this.map.getDevicePixelRatio();u!==1&&h._multi(u);var f=o.image,c=f.width,d=f.height;if(!(h.x+c<=0||h.y+d<=0)){var g=e.options.opacity;if(V(g)||(g=1),!(g<=0)){var v=o.opacity;if(V(v)||(v=1),!(v<=0)){var y=l.globalAlpha;g<1&&(l.globalAlpha*=g),v<1&&(l.globalAlpha*=v),e.options.cssFilter&&(l.filter=e.options.cssFilter);var p=e.getRenderer(),m=p.__zoomTransformMatrix,_=p.clipCanvas(this.context);m&&(l.save(),l.setTransform.apply(l,m)),l.drawImage(f,0,0,c,d,h.x,h.y,a,s),m&&l.restore(),_&&l.restore(),l.filter!=="none"&&(l.filter="none"),l.globalAlpha=y}}}},i._drawCenterCross=function(){var e=this.map.options.centerCross;if(e){var o=this.context,a=new k(this.canvas.width/2,this.canvas.height/2);oe(e)?e(o,a):j.drawCross(this.context,a.x,a.y,2,"#f00")}},i._drawContainerExtent=function(){var e=this.map.options.cascadePitches,o=this.map.height-this.map._getVisualHeight(e[0]),a=this.map.height-this.map._getVisualHeight(e[1]),s=this.map.getContainerExtent(),l=this.context;l.beginPath(),l.moveTo(0,s.ymin),l.lineTo(s.xmax,s.ymin),l.stroke(),l.beginPath(),l.moveTo(0,o),l.lineTo(s.xmax,o),l.stroke(),l.beginPath(),l.moveTo(0,a),l.lineTo(s.xmax,a),l.stroke()},i._drawFog=function(){var e=this.map;if(!(e.getPitch()<=e.options.maxVisualPitch||!e.options.fog)){var o=30,a=e.getDevicePixelRatio(),s=this.context,l=e.getContainerExtent(),h=(e.height-e._getVisualHeight(75))*a;h<0&&(h=0);var u=l.ymin*a,f=Math.ceil(u-h),c=e.options.fogColor.join(),d=s.createLinearGradient(0,h,0,u+o),g=1-o/(f+o);d.addColorStop(0,"rgba("+c+", 0)"),d.addColorStop(.3,"rgba("+c+", 0.3)"),d.addColorStop(g,"rgba("+c+", 1)"),d.addColorStop(1,"rgba("+c+", 0)"),s.beginPath(),s.fillStyle=d,s.fillRect(0,h,Math.ceil(l.getWidth())*a,Math.ceil(f+o))}},i._debugSky=function(){var e=this.map;if(!e)return this;var o=e.getContainerExtent().ymin;if(o<=0)return this;var a=this.context;return a.strokeStyle="red",a.strokeRect(0,0,e.width,o),this},i._getAllLayerToRender=function(){return this.map._getLayers()},i.clearCanvas=function(){this.canvas&&j.clearRect(this.context,0,0,this.canvas.width,this.canvas.height)},i._updateCanvasSize=function(){if(!this.canvas||this._containerIsCanvas)return!1;var e=this.map,o=e.getSize(),a=this.canvas,s=e.getDevicePixelRatio(),l=Am(o,s),h=l.width,u=l.height,f=l.cssWidth,c=l.cssHeight;return a.style&&(a.style.width!==f||a.style.height!==c)&&(a.style.width=f,a.style.height=c),h===a.width&&u===a.height?!1:(a.height=u,a.width=h,this.topLayer.width=a.width,this.topLayer.height=a.height,!0)},i.createCanvas=function(){this.topLayer=Y("canvas"),this.topCtx=this.topLayer.getContext("2d"),this._containerIsCanvas?this.canvas=this.map._containerDOM:(this.canvas=Y("canvas"),this._updateCanvasSize(),this.map._panels.canvasContainer.appendChild(this.canvas)),this.context=this.canvas.getContext("2d")},i._updateDomPosition=function(e){this._checkPositionTime===void 0&&(this._checkPositionTime=-1/0);var o=Math.abs(e-this._checkPositionTime);return o>=500&&(rl(this.map._containerDOM),this._checkPositionTime=Math.min(e,this._checkPositionTime)),this},i._handleResizeEventList=function(e){if(!this._resizeEventList)return this;var o=this._resizeEventList.length;if(o===0)return this;if(this._resizeTime&&e-this._resizeTime<60)return this;var a=this._resizeEventList[o-1].contentRect;return this.map._containerDomContentRect=a,this._resizeEventList=[],this._checkSize(a),this._resizeCount=this._resizeCount||0,this.renderFrame((this._frameTimestamp||0)+ ++this._resizeCount/100),this._resizeTime=e,this},i._checkSize=function(){this.map&&this.map.checkSize()},i._setCheckSizeInterval=function(e){var o=this;K.resizeObserver?(this._resizeObserver&&this._resizeObserver.disconnect(),this.map&&(this._resizeObserver=new ResizeObserver(function(a){!o.map||o.map.isRemoved()?o._resizeObserver.disconnect():a.length&&(o._resizeEventList=o._resizeEventList||[],o._resizeEventList.push(a[0]))}),this._resizeObserver.observe(this.map._containerDOM))):(clearInterval(this._resizeInterval),this._checkSizeInterval=e,this._resizeInterval=setInterval(function(){!o.map||o.map.isRemoved()?clearInterval(o._resizeInterval):o._checkSize()},this._checkSizeInterval))},i._registerEvents=function(){var e=this,o=this.map;o.options.checkSize&&!Fe&&typeof window<"u"&&this._setCheckSizeInterval(o.options.checkSizeInterval),K.mobile||o.on("_mousemove",this._onMapMouseMove,this),o.on("_dragrotatestart _dragrotating _dragrotateend _movestart _moving _moveend _zoomstart",function(a){e._eventParam=a}),o.on("_zooming",function(a){o.getPitch()||(e._zoomMatrix=a.matrix.container),e._eventParam=a}),o.on("_zoomend",function(a){e._eventParam=a,delete e._zoomMatrix}),o.on("_spatialreferencechange",function(){e._spatialRefChanged=!0}),K.webgl&&typeof document<"u"&&(ir(document,"visibilitychange",this._thisDocVisibilitychange,this),ir(document,"dragstart",this._thisDocDragStart,this),ir(document,"dragend",this._thisDocDragEnd,this)),K.addDPRListening&&K.addDPRListening(this.map)},i._onMapMouseMove=function(e){var o=this,a=this.map;a.isInteracting()||!a.options.hitDetect||(this._hitDetectFrame&&Cs(this._hitDetectFrame),this._hitDetectFrame=_r(function(){o.hitDetect(e.containerPoint)}))},i._getCanvasLayers=function(){return this.map._getLayers(function(e){return e.isCanvasRender()})},i.addTopElement=function(e){this._tops||(this._tops=[]),this._tops.push(e)},i.removeTopElement=function(e){if(this._tops){var o=this._tops.indexOf(e);o>=0&&this._tops.splice(o,1)}},i.getTopElements=function(){return this._tops||[]},i.drawTops=function(){this.topCtx.clearRect(0,0,this.topLayer.width,this.topLayer.height),this.map.fire("drawtopstart"),this.map.fire("drawtops");for(var e=this.getTopElements(),o=!1,a=0;a<e.length;a++)e[a].render(this.topCtx)&&(o=!0);o&&this.context.drawImage(this.topLayer,0,0),this.map.fire("drawtopsend")},t}(cS);Q.registerRenderer("canvas",dS);Q.mergeOptions({fog:!1,fogColor:[233,233,233]});var fl={_getRenderPoints:function(){return[[this._getCenter2DPoint(this.getMap().getGLRes())],null]}};Se.include(fl);wr.include(fl);nr.include(fl);En.include(fl);hn.include({_getRenderPoints:function(t){var i=this.getMap(),n=i.getGLRes();if(t==="vertex"){for(var e=this._trimRing(this.getShell()),o=[],a=0,s=e.length;a<s;a++)o.push(i.coordToPointAtRes(e[a],n));return[o,null]}else{var l=i.coordToPointAtRes(this.getCenter(),n);return[[l],null]}}});var Ry={_getRenderPoints:function(t){var i=this.getMap(),n=i.getGLRes(),e,o=null;if(t==="point")e=this._getPath2DPoints(this._getPrjCoordinates(),!1,n),e&&e.length>0&&Array.isArray(e[0])&&(e=e[0].concat(e[1]));else if(t==="vertex")if(e=this._getPath2DPoints(this._getPrjCoordinates(),!1,n),o=[],e&&e.length>0&&Array.isArray(e[0])){for(var a=0,s=e.length;a<s;a++)for(var l=0,h=e[a].length;l<h;l++)l===0?o.push([e[a][l],e[a][l+1]]):o.push([e[a][l-1],e[a][l]]);e=e[0].concat(e[1])}else for(var u=0,f=e.length;u<f;u++)u===0?o.push([e[u],e[u+1]]):o.push([e[u-1],e[u]]);else if(t==="line"){e=[],o=[];var c=this._getPath2DPoints(this._getPrjCoordinates(),!1,n),d=c.length>0&&Array.isArray(c[0]);if(d)for(var g,v=1,y=c.length;v<y;v++){g=c[v],this instanceof Oe&&g.length>0&&!g[0].equals(g[g.length-1])&&g.push(g[0]);for(var p=1,m=g.length;p<m;p++)e.push(g[p].add(g[p-1])._multi(.5)),o.push([g[p-1],g[p]])}else{this instanceof Oe&&c.length>0&&!c[0].equals(c[c.length-1])&&c.push(c[0]);for(var _=1,w=c.length;_<w;_++)e.push(c[_].add(c[_-1])._multi(.5)),o.push([c[_-1],c[_]])}}else if(t==="vertex-first"){var C=this._getPrjCoordinates(),x=C.length,T=x?i._prjToPointAtRes(C[0],n):null;e=x?[T]:[],o=x?[[T,C[1]?i._prjToPointAtRes(C[1],n):T]]:[]}else if(t==="vertex-last"){var P=this._getPrjCoordinates(),S=P.length,E=S?i._prjToPointAtRes(P[S-1],n):null;e=S?[E]:[];var D=S>1?S-2:S-1;o=S?[[P[D]?i._prjToPointAtRes(P[D],n):E,E]]:[]}else{var A=this.getCenter();if(!A)e=[];else{var I=this._getProjection().project(A);e=[i._prjToPointAtRes(I,n)]}}return[e,o]}};xe.include(Ry);Oe.include(Ry);var Oi={within:!1,center:[0,0]};function Ay(r){if(!r||!r._containerBbox)Oi.within=!1;else{Oi.within=!1;var t=r._containerBbox,i=t.minx,n=t.miny,e=t.maxx,o=t.maxy,a=Math.abs(e-i),s=Math.abs(o-n);a<=1&&s<=1&&(Oi.within=!0,Oi.center[0]=(i+e)/2,Oi.center[1]=(n+o)/2),delete r._containerBbox}return Oi}ae.include({_redrawWhenPitch:function(){return!1},_redrawWhenRotate:function(){return!1},_getRenderBBOX:function(t,i){return t.isHitTesting?null:(Io(nn),o_(i,nn),nn)}});var dc={_redrawWhenPitch:function(){return!0},_redrawWhenRotate:function(){return this instanceof wr||this instanceof En},_paintAsPath:function(){var t=this.getMap(),i=this._getAltitude();return i>0||t.getPitch()||this instanceof wr&&t.getBearing()},_getPaintParams:function(){var t=this.getMap();if(this._paintAsPath())return Oe.prototype._getPaintParams.call(this,!0);var i=this._getPrjCoordinates(),n=t._prjToPointAtRes(i,t.getGLRes()),e=this._getRenderSize(n);return[n].concat(e)},_paintOn:function(){return this._paintAsPath()?j.polygon.apply(j,arguments):j.ellipse.apply(j,arguments)},_getRenderSize:function(t){var i=this.getMap(),n=i.getGLRes(),e=this._getPrjExtent(),o=i._prjToPointAtRes(e.getMin(),n),a=i._prjToPointAtRes(e.getMax(),n);return[Math.abs(a.x-o.x)/2,Math.abs(a.y-t.y),Math.abs(t.y-o.y)]}};wr.include(dc);nr.include(dc);hn.include({_getPaintParams:function(){var t=this.getMap(),i=this._getPrjShell(),n=this._getPath2DPoints(i,!1,t.getGLRes());return[n]},_paintOn:j.polygon});En.include(dc,{_redrawWhenPitch:function(){return!0},_getPaintParams:function(){if(this._paintAsPath())return Oe.prototype._getPaintParams.call(this,!0);var t=this.getMap(),i=t._prjToPointAtRes(this._getPrjCoordinates(),t.getGLRes()),n=this._getRenderSize(i);return[i,n[0],[this.getStartAngle(),this.getEndAngle()]]},_paintOn:function(){if(this._paintAsPath())return j.polygon.apply(j,arguments);var t=this.getMap().getBearing(),i=arguments;return t&&(i[3]=i[3].slice(0),i[3][0]+=t,i[3][1]+=t),j.sector.apply(j,i)}});hl.include({_paintAsPath:function(){return!0}});xe.include({arrowStyles:{classic:[3,4]},_getArrowShape:function(t,i,n,e,o){if(!t||!i||t.equals(i))return null;o||(o=0);var a=n*e[0],s=n*e[1]+o,l=a/2+o,h;i.nextCtrlPoint||i.prevCtrlPoint?i.prevCtrlPoint?h=i.sub(new k(i.prevCtrlPoint)):h=i.sub(new k(i.nextCtrlPoint)):h=i.sub(t),h._unit();var u=i.sub(h.multi(s));h._perp();var f=u.add(h.multi(l));h._multi(-1);var c=u.add(h.multi(l));return[f,i,c,f]},_getPaintParams:function(){var t=this._getPrjCoordinates(),i=this._getPath2DPoints(t,!1,this.getMap().getGLRes());return[i]},_paintOn:function(t,i,n,e,o){var a=Ay(this._painter);return a.within?j.pixelRect(t,a.center,n,e):this.options.smoothness?j.paintSmoothLine(t,i,n,this.options.smoothness,!1,this._animIdx,this._animTailRatio):j.path(t,i,n,null,o),this._paintArrow(t,i,n),this._getRenderBBOX(t,i)},_getArrowPlacement:function(){return this.options.arrowPlacement},_getArrowStyle:function(){var t=this.options.arrowStyle;return t?Array.isArray(t)?t:this.arrowStyles[t]:null},_getArrows:function(t,i,n){var e=this._getArrowStyle();if(!e||t.length<2)return[];for(var o=t.length>0&&Array.isArray(t[0]),a=o?t:[t],s=this._getArrowPlacement(),l=[],h=this.getMap(),u=h.coordToContainerPoint(this.getFirstCoordinate()),f=h.coordToContainerPoint(this.getLastCoordinate()),c=a.length-1;c>=0;c--){if(s==="vertex-first"||s==="vertex-firstlast"&&a[c][0].closeTo(u,.01)){var d=this._getArrowShape(a[c][1],a[c][0],i,e,n);d&&l.push(d)}if(s==="vertex-last"||s==="vertex-firstlast"&&a[c][a[c].length-1].closeTo(f,.01)){var g=this._getArrowShape(a[c][a[c].length-2],a[c][a[c].length-1],i,e,n);g&&l.push(g)}else s==="point"&&this._getArrowPoints(l,a[c],i,e,n)}return l},_getArrowPoints:function(t,i,n,e,o){for(var a=0,s=i.length-1;a<s;a++){var l=this._getArrowShape(i[a],i[a+1],n,e,o);l&&t.push(l)}},_paintArrow:function(t,i,n){var e=this._getInternalSymbol().lineWidth;(!V(e)||e<3)&&(e=3);var o=this._getArrows(i,e);if(o.length){t.setLineDash&&t.setLineDash([]);for(var a=o.length-1;a>=0;a--)t.fillStyle=t.strokeStyle,j.polygon(t,o[a],n,n)}}});Oe.include({_getPaintParams:function(t){var i=this.getMap().getGLRes(),n=this._getPrjShell(),e=this._getPath2DPoints(n,t,i),o=e.length>0&&Array.isArray(e[0]);o&&(e=[[e[0]],[e[1]]]);var a=this._getPrjHoles(),s=[];if(a&&a.length>0){for(var l=this._simplified,h=0;h<a.length;h++){var u=this._getPath2DPoints(a[h],t,i);Array.isArray(u)&&o?Array.isArray(u[0])?(e[0].push(u[0]),e[1].push(u[1])):e[0].push(u):s.push(u)}l&&(this._simplified=l)}return o||(e=[e],pi(e,s)),[e]},_paintOn:function(t,i,n,e,o){var a=Ay(this._painter);return a.within?j.pixelRect(t,a.center,n,e):j.polygon(t,i,n,e,o,this.options.smoothness),this._getRenderBBOX(t,i)}});Q.VERSION=Ix;const gS=()=>{const{coordinate:r}=Xe.useContext(jf),{streetCrimes:t}=Xe.useContext(Nf),i=Xe.useRef(null);return Xe.useEffect(()=>{const n=[r[1],r[0]],e=new Q(i.current,{center:n,zoom:16.2,pitch:40,baseLayer:new Lt("base",{urlTemplate:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}@2x.png",subdomains:["a","b","c","d"],attribution:'&copy; <a href="http://osm.org">OpenStreetMap</a> contributors, &copy; <a href="https://carto.com/">CARTO</a>'})});let o=Do.getBoundingSquareLatLonPolygon(r,1e3);o.push(o[0]);const a=new xe(o.map(f=>[f[1],f[0]]),{symbol:{lineColor:"black",lineWidth:1}}),s=new Se(n);let l=[];for(const f of t){const c=l.findIndex(d=>d.length>0&&d[0].location.latitude==f.location.latitude&&d[0].location.longitude==f.location.longitude);if(c==-1){l.push([f]);continue}l[c].push(f)}const h=5,u=l.map(f=>{const c=parseFloat(f[0].location.latitude),d=parseFloat(f[0].location.longitude),g=f.length;let v=Do.getBoundingSquareLatLonPolygon([c,d],10);return v.push(v[0]),new xe(v.map(y=>[y[1],y[0]]),{symbol:{lineColor:"red",lineWidth:1,polygonFill:"red"},properties:{altitude:v.map(()=>g*h)}})});return new or("vector",[s,...u,a],{enableAltitude:!0,drawAltitude:{polygonFill:"red",polygonOpacity:.3}}).addTo(e),()=>{e.remove()}},[r]),We.jsx(We.Fragment,{children:We.jsx("div",{ref:i,id:"map",className:"container"})})},vS=({children:r})=>We.jsx(We.Fragment,{children:We.jsx(yx,{children:We.jsx(wx,{children:r})})});function pS(){return We.jsxs(vS,{children:[We.jsx(xx,{}),We.jsx(gS,{})]})}Eh.createRoot(document.getElementById("root")).render(We.jsx(Qy.StrictMode,{children:We.jsx(pS,{})}));
